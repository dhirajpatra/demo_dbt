2021-05-29 08:42:27.010542 (MainThread): Running with dbt=0.19.1
2021-05-29 08:42:28.262550 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:42:28.264388 (MainThread): Tracking: tracking
2021-05-29 08:42:28.264938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e66cfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e820d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e820d7c0>]}
2021-05-29 08:42:28.275812 (MainThread): Partial parsing not enabled
2021-05-29 08:42:28.276888 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:42:28.279154 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:42:28.308603 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:42:28.310828 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:42:28.312414 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:42:28.316397 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:42:28.327286 (MainThread): Parsing macros/core.sql
2021-05-29 08:42:28.331479 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:42:28.344200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:42:28.346911 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:42:28.375228 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:42:28.434499 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:42:28.462287 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:42:28.465889 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:42:28.477675 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:42:28.495935 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:42:28.503881 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:42:28.511748 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:42:28.519432 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:42:28.520642 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:42:28.522111 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:42:28.524224 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:42:28.534761 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:42:28.536975 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:42:28.538878 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:42:28.609763 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:42:28.613438 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:42:28.615391 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:42:28.617819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:42:28.631264 (MainThread): Partial parsing not enabled
2021-05-29 08:42:28.665018 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:28.678061 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:28.682547 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:28.819739 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e600b370>]}
2021-05-29 08:42:28.824139 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e600e8b0>]}
2021-05-29 08:42:28.824424 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:42:28.825284 (MainThread): 
2021-05-29 08:42:28.825605 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:42:28.826617 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:42:28.842083 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:42:28.842246 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:42:28.842345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:42:30.711734 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.87 seconds
2021-05-29 08:42:30.716062 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:42:31.736710 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:42:31.743927 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:42:31.744098 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:42:31.744203 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:42:33.908333 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.16 seconds
2021-05-29 08:42:33.909484 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:42:34.704544 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:34.704741 (MainThread): On master: BEGIN
2021-05-29 08:42:34.704856 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:42:36.236443 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 08:42:36.236660 (MainThread): On master: COMMIT
2021-05-29 08:42:36.236854 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:36.236962 (MainThread): On master: COMMIT
2021-05-29 08:42:36.748619 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:42:36.748888 (MainThread): On master: Close
2021-05-29 08:42:38.025786 (MainThread): 14:12:38 | Concurrency: 10 threads (target='dev')
2021-05-29 08:42:38.026006 (MainThread): 14:12:38 | 
2021-05-29 08:42:38.028207 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:38.028522 (Thread-1): 14:12:38 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:42:38.028738 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:42:38.029013 (Thread-2): 14:12:38 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:42:38.029345 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:38.029484 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:38.031911 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:42:38.032294 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:38.032424 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:42:38.033627 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:42:38.034039 (Thread-1): finished collecting timing info
2021-05-29 08:42:38.046146 (Thread-2): finished collecting timing info
2021-05-29 08:42:38.075106 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:42:38.078965 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:42:38.079979 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:38.080076 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:42:38.080162 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:42:38.082986 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:38.083294 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:42:38.083410 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:42:39.771957 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-29 08:42:39.772206 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:39.772339 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `demo_dbt`.demo_db.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `demo_dbt`.demo_db.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:42:39.871166 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 08:42:39.871358 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:39.871472 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:42:40.261153 (Thread-2): Snowflake query id: 019c910a-0000-439c-0000-0000b0b1e0f5
2021-05-29 08:42:40.261362 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DEMO_DBT`"' does not exist or not authorized.
2021-05-29 08:42:40.261578 (Thread-2): finished collecting timing info
2021-05-29 08:42:40.261783 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:42:40.637392 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:42:41.210508 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 08:42:41.212071 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:42:41.212328 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:41.212437 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:42:41.442441 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DBT`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DEMO_DBT`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DBT`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:42:41.447365 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8432a30>]}
2021-05-29 08:42:41.447866 (Thread-2): 14:12:41 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.42s]
2021-05-29 08:42:41.448037 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:42:42.351387 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-05-29 08:42:42.362825 (Thread-1): finished collecting timing info
2021-05-29 08:42:42.362981 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:42:43.170038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e841dc10>]}
2021-05-29 08:42:43.170492 (Thread-1): 14:12:43 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.14s]
2021-05-29 08:42:43.170655 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:43.171222 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:43.171662 (Thread-4): 14:12:43 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:42:43.171976 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:43.172089 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:43.174082 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:42:43.174513 (Thread-4): finished collecting timing info
2021-05-29 08:42:43.192843 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:42:43.193670 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:43.193772 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:42:43.193861 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:42:44.777075 (Thread-4): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 08:42:44.777320 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:44.777454 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:42:45.236111 (Thread-4): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-29 08:42:45.237239 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:42:45.237438 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:45.237548 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:42:45.526310 (Thread-4): SQL status: SUCCESS 1 in 0.29 seconds
2021-05-29 08:42:45.527373 (Thread-4): finished collecting timing info
2021-05-29 08:42:45.527624 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:42:46.116730 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8476130>]}
2021-05-29 08:42:46.117173 (Thread-4): 14:12:46 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.94s]
2021-05-29 08:42:46.117339 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:46.118790 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:42:46.119026 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:46.119138 (MainThread): On master: BEGIN
2021-05-29 08:42:46.119242 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:42:47.713589 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-29 08:42:47.713802 (MainThread): On master: COMMIT
2021-05-29 08:42:47.713961 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:47.714048 (MainThread): On master: COMMIT
2021-05-29 08:42:48.110650 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 08:42:48.110914 (MainThread): On master: Close
2021-05-29 08:42:48.727103 (MainThread): 14:12:48 | 
2021-05-29 08:42:48.727316 (MainThread): 14:12:48 | Finished running 2 table models, 1 view model in 19.90s.
2021-05-29 08:42:48.727451 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:42:48.727547 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:42:48.727633 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:42:48.727714 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:42:48.732261 (MainThread): 
2021-05-29 08:42:48.732416 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:42:48.732541 (MainThread): 
2021-05-29 08:42:48.732653 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:42:48.732793 (MainThread):   002003 (02000): SQL compilation error:
2021-05-29 08:42:48.732929 (MainThread):   Database '"`DEMO_DBT`"' does not exist or not authorized.
2021-05-29 08:42:48.733036 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:42:48.733141 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:42:48.733333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8397730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e81f7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e81f7910>]}
2021-05-29 08:42:48.733556 (MainThread): Flushing usage events
2021-05-29 08:43:53.439169 (MainThread): Running with dbt=0.19.1
2021-05-29 08:43:54.289817 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:43:54.291347 (MainThread): Tracking: tracking
2021-05-29 08:43:54.291944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9626ac7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a050580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a050610>]}
2021-05-29 08:43:54.303050 (MainThread): Partial parsing not enabled
2021-05-29 08:43:54.304292 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:43:54.307021 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:43:54.337671 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:43:54.339435 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:43:54.340712 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:43:54.344626 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:43:54.354416 (MainThread): Parsing macros/core.sql
2021-05-29 08:43:54.357808 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:43:54.365594 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:43:54.367141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:43:54.383707 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:43:54.416685 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:43:54.435297 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:43:54.436897 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:43:54.442233 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:43:54.455214 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:43:54.461628 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:43:54.467643 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:43:54.472661 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:43:54.473597 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:43:54.474773 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:43:54.476479 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:43:54.485161 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:43:54.487088 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:43:54.488615 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:43:54.531643 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:43:54.533367 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:43:54.534725 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:43:54.536223 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:43:54.542841 (MainThread): Partial parsing not enabled
2021-05-29 08:43:54.562208 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:43:54.569786 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:43:54.572754 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:43:54.688618 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962651a790>]}
2021-05-29 08:43:54.693412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962652b6d0>]}
2021-05-29 08:43:54.693684 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:43:54.694526 (MainThread): 
2021-05-29 08:43:54.694849 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:43:54.695815 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:43:54.709973 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:43:54.710134 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:43:54.710251 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:43:56.303111 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.59 seconds
2021-05-29 08:43:56.307155 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:43:56.919270 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:43:56.926472 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:43:56.926596 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:43:56.926687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:43:58.350076 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 08:43:58.351053 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:43:59.171446 (MainThread): Using snowflake connection "master".
2021-05-29 08:43:59.171646 (MainThread): On master: BEGIN
2021-05-29 08:43:59.171764 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:44:00.704959 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 08:44:00.705225 (MainThread): On master: COMMIT
2021-05-29 08:44:00.705455 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:00.705592 (MainThread): On master: COMMIT
2021-05-29 08:44:01.114914 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:01.115177 (MainThread): On master: Close
2021-05-29 08:44:02.243427 (MainThread): 14:14:02 | Concurrency: 10 threads (target='dev')
2021-05-29 08:44:02.243652 (MainThread): 14:14:02 | 
2021-05-29 08:44:02.245909 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:02.246188 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:44:02.246472 (Thread-1): 14:14:02 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:44:02.246742 (Thread-2): 14:14:02 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:44:02.247072 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:02.247535 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:02.250047 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:44:02.250486 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:02.250783 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:44:02.251900 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:44:02.252302 (Thread-1): finished collecting timing info
2021-05-29 08:44:02.258328 (Thread-2): finished collecting timing info
2021-05-29 08:44:02.303283 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:44:02.303620 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:44:02.305500 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:02.306146 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:02.306242 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:44:02.306364 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:44:02.306467 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:44:02.306551 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:44:03.641718 (Thread-2): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 08:44:03.641970 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:03.642112 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `DEMO_DB`.public.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `DEMO_DB`.public.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:44:03.711768 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-05-29 08:44:03.711993 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:03.712125 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:44:04.030663 (Thread-2): Snowflake query id: 019c910c-0000-43c0-0000-b0b1000100c2
2021-05-29 08:44:04.030880 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DEMO_DB`"' does not exist or not authorized.
2021-05-29 08:44:04.031056 (Thread-2): finished collecting timing info
2021-05-29 08:44:04.031218 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:44:04.494167 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:44:05.108958 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 08:44:05.110226 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:44:05.110419 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:05.110535 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:44:05.111813 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DB`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DEMO_DB`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DB`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:44:05.115791 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a266760>]}
2021-05-29 08:44:05.116170 (Thread-2): 14:14:05 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.87s]
2021-05-29 08:44:05.116345 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:44:05.415277 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 08:44:05.426934 (Thread-1): finished collecting timing info
2021-05-29 08:44:05.427129 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:44:06.134527 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a263ac0>]}
2021-05-29 08:44:06.134955 (Thread-1): 14:14:06 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.89s]
2021-05-29 08:44:06.135121 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:06.135695 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:06.135955 (Thread-4): 14:14:06 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:44:06.136390 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:06.136536 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:06.138763 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:44:06.139178 (Thread-4): finished collecting timing info
2021-05-29 08:44:06.157494 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:44:06.158317 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:06.158417 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:44:06.158504 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:44:08.282225 (Thread-4): SQL status: SUCCESS 1 in 2.12 seconds
2021-05-29 08:44:08.282448 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:08.282563 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:44:08.795542 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:44:08.796732 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:44:08.796951 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:08.797048 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:44:09.204521 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:09.205407 (Thread-4): finished collecting timing info
2021-05-29 08:44:09.205585 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:44:09.820778 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a2d7ca0>]}
2021-05-29 08:44:09.821236 (Thread-4): 14:14:09 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.68s]
2021-05-29 08:44:09.821406 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:09.822854 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:44:09.823051 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:09.823141 (MainThread): On master: BEGIN
2021-05-29 08:44:09.823224 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:44:11.661822 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 08:44:11.662079 (MainThread): On master: COMMIT
2021-05-29 08:44:11.662314 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:11.662448 (MainThread): On master: COMMIT
2021-05-29 08:44:12.070616 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:12.070864 (MainThread): On master: Close
2021-05-29 08:44:12.789352 (MainThread): 14:14:12 | 
2021-05-29 08:44:12.789563 (MainThread): 14:14:12 | Finished running 2 table models, 1 view model in 18.09s.
2021-05-29 08:44:12.789701 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:44:12.789798 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:44:12.789885 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:44:12.789975 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:44:12.794187 (MainThread): 
2021-05-29 08:44:12.794325 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:44:12.794442 (MainThread): 
2021-05-29 08:44:12.794552 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:44:12.794650 (MainThread):   002003 (02000): SQL compilation error:
2021-05-29 08:44:12.794740 (MainThread):   Database '"`DEMO_DB`"' does not exist or not authorized.
2021-05-29 08:44:12.794827 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:44:12.794925 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:44:12.795093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a1d85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9626ad2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a02fc70>]}
2021-05-29 08:44:12.795286 (MainThread): Flushing usage events
2021-05-29 08:45:35.537067 (MainThread): Running with dbt=0.19.1
2021-05-29 08:45:36.418492 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:45:36.419897 (MainThread): Tracking: tracking
2021-05-29 08:45:36.420403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb981dc7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984c50550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984c505e0>]}
2021-05-29 08:45:36.431955 (MainThread): Partial parsing not enabled
2021-05-29 08:45:36.433161 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:45:36.435849 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:45:36.469033 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:45:36.471370 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:45:36.473017 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:45:36.477348 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:45:36.488176 (MainThread): Parsing macros/core.sql
2021-05-29 08:45:36.492346 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:45:36.502043 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:45:36.503840 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:45:36.520713 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:45:36.552900 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:45:36.572167 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:45:36.573827 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:45:36.579315 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:45:36.592590 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:45:36.598957 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:45:36.604803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:45:36.609194 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:45:36.610048 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:45:36.610975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:45:36.612424 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:45:36.620907 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:45:36.622744 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:45:36.624282 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:45:36.664163 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:45:36.666043 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:45:36.667431 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:45:36.669079 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:45:36.675536 (MainThread): Partial parsing not enabled
2021-05-29 08:45:36.694626 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:36.702115 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:36.705035 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:36.830119 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7e20>]}
2021-05-29 08:45:36.835257 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7760>]}
2021-05-29 08:45:36.835543 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:45:36.836429 (MainThread): 
2021-05-29 08:45:36.836777 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:45:36.837786 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:45:36.852761 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:45:36.852922 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:45:36.853020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:45:38.659894 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.81 seconds
2021-05-29 08:45:38.663088 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:45:39.241051 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:45:39.247208 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:45:39.247349 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:45:39.247436 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:45:41.027938 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.78 seconds
2021-05-29 08:45:41.028899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:45:41.879160 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:41.879307 (MainThread): On master: BEGIN
2021-05-29 08:45:41.879418 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:45:43.647518 (MainThread): SQL status: SUCCESS 1 in 1.77 seconds
2021-05-29 08:45:43.647783 (MainThread): On master: COMMIT
2021-05-29 08:45:43.648027 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:43.648163 (MainThread): On master: COMMIT
2021-05-29 08:45:44.086866 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-29 08:45:44.087127 (MainThread): On master: Close
2021-05-29 08:45:44.857616 (MainThread): 14:15:44 | Concurrency: 10 threads (target='dev')
2021-05-29 08:45:44.857834 (MainThread): 14:15:44 | 
2021-05-29 08:45:44.859966 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:44.860247 (Thread-1): 14:15:44 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:45:44.860414 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:45:44.860704 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:44.860923 (Thread-2): 14:15:44 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:45:44.861069 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:44.861578 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:44.863778 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:45:44.863926 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:45:44.865365 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:45:44.865794 (Thread-1): finished collecting timing info
2021-05-29 08:45:44.872258 (Thread-2): finished collecting timing info
2021-05-29 08:45:44.915157 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:45:44.915493 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:45:44.917359 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:44.918014 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:44.918103 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:45:44.918209 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:45:44.918300 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:45:44.918378 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:45:46.645094 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-29 08:45:46.645344 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:46.645480 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:45:46.704606 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 08:45:46.704795 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:46.704900 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:45:47.093599 (Thread-2): Snowflake query id: 019c910d-0000-43c0-0000-b0b1000100e6
2021-05-29 08:45:47.093809 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 08:45:47.094028 (Thread-2): finished collecting timing info
2021-05-29 08:45:47.094234 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:45:47.604316 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-05-29 08:45:47.605888 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:45:47.606087 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:47.606195 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:45:47.944316 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 08:45:47.956162 (Thread-1): finished collecting timing info
2021-05-29 08:45:47.956361 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:45:48.974392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e63790>]}
2021-05-29 08:45:48.974983 (Thread-1): 14:15:48 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.11s]
2021-05-29 08:45:48.975145 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:48.975469 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:48.975691 (Thread-4): 14:15:48 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:45:48.975987 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:48.976103 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:48.978224 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:45:48.978694 (Thread-4): finished collecting timing info
2021-05-29 08:45:48.997374 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:45:48.999251 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:48.999557 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:45:48.999797 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:45:50.270127 (Thread-4): SQL status: SUCCESS 1 in 1.27 seconds
2021-05-29 08:45:50.270628 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:45:50.270746 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:50.272043 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:45:51.396576 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:45:51.399760 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e5dc40>]}
2021-05-29 08:45:51.400155 (Thread-2): 14:15:51 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 6.54s]
2021-05-29 08:45:51.400312 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:45:53.442601 (Thread-4): SQL status: SUCCESS 1 in 3.17 seconds
2021-05-29 08:45:53.443980 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:45:53.444221 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:53.444354 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:45:53.954609 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:45:53.955688 (Thread-4): finished collecting timing info
2021-05-29 08:45:53.955904 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:45:54.775503 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984ede910>]}
2021-05-29 08:45:54.775943 (Thread-4): 14:15:54 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 5.80s]
2021-05-29 08:45:54.776109 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:54.777692 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:45:54.777928 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:54.778036 (MainThread): On master: BEGIN
2021-05-29 08:45:54.778137 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:45:56.737744 (MainThread): SQL status: SUCCESS 1 in 1.96 seconds
2021-05-29 08:45:56.737915 (MainThread): On master: COMMIT
2021-05-29 08:45:56.738062 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:56.738144 (MainThread): On master: COMMIT
2021-05-29 08:45:57.128315 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-29 08:45:57.128586 (MainThread): On master: Close
2021-05-29 08:45:58.256788 (MainThread): 14:15:58 | 
2021-05-29 08:45:58.257003 (MainThread): 14:15:58 | Finished running 2 table models, 1 view model in 21.42s.
2021-05-29 08:45:58.257140 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:45:58.257237 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:45:58.257324 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:45:58.257406 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:45:58.261892 (MainThread): 
2021-05-29 08:45:58.262031 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:45:58.262146 (MainThread): 
2021-05-29 08:45:58.262260 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:45:58.262359 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 08:45:58.262449 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 08:45:58.262534 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:45:58.262631 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:45:58.262813 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb985005190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e5dc40>]}
2021-05-29 08:45:58.263019 (MainThread): Flushing usage events
2021-05-29 10:23:43.885901 (MainThread): Running with dbt=0.19.1
2021-05-29 10:23:45.172857 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:23:45.174517 (MainThread): Tracking: tracking
2021-05-29 10:23:45.175086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab41c5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab6550610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab65506a0>]}
2021-05-29 10:23:45.187257 (MainThread): Partial parsing not enabled
2021-05-29 10:23:45.188494 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:23:45.191254 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:23:45.220650 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:23:45.222390 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:23:45.223641 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:23:45.227180 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:23:45.236738 (MainThread): Parsing macros/core.sql
2021-05-29 10:23:45.240383 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:23:45.248109 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:23:45.249604 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:23:45.265223 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:23:45.297116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:23:45.315542 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:23:45.317131 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:23:45.322388 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:23:45.335296 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:23:45.341331 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:23:45.346848 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:23:45.351087 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:23:45.352040 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:23:45.353106 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:23:45.354519 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:23:45.362551 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:23:45.364258 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:23:45.365710 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:23:45.404352 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:23:45.405924 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:23:45.407189 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:23:45.408718 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:23:45.414964 (MainThread): Partial parsing not enabled
2021-05-29 10:23:45.433013 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:23:45.440968 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:23:45.443861 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:23:45.492685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab6716f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab66f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab687cb50>]}
2021-05-29 10:23:45.492883 (MainThread): Flushing usage events
2021-05-29 10:23:47.355669 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:23:47.355901 (MainThread): Encountered an error:
2021-05-29 10:23:47.356091 (MainThread): Compilation Error in model customers (models/customers.sql)
  Model 'model.demo_dbt.customers' (models/customers.sql) depends on a node named 'stg_customers' which was not found
2021-05-29 10:23:47.362406 (MainThread): Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 740, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 483, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Model 'model.demo_dbt.customers' (models/customers.sql) depends on a node named 'stg_customers' which was not found

2021-05-29 10:30:18.648566 (MainThread): Running with dbt=0.19.1
2021-05-29 10:30:19.445018 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:30:19.446479 (MainThread): Tracking: tracking
2021-05-29 10:30:19.447014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f986505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98650640>]}
2021-05-29 10:30:19.456936 (MainThread): Partial parsing not enabled
2021-05-29 10:30:19.458106 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:30:19.460315 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:30:19.486365 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:30:19.488099 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:30:19.489344 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:30:19.492843 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:30:19.501383 (MainThread): Parsing macros/core.sql
2021-05-29 10:30:19.504653 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:30:19.512537 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:30:19.514040 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:30:19.529467 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:30:19.560145 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:30:19.579898 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:30:19.581537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:30:19.586718 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:30:19.598761 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:30:19.604632 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:30:19.610365 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:30:19.614543 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:30:19.615346 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:30:19.616233 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:30:19.617613 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:30:19.625283 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:30:19.627000 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:30:19.628423 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:30:19.666264 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:30:19.667832 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:30:19.669109 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:30:19.670534 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:30:19.676968 (MainThread): Partial parsing not enabled
2021-05-29 10:30:19.695029 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:19.702534 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:19.705225 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:19.815282 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95233e80>]}
2021-05-29 10:30:19.820404 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f952337c0>]}
2021-05-29 10:30:19.820683 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:30:19.821579 (MainThread): 
2021-05-29 10:30:19.821944 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:30:19.822937 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:30:19.837101 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:30:19.837244 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:30:19.837343 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:30:21.908828 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.07 seconds
2021-05-29 10:30:21.913297 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:30:22.653181 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:30:22.661164 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:30:22.661298 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:30:22.661403 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:30:24.392367 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.73 seconds
2021-05-29 10:30:24.393507 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:30:25.212091 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:25.212283 (MainThread): On master: BEGIN
2021-05-29 10:30:25.212402 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:30:26.848501 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-29 10:30:26.848766 (MainThread): On master: COMMIT
2021-05-29 10:30:26.849008 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:26.849146 (MainThread): On master: COMMIT
2021-05-29 10:30:27.334740 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 10:30:27.335008 (MainThread): On master: Close
2021-05-29 10:30:28.006002 (MainThread): 16:00:28 | Concurrency: 10 threads (target='dev')
2021-05-29 10:30:28.006249 (MainThread): 16:00:28 | 
2021-05-29 10:30:28.008635 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:28.008876 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:30:28.009163 (Thread-1): 16:00:28 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:30:28.009419 (Thread-2): 16:00:28 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:30:28.009789 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:28.010438 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:28.010568 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:28.010704 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:30:28.013334 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:30:28.015725 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:30:28.016253 (Thread-1): finished collecting timing info
2021-05-29 10:30:28.034217 (Thread-2): finished collecting timing info
2021-05-29 10:30:28.062397 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:30:28.066111 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:30:28.067875 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:28.067976 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:30:28.068063 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:30:28.069818 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:28.069924 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:30:28.070010 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:30:29.921253 (Thread-2): SQL status: SUCCESS 1 in 1.85 seconds
2021-05-29 10:30:29.921544 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:29.921696 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:30:29.922702 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-05-29 10:30:29.923595 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:29.923752 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:30:30.534894 (Thread-2): Snowflake query id: 019c9176-0000-43c0-0000-b0b1000100fe
2021-05-29 10:30:30.535115 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:30:30.535342 (Thread-2): finished collecting timing info
2021-05-29 10:30:30.535558 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:30:31.148999 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:30:32.172791 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2021-05-29 10:30:32.174390 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:30:32.174644 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:32.174761 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:30:32.584434 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:30:32.596927 (Thread-1): finished collecting timing info
2021-05-29 10:30:32.597097 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:30:32.589220 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:30:32.603899 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9861ef70>]}
2021-05-29 10:30:32.604294 (Thread-2): 16:00:32 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 4.59s]
2021-05-29 10:30:32.604450 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:30:33.362385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98881eb0>]}
2021-05-29 10:30:33.362860 (Thread-1): 16:00:33 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.35s]
2021-05-29 10:30:33.363038 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:33.363550 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:33.364016 (Thread-4): 16:00:33 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:30:33.364382 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:33.364532 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:33.367046 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:30:33.367550 (Thread-4): finished collecting timing info
2021-05-29 10:30:33.386807 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:30:33.387612 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:33.387723 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:30:33.387815 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:30:38.111420 (Thread-4): SQL status: SUCCESS 1 in 4.72 seconds
2021-05-29 10:30:38.111678 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:38.111820 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:30:39.649678 (Thread-4): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 10:30:39.651095 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:30:39.651349 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:39.651468 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:30:40.057414 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:30:40.058520 (Thread-4): finished collecting timing info
2021-05-29 10:30:40.058746 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:30:41.083252 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b82fb80>]}
2021-05-29 10:30:41.083727 (Thread-4): 16:00:41 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 7.72s]
2021-05-29 10:30:41.083911 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:41.085482 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:30:41.085733 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:41.085851 (MainThread): On master: BEGIN
2021-05-29 10:30:41.085962 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:30:44.255329 (MainThread): SQL status: SUCCESS 1 in 3.17 seconds
2021-05-29 10:30:44.255602 (MainThread): On master: COMMIT
2021-05-29 10:30:44.255835 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:44.255971 (MainThread): On master: COMMIT
2021-05-29 10:30:44.767347 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 10:30:44.767629 (MainThread): On master: Close
2021-05-29 10:30:45.485997 (MainThread): 16:00:45 | 
2021-05-29 10:30:45.486233 (MainThread): 16:00:45 | Finished running 2 table models, 1 view model in 25.66s.
2021-05-29 10:30:45.486379 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:30:45.486483 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:30:45.486577 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:30:45.486667 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:30:45.492211 (MainThread): 
2021-05-29 10:30:45.492384 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:30:45.492531 (MainThread): 
2021-05-29 10:30:45.492669 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:30:45.492791 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:30:45.492905 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:30:45.493018 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:30:45.493141 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:30:45.493332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95233e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b8043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b804640>]}
2021-05-29 10:30:45.493600 (MainThread): Flushing usage events
2021-05-29 10:44:03.379168 (MainThread): Running with dbt=0.19.1
2021-05-29 10:44:04.152589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:44:04.155316 (MainThread): Tracking: tracking
2021-05-29 10:44:04.155852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02ab06cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c5925b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c592640>]}
2021-05-29 10:44:04.165454 (MainThread): Partial parsing not enabled
2021-05-29 10:44:04.166440 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:44:04.168657 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:44:04.194820 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:44:04.196691 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:44:04.197965 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:44:04.201451 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:44:04.210508 (MainThread): Parsing macros/core.sql
2021-05-29 10:44:04.214072 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:44:04.221746 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:44:04.223250 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:44:04.238767 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:44:04.269679 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:44:04.288778 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:44:04.290946 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:44:04.296485 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:44:04.308659 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:44:04.315016 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:44:04.320518 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:44:04.324687 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:44:04.325486 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:44:04.326372 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:44:04.327746 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:44:04.335316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:44:04.336976 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:44:04.338540 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:44:04.376927 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:44:04.378533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:44:04.379830 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:44:04.381434 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:44:04.387761 (MainThread): Partial parsing not enabled
2021-05-29 10:44:04.405759 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:04.413390 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:04.416367 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:04.526510 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a461e80>]}
2021-05-29 10:44:04.531467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a4617c0>]}
2021-05-29 10:44:04.531749 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:44:04.532602 (MainThread): 
2021-05-29 10:44:04.532945 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:44:04.533930 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:44:04.548496 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:44:04.548660 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:44:04.548763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:44:06.170204 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-29 10:44:06.174604 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:44:06.888517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:44:06.896757 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:44:06.896899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:44:06.897012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:44:08.002622 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.11 seconds
2021-05-29 10:44:08.003785 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:44:08.624874 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:08.625068 (MainThread): On master: BEGIN
2021-05-29 10:44:08.625187 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:44:10.061237 (MainThread): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 10:44:10.061517 (MainThread): On master: COMMIT
2021-05-29 10:44:10.061760 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:10.061907 (MainThread): On master: COMMIT
2021-05-29 10:44:10.480938 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-29 10:44:10.481305 (MainThread): On master: Close
2021-05-29 10:44:11.087377 (MainThread): 16:14:11 | Concurrency: 10 threads (target='dev')
2021-05-29 10:44:11.087618 (MainThread): 16:14:11 | 
2021-05-29 10:44:11.090002 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:11.090343 (Thread-1): 16:14:11 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:44:11.090705 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:11.090859 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:11.091425 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:44:11.093946 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:44:11.094151 (Thread-2): 16:14:11 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:44:11.094647 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:11.094779 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:44:11.096970 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:44:11.097342 (Thread-1): finished collecting timing info
2021-05-29 10:44:11.122273 (Thread-2): finished collecting timing info
2021-05-29 10:44:11.130171 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:44:11.130425 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:44:11.132521 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:11.132640 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:44:11.132730 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:44:11.134560 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:11.134669 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:44:11.134760 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:44:12.429862 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-29 10:44:12.430111 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:12.430252 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:44:12.927563 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 10:44:12.927799 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:12.927932 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:44:13.336634 (Thread-2): Snowflake query id: 019c9184-0000-43c0-0000-b0b100010126
2021-05-29 10:44:13.336859 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:44:13.337085 (Thread-2): finished collecting timing info
2021-05-29 10:44:13.337307 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:44:13.779264 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-29 10:44:13.780867 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:44:13.781120 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:13.781298 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:44:14.085609 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:44:14.098039 (Thread-1): finished collecting timing info
2021-05-29 10:44:14.098214 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:44:14.528523 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:44:14.795932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c6e5640>]}
2021-05-29 10:44:14.796426 (Thread-1): 16:14:14 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.71s]
2021-05-29 10:44:14.796617 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:14.797007 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:14.797275 (Thread-4): 16:14:14 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:44:14.797620 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:14.797763 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:14.800294 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:44:14.800793 (Thread-4): finished collecting timing info
2021-05-29 10:44:14.819842 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:44:14.820648 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:14.820753 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:44:14.820844 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:44:15.809605 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:44:15.814443 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d15ae50>]}
2021-05-29 10:44:15.814887 (Thread-2): 16:14:15 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 4.72s]
2021-05-29 10:44:15.815066 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:44:16.017093 (Thread-4): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-29 10:44:16.017340 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:16.017479 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:44:16.511232 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 10:44:16.512638 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:44:16.512888 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:16.513039 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:44:16.921056 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:44:16.922144 (Thread-4): finished collecting timing info
2021-05-29 10:44:16.922369 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:44:17.537555 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d45fac0>]}
2021-05-29 10:44:17.538028 (Thread-4): 16:14:17 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.74s]
2021-05-29 10:44:17.538206 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:17.539828 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:44:17.540077 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:17.540195 (MainThread): On master: BEGIN
2021-05-29 10:44:17.540306 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:44:18.866481 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:44:18.866759 (MainThread): On master: COMMIT
2021-05-29 10:44:18.866989 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:18.867136 (MainThread): On master: COMMIT
2021-05-29 10:44:19.277096 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:44:19.277380 (MainThread): On master: Close
2021-05-29 10:44:19.892337 (MainThread): 16:14:19 | 
2021-05-29 10:44:19.892565 (MainThread): 16:14:19 | Finished running 2 table models, 1 view model in 15.36s.
2021-05-29 10:44:19.892708 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:44:19.892813 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:44:19.892908 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:44:19.892999 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:44:19.898467 (MainThread): 
2021-05-29 10:44:19.898638 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:44:19.898777 (MainThread): 
2021-05-29 10:44:19.898911 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:44:19.899030 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:44:19.899135 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:44:19.899239 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:44:19.899356 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:44:19.899550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c5c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d0a2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d0a2eb0>]}
2021-05-29 10:44:19.899772 (MainThread): Flushing usage events
2021-05-29 10:45:27.822755 (MainThread): Running with dbt=0.19.1
2021-05-29 10:45:28.576876 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:45:28.578059 (MainThread): Tracking: tracking
2021-05-29 10:45:28.578733 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9360906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93624525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9362452640>]}
2021-05-29 10:45:28.588651 (MainThread): Partial parsing not enabled
2021-05-29 10:45:28.589697 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:45:28.591851 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:45:28.618177 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:45:28.619997 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:45:28.621276 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:45:28.624786 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:45:28.633539 (MainThread): Parsing macros/core.sql
2021-05-29 10:45:28.636881 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:45:28.644897 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:45:28.646437 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:45:28.662190 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:45:28.693399 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:45:28.713048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:45:28.714695 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:45:28.720063 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:45:28.732419 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:45:28.738587 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:45:28.744224 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:45:28.748521 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:45:28.749351 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:45:28.750263 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:45:28.751676 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:45:28.759496 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:45:28.761202 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:45:28.762666 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:45:28.801559 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:45:28.803356 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:45:28.804816 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:45:28.806466 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:45:28.812943 (MainThread): Partial parsing not enabled
2021-05-29 10:45:28.830868 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:28.838519 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:28.841475 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:28.951988 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936022fe80>]}
2021-05-29 10:45:28.957116 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936022f7c0>]}
2021-05-29 10:45:28.957395 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:45:28.958291 (MainThread): 
2021-05-29 10:45:28.958649 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:45:28.959665 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:45:28.974416 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:45:28.974573 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:45:28.974679 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:45:30.971788 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.00 seconds
2021-05-29 10:45:30.976206 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:45:31.675302 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:45:31.683532 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:45:31.683677 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:45:31.683791 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:45:33.104750 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 10:45:33.105921 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:45:34.131276 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:34.131466 (MainThread): On master: BEGIN
2021-05-29 10:45:34.131582 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:45:35.664707 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:45:35.664985 (MainThread): On master: COMMIT
2021-05-29 10:45:35.665223 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:35.665362 (MainThread): On master: COMMIT
2021-05-29 10:45:36.037552 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-29 10:45:36.037843 (MainThread): On master: Close
2021-05-29 10:45:36.690584 (MainThread): 16:15:36 | Concurrency: 10 threads (target='dev')
2021-05-29 10:45:36.690819 (MainThread): 16:15:36 | 
2021-05-29 10:45:36.693131 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:36.693462 (Thread-1): 16:15:36 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:45:36.693810 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:36.693973 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:36.694543 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:45:36.697083 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:45:36.697296 (Thread-2): 16:15:36 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:45:36.697788 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:36.697937 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:45:36.700290 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:45:36.700741 (Thread-1): finished collecting timing info
2021-05-29 10:45:36.706343 (Thread-2): finished collecting timing info
2021-05-29 10:45:36.753300 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:45:36.757093 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:45:36.758185 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:36.758287 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:45:36.758377 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:45:36.759616 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:36.759722 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:45:36.759809 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:45:38.056274 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-29 10:45:38.056531 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:38.056672 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:45:38.166109 (Thread-2): SQL status: SUCCESS 1 in 1.41 seconds
2021-05-29 10:45:38.166361 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:38.166510 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
select * from customers
      );
2021-05-29 10:45:38.505662 (Thread-2): Snowflake query id: 019c9185-0000-43c7-0000-b0b100014042
2021-05-29 10:45:38.505879 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 0 unexpected 'select'.
2021-05-29 10:45:38.506099 (Thread-2): finished collecting timing info
2021-05-29 10:45:38.506305 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:45:38.940925 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:45:39.658930 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-05-29 10:45:39.660493 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:45:39.660744 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:39.660856 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:45:39.687353 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 60 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:45:39.690441 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936266dc70>]}
2021-05-29 10:45:39.690812 (Thread-2): 16:15:39 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.99s]
2021-05-29 10:45:39.690980 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:45:39.955132 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-05-29 10:45:39.968158 (Thread-1): finished collecting timing info
2021-05-29 10:45:39.968354 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:45:40.684302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936265ddf0>]}
2021-05-29 10:45:40.684774 (Thread-1): 16:15:40 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 10:45:40.684947 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:40.685564 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:40.685838 (Thread-4): 16:15:40 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:45:40.686287 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:40.686438 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:40.688947 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:45:40.689435 (Thread-4): finished collecting timing info
2021-05-29 10:45:40.709090 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:45:40.709906 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:40.710011 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:45:40.710102 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:45:42.627608 (Thread-4): SQL status: SUCCESS 1 in 1.92 seconds
2021-05-29 10:45:42.627848 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:42.627983 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:45:43.242667 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:45:43.243994 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:45:43.244202 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:43.244318 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:45:43.651539 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:45:43.652636 (Thread-4): finished collecting timing info
2021-05-29 10:45:43.652858 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:45:44.677168 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93626b3670>]}
2021-05-29 10:45:44.677635 (Thread-4): 16:15:44 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 10:45:44.677808 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:44.679457 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:45:44.679703 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:44.679817 (MainThread): On master: BEGIN
2021-05-29 10:45:44.679921 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:45:46.413195 (MainThread): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-29 10:45:46.413460 (MainThread): On master: COMMIT
2021-05-29 10:45:46.413691 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:46.413831 (MainThread): On master: COMMIT
2021-05-29 10:45:46.800866 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-29 10:45:46.801140 (MainThread): On master: Close
2021-05-29 10:45:47.439380 (MainThread): 16:15:47 | 
2021-05-29 10:45:47.439607 (MainThread): 16:15:47 | Finished running 2 table models, 1 view model in 18.48s.
2021-05-29 10:45:47.439750 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:45:47.439854 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:45:47.439947 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:45:47.440036 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:45:47.445558 (MainThread): 
2021-05-29 10:45:47.445719 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:45:47.445854 (MainThread): 
2021-05-29 10:45:47.445982 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:45:47.446122 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:45:47.446220 (MainThread):   syntax error line 60 at position 0 unexpected 'select'.
2021-05-29 10:45:47.446316 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:45:47.446429 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:45:47.446602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93626ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93627dea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93627dec70>]}
2021-05-29 10:45:47.446825 (MainThread): Flushing usage events
2021-05-29 10:46:32.420554 (MainThread): Running with dbt=0.19.1
2021-05-29 10:46:33.169275 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:46:33.171478 (MainThread): Tracking: tracking
2021-05-29 10:46:33.171949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37eacdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38174f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38174f610>]}
2021-05-29 10:46:33.181427 (MainThread): Partial parsing not enabled
2021-05-29 10:46:33.182360 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:46:33.184519 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:46:33.210913 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:46:33.212653 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:46:33.213909 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:46:33.217349 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:46:33.225953 (MainThread): Parsing macros/core.sql
2021-05-29 10:46:33.229215 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:46:33.237196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:46:33.238737 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:46:33.254616 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:46:33.285022 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:46:33.304652 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:46:33.306442 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:46:33.311840 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:46:33.324018 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:46:33.329967 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:46:33.335378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:46:33.339864 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:46:33.340677 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:46:33.341571 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:46:33.342959 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:46:33.350636 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:46:33.352361 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:46:33.353814 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:46:33.391731 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:46:33.393328 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:46:33.394629 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:46:33.396076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:46:33.402283 (MainThread): Partial parsing not enabled
2021-05-29 10:46:33.420667 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:33.427817 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:33.430567 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:33.541234 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e52d790>]}
2021-05-29 10:46:33.546272 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e5406d0>]}
2021-05-29 10:46:33.546542 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:46:33.547407 (MainThread): 
2021-05-29 10:46:33.547756 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:46:33.548747 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:46:33.563030 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:46:33.563173 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:46:33.563270 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:46:35.261218 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.70 seconds
2021-05-29 10:46:35.265603 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:46:35.903203 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:46:35.910745 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:46:35.910876 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:46:35.910974 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:46:37.209416 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.30 seconds
2021-05-29 10:46:37.210580 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:46:37.924748 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:37.924939 (MainThread): On master: BEGIN
2021-05-29 10:46:37.925060 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:46:39.151578 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-29 10:46:39.151873 (MainThread): On master: COMMIT
2021-05-29 10:46:39.152124 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:39.152262 (MainThread): On master: COMMIT
2021-05-29 10:46:39.765560 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:46:39.765834 (MainThread): On master: Close
2021-05-29 10:46:40.379494 (MainThread): 16:16:40 | Concurrency: 10 threads (target='dev')
2021-05-29 10:46:40.379734 (MainThread): 16:16:40 | 
2021-05-29 10:46:40.382074 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:40.382408 (Thread-1): 16:16:40 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:46:40.382773 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:40.382926 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:40.383494 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:46:40.385970 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:46:40.386173 (Thread-2): 16:16:40 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:46:40.386657 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:40.386795 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:46:40.388097 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:46:40.388531 (Thread-1): finished collecting timing info
2021-05-29 10:46:40.394976 (Thread-2): finished collecting timing info
2021-05-29 10:46:40.440079 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:46:40.444322 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:46:40.445329 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:40.445429 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:46:40.445516 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:46:40.446783 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:40.446890 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:46:40.446978 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:46:41.814791 (Thread-2): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-29 10:46:41.816438 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:41.816597 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

)

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
select * from customers
      );
2021-05-29 10:46:42.222838 (Thread-2): Snowflake query id: 019c9186-0000-43c5-0000-b0b1000130d2
2021-05-29 10:46:42.223067 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:46:42.223302 (Thread-2): finished collecting timing info
2021-05-29 10:46:42.224224 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:46:42.226109 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2021-05-29 10:46:42.226457 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:42.226598 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:46:42.633648 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:46:43.347815 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:46:43.350817 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381969490>]}
2021-05-29 10:46:43.351225 (Thread-2): 16:16:43 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.96s]
2021-05-29 10:46:43.351393 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:46:43.465619 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-05-29 10:46:43.467215 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:46:43.467441 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:43.467555 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:46:43.963781 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-29 10:46:43.977063 (Thread-1): finished collecting timing info
2021-05-29 10:46:43.977262 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:46:44.683678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38195df70>]}
2021-05-29 10:46:44.684149 (Thread-1): 16:16:44 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.30s]
2021-05-29 10:46:44.684329 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:44.685010 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:44.685329 (Thread-4): 16:16:44 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:46:44.685785 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:44.685939 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:44.688452 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:46:44.688931 (Thread-4): finished collecting timing info
2021-05-29 10:46:44.707908 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:46:44.708730 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:44.708840 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:46:44.708931 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:46:46.318863 (Thread-4): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-29 10:46:46.319115 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:46.319253 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:46:46.933587 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:46:46.934985 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:46:46.935228 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:46.935371 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:46:47.493184 (Thread-4): SQL status: SUCCESS 1 in 0.56 seconds
2021-05-29 10:46:47.494282 (Thread-4): finished collecting timing info
2021-05-29 10:46:47.494508 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:46:48.164156 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381991100>]}
2021-05-29 10:46:48.164643 (Thread-4): 16:16:48 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-29 10:46:48.164821 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:48.166347 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:46:48.166586 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:48.166698 (MainThread): On master: BEGIN
2021-05-29 10:46:48.166802 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:46:49.802330 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-29 10:46:49.802601 (MainThread): On master: COMMIT
2021-05-29 10:46:49.802830 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:49.802964 (MainThread): On master: COMMIT
2021-05-29 10:46:50.202086 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 10:46:50.202372 (MainThread): On master: Close
2021-05-29 10:46:50.929158 (MainThread): 16:16:50 | 
2021-05-29 10:46:50.929388 (MainThread): 16:16:50 | Finished running 2 table models, 1 view model in 17.38s.
2021-05-29 10:46:50.929532 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:46:50.929636 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:46:50.929732 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:46:50.929822 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:46:50.935281 (MainThread): 
2021-05-29 10:46:50.935457 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:46:50.935632 (MainThread): 
2021-05-29 10:46:50.935779 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:46:50.935906 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:46:50.936020 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:46:50.936132 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:46:50.936255 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:46:50.936526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e52d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381969220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381ada3a0>]}
2021-05-29 10:46:50.936794 (MainThread): Flushing usage events
2021-05-29 10:47:26.819912 (MainThread): Running with dbt=0.19.1
2021-05-29 10:47:27.613351 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:47:27.614986 (MainThread): Tracking: tracking
2021-05-29 10:47:27.615650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4de705e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e024e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e024e6d0>]}
2021-05-29 10:47:27.625359 (MainThread): Partial parsing not enabled
2021-05-29 10:47:27.626401 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:47:27.628640 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:47:27.654967 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:47:27.656914 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:47:27.658172 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:47:27.661628 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:47:27.670486 (MainThread): Parsing macros/core.sql
2021-05-29 10:47:27.673764 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:47:27.681470 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:47:27.683000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:47:27.698924 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:47:27.729227 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:47:27.748295 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:47:27.749913 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:47:27.755149 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:47:27.767839 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:47:27.773837 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:47:27.779254 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:47:27.783419 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:47:27.784231 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:47:27.785112 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:47:27.786491 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:47:27.794101 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:47:27.795772 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:47:27.797346 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:47:27.835528 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:47:27.837114 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:47:27.838404 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:47:27.839851 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:47:27.846061 (MainThread): Partial parsing not enabled
2021-05-29 10:47:27.863866 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:27.871098 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:27.873912 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:27.984249 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e00f3eb0>]}
2021-05-29 10:47:27.989286 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e021e2e0>]}
2021-05-29 10:47:27.989579 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:47:27.990456 (MainThread): 
2021-05-29 10:47:27.990807 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:47:27.991816 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:47:28.006742 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:47:28.006919 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:47:28.007030 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:47:29.839186 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-29 10:47:29.843683 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:47:30.660429 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:47:30.668509 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:47:30.668650 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:47:30.668757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:47:32.193252 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.52 seconds
2021-05-29 10:47:32.194407 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:47:33.219421 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:33.219614 (MainThread): On master: BEGIN
2021-05-29 10:47:33.219733 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:47:34.753107 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:47:34.753377 (MainThread): On master: COMMIT
2021-05-29 10:47:34.753615 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:34.753752 (MainThread): On master: COMMIT
2021-05-29 10:47:35.162716 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:47:35.162989 (MainThread): On master: Close
2021-05-29 10:47:35.882318 (MainThread): 16:17:35 | Concurrency: 10 threads (target='dev')
2021-05-29 10:47:35.882557 (MainThread): 16:17:35 | 
2021-05-29 10:47:35.884852 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:35.885090 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:47:35.885373 (Thread-1): 16:17:35 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:47:35.885637 (Thread-2): 16:17:35 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:47:35.885997 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:35.886693 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:35.886839 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:35.886991 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:47:35.889518 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:47:35.890799 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:47:35.891293 (Thread-1): finished collecting timing info
2021-05-29 10:47:35.897488 (Thread-2): finished collecting timing info
2021-05-29 10:47:35.945360 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:47:35.948430 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:47:35.949465 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:35.949574 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:47:35.949667 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:47:35.950907 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:35.951015 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:47:35.951102 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:47:37.231756 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-29 10:47:37.232004 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:37.232143 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:47:37.341793 (Thread-2): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-29 10:47:37.342038 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:37.342185 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
      );
2021-05-29 10:47:37.722126 (Thread-2): Snowflake query id: 019c9187-0000-43c0-0000-b0b100010196
2021-05-29 10:47:37.722349 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:47:37.722576 (Thread-2): finished collecting timing info
2021-05-29 10:47:37.722787 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:47:38.131706 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:47:38.261243 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-05-29 10:47:38.262826 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:47:38.263087 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:38.263206 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:47:38.580911 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-29 10:47:38.593724 (Thread-1): finished collecting timing info
2021-05-29 10:47:38.593906 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:47:38.692886 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:47:38.696044 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e051e670>]}
2021-05-29 10:47:38.696459 (Thread-2): 16:17:38 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.81s]
2021-05-29 10:47:38.696645 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:47:39.162768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e051d310>]}
2021-05-29 10:47:39.163222 (Thread-1): 16:17:39 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.28s]
2021-05-29 10:47:39.163401 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:39.164028 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:39.164426 (Thread-4): 16:17:39 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:47:39.164783 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:39.164924 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:39.167412 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:47:39.167874 (Thread-4): finished collecting timing info
2021-05-29 10:47:39.187456 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:47:39.188254 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:39.188362 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:47:39.188453 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:47:40.691984 (Thread-4): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 10:47:40.692235 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:40.692379 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:47:41.159338 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-29 10:47:41.160741 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:47:41.160989 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:41.161127 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:47:41.511256 (Thread-4): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-29 10:47:41.512371 (Thread-4): finished collecting timing info
2021-05-29 10:47:41.512597 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:47:42.127764 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e0928fd0>]}
2021-05-29 10:47:42.128248 (Thread-4): 16:17:42 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.96s]
2021-05-29 10:47:42.128433 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:42.130099 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:47:42.130346 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:42.130467 (MainThread): On master: BEGIN
2021-05-29 10:47:42.130580 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:47:43.661658 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:47:43.661929 (MainThread): On master: COMMIT
2021-05-29 10:47:43.662159 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:43.662296 (MainThread): On master: COMMIT
2021-05-29 10:47:44.072313 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:47:44.072589 (MainThread): On master: Close
2021-05-29 10:47:44.892375 (MainThread): 16:17:44 | 
2021-05-29 10:47:44.892604 (MainThread): 16:17:44 | Finished running 2 table models, 1 view model in 16.90s.
2021-05-29 10:47:44.892749 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:47:44.892853 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:47:44.892947 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:47:44.893039 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:47:44.897954 (MainThread): 
2021-05-29 10:47:44.898130 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:47:44.898275 (MainThread): 
2021-05-29 10:47:44.898411 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:47:44.898531 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:47:44.898649 (MainThread):   syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:47:44.898759 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:47:44.898881 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:47:44.899067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e03e26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e04eb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e02a0250>]}
2021-05-29 10:47:44.899301 (MainThread): Flushing usage events
2021-05-29 10:48:05.828839 (MainThread): Running with dbt=0.19.1
2021-05-29 10:48:06.582810 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:48:06.583959 (MainThread): Tracking: tracking
2021-05-29 10:48:06.584461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd565c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aa0e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aa0e6a0>]}
2021-05-29 10:48:06.593970 (MainThread): Partial parsing not enabled
2021-05-29 10:48:06.594986 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:48:06.597112 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:48:06.625160 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:48:06.626942 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:48:06.628244 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:48:06.631820 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:48:06.640716 (MainThread): Parsing macros/core.sql
2021-05-29 10:48:06.644066 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:48:06.655962 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:48:06.657984 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:48:06.680668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:48:06.722264 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:48:06.746363 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:48:06.748458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:48:06.755328 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:48:06.770498 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:48:06.776830 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:48:06.782542 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:48:06.787077 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:48:06.787956 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:48:06.788913 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:48:06.790370 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:48:06.798435 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:48:06.800351 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:48:06.801881 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:48:06.842066 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:48:06.843758 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:48:06.845155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:48:06.846658 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:48:06.853249 (MainThread): Partial parsing not enabled
2021-05-29 10:48:06.872447 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:06.879828 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:06.882725 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:06.997606 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5542ee20>]}
2021-05-29 10:48:07.002421 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5542e730>]}
2021-05-29 10:48:07.002692 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:48:07.003563 (MainThread): 
2021-05-29 10:48:07.003938 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:48:07.005063 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:48:07.019356 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:48:07.019502 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:48:07.019604 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:48:08.603442 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-29 10:48:08.607892 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:48:09.263901 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:48:09.271898 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:48:09.272032 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:48:09.272159 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:48:10.694912 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 10:48:10.714871 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:48:11.311334 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:11.311518 (MainThread): On master: BEGIN
2021-05-29 10:48:11.311631 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:48:12.640232 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:48:12.640497 (MainThread): On master: COMMIT
2021-05-29 10:48:12.640734 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:12.640866 (MainThread): On master: COMMIT
2021-05-29 10:48:13.049764 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:48:13.050036 (MainThread): On master: Close
2021-05-29 10:48:13.651423 (MainThread): 16:18:13 | Concurrency: 10 threads (target='dev')
2021-05-29 10:48:13.651654 (MainThread): 16:18:13 | 
2021-05-29 10:48:13.654057 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:13.654388 (Thread-1): 16:18:13 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:48:13.654596 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:48:13.654977 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:13.655191 (Thread-2): 16:18:13 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:48:13.655358 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:13.656026 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:13.658560 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:48:13.658722 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:48:13.660137 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:48:13.660692 (Thread-2): finished collecting timing info
2021-05-29 10:48:13.667161 (Thread-1): finished collecting timing info
2021-05-29 10:48:13.714661 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:48:13.717913 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:48:13.718837 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:13.719480 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:13.719560 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:48:13.719656 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:48:13.719745 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:48:13.719822 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:48:15.303330 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 10:48:15.303907 (Thread-2): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 10:48:15.304055 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:15.304214 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:15.304360 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:48:15.304495 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

)

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
      );
2021-05-29 10:48:15.711479 (Thread-2): Snowflake query id: 019c9188-0000-43c5-0000-b0b100013126
2021-05-29 10:48:15.711698 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:48:15.711920 (Thread-2): finished collecting timing info
2021-05-29 10:48:15.712126 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:48:16.121294 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:48:16.467383 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-05-29 10:48:16.469013 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:48:16.469239 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:16.469353 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:48:16.737568 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:48:16.740726 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac29f10>]}
2021-05-29 10:48:16.741120 (Thread-2): 16:18:16 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.09s]
2021-05-29 10:48:16.741292 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:48:16.767383 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:48:16.779853 (Thread-1): finished collecting timing info
2021-05-29 10:48:16.780063 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:48:17.455011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ace25e0>]}
2021-05-29 10:48:17.455478 (Thread-1): 16:18:17 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.80s]
2021-05-29 10:48:17.455648 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:17.456247 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:17.456518 (Thread-4): 16:18:17 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:48:17.456966 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:17.457122 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:17.459612 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:48:17.460069 (Thread-4): finished collecting timing info
2021-05-29 10:48:17.478952 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:48:17.479732 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:17.479832 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:48:17.479918 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:48:19.295579 (Thread-4): SQL status: SUCCESS 1 in 1.82 seconds
2021-05-29 10:48:19.295817 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:19.295947 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:48:19.911293 (Thread-4): SQL status: SUCCESS 1 in 0.62 seconds
2021-05-29 10:48:19.912704 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:48:19.912963 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:19.913130 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:48:20.215034 (Thread-4): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:48:20.216121 (Thread-4): finished collecting timing info
2021-05-29 10:48:20.216336 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:48:20.834261 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac50880>]}
2021-05-29 10:48:20.834740 (Thread-4): 16:18:20 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-29 10:48:20.834914 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:20.836984 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:48:20.837224 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:20.837334 (MainThread): On master: BEGIN
2021-05-29 10:48:20.837435 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:48:22.265545 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-29 10:48:22.265805 (MainThread): On master: COMMIT
2021-05-29 10:48:22.266038 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:22.266172 (MainThread): On master: COMMIT
2021-05-29 10:48:22.675105 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:48:22.675375 (MainThread): On master: Close
2021-05-29 10:48:23.291417 (MainThread): 16:18:23 | 
2021-05-29 10:48:23.291639 (MainThread): 16:18:23 | Finished running 2 table models, 1 view model in 16.29s.
2021-05-29 10:48:23.291775 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:48:23.291871 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:48:23.291964 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:48:23.292404 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:48:23.297027 (MainThread): 
2021-05-29 10:48:23.297173 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:48:23.297299 (MainThread): 
2021-05-29 10:48:23.297417 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:48:23.297550 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:48:23.297646 (MainThread):   syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:48:23.297734 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:48:23.297834 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:48:23.297992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aba2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac31b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac31610>]}
2021-05-29 10:48:23.298200 (MainThread): Flushing usage events
2021-05-29 10:50:52.228849 (MainThread): Running with dbt=0.19.1
2021-05-29 10:50:52.993966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:50:52.995346 (MainThread): Tracking: tracking
2021-05-29 10:50:52.995846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd0307c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1e50580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1e50610>]}
2021-05-29 10:50:53.005842 (MainThread): Partial parsing not enabled
2021-05-29 10:50:53.006931 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:50:53.009092 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:50:53.035886 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:50:53.038113 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:50:53.039361 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:50:53.042775 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:50:53.051192 (MainThread): Parsing macros/core.sql
2021-05-29 10:50:53.054578 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:50:53.062020 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:50:53.063805 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:50:53.079570 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:50:53.109979 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:50:53.128678 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:50:53.130300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:50:53.135553 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:50:53.148478 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:50:53.154509 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:50:53.160067 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:50:53.164284 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:50:53.165097 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:50:53.165987 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:50:53.167381 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:50:53.175454 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:50:53.177163 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:50:53.178619 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:50:53.216771 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:50:53.218329 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:50:53.219735 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:50:53.221191 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:50:53.227377 (MainThread): Partial parsing not enabled
2021-05-29 10:50:53.245142 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:50:53.252141 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:50:53.255008 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:50:53.368998 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcfb2d790>]}
2021-05-29 10:50:53.374517 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcfb406d0>]}
2021-05-29 10:50:53.374836 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:50:53.375762 (MainThread): 
2021-05-29 10:50:53.376139 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:50:53.377219 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:50:53.392571 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:50:53.392725 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:50:53.392832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:50:55.346695 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.95 seconds
2021-05-29 10:50:55.350972 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:50:56.065572 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:50:56.073578 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:50:56.073722 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:50:56.073834 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:50:57.664979 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.59 seconds
2021-05-29 10:50:57.666137 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:50:58.518543 (MainThread): Using snowflake connection "master".
2021-05-29 10:50:58.518733 (MainThread): On master: BEGIN
2021-05-29 10:50:58.518853 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:51:00.363040 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 10:51:00.363309 (MainThread): On master: COMMIT
2021-05-29 10:51:00.363536 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:00.363670 (MainThread): On master: COMMIT
2021-05-29 10:51:00.977503 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:51:00.977780 (MainThread): On master: Close
2021-05-29 10:51:01.724711 (MainThread): 16:21:01 | Concurrency: 10 threads (target='dev')
2021-05-29 10:51:01.724942 (MainThread): 16:21:01 | 
2021-05-29 10:51:01.727377 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:01.727703 (Thread-1): 16:21:01 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:51:01.727885 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:51:01.728257 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:01.728521 (Thread-2): 16:21:01 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:51:01.728692 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:01.731518 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:51:01.732071 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:01.732225 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:51:01.733370 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:51:01.733789 (Thread-1): finished collecting timing info
2021-05-29 10:51:01.740247 (Thread-2): finished collecting timing info
2021-05-29 10:51:01.786427 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:51:01.790149 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:51:01.791973 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:01.792078 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:51:01.792169 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:51:01.793388 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:01.793493 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:51:01.793580 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:51:03.041327 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-29 10:51:03.041581 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:03.041722 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:51:03.121422 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:51:03.121659 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:03.121793 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:51:03.461069 (Thread-2): Snowflake query id: 019c918b-0000-43c5-0000-b0b10001313e
2021-05-29 10:51:03.461295 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:51:03.461516 (Thread-2): finished collecting timing info
2021-05-29 10:51:03.461725 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:51:03.793262 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:51:03.971170 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-05-29 10:51:03.972762 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:51:03.973022 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:03.973140 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:51:04.270845 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:51:04.283518 (Thread-1): finished collecting timing info
2021-05-29 10:51:04.283694 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:51:04.353038 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:51:04.356212 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd206a760>]}
2021-05-29 10:51:04.356623 (Thread-2): 16:21:04 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.63s]
2021-05-29 10:51:04.356802 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:51:04.871746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd209b880>]}
2021-05-29 10:51:04.872205 (Thread-1): 16:21:04 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.14s]
2021-05-29 10:51:04.872379 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:04.872990 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:04.873274 (Thread-4): 16:21:04 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:51:04.873635 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:04.873783 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:04.876405 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:51:04.876897 (Thread-4): finished collecting timing info
2021-05-29 10:51:04.897041 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:51:04.897879 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:04.897992 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:51:04.898101 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:51:06.454580 (Thread-4): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-29 10:51:06.454830 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:06.454969 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:51:06.982051 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-29 10:51:06.983455 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:51:06.983701 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:06.983842 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:51:07.326292 (Thread-4): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 10:51:07.327401 (Thread-4): finished collecting timing info
2021-05-29 10:51:07.327629 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:51:07.940819 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd2064370>]}
2021-05-29 10:51:07.941293 (Thread-4): 16:21:07 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.07s]
2021-05-29 10:51:07.941469 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:07.943017 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:51:07.943264 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:07.943383 (MainThread): On master: BEGIN
2021-05-29 10:51:07.943494 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:51:09.421253 (MainThread): SQL status: SUCCESS 1 in 1.48 seconds
2021-05-29 10:51:09.421522 (MainThread): On master: COMMIT
2021-05-29 10:51:09.421747 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:09.421881 (MainThread): On master: COMMIT
2021-05-29 10:51:09.783880 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-29 10:51:09.784157 (MainThread): On master: Close
2021-05-29 10:51:10.408724 (MainThread): 16:21:10 | 
2021-05-29 10:51:10.408954 (MainThread): 16:21:10 | Finished running 2 table models, 1 view model in 17.03s.
2021-05-29 10:51:10.409105 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:51:10.409210 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:51:10.409305 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:51:10.409396 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:51:10.414226 (MainThread): 
2021-05-29 10:51:10.414399 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:51:10.414545 (MainThread): 
2021-05-29 10:51:10.414687 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:51:10.414817 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:51:10.414931 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:51:10.415040 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:51:10.415163 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:51:10.415357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1fe05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd21189a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd2118a00>]}
2021-05-29 10:51:10.415607 (MainThread): Flushing usage events
2021-05-29 10:52:42.579349 (MainThread): Running with dbt=0.19.1
2021-05-29 10:52:43.335419 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:52:43.336819 (MainThread): Tracking: tracking
2021-05-29 10:52:43.337297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eccad0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece70d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece70d700>]}
2021-05-29 10:52:43.346569 (MainThread): Partial parsing not enabled
2021-05-29 10:52:43.347589 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:52:43.349933 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:52:43.375808 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:52:43.377557 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:52:43.378867 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:52:43.382299 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:52:43.390722 (MainThread): Parsing macros/core.sql
2021-05-29 10:52:43.393953 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:52:43.401906 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:52:43.403429 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:52:43.419137 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:52:43.449369 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:52:43.468995 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:52:43.470762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:52:43.476015 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:52:43.488130 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:52:43.494023 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:52:43.499429 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:52:43.504073 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:52:43.504876 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:52:43.505754 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:52:43.507131 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:52:43.514654 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:52:43.516315 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:52:43.517738 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:52:43.556188 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:52:43.557873 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:52:43.559167 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:52:43.560613 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:52:43.566925 (MainThread): Partial parsing not enabled
2021-05-29 10:52:43.585017 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:43.592132 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:43.594913 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:43.704157 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc40a730>]}
2021-05-29 10:52:43.709051 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc404820>]}
2021-05-29 10:52:43.709319 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:52:43.710163 (MainThread): 
2021-05-29 10:52:43.710504 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:52:43.711528 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:52:43.725739 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:52:43.725885 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:52:43.725988 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:52:45.527896 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.80 seconds
2021-05-29 10:52:45.532303 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:52:46.246772 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:52:46.254947 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:52:46.255081 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:52:46.255186 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:52:47.887606 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-29 10:52:47.888768 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:52:48.609813 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:48.610007 (MainThread): On master: BEGIN
2021-05-29 10:52:48.610128 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:52:50.032301 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-29 10:52:50.032577 (MainThread): On master: COMMIT
2021-05-29 10:52:50.032818 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:50.032964 (MainThread): On master: COMMIT
2021-05-29 10:52:50.544359 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 10:52:50.544642 (MainThread): On master: Close
2021-05-29 10:52:51.365576 (MainThread): 16:22:51 | Concurrency: 10 threads (target='dev')
2021-05-29 10:52:51.365813 (MainThread): 16:22:51 | 
2021-05-29 10:52:51.368092 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:51.368275 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:52:51.368603 (Thread-1): 16:22:51 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:52:51.368856 (Thread-2): 16:22:51 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 10:52:51.369221 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:51.369952 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:51.370095 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:51.370262 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:52:51.372882 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:52:51.374234 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:52:51.374828 (Thread-1): finished collecting timing info
2021-05-29 10:52:51.381288 (Thread-2): finished collecting timing info
2021-05-29 10:52:51.428873 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:52:51.430531 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:52:51.431488 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:51.431589 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:52:51.431679 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:52:51.434161 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:51.434271 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:52:51.434359 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:52:53.103877 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-05-29 10:52:53.104134 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:53.104278 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:52:53.244387 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-05-29 10:52:53.244635 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:53.244774 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 10:52:53.718361 (Thread-2): Snowflake query id: 019c918c-0000-43c0-0000-b0b1000101ea
2021-05-29 10:52:53.718580 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:52:53.718815 (Thread-2): finished collecting timing info
2021-05-29 10:52:53.719032 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:52:54.073916 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:52:54.573506 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-05-29 10:52:54.575120 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:52:54.575346 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:54.575467 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:52:54.745441 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:52:54.748602 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece926220>]}
2021-05-29 10:52:54.749024 (Thread-2): 16:22:54 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.38s]
2021-05-29 10:52:54.749196 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:52:54.883607 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 10:52:54.895264 (Thread-1): finished collecting timing info
2021-05-29 10:52:54.895429 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:52:55.565041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece93a430>]}
2021-05-29 10:52:55.565515 (Thread-1): 16:22:55 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.20s]
2021-05-29 10:52:55.565693 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:55.566199 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:55.566639 (Thread-4): 16:22:55 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:52:55.566995 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:55.567139 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:55.569553 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:52:55.570095 (Thread-4): finished collecting timing info
2021-05-29 10:52:55.572202 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:52:55.573031 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:55.573147 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:52:55.573249 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:52:57.200260 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-29 10:52:57.200521 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:57.200663 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:52:58.223894 (Thread-4): SQL status: SUCCESS 1 in 1.02 seconds
2021-05-29 10:52:58.225310 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:52:58.225559 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:58.225697 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:52:58.521178 (Thread-4): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:52:58.522287 (Thread-4): finished collecting timing info
2021-05-29 10:52:58.522518 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:52:59.353969 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecef2a4f0>]}
2021-05-29 10:52:59.354448 (Thread-4): 16:22:59 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-29 10:52:59.354630 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:59.356275 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:52:59.356528 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:59.356649 (MainThread): On master: BEGIN
2021-05-29 10:52:59.356762 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:53:00.650010 (MainThread): SQL status: SUCCESS 1 in 1.29 seconds
2021-05-29 10:53:00.650281 (MainThread): On master: COMMIT
2021-05-29 10:53:00.650516 (MainThread): Using snowflake connection "master".
2021-05-29 10:53:00.650654 (MainThread): On master: COMMIT
2021-05-29 10:53:01.091621 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-29 10:53:01.091903 (MainThread): On master: Close
2021-05-29 10:53:01.709015 (MainThread): 16:23:01 | 
2021-05-29 10:53:01.709254 (MainThread): 16:23:01 | Finished running 2 view models, 1 table model in 18.00s.
2021-05-29 10:53:01.709401 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:53:01.709508 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:53:01.709606 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:53:01.709698 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:53:01.714645 (MainThread): 
2021-05-29 10:53:01.714812 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:53:01.714955 (MainThread): 
2021-05-29 10:53:01.715092 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:53:01.715217 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:53:01.715326 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:53:01.715433 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:53:01.715552 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:53:01.715739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc404490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece777ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece777430>]}
2021-05-29 10:53:01.715998 (MainThread): Flushing usage events
2021-05-29 11:04:38.356033 (MainThread): Running with dbt=0.19.1
2021-05-29 11:04:39.685436 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:04:39.686936 (MainThread): Tracking: tracking
2021-05-29 11:04:39.687572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a3505e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a574e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a574e6d0>]}
2021-05-29 11:04:39.698595 (MainThread): Partial parsing not enabled
2021-05-29 11:04:39.699802 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:04:39.702635 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:04:39.730299 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:04:39.731993 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:04:39.733212 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:04:39.736579 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:04:39.746820 (MainThread): Parsing macros/core.sql
2021-05-29 11:04:39.750160 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:04:39.757713 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:04:39.759186 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:04:39.774992 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:04:39.805030 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:04:39.823918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:04:39.825517 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:04:39.830755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:04:39.843297 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:04:39.849351 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:04:39.855133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:04:39.859308 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:04:39.860112 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:04:39.860998 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:04:39.862376 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:04:39.869948 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:04:39.871641 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:04:39.873311 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:04:39.911304 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:04:39.912842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:04:39.914092 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:04:39.915503 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:04:39.921763 (MainThread): Partial parsing not enabled
2021-05-29 11:04:39.939578 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:39.946520 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:39.949315 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:40.059943 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a55f3eb0>]}
2021-05-29 11:04:40.064973 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a571e2e0>]}
2021-05-29 11:04:40.065256 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:04:40.066162 (MainThread): 
2021-05-29 11:04:40.066520 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:04:40.067559 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:04:40.082775 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:04:40.082922 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:04:40.083020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:04:42.013964 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.93 seconds
2021-05-29 11:04:42.018393 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:04:42.604827 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:04:42.613520 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:04:42.613728 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:04:42.613840 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:04:43.870766 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.26 seconds
2021-05-29 11:04:43.871947 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:04:44.473493 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:44.473677 (MainThread): On master: BEGIN
2021-05-29 11:04:44.473793 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:04:45.700421 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-29 11:04:45.700683 (MainThread): On master: COMMIT
2021-05-29 11:04:45.700925 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:45.701057 (MainThread): On master: COMMIT
2021-05-29 11:04:46.108383 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:04:46.108660 (MainThread): On master: Close
2021-05-29 11:04:46.724988 (MainThread): 16:34:46 | Concurrency: 10 threads (target='dev')
2021-05-29 11:04:46.725218 (MainThread): 16:34:46 | 
2021-05-29 11:04:46.727561 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:46.727877 (Thread-1): 16:34:46 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:04:46.728092 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:04:46.728370 (Thread-2): 16:34:46 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 11:04:46.728719 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:46.728879 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:46.731651 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:04:46.732072 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:46.732209 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:04:46.733458 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:04:46.734886 (Thread-1): finished collecting timing info
2021-05-29 11:04:46.741198 (Thread-2): finished collecting timing info
2021-05-29 11:04:46.788450 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:04:46.789910 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:04:46.790954 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:46.791053 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:04:46.791142 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:04:46.792802 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:46.792906 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:04:46.792992 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:04:48.108567 (Thread-2): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-29 11:04:48.108814 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:48.108965 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-29 11:04:48.207775 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-29 11:04:48.208016 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:48.208146 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:04:48.566033 (Thread-2): Snowflake query id: 019c9198-0000-43c7-0000-b0b1000140ea
2021-05-29 11:04:48.566246 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-29 11:04:48.566471 (Thread-2): finished collecting timing info
2021-05-29 11:04:48.566675 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:04:49.180597 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:04:49.587282 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-29 11:04:49.588863 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:04:49.589095 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:49.589207 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:04:49.799411 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:04:49.804867 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5aee670>]}
2021-05-29 11:04:49.805390 (Thread-2): 16:34:49 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.07s]
2021-05-29 11:04:49.805607 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:04:49.917028 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-29 11:04:49.928749 (Thread-1): finished collecting timing info
2021-05-29 11:04:49.928901 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:04:50.718976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5ae35b0>]}
2021-05-29 11:04:50.719436 (Thread-1): 16:34:50 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 11:04:50.719614 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:50.720124 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:50.720419 (Thread-4): 16:34:50 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:04:50.720781 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:50.720924 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:50.723349 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:04:50.723974 (Thread-4): finished collecting timing info
2021-05-29 11:04:50.726126 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:04:50.726963 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:50.727072 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:04:50.727170 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:04:52.355900 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-29 11:04:52.356140 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:52.356276 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:04:52.835312 (Thread-4): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-29 11:04:52.836711 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:04:52.836955 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:52.837088 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:04:53.173631 (Thread-4): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 11:04:53.174696 (Thread-4): finished collecting timing info
2021-05-29 11:04:53.174902 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:04:53.756750 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5aec400>]}
2021-05-29 11:04:53.757205 (Thread-4): 16:34:53 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.04s]
2021-05-29 11:04:53.757379 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:53.759050 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:04:53.759296 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:53.759409 (MainThread): On master: BEGIN
2021-05-29 11:04:53.759516 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:04:55.324592 (MainThread): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-29 11:04:55.324845 (MainThread): On master: COMMIT
2021-05-29 11:04:55.325066 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:55.325193 (MainThread): On master: COMMIT
2021-05-29 11:04:55.734161 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:04:55.734434 (MainThread): On master: Close
2021-05-29 11:04:56.453195 (MainThread): 16:34:56 | 
2021-05-29 11:04:56.453385 (MainThread): 16:34:56 | Finished running 2 view models, 1 table model in 16.39s.
2021-05-29 11:04:56.453503 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:04:56.453584 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:04:56.453657 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:04:56.453727 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:04:56.457855 (MainThread): 
2021-05-29 11:04:56.458030 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:04:56.458151 (MainThread): 
2021-05-29 11:04:56.458262 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:04:56.458360 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:04:56.458449 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-29 11:04:56.458534 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:04:56.458633 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:04:56.458806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a59d76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5b2ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5b1c970>]}
2021-05-29 11:04:56.459023 (MainThread): Flushing usage events
2021-05-29 11:06:00.154580 (MainThread): Running with dbt=0.19.1
2021-05-29 11:06:00.902123 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:06:00.903596 (MainThread): Tracking: tracking
2021-05-29 11:06:00.904049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20d7f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f34c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f34c6d0>]}
2021-05-29 11:06:00.913446 (MainThread): Partial parsing not enabled
2021-05-29 11:06:00.914408 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:06:00.916578 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:06:00.942959 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:06:00.944810 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:06:00.946040 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:06:00.949410 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:06:00.957798 (MainThread): Parsing macros/core.sql
2021-05-29 11:06:00.961288 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:06:00.968795 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:06:00.970282 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:06:00.985715 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:06:01.017405 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:06:01.037337 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:06:01.038954 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:06:01.044344 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:06:01.056505 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:06:01.062657 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:06:01.068135 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:06:01.072482 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:06:01.073291 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:06:01.074251 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:06:01.075639 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:06:01.083288 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:06:01.084974 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:06:01.086412 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:06:01.124865 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:06:01.126574 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:06:01.127888 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:06:01.129347 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:06:01.135718 (MainThread): Partial parsing not enabled
2021-05-29 11:06:01.154132 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:01.162173 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:01.164964 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:01.279094 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f2f3eb0>]}
2021-05-29 11:06:01.284133 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f31e2e0>]}
2021-05-29 11:06:01.284415 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:06:01.285315 (MainThread): 
2021-05-29 11:06:01.285679 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:06:01.286675 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:06:01.301015 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:06:01.301165 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:06:01.301267 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:06:02.995433 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.69 seconds
2021-05-29 11:06:02.999672 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:06:03.782517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:06:03.790280 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:06:03.790407 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:06:03.790520 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:06:05.437505 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.65 seconds
2021-05-29 11:06:05.438666 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:06:06.010398 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:06.010587 (MainThread): On master: BEGIN
2021-05-29 11:06:06.010705 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:06:07.500683 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-29 11:06:07.500951 (MainThread): On master: COMMIT
2021-05-29 11:06:07.501192 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:07.501327 (MainThread): On master: COMMIT
2021-05-29 11:06:07.910139 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:06:07.910413 (MainThread): On master: Close
2021-05-29 11:06:08.526482 (MainThread): 16:36:08 | Concurrency: 10 threads (target='dev')
2021-05-29 11:06:08.526719 (MainThread): 16:36:08 | 
2021-05-29 11:06:08.529050 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:08.529386 (Thread-1): 16:36:08 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:06:08.529604 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:06:08.529899 (Thread-2): 16:36:08 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:06:08.530285 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:08.530452 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:08.531028 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:08.531180 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:06:08.533753 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:06:08.536372 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:06:08.536797 (Thread-2): finished collecting timing info
2021-05-29 11:06:08.542656 (Thread-1): finished collecting timing info
2021-05-29 11:06:08.590066 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:06:08.592948 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:06:08.594416 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:08.594523 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:06:08.594614 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:06:08.596409 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:08.596523 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:06:08.596610 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:06:09.966208 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-29 11:06:09.966460 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:09.966595 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:06:10.034768 (Thread-2): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:06:10.034972 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:10.035081 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-29 11:06:10.572165 (Thread-2): Snowflake query id: 019c919a-0000-43c0-0000-b0b100010212
2021-05-29 11:06:10.572390 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:06:10.572616 (Thread-2): finished collecting timing info
2021-05-29 11:06:10.572829 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:06:11.186934 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:06:11.224777 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-29 11:06:11.226372 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:06:11.226623 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:11.226739 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:06:11.534689 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 11:06:11.547180 (Thread-1): finished collecting timing info
2021-05-29 11:06:11.547348 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:06:11.803462 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:06:11.806571 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f79cfa0>]}
2021-05-29 11:06:11.806975 (Thread-2): 16:36:11 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.28s]
2021-05-29 11:06:11.807166 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:06:12.316514 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3a0250>]}
2021-05-29 11:06:12.316978 (Thread-1): 16:36:12 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-29 11:06:12.317154 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:12.317790 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:12.318085 (Thread-4): 16:36:12 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:06:12.318544 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:12.318696 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:12.321162 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:06:12.321643 (Thread-4): finished collecting timing info
2021-05-29 11:06:12.340498 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:06:12.341293 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:12.341402 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:06:12.341494 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:06:13.849697 (Thread-4): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-29 11:06:13.849953 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:13.850092 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:06:14.463475 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 11:06:14.464793 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:06:14.464998 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:14.465114 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:06:14.771791 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 11:06:14.772893 (Thread-4): finished collecting timing info
2021-05-29 11:06:14.773114 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:06:15.796430 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd210c1dfa0>]}
2021-05-29 11:06:15.796898 (Thread-4): 16:36:15 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-29 11:06:15.797078 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:15.798603 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:06:15.798853 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:15.798970 (MainThread): On master: BEGIN
2021-05-29 11:06:15.799078 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:06:17.638201 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 11:06:17.638474 (MainThread): On master: COMMIT
2021-05-29 11:06:17.638715 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:17.638851 (MainThread): On master: COMMIT
2021-05-29 11:06:18.252579 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 11:06:18.252856 (MainThread): On master: Close
2021-05-29 11:06:19.073880 (MainThread): 16:36:19 | 
2021-05-29 11:06:19.074117 (MainThread): 16:36:19 | Finished running 2 table models, 1 view model in 17.79s.
2021-05-29 11:06:19.074271 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:06:19.074376 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:06:19.074472 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:06:19.074563 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:06:19.079261 (MainThread): 
2021-05-29 11:06:19.079419 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:06:19.079553 (MainThread): 
2021-05-29 11:06:19.079683 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:06:19.079799 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:06:19.079904 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:06:19.080004 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:06:19.080118 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:06:19.080396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3889d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3a0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f7d5a30>]}
2021-05-29 11:06:19.080652 (MainThread): Flushing usage events
2021-05-29 11:11:05.669223 (MainThread): Running with dbt=0.19.1
2021-05-29 11:11:06.447776 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:11:06.449329 (MainThread): Tracking: tracking
2021-05-29 11:11:06.449765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa285b06c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2899925b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289992640>]}
2021-05-29 11:11:06.459584 (MainThread): Partial parsing not enabled
2021-05-29 11:11:06.460550 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:11:06.462673 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:11:06.488676 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:11:06.490613 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:11:06.491885 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:11:06.495479 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:11:06.504050 (MainThread): Parsing macros/core.sql
2021-05-29 11:11:06.507333 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:11:06.514982 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:11:06.516506 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:11:06.532255 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:11:06.562393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:11:06.581608 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:11:06.583318 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:11:06.589099 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:11:06.601488 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:11:06.607432 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:11:06.612881 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:11:06.617089 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:11:06.618228 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:11:06.619126 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:11:06.620503 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:11:06.628187 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:11:06.629880 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:11:06.631327 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:11:06.669499 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:11:06.671110 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:11:06.672530 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:11:06.673991 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:11:06.680284 (MainThread): Partial parsing not enabled
2021-05-29 11:11:06.698326 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:06.705997 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:06.708722 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:06.818543 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa285449e80>]}
2021-05-29 11:11:06.823545 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2854497c0>]}
2021-05-29 11:11:06.823821 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:11:06.824684 (MainThread): 
2021-05-29 11:11:06.825030 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:11:06.826014 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:11:06.840561 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:11:06.840712 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:11:06.840810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:11:08.763309 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-05-29 11:11:08.767742 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:11:09.380701 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:11:09.388971 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:11:09.389120 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:11:09.389236 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:11:11.219542 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-29 11:11:11.220682 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:11:12.041459 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:12.041651 (MainThread): On master: BEGIN
2021-05-29 11:11:12.041770 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:11:13.394376 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-29 11:11:13.394656 (MainThread): On master: COMMIT
2021-05-29 11:11:13.394899 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:13.395037 (MainThread): On master: COMMIT
2021-05-29 11:11:13.779816 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:11:13.780099 (MainThread): On master: Close
2021-05-29 11:11:14.375693 (MainThread): 16:41:14 | Concurrency: 10 threads (target='dev')
2021-05-29 11:11:14.375933 (MainThread): 16:41:14 | 
2021-05-29 11:11:14.378208 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:14.378395 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:11:14.378716 (Thread-1): 16:41:14 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:11:14.378966 (Thread-2): 16:41:14 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:11:14.379322 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:14.379997 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:14.380154 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:14.380285 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:11:14.382830 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:11:14.385108 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:11:14.385617 (Thread-1): finished collecting timing info
2021-05-29 11:11:14.385770 (Thread-2): finished collecting timing info
2021-05-29 11:11:14.432026 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:11:14.434199 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:11:14.435182 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:14.435283 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:11:14.435371 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:11:14.437572 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:14.437679 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:11:14.437766 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:11:15.832746 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 11:11:15.832997 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:15.833135 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:11:15.892660 (Thread-2): SQL status: SUCCESS 1 in 1.45 seconds
2021-05-29 11:11:15.892904 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:15.893041 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-29 11:11:16.223386 (Thread-2): Snowflake query id: 019c919f-0000-43c7-0000-b0b100014196
2021-05-29 11:11:16.223608 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:11:16.223829 (Thread-2): finished collecting timing info
2021-05-29 11:11:16.224042 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:11:16.646833 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:11:17.365934 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:11:17.369090 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289ba85e0>]}
2021-05-29 11:11:17.369516 (Thread-2): 16:41:17 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.99s]
2021-05-29 11:11:17.369702 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:11:17.370956 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 11:11:17.372144 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:11:17.372337 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:17.372452 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:11:17.671104 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 11:11:17.683897 (Thread-1): finished collecting timing info
2021-05-29 11:11:17.684073 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:11:18.253385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289ba3ee0>]}
2021-05-29 11:11:18.253840 (Thread-1): 16:41:18 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.87s]
2021-05-29 11:11:18.254015 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:18.254619 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:18.254891 (Thread-4): 16:41:18 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:11:18.255344 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:18.255486 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:18.257902 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:11:18.258383 (Thread-4): finished collecting timing info
2021-05-29 11:11:18.276809 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:11:18.277583 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:18.277688 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:11:18.277779 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:11:19.718902 (Thread-4): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:11:19.719142 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:19.719272 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:11:20.389422 (Thread-4): SQL status: SUCCESS 1 in 0.67 seconds
2021-05-29 11:11:20.390751 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:11:20.390958 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:20.391072 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:11:20.743192 (Thread-4): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-29 11:11:20.744270 (Thread-4): finished collecting timing info
2021-05-29 11:11:20.744487 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:11:21.462083 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bedc40>]}
2021-05-29 11:11:21.462555 (Thread-4): 16:41:21 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.21s]
2021-05-29 11:11:21.462729 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:21.464336 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:11:21.464578 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:21.464692 (MainThread): On master: BEGIN
2021-05-29 11:11:21.464795 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:11:23.008444 (MainThread): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 11:11:23.008708 (MainThread): On master: COMMIT
2021-05-29 11:11:23.008935 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:23.009065 (MainThread): On master: COMMIT
2021-05-29 11:11:23.405641 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 11:11:23.405914 (MainThread): On master: Close
2021-05-29 11:11:24.009919 (MainThread): 16:41:24 | 
2021-05-29 11:11:24.010146 (MainThread): 16:41:24 | Finished running 2 table models, 1 view model in 17.18s.
2021-05-29 11:11:24.010284 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:11:24.010383 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:11:24.010473 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:11:24.010562 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:11:24.015300 (MainThread): 
2021-05-29 11:11:24.015454 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:11:24.015583 (MainThread): 
2021-05-29 11:11:24.015706 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:11:24.015814 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:11:24.015914 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:11:24.016009 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:11:24.016120 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:11:24.016289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bd0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289b21610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bec220>]}
2021-05-29 11:11:24.016519 (MainThread): Flushing usage events
2021-05-29 11:13:50.764569 (MainThread): Running with dbt=0.19.1
2021-05-29 11:13:51.605237 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:13:51.606801 (MainThread): Tracking: tracking
2021-05-29 11:13:51.607350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf6c47d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8790580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8790610>]}
2021-05-29 11:13:51.618911 (MainThread): Partial parsing not enabled
2021-05-29 11:13:51.620077 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:13:51.622677 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:13:51.651524 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:13:51.653745 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:13:51.655254 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:13:51.659015 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:13:51.668285 (MainThread): Parsing macros/core.sql
2021-05-29 11:13:51.672157 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:13:51.680061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:13:51.681636 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:13:51.697875 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:13:51.730353 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:13:51.749521 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:13:51.751173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:13:51.756560 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:13:51.769372 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:13:51.775645 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:13:51.781299 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:13:51.785752 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:13:51.786602 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:13:51.787575 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:13:51.789209 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:13:51.797363 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:13:51.799096 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:13:51.800573 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:13:51.840316 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:13:51.842029 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:13:51.843364 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:13:51.844910 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:13:51.851414 (MainThread): Partial parsing not enabled
2021-05-29 11:13:51.871217 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:51.878773 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:51.881717 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:13:51.997616 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf657a790>]}
2021-05-29 11:13:52.002584 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf658f6d0>]}
2021-05-29 11:13:52.002898 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:13:52.003897 (MainThread): 
2021-05-29 11:13:52.004308 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:13:52.005360 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:13:52.019698 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:13:52.019855 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:13:52.019956 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:13:53.729681 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.71 seconds
2021-05-29 11:13:53.733633 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:13:54.540922 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:13:54.548129 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:13:54.548268 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:13:54.548368 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:13:55.879455 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.33 seconds
2021-05-29 11:13:55.880743 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:13:56.904837 (MainThread): Using snowflake connection "master".
2021-05-29 11:13:56.905035 (MainThread): On master: BEGIN
2021-05-29 11:13:56.905174 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:13:58.234157 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 11:13:58.234398 (MainThread): On master: COMMIT
2021-05-29 11:13:58.234597 (MainThread): Using snowflake connection "master".
2021-05-29 11:13:58.234717 (MainThread): On master: COMMIT
2021-05-29 11:13:58.615536 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:13:58.615815 (MainThread): On master: Close
2021-05-29 11:13:59.456918 (MainThread): 16:43:59 | Concurrency: 10 threads (target='dev')
2021-05-29 11:13:59.457149 (MainThread): 16:43:59 | 
2021-05-29 11:13:59.459399 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:13:59.459729 (Thread-1): 16:43:59 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:13:59.460078 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:59.460230 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:13:59.460746 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:13:59.460982 (Thread-2): 16:43:59 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:13:59.463197 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:13:59.463497 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:59.463721 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:13:59.464938 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:13:59.465308 (Thread-1): finished collecting timing info
2021-05-29 11:13:59.471161 (Thread-2): finished collecting timing info
2021-05-29 11:13:59.516918 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:13:59.521262 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:13:59.522235 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:59.522337 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:13:59.522426 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:13:59.524439 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:59.524547 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:13:59.524635 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:14:00.965356 (Thread-2): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:14:00.965832 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:14:00.966009 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:14:00.966135 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:14:00.966252 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 11:14:00.966372 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:14:01.282822 (Thread-2): Snowflake query id: 019c91a2-0000-43c7-0000-b0b1000141b2
2021-05-29 11:14:01.283004 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:14:01.283188 (Thread-2): finished collecting timing info
2021-05-29 11:14:01.283357 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:14:01.716051 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:14:02.003625 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-05-29 11:14:02.005227 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:14:02.005492 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:14:02.005605 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:14:02.331281 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-29 11:14:02.343008 (Thread-1): finished collecting timing info
2021-05-29 11:14:02.343193 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:14:02.335797 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:14:02.347858 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf9238c70>]}
2021-05-29 11:14:02.348225 (Thread-2): 16:44:02 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.88s]
2021-05-29 11:14:02.348376 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:14:03.014675 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91afb50>]}
2021-05-29 11:14:03.015136 (Thread-1): 16:44:03 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.55s]
2021-05-29 11:14:03.015303 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:14:03.015933 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:03.016220 (Thread-4): 16:44:03 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:14:03.016577 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:03.016723 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:03.019170 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:14:03.019625 (Thread-4): finished collecting timing info
2021-05-29 11:14:03.038412 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:14:03.039259 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:03.039367 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:14:03.039460 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:14:04.378671 (Thread-4): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 11:14:04.378921 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:04.379063 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:14:05.095299 (Thread-4): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-29 11:14:05.096905 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:14:05.097186 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:05.097317 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:14:05.506051 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:14:05.507159 (Thread-4): finished collecting timing info
2021-05-29 11:14:05.507386 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:14:06.223860 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf9260700>]}
2021-05-29 11:14:06.224333 (Thread-4): 16:44:06 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.21s]
2021-05-29 11:14:06.224506 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:06.226174 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:14:06.226419 (MainThread): Using snowflake connection "master".
2021-05-29 11:14:06.226539 (MainThread): On master: BEGIN
2021-05-29 11:14:06.226650 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:14:07.789938 (MainThread): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-29 11:14:07.790212 (MainThread): On master: COMMIT
2021-05-29 11:14:07.790445 (MainThread): Using snowflake connection "master".
2021-05-29 11:14:07.790581 (MainThread): On master: COMMIT
2021-05-29 11:14:08.167553 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:14:08.167834 (MainThread): On master: Close
2021-05-29 11:14:08.850849 (MainThread): 16:44:08 | 
2021-05-29 11:14:08.851081 (MainThread): 16:44:08 | Finished running 2 table models, 1 view model in 16.85s.
2021-05-29 11:14:08.851230 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:14:08.851332 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:14:08.851424 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:14:08.851512 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:14:08.856131 (MainThread): 
2021-05-29 11:14:08.856284 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:14:08.856412 (MainThread): 
2021-05-29 11:14:08.856535 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:14:08.856656 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 11:14:08.856752 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:14:08.856846 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:14:08.856950 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:14:08.857116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91185e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91f9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91f99a0>]}
2021-05-29 11:14:08.857331 (MainThread): Flushing usage events
2021-05-29 11:46:38.033212 (MainThread): Running with dbt=0.19.1
2021-05-29 11:46:39.505945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:46:39.508254 (MainThread): Tracking: tracking
2021-05-29 11:46:39.508808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb743608c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745152580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745152610>]}
2021-05-29 11:46:39.521576 (MainThread): Partial parsing not enabled
2021-05-29 11:46:39.523284 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:46:39.526410 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:46:39.560409 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:46:39.562905 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:46:39.564881 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:46:39.569602 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:46:39.580297 (MainThread): Parsing macros/core.sql
2021-05-29 11:46:39.584258 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:46:39.592460 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:46:39.594232 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:46:39.611562 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:46:39.646258 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:46:39.666078 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:46:39.667905 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:46:39.673621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:46:39.687339 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:46:39.694199 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:46:39.700283 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:46:39.704958 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:46:39.705979 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:46:39.707331 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:46:39.708979 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:46:39.717575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:46:39.719514 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:46:39.721230 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:46:39.762009 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:46:39.763949 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:46:39.765524 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:46:39.767085 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:46:39.773626 (MainThread): Partial parsing not enabled
2021-05-29 11:46:39.794425 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:39.803727 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:39.808810 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:39.935101 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273a790>]}
2021-05-29 11:46:39.940907 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273aeb0>]}
2021-05-29 11:46:39.941232 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:46:39.942167 (MainThread): 
2021-05-29 11:46:39.942541 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:46:39.943618 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:46:39.958988 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:46:39.959153 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:46:39.959256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:46:42.008418 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.05 seconds
2021-05-29 11:46:42.011724 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:46:43.049127 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:46:43.056776 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:46:43.056908 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:46:43.057017 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:46:44.245511 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.19 seconds
2021-05-29 11:46:44.246591 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:46:45.087367 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:45.087550 (MainThread): On master: BEGIN
2021-05-29 11:46:45.087654 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:46:46.484637 (MainThread): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 11:46:46.484906 (MainThread): On master: COMMIT
2021-05-29 11:46:46.485134 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:46.485271 (MainThread): On master: COMMIT
2021-05-29 11:46:46.944196 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-29 11:46:46.944480 (MainThread): On master: Close
2021-05-29 11:46:47.636135 (MainThread): 17:16:47 | Concurrency: 10 threads (target='dev')
2021-05-29 11:46:47.636361 (MainThread): 17:16:47 | 
2021-05-29 11:46:47.638444 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:47.638624 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:46:47.638944 (Thread-1): 17:16:47 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:46:47.639210 (Thread-2): 17:16:47 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 11:46:47.639613 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:47.640178 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:47.640374 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:47.640503 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:46:47.642761 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:46:47.643985 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:46:47.645189 (Thread-1): finished collecting timing info
2021-05-29 11:46:47.645327 (Thread-2): finished collecting timing info
2021-05-29 11:46:47.692528 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:46:47.696106 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:46:47.697888 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:47.697990 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:46:47.698079 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:46:47.699316 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:47.699424 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:46:47.699514 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:46:49.202848 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 11:46:49.203102 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:49.203254 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:46:49.422761 (Thread-2): SQL status: SUCCESS 1 in 1.72 seconds
2021-05-29 11:46:49.423006 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:49.423145 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 11:46:49.821744 (Thread-2): Snowflake query id: 019c91c2-0000-43c5-0000-b0b100013246
2021-05-29 11:46:49.821969 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:46:49.822207 (Thread-2): finished collecting timing info
2021-05-29 11:46:49.822444 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:46:50.432154 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:46:50.704107 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 11:46:50.705509 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:46:50.705719 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:50.705838 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:46:51.064514 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:46:51.079681 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745462850>]}
2021-05-29 11:46:51.080109 (Thread-2): 17:16:51 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.44s]
2021-05-29 11:46:51.080336 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:46:51.201454 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-29 11:46:51.213486 (Thread-1): finished collecting timing info
2021-05-29 11:46:51.213785 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:46:52.103001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745311910>]}
2021-05-29 11:46:52.103458 (Thread-1): 17:16:52 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.46s]
2021-05-29 11:46:52.103636 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:52.104430 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:52.104707 (Thread-4): 17:16:52 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:46:52.105122 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:52.105265 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:52.107515 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:46:52.107963 (Thread-4): finished collecting timing info
2021-05-29 11:46:52.109995 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:46:52.110744 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:52.110851 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:46:52.110945 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:46:53.600839 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-29 11:46:53.601094 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:53.601237 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:46:54.090956 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 11:46:54.092346 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:46:54.092590 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:54.092732 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:46:54.411186 (Thread-4): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-29 11:46:54.412197 (Thread-4): finished collecting timing info
2021-05-29 11:46:54.412391 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:46:55.002130 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7454a1790>]}
2021-05-29 11:46:55.002612 (Thread-4): 17:16:55 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.90s]
2021-05-29 11:46:55.002789 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:55.004276 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:46:55.004518 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:55.004637 (MainThread): On master: BEGIN
2021-05-29 11:46:55.004745 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:46:56.179385 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-05-29 11:46:56.179667 (MainThread): On master: COMMIT
2021-05-29 11:46:56.179913 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:56.180024 (MainThread): On master: COMMIT
2021-05-29 11:46:56.608341 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-05-29 11:46:56.608618 (MainThread): On master: Close
2021-05-29 11:46:57.220477 (MainThread): 17:16:57 | 
2021-05-29 11:46:57.220696 (MainThread): 17:16:57 | Finished running 2 view models, 1 table model in 17.28s.
2021-05-29 11:46:57.220831 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:46:57.220930 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:46:57.221021 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:46:57.221108 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:46:57.227084 (MainThread): 
2021-05-29 11:46:57.227285 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:46:57.227419 (MainThread): 
2021-05-29 11:46:57.227557 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:46:57.227681 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 11:46:57.227790 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:46:57.227881 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:46:57.227985 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:46:57.228160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7453d75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74704a670>]}
2021-05-29 11:46:57.228380 (MainThread): Flushing usage events
2021-05-29 12:29:08.393114 (MainThread): Running with dbt=0.19.1
2021-05-29 12:29:09.679752 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 12:29:09.682120 (MainThread): Tracking: tracking
2021-05-29 12:29:09.683053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab84a8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba24e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba24e7f0>]}
2021-05-29 12:29:09.697853 (MainThread): Partial parsing not enabled
2021-05-29 12:29:09.699238 (MainThread): Parsing macros/catalog.sql
2021-05-29 12:29:09.702280 (MainThread): Parsing macros/adapters.sql
2021-05-29 12:29:09.738331 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 12:29:09.740573 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 12:29:09.742266 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 12:29:09.747262 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 12:29:09.759915 (MainThread): Parsing macros/core.sql
2021-05-29 12:29:09.764657 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 12:29:09.774464 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 12:29:09.776459 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 12:29:09.797474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 12:29:09.837440 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 12:29:09.861715 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 12:29:09.863757 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 12:29:09.870680 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 12:29:09.887440 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 12:29:09.895238 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 12:29:09.902196 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 12:29:09.907640 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 12:29:09.908654 (MainThread): Parsing macros/etc/query.sql
2021-05-29 12:29:09.909761 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 12:29:09.911728 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 12:29:09.922111 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 12:29:09.924743 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 12:29:09.927017 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 12:29:09.977513 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 12:29:09.979636 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 12:29:09.981303 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 12:29:09.983158 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 12:29:09.991315 (MainThread): Partial parsing not enabled
2021-05-29 12:29:10.016063 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:10.025473 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:10.029159 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:10.169731 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab7f043a0>]}
2021-05-29 12:29:10.176567 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba2e5220>]}
2021-05-29 12:29:10.176971 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 12:29:10.178054 (MainThread): 
2021-05-29 12:29:10.178533 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 12:29:10.179725 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 12:29:10.195586 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 12:29:10.195757 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 12:29:10.195861 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 12:29:11.779663 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-29 12:29:11.783227 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 12:29:12.381424 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 12:29:12.388971 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 12:29:12.389188 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 12:29:12.389303 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 12:29:13.717125 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.33 seconds
2021-05-29 12:29:13.718062 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 12:29:14.310259 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:14.310495 (MainThread): On master: BEGIN
2021-05-29 12:29:14.310623 (MainThread): Opening a new connection, currently in state init
2021-05-29 12:29:15.685935 (MainThread): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-29 12:29:15.686186 (MainThread): On master: COMMIT
2021-05-29 12:29:15.686371 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:15.686473 (MainThread): On master: COMMIT
2021-05-29 12:29:16.085975 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 12:29:16.086207 (MainThread): On master: Close
2021-05-29 12:29:16.856659 (MainThread): 17:59:16 | Concurrency: 10 threads (target='dev')
2021-05-29 12:29:16.856876 (MainThread): 17:59:16 | 
2021-05-29 12:29:16.858544 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:16.858703 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 12:29:16.858992 (Thread-1): 17:59:16 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 12:29:16.859218 (Thread-2): 17:59:16 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 12:29:16.859573 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:16.860006 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:16.862169 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 12:29:16.862592 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:16.862716 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 12:29:16.863795 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 12:29:16.863903 (Thread-1): finished collecting timing info
2021-05-29 12:29:16.886230 (Thread-2): finished collecting timing info
2021-05-29 12:29:16.902275 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 12:29:16.915331 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 12:29:16.917554 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:16.919263 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:16.919408 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 12:29:16.919576 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 12:29:16.919717 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 12:29:16.919844 (Thread-2): Opening a new connection, currently in state init
2021-05-29 12:29:18.184150 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-29 12:29:18.184364 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:18.184477 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 12:29:18.234301 (Thread-2): SQL status: SUCCESS 1 in 1.31 seconds
2021-05-29 12:29:18.234483 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:18.234583 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 12:29:18.562988 (Thread-2): Snowflake query id: 019c91ed-0000-43c7-0000-b0b100014216
2021-05-29 12:29:18.563159 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 12:29:18.563328 (Thread-2): finished collecting timing info
2021-05-29 12:29:18.563479 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 12:29:18.914000 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 12:29:19.514133 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 12:29:19.515379 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 12:29:19.515600 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:19.515700 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 12:29:19.595648 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 12:29:19.601513 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba46fdf0>]}
2021-05-29 12:29:19.601950 (Thread-2): 17:59:19 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 2.74s]
2021-05-29 12:29:19.602115 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 12:29:19.813294 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 12:29:19.823982 (Thread-1): finished collecting timing info
2021-05-29 12:29:19.824153 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 12:29:20.384669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba2809a0>]}
2021-05-29 12:29:20.385066 (Thread-1): 17:59:20 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.53s]
2021-05-29 12:29:20.385290 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:20.385828 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:20.386130 (Thread-4): 17:59:20 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 12:29:20.386469 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:20.386626 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:20.389229 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 12:29:20.390048 (Thread-4): finished collecting timing info
2021-05-29 12:29:20.392679 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 12:29:20.393649 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:20.393768 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 12:29:20.393863 (Thread-4): Opening a new connection, currently in state init
2021-05-29 12:29:21.712242 (Thread-4): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-29 12:29:21.712463 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:21.712576 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 12:29:22.311724 (Thread-4): SQL status: SUCCESS 1 in 0.60 seconds
2021-05-29 12:29:22.312776 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 12:29:22.312956 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:22.313049 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 12:29:22.791857 (Thread-4): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-29 12:29:22.793108 (Thread-4): finished collecting timing info
2021-05-29 12:29:22.793392 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 12:29:23.373737 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba5cbd90>]}
2021-05-29 12:29:23.374171 (Thread-4): 17:59:23 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.99s]
2021-05-29 12:29:23.374336 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:23.375978 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 12:29:23.376239 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:23.376351 (MainThread): On master: BEGIN
2021-05-29 12:29:23.376453 (MainThread): Opening a new connection, currently in state closed
2021-05-29 12:29:25.370617 (MainThread): SQL status: SUCCESS 1 in 1.99 seconds
2021-05-29 12:29:25.370882 (MainThread): On master: COMMIT
2021-05-29 12:29:25.371119 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:25.371250 (MainThread): On master: COMMIT
2021-05-29 12:29:25.790275 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-29 12:29:25.790549 (MainThread): On master: Close
2021-05-29 12:29:26.381125 (MainThread): 17:59:26 | 
2021-05-29 12:29:26.381324 (MainThread): 17:59:26 | Finished running 2 view models, 1 table model in 16.20s.
2021-05-29 12:29:26.381451 (MainThread): Connection 'master' was properly closed.
2021-05-29 12:29:26.381536 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 12:29:26.381611 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 12:29:26.381682 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 12:29:26.386423 (MainThread): 
2021-05-29 12:29:26.386638 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 12:29:26.386827 (MainThread): 
2021-05-29 12:29:26.386988 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 12:29:26.387122 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 12:29:26.387236 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 12:29:26.387332 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 12:29:26.387454 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 12:29:26.387665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba21db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba3d8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba490190>]}
2021-05-29 12:29:26.387935 (MainThread): Flushing usage events
2021-05-30 13:45:42.969214 (MainThread): Running with dbt=0.19.1
2021-05-30 13:45:44.698517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:45:44.700613 (MainThread): Tracking: tracking
2021-05-30 13:45:44.701129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d1623b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d398f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d398f7f0>]}
2021-05-30 13:45:44.713420 (MainThread): Partial parsing not enabled
2021-05-30 13:45:44.714919 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:45:44.717942 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:45:44.748094 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:45:44.750032 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:45:44.751502 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:45:44.755115 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:45:44.765111 (MainThread): Parsing macros/core.sql
2021-05-30 13:45:44.769290 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:45:44.777892 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:45:44.779872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:45:44.798344 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:45:44.831401 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:45:44.850010 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:45:44.851811 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:45:44.857521 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:45:44.870474 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:45:44.877367 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:45:44.883874 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:45:44.888529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:45:44.889754 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:45:44.890953 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:45:44.892621 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:45:44.900686 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:45:44.902647 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:45:44.904308 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:45:44.944906 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:45:44.947387 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:45:44.948900 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:45:44.950566 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:45:44.958005 (MainThread): Partial parsing not enabled
2021-05-30 13:45:44.981848 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:44.991268 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:44.995543 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:45:45.126416 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d107c3a0>]}
2021-05-30 13:45:45.134763 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3b26220>]}
2021-05-30 13:45:45.135160 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:45:45.136180 (MainThread): 
2021-05-30 13:45:45.136583 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:45:45.137677 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:45:45.153863 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:45:45.154018 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:45:45.154116 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:45:47.607409 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.45 seconds
2021-05-30 13:45:47.612044 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:45:48.427544 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:45:48.435205 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:45:48.435325 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:45:48.435418 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:45:50.574945 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.14 seconds
2021-05-30 13:45:50.576101 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:45:51.396865 (MainThread): Using snowflake connection "master".
2021-05-30 13:45:51.397048 (MainThread): On master: BEGIN
2021-05-30 13:45:51.397163 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:45:52.929956 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:45:52.930226 (MainThread): On master: COMMIT
2021-05-30 13:45:52.930462 (MainThread): Using snowflake connection "master".
2021-05-30 13:45:52.930604 (MainThread): On master: COMMIT
2021-05-30 13:45:54.211645 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-30 13:45:54.211915 (MainThread): On master: Close
2021-05-30 13:45:55.696555 (MainThread): 19:15:55 | Concurrency: 10 threads (target='dev')
2021-05-30 13:45:55.696785 (MainThread): 19:15:55 | 
2021-05-30 13:45:55.699150 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:45:55.699480 (Thread-1): 19:15:55 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:45:55.699694 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:45:55.699976 (Thread-2): 19:15:55 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 13:45:55.700346 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:55.700512 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:45:55.701179 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:55.701324 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:45:55.702634 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:45:55.705189 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:45:55.706225 (Thread-2): finished collecting timing info
2021-05-30 13:45:55.706419 (Thread-1): finished collecting timing info
2021-05-30 13:45:55.746819 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:45:55.758340 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:45:55.759298 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:55.759404 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:45:55.759490 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:45:55.761155 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:55.761264 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:45:55.761886 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:45:57.891261 (Thread-2): SQL status: SUCCESS 1 in 2.13 seconds
2021-05-30 13:45:57.891506 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:57.891638 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from jaffle_shop.orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from jaffle_shop.customers

left join customer_orders using (customer_id)
  );
2021-05-30 13:45:58.509924 (Thread-1): SQL status: SUCCESS 1 in 2.75 seconds
2021-05-30 13:45:58.510161 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:58.510294 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:45:58.971188 (Thread-2): Snowflake query id: 019c97d9-0000-438f-0000-b0b100017016
2021-05-30 13:45:58.971405 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
2021-05-30 13:45:58.971635 (Thread-2): finished collecting timing info
2021-05-30 13:45:58.971841 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:45:59.381218 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:46:00.098051 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-30 13:46:00.099634 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:00.099882 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:00.099998 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:00.399363 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 13:46:00.410928 (Thread-1): finished collecting timing info
2021-05-30 13:46:00.411086 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:46:01.011207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39c0bb0>]}
2021-05-30 13:46:01.011688 (Thread-1): 19:16:01 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.31s]
2021-05-30 13:46:01.011874 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:01.012309 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:01.012594 (Thread-4): 19:16:01 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:46:01.012971 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:01.013105 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:01.015558 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:01.016101 (Thread-4): finished collecting timing info
2021-05-30 13:46:01.018361 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:01.019167 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:01.019276 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:46:01.019372 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:46:01.781042 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:01.781953 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d4057d90>]}
2021-05-30 13:46:01.782355 (Thread-2): 19:16:01 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 6.08s]
2021-05-30 13:46:01.782529 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:46:02.453120 (Thread-4): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 13:46:02.453358 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:02.453490 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:46:03.273725 (Thread-4): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-30 13:46:03.275117 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:03.275358 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:03.275514 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:03.682834 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:46:03.683913 (Thread-4): finished collecting timing info
2021-05-30 13:46:03.684129 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:46:04.400630 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3cee730>]}
2021-05-30 13:46:04.401109 (Thread-4): 19:16:04 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.39s]
2021-05-30 13:46:04.401544 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:04.403255 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:04.403508 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:04.403629 (MainThread): On master: BEGIN
2021-05-30 13:46:04.403740 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:46:06.139615 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 13:46:06.139892 (MainThread): On master: COMMIT
2021-05-30 13:46:06.140123 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:06.140259 (MainThread): On master: COMMIT
2021-05-30 13:46:06.651494 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:06.651773 (MainThread): On master: Close
2021-05-30 13:46:07.370375 (MainThread): 19:16:07 | 
2021-05-30 13:46:07.370611 (MainThread): 19:16:07 | Finished running 1 table model, 2 view models in 22.23s.
2021-05-30 13:46:07.370762 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:46:07.370868 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:46:07.370975 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:46:07.371063 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:46:07.375654 (MainThread): 
2021-05-30 13:46:07.375807 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:46:07.375938 (MainThread): 
2021-05-30 13:46:07.376063 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:46:07.376172 (MainThread):   002003 (02000): SQL compilation error:
2021-05-30 13:46:07.376273 (MainThread):   Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
2021-05-30 13:46:07.376370 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:07.376484 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:46:07.376660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3c18760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39d25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39d21f0>]}
2021-05-30 13:46:07.376886 (MainThread): Flushing usage events
2021-05-30 13:46:33.915979 (MainThread): Running with dbt=0.19.1
2021-05-30 13:46:34.679984 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:46:34.681555 (MainThread): Tracking: tracking
2021-05-30 13:46:34.681971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb1205e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b4e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b4e6d0>]}
2021-05-30 13:46:34.691111 (MainThread): Partial parsing not enabled
2021-05-30 13:46:34.692292 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:46:34.694522 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:46:34.720425 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:46:34.722150 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:46:34.723385 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:46:34.727007 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:46:34.735308 (MainThread): Parsing macros/core.sql
2021-05-30 13:46:34.738525 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:46:34.746131 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:46:34.747642 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:46:34.763369 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:46:34.793678 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:46:34.812317 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:46:34.813927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:46:34.819273 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:46:34.831835 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:46:34.837784 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:46:34.843189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:46:34.847349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:46:34.848141 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:46:34.849025 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:46:34.850405 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:46:34.857969 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:46:34.859835 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:46:34.861257 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:46:34.899295 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:46:34.900898 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:46:34.902206 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:46:34.903650 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:46:34.909946 (MainThread): Partial parsing not enabled
2021-05-30 13:46:34.928703 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:34.935796 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:34.938594 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:35.047984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2af3eb0>]}
2021-05-30 13:46:35.052957 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b1e2e0>]}
2021-05-30 13:46:35.053232 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:46:35.054118 (MainThread): 
2021-05-30 13:46:35.054462 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:35.055449 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:46:35.070233 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:46:35.070388 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:46:35.070490 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:46:36.556170 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.49 seconds
2021-05-30 13:46:36.559834 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:46:37.478150 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:46:37.486089 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:46:37.486221 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:46:37.486325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:46:39.345240 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.86 seconds
2021-05-30 13:46:39.346410 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:46:40.032262 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:40.032454 (MainThread): On master: BEGIN
2021-05-30 13:46:40.032574 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:46:41.671996 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 13:46:41.672266 (MainThread): On master: COMMIT
2021-05-30 13:46:41.672513 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:41.672649 (MainThread): On master: COMMIT
2021-05-30 13:46:42.286230 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 13:46:42.286511 (MainThread): On master: Close
2021-05-30 13:46:43.005286 (MainThread): 19:16:43 | Concurrency: 10 threads (target='dev')
2021-05-30 13:46:43.005522 (MainThread): 19:16:43 | 
2021-05-30 13:46:43.007954 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:43.008291 (Thread-1): 19:16:43 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:46:43.008650 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:43.008805 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:43.009420 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:46:43.011969 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:46:43.012188 (Thread-2): 19:16:43 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 13:46:43.012696 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:43.012857 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:46:43.014124 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:46:43.014553 (Thread-1): finished collecting timing info
2021-05-30 13:46:43.021004 (Thread-2): finished collecting timing info
2021-05-30 13:46:43.061470 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:46:43.065546 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:46:43.066904 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:43.067003 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:46:43.067092 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:46:43.068815 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:43.068920 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:46:43.069007 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:46:44.643224 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 13:46:44.643514 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:44.643667 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:46:44.644652 (Thread-2): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-30 13:46:44.645574 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:44.645716 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-30 13:46:45.153241 (Thread-2): Snowflake query id: 019c97da-0000-43cc-0000-b0b100016032
2021-05-30 13:46:45.153461 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 13:46:45.153689 (Thread-2): finished collecting timing info
2021-05-30 13:46:45.153899 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:46:45.503832 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:46:46.177522 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:46:46.179118 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:46.179351 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:46.179469 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:46.194877 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:46.198013 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f60bb0>]}
2021-05-30 13:46:46.198415 (Thread-2): 19:16:46 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.19s]
2021-05-30 13:46:46.198593 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:46:46.690514 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:46.703342 (Thread-1): finished collecting timing info
2021-05-30 13:46:46.703516 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:46:47.314815 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f653a0>]}
2021-05-30 13:46:47.315271 (Thread-1): 19:16:47 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.31s]
2021-05-30 13:46:47.315438 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:47.315940 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:47.316413 (Thread-4): 19:16:47 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:46:47.316763 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:47.316903 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:47.319277 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:47.319715 (Thread-4): finished collecting timing info
2021-05-30 13:46:47.321604 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:47.322337 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:47.322440 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:46:47.322530 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:46:49.863581 (Thread-4): SQL status: SUCCESS 1 in 2.54 seconds
2021-05-30 13:46:49.863832 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:49.863970 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:46:50.376686 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:50.378086 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:50.378331 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:50.378471 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:50.786402 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:46:50.787505 (Thread-4): finished collecting timing info
2021-05-30 13:46:50.787731 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:46:51.401988 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f6e520>]}
2021-05-30 13:46:51.402461 (Thread-4): 19:16:51 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 4.09s]
2021-05-30 13:46:51.402636 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:51.404214 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:51.404458 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:51.404574 (MainThread): On master: BEGIN
2021-05-30 13:46:51.404682 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:46:53.140895 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 13:46:53.141167 (MainThread): On master: COMMIT
2021-05-30 13:46:53.141398 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:53.141535 (MainThread): On master: COMMIT
2021-05-30 13:46:53.560098 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-30 13:46:53.560371 (MainThread): On master: Close
2021-05-30 13:46:54.576257 (MainThread): 19:16:54 | 
2021-05-30 13:46:54.576491 (MainThread): 19:16:54 | Finished running 2 view models, 1 table model in 19.52s.
2021-05-30 13:46:54.576641 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:46:54.576747 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:46:54.576843 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:46:54.576935 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:46:54.581625 (MainThread): 
2021-05-30 13:46:54.581802 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:46:54.581940 (MainThread): 
2021-05-30 13:46:54.582075 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:46:54.582199 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:46:54.582306 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 13:46:54.582408 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:54.582584 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:46:54.582825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2dd66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb302ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f75bb0>]}
2021-05-30 13:46:54.583070 (MainThread): Flushing usage events
2021-05-30 13:48:10.896414 (MainThread): Running with dbt=0.19.1
2021-05-30 13:48:11.637150 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:48:11.638777 (MainThread): Tracking: tracking
2021-05-30 13:48:11.639211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd4505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd450640>]}
2021-05-30 13:48:11.648157 (MainThread): Partial parsing not enabled
2021-05-30 13:48:11.649118 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:48:11.651210 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:48:11.677146 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:48:11.678923 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:48:11.680287 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:48:11.683607 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:48:11.692264 (MainThread): Parsing macros/core.sql
2021-05-30 13:48:11.695446 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:48:11.702818 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:48:11.704436 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:48:11.719652 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:48:11.749437 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:48:11.768249 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:48:11.769828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:48:11.775108 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:48:11.786967 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:48:11.793397 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:48:11.798754 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:48:11.802850 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:48:11.803670 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:48:11.804653 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:48:11.806003 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:48:11.813403 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:48:11.815040 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:48:11.816431 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:48:11.853910 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:48:11.855701 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:48:11.856952 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:48:11.858352 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:48:11.864415 (MainThread): Partial parsing not enabled
2021-05-30 13:48:11.881986 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:11.889918 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:11.892692 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:12.002795 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb24de80>]}
2021-05-30 13:48:12.008886 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb24d7c0>]}
2021-05-30 13:48:12.009248 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:48:12.010212 (MainThread): 
2021-05-30 13:48:12.010588 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:48:12.011615 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:48:12.026069 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:48:12.026229 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:48:12.026334 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:48:13.882418 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.86 seconds
2021-05-30 13:48:13.886941 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:48:14.551137 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:48:14.558835 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:48:14.558969 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:48:14.559072 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:48:15.910595 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.35 seconds
2021-05-30 13:48:15.911763 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:48:16.602877 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:16.603053 (MainThread): On master: BEGIN
2021-05-30 13:48:16.603163 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:48:18.161377 (MainThread): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-30 13:48:18.161652 (MainThread): On master: COMMIT
2021-05-30 13:48:18.161898 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:18.162049 (MainThread): On master: COMMIT
2021-05-30 13:48:18.519740 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 13:48:18.520015 (MainThread): On master: Close
2021-05-30 13:48:19.158019 (MainThread): 19:18:19 | Concurrency: 10 threads (target='dev')
2021-05-30 13:48:19.158259 (MainThread): 19:18:19 | 
2021-05-30 13:48:19.160666 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:19.160986 (Thread-1): 19:18:19 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:48:19.161336 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:19.161485 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:19.161648 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:48:19.164487 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:48:19.164688 (Thread-2): 19:18:19 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-30 13:48:19.165145 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:19.165281 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:48:19.167445 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:48:19.167887 (Thread-2): finished collecting timing info
2021-05-30 13:48:19.173894 (Thread-1): finished collecting timing info
2021-05-30 13:48:19.221085 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:48:19.223303 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:48:19.224355 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:19.224462 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:48:19.224551 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:48:19.226774 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:19.226883 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:48:19.226973 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:48:20.488623 (Thread-2): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:48:20.488856 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:20.488977 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-30 13:48:20.489420 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:48:20.489921 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:20.490168 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:48:20.897273 (Thread-2): Snowflake query id: 019c97dc-0000-438f-0000-b0b100017046
2021-05-30 13:48:20.897495 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:48:20.897714 (Thread-2): finished collecting timing info
2021-05-30 13:48:20.897922 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:48:21.248540 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:48:21.458633 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-05-30 13:48:21.460063 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:48:21.460262 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:21.460377 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:48:21.778372 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-30 13:48:21.790821 (Thread-1): finished collecting timing info
2021-05-30 13:48:21.790988 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:48:21.810339 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:48:21.813355 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd77e8b0>]}
2021-05-30 13:48:21.813731 (Thread-2): 19:18:21 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.65s]
2021-05-30 13:48:21.813887 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:48:22.537331 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd77e0a0>]}
2021-05-30 13:48:22.537800 (Thread-1): 19:18:22 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-30 13:48:22.537978 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:22.538477 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:22.538756 (Thread-4): 19:18:22 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:48:22.539262 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:22.539426 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:22.541930 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:48:22.542416 (Thread-4): finished collecting timing info
2021-05-30 13:48:22.561255 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:48:22.562057 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:22.562162 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:48:22.562252 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:48:24.051950 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-30 13:48:24.052135 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:24.052242 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:48:24.581992 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-30 13:48:24.582808 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:48:24.582952 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:24.583021 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:48:25.053971 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-30 13:48:25.055046 (Thread-4): finished collecting timing info
2021-05-30 13:48:25.055261 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:48:25.916413 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd762d90>]}
2021-05-30 13:48:25.916883 (Thread-4): 19:18:25 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-30 13:48:25.917060 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:25.918639 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:48:25.918872 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:25.918981 (MainThread): On master: BEGIN
2021-05-30 13:48:25.919081 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:48:27.450150 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:48:27.450409 (MainThread): On master: COMMIT
2021-05-30 13:48:27.450635 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:27.450764 (MainThread): On master: COMMIT
2021-05-30 13:48:27.859331 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:48:27.859598 (MainThread): On master: Close
2021-05-30 13:48:28.783639 (MainThread): 19:18:28 | 
2021-05-30 13:48:28.783863 (MainThread): 19:18:28 | Finished running 2 table models, 1 view model in 16.77s.
2021-05-30 13:48:28.784002 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:48:28.784100 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:48:28.784189 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:48:28.784274 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:48:28.789085 (MainThread): 
2021-05-30 13:48:28.789248 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:48:28.789389 (MainThread): 
2021-05-30 13:48:28.789523 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:48:28.789641 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:48:28.789778 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:48:28.789885 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:48:28.790091 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:48:28.790315 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd6e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fe0326a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fe034b20>]}
2021-05-30 13:48:28.790569 (MainThread): Flushing usage events
2021-05-30 13:55:41.051162 (MainThread): Running with dbt=0.19.1
2021-05-30 13:55:41.783087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:55:41.785313 (MainThread): Tracking: tracking
2021-05-30 13:55:41.786126 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56d205e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed4d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed4d730>]}
2021-05-30 13:55:41.795731 (MainThread): Partial parsing not enabled
2021-05-30 13:55:41.796666 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:55:41.798807 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:55:41.824546 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:55:41.826244 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:55:41.827619 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:55:41.830963 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:55:41.839438 (MainThread): Parsing macros/core.sql
2021-05-30 13:55:41.842602 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:55:41.850200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:55:41.851974 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:55:41.867238 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:55:41.897127 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:55:41.916178 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:55:41.918016 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:55:41.923413 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:55:41.935550 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:55:41.941420 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:55:41.946792 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:55:41.951236 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:55:41.952110 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:55:41.953004 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:55:41.954381 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:55:41.961958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:55:41.963624 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:55:41.965055 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:55:42.003148 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:55:42.004741 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:55:42.006032 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:55:42.007485 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:55:42.013700 (MainThread): Partial parsing not enabled
2021-05-30 13:55:42.031838 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:42.039605 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:42.041728 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:42.154386 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ecf3eb0>]}
2021-05-30 13:55:42.159373 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed1e2e0>]}
2021-05-30 13:55:42.159649 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:55:42.160517 (MainThread): 
2021-05-30 13:55:42.160859 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:55:42.161844 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:55:42.175859 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:55:42.175990 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:55:42.176084 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:55:43.801644 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 13:55:43.810107 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:55:44.421523 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:55:44.429729 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:55:44.429871 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:55:44.429982 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:55:45.851944 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-30 13:55:45.853098 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:55:46.468774 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:46.468963 (MainThread): On master: BEGIN
2021-05-30 13:55:46.469082 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:55:47.695345 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 13:55:47.695616 (MainThread): On master: COMMIT
2021-05-30 13:55:47.695853 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:47.695999 (MainThread): On master: COMMIT
2021-05-30 13:55:48.099040 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-30 13:55:48.099343 (MainThread): On master: Close
2021-05-30 13:55:48.680805 (MainThread): 19:25:48 | Concurrency: 10 threads (target='dev')
2021-05-30 13:55:48.681044 (MainThread): 19:25:48 | 
2021-05-30 13:55:48.683407 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:48.683645 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:55:48.683943 (Thread-1): 19:25:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:55:48.684229 (Thread-2): 19:25:48 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-30 13:55:48.684649 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:48.685385 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:48.685552 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:48.685718 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:55:48.688268 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:55:48.689576 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:55:48.690179 (Thread-1): finished collecting timing info
2021-05-30 13:55:48.714027 (Thread-2): finished collecting timing info
2021-05-30 13:55:48.729664 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:55:48.731379 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:55:48.732823 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:48.732924 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:55:48.733014 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:55:48.734749 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:48.734855 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:55:48.734942 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:55:50.255737 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 13:55:50.256219 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 13:55:50.256336 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:50.256466 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:50.256584 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-30 13:55:50.256702 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:55:50.664340 (Thread-2): Snowflake query id: 019c97e3-0000-43d8-0000-b0b10001509a
2021-05-30 13:55:50.664565 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:55:50.664788 (Thread-2): finished collecting timing info
2021-05-30 13:55:50.665001 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:55:51.074359 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:55:51.517775 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:55:51.519347 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:55:51.519602 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:51.519718 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:55:51.679703 (Thread-2): Database Error in model customers (models/example/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/example/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/customers.sql
2021-05-30 13:55:51.682809 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f0ce520>]}
2021-05-30 13:55:51.683239 (Thread-2): 19:25:51 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.00s]
2021-05-30 13:55:51.683425 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:55:51.817615 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 13:55:51.834818 (Thread-1): finished collecting timing info
2021-05-30 13:55:51.835017 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:55:52.499639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f060fa0>]}
2021-05-30 13:55:52.500107 (Thread-1): 19:25:52 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.82s]
2021-05-30 13:55:52.500286 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:52.500887 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:52.501168 (Thread-4): 19:25:52 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 13:55:52.501515 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:52.501663 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:52.504100 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:55:52.504661 (Thread-4): finished collecting timing info
2021-05-30 13:55:52.506429 (Thread-4): Dropping relation "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" because it is of type view
2021-05-30 13:55:52.512910 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:52.513021 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" cascade
2021-05-30 13:55:52.513117 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:55:53.766915 (Thread-4): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-30 13:55:53.768691 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:55:53.769755 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:53.769885 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:55:54.076781 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 13:55:54.077024 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:54.077161 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
      );
2021-05-30 13:55:55.580789 (Thread-4): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 13:55:55.582153 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:55:55.582395 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:55.582534 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:55:55.989415 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:55:55.990476 (Thread-4): finished collecting timing info
2021-05-30 13:55:55.990670 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:55:56.607757 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f08c0d0>]}
2021-05-30 13:55:56.608244 (Thread-4): 19:25:56 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.11s]
2021-05-30 13:55:56.608426 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:56.610054 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:55:56.610305 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:56.610426 (MainThread): On master: BEGIN
2021-05-30 13:55:56.610538 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:55:58.344847 (MainThread): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-30 13:55:58.345118 (MainThread): On master: COMMIT
2021-05-30 13:55:58.345357 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:58.345493 (MainThread): On master: COMMIT
2021-05-30 13:55:58.959368 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 13:55:58.959646 (MainThread): On master: Close
2021-05-30 13:55:59.575643 (MainThread): 19:25:59 | 
2021-05-30 13:55:59.575869 (MainThread): 19:25:59 | Finished running 3 table models in 17.41s.
2021-05-30 13:55:59.576011 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:55:59.576115 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:55:59.576207 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:55:59.576297 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:55:59.580874 (MainThread): 
2021-05-30 13:55:59.581021 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:55:59.581158 (MainThread): 
2021-05-30 13:55:59.581274 (MainThread): Database Error in model customers (models/example/customers.sql)
2021-05-30 13:55:59.581375 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:55:59.581468 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:55:59.581556 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/customers.sql
2021-05-30 13:55:59.581658 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:55:59.581825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed1ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed84bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed843a0>]}
2021-05-30 13:55:59.582026 (MainThread): Flushing usage events
2021-05-30 14:03:24.627513 (MainThread): Running with dbt=0.19.1
2021-05-30 14:03:25.411119 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:03:25.412664 (MainThread): Tracking: tracking
2021-05-30 14:03:25.413091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e48cfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e754e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e754e700>]}
2021-05-30 14:03:25.422854 (MainThread): Partial parsing not enabled
2021-05-30 14:03:25.423804 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:03:25.425885 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:03:25.452043 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:03:25.453711 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:03:25.454921 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:03:25.458607 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:03:25.467353 (MainThread): Parsing macros/core.sql
2021-05-30 14:03:25.470700 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:03:25.478252 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:03:25.479774 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:03:25.495149 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:03:25.525514 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:03:25.543944 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:03:25.545521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:03:25.550942 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:03:25.563340 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:03:25.569246 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:03:25.574640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:03:25.578793 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:03:25.579595 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:03:25.580476 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:03:25.581846 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:03:25.589651 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:03:25.591295 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:03:25.592704 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:03:25.630329 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:03:25.631974 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:03:25.633257 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:03:25.634697 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:03:25.640884 (MainThread): Partial parsing not enabled
2021-05-30 14:03:25.659062 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:25.666194 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:25.668941 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:25.781404 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e430d7f0>]}
2021-05-30 14:03:25.786694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e430df40>]}
2021-05-30 14:03:25.786979 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:03:25.787924 (MainThread): 
2021-05-30 14:03:25.788274 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:03:25.789266 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:03:25.803683 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:03:25.803826 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:03:25.803926 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:03:27.776137 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.97 seconds
2021-05-30 14:03:27.780453 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:03:28.597646 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:03:28.605744 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:03:28.605880 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:03:28.605989 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:03:29.922998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.32 seconds
2021-05-30 14:03:29.924128 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:03:31.155818 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:31.156007 (MainThread): On master: BEGIN
2021-05-30 14:03:31.156106 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:03:32.843108 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-30 14:03:32.843388 (MainThread): On master: COMMIT
2021-05-30 14:03:32.843625 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:32.843764 (MainThread): On master: COMMIT
2021-05-30 14:03:33.410421 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-05-30 14:03:33.410694 (MainThread): On master: Close
2021-05-30 14:03:34.434376 (MainThread): 19:33:34 | Concurrency: 10 threads (target='dev')
2021-05-30 14:03:34.434616 (MainThread): 19:33:34 | 
2021-05-30 14:03:34.436959 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:34.437188 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 14:03:34.437478 (Thread-1): 19:33:34 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:03:34.437771 (Thread-2): 19:33:34 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 14:03:34.438151 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:34.438851 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:34.438973 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:34.439108 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 14:03:34.441844 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:03:34.443809 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 14:03:34.444321 (Thread-1): finished collecting timing info
2021-05-30 14:03:34.444482 (Thread-2): finished collecting timing info
2021-05-30 14:03:34.490994 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:03:34.492194 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 14:03:34.493171 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:34.493274 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:03:34.493366 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:03:34.495506 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:34.495613 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 14:03:34.495699 (Thread-2): Opening a new connection, currently in state init
2021-05-30 14:03:36.172265 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:03:36.172535 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:36.172993 (Thread-2): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:03:36.173104 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:03:36.173243 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:36.174417 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-30 14:03:36.683578 (Thread-2): Snowflake query id: 019c97eb-0000-43d8-0000-b0b1000150ae
2021-05-30 14:03:36.683818 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 14:03:36.684180 (Thread-2): finished collecting timing info
2021-05-30 14:03:36.684419 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 14:03:37.195765 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 14:03:37.420053 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-30 14:03:37.421536 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:03:37.421743 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:37.421860 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:03:38.219362 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-05-30 14:03:38.231089 (Thread-1): finished collecting timing info
2021-05-30 14:03:38.231249 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:03:38.633101 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:03:38.639520 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7809700>]}
2021-05-30 14:03:38.640045 (Thread-2): 19:33:38 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 4.20s]
2021-05-30 14:03:38.640267 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 14:03:39.348570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e78023a0>]}
2021-05-30 14:03:39.349031 (Thread-1): 19:33:39 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.91s]
2021-05-30 14:03:39.349204 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:39.349861 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:39.350255 (Thread-4): 19:33:39 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:03:39.350623 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:39.350771 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:39.353300 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:03:39.353823 (Thread-4): finished collecting timing info
2021-05-30 14:03:39.356099 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:03:39.356968 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:39.357088 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:03:39.357194 (Thread-4): Opening a new connection, currently in state init
2021-05-30 14:03:40.984266 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-30 14:03:40.984521 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:40.984659 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:03:42.520011 (Thread-4): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-30 14:03:42.521305 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:03:42.521502 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:42.521617 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:03:42.930085 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:03:42.931179 (Thread-4): finished collecting timing info
2021-05-30 14:03:42.931405 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:03:44.058493 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7740220>]}
2021-05-30 14:03:44.058961 (Thread-4): 19:33:44 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.71s]
2021-05-30 14:03:44.059140 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:44.060824 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:03:44.061067 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:44.061185 (MainThread): On master: BEGIN
2021-05-30 14:03:44.061295 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:03:45.797147 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:03:45.797429 (MainThread): On master: COMMIT
2021-05-30 14:03:45.797666 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:45.797816 (MainThread): On master: COMMIT
2021-05-30 14:03:46.206840 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:03:46.207118 (MainThread): On master: Close
2021-05-30 14:03:47.335615 (MainThread): 19:33:47 | 
2021-05-30 14:03:47.335860 (MainThread): 19:33:47 | Finished running 1 view model, 2 table models in 21.55s.
2021-05-30 14:03:47.336019 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:03:47.336129 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:03:47.336225 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 14:03:47.336317 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:03:47.342634 (MainThread): 
2021-05-30 14:03:47.342833 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:03:47.342975 (MainThread): 
2021-05-30 14:03:47.343107 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 14:03:47.343229 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 14:03:47.343344 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 14:03:47.343453 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:03:47.343575 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 14:03:47.343764 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7782670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e76d66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e77bd850>]}
2021-05-30 14:03:47.343999 (MainThread): Flushing usage events
2021-05-30 14:10:40.638349 (MainThread): Running with dbt=0.19.1
2021-05-30 14:10:41.891434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:10:41.893120 (MainThread): Tracking: tracking
2021-05-30 14:10:41.893616 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a530fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a824d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a824d760>]}
2021-05-30 14:10:41.904587 (MainThread): Partial parsing not enabled
2021-05-30 14:10:41.905822 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:10:41.908583 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:10:41.936022 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:10:41.937782 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:10:41.938995 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:10:41.942485 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:10:41.951691 (MainThread): Parsing macros/core.sql
2021-05-30 14:10:41.955658 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:10:41.964929 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:10:41.966592 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:10:41.982074 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:10:42.012966 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:10:42.032160 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:10:42.033773 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:10:42.039011 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:10:42.051070 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:10:42.057061 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:10:42.062706 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:10:42.066890 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:10:42.067705 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:10:42.068607 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:10:42.069988 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:10:42.077639 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:10:42.079310 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:10:42.080778 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:10:42.118676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:10:42.120265 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:10:42.121557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:10:42.122996 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:10:42.129516 (MainThread): Partial parsing not enabled
2021-05-30 14:10:42.147650 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:42.154659 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:42.157662 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:42.281253 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a444f460>]}
2021-05-30 14:10:42.287560 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a44518b0>]}
2021-05-30 14:10:42.287935 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:10:42.289004 (MainThread): 
2021-05-30 14:10:42.289399 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:10:42.290519 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:10:42.305382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:10:42.305523 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:10:42.305624 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:10:43.915371 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.61 seconds
2021-05-30 14:10:43.918568 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:10:44.532187 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:10:44.539560 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:10:44.539691 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:10:44.539787 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:10:45.831176 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.29 seconds
2021-05-30 14:10:45.832360 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:10:46.401897 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:46.402085 (MainThread): On master: BEGIN
2021-05-30 14:10:46.402204 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:10:47.620912 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-30 14:10:47.621169 (MainThread): On master: COMMIT
2021-05-30 14:10:47.621415 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:47.621552 (MainThread): On master: COMMIT
2021-05-30 14:10:47.974504 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-30 14:10:47.974783 (MainThread): On master: Close
2021-05-30 14:10:48.578972 (MainThread): 19:40:48 | Concurrency: 10 threads (target='dev')
2021-05-30 14:10:48.579208 (MainThread): 19:40:48 | 
2021-05-30 14:10:48.581522 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:48.581706 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 14:10:48.582031 (Thread-1): 19:40:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:10:48.582270 (Thread-2): 19:40:48 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 14:10:48.582609 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:48.583119 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:48.583421 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:48.585909 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:10:48.586058 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 14:10:48.587983 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 14:10:48.588377 (Thread-1): finished collecting timing info
2021-05-30 14:10:48.594241 (Thread-2): finished collecting timing info
2021-05-30 14:10:48.633130 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 14:10:48.637761 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:10:48.638751 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:48.638852 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:10:48.638938 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:10:48.639893 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:48.639999 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 14:10:48.640087 (Thread-2): Opening a new connection, currently in state init
2021-05-30 14:10:49.797698 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-05-30 14:10:49.797945 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:49.798079 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:10:49.966954 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-30 14:10:49.967180 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:49.967315 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    -- with customer_orders as (
--     select
--         customer_id,
--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1
-- )

-- select
--     customers.customer_id,
--     customers.first_name,
--     customers.last_name,
--     customer_orders.first_order_date,
--     customer_orders.most_recent_order_date,
--     coalesce(customer_orders.number_of_orders, 0) as number_of_orders

-- from customers

-- left join customer_orders using (customer_id)
  );
2021-05-30 14:10:50.299067 (Thread-2): Snowflake query id: 019c97f2-0000-43d8-0000-b0b1000150fe
2021-05-30 14:10:50.299290 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 2 unexpected ')'.
2021-05-30 14:10:50.299525 (Thread-2): finished collecting timing info
2021-05-30 14:10:50.299739 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 14:10:50.677019 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 14:10:50.757503 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-05-30 14:10:50.759176 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:10:50.759392 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:50.759511 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:10:51.057222 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 14:10:51.069308 (Thread-1): finished collecting timing info
2021-05-30 14:10:51.069483 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:10:51.269037 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 25 at position 2 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:10:51.273480 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a82a0b80>]}
2021-05-30 14:10:51.273919 (Thread-2): 19:40:51 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 2.69s]
2021-05-30 14:10:51.274092 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 14:10:51.628454 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a82a0b80>]}
2021-05-30 14:10:51.628902 (Thread-1): 19:40:51 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.05s]
2021-05-30 14:10:51.629064 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:51.629657 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:51.629937 (Thread-4): 19:40:51 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:10:51.630276 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:51.630421 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:51.632541 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:10:51.633022 (Thread-4): finished collecting timing info
2021-05-30 14:10:51.635013 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:10:51.636398 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:51.636553 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:10:51.636652 (Thread-4): Opening a new connection, currently in state init
2021-05-30 14:10:53.006481 (Thread-4): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:10:53.006721 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:53.006853 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:10:54.053330 (Thread-4): SQL status: SUCCESS 1 in 1.05 seconds
2021-05-30 14:10:54.054754 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:10:54.054991 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:54.055140 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:10:54.365097 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:10:54.365830 (Thread-4): finished collecting timing info
2021-05-30 14:10:54.365980 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:10:54.947875 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a8474ee0>]}
2021-05-30 14:10:54.948347 (Thread-4): 19:40:54 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 3.32s]
2021-05-30 14:10:54.948515 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:54.950126 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:10:54.950367 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:54.950480 (MainThread): On master: BEGIN
2021-05-30 14:10:54.950583 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:10:56.225786 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-30 14:10:56.226039 (MainThread): On master: COMMIT
2021-05-30 14:10:56.226264 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:56.226389 (MainThread): On master: COMMIT
2021-05-30 14:10:56.585415 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 14:10:56.585618 (MainThread): On master: Close
2021-05-30 14:10:57.229142 (MainThread): 19:40:57 | 
2021-05-30 14:10:57.229367 (MainThread): 19:40:57 | Finished running 1 view model, 2 table models in 14.94s.
2021-05-30 14:10:57.229507 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:10:57.229605 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:10:57.229693 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 14:10:57.229775 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:10:57.234849 (MainThread): 
2021-05-30 14:10:57.235003 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:10:57.235134 (MainThread): 
2021-05-30 14:10:57.235257 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 14:10:57.235366 (MainThread):   001003 (42000): SQL compilation error:
2021-05-30 14:10:57.235463 (MainThread):   syntax error line 25 at position 2 unexpected ')'.
2021-05-30 14:10:57.235563 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:10:57.235674 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 14:10:57.235860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a8280490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a829f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8aa10ea00>]}
2021-05-30 14:10:57.236085 (MainThread): Flushing usage events
2021-05-30 14:11:12.664734 (MainThread): Running with dbt=0.19.1
2021-05-30 14:11:13.431416 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:11:13.432752 (MainThread): Tracking: tracking
2021-05-30 14:11:13.433327 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec2c6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee5525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee552640>]}
2021-05-30 14:11:13.443187 (MainThread): Partial parsing not enabled
2021-05-30 14:11:13.444232 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:11:13.446468 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:11:13.472704 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:11:13.474687 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:11:13.475949 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:11:13.479428 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:11:13.487993 (MainThread): Parsing macros/core.sql
2021-05-30 14:11:13.491280 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:11:13.498842 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:11:13.500360 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:11:13.516161 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:11:13.547248 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:11:13.565504 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:11:13.567069 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:11:13.572254 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:11:13.585083 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:11:13.591104 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:11:13.596563 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:11:13.600767 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:11:13.601576 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:11:13.602485 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:11:13.603877 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:11:13.611895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:11:13.613588 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:11:13.615025 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:11:13.653206 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:11:13.654789 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:11:13.656080 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:11:13.657523 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:11:13.663815 (MainThread): Partial parsing not enabled
2021-05-30 14:11:13.682114 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:13.690021 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:13.797651 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee51efd0>]}
2021-05-30 14:11:13.802944 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee51ef40>]}
2021-05-30 14:11:13.803237 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:11:13.804186 (MainThread): 
2021-05-30 14:11:13.804538 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:11:13.805454 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:11:13.820184 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:11:13.820338 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:11:13.820442 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:11:15.557995 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.74 seconds
2021-05-30 14:11:15.562610 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:11:16.277825 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:11:16.285696 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:11:16.285829 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:11:16.285932 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:11:17.912079 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 14:11:17.913199 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:11:18.489727 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:18.489920 (MainThread): On master: BEGIN
2021-05-30 14:11:18.490036 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:11:19.857978 (MainThread): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:11:19.858247 (MainThread): On master: COMMIT
2021-05-30 14:11:19.858482 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:19.858618 (MainThread): On master: COMMIT
2021-05-30 14:11:20.370805 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:11:20.371086 (MainThread): On master: Close
2021-05-30 14:11:20.986068 (MainThread): 19:41:20 | Concurrency: 10 threads (target='dev')
2021-05-30 14:11:20.986306 (MainThread): 19:41:20 | 
2021-05-30 14:11:20.988596 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:20.988944 (Thread-1): 19:41:20 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:11:20.989285 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:20.989440 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:20.992364 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:11:20.992874 (Thread-1): finished collecting timing info
2021-05-30 14:11:21.022829 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:11:21.023835 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:21.023939 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:11:21.024032 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:11:22.418727 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-30 14:11:22.418979 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:22.419121 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:11:23.646688 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:11:23.648292 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:11:23.648499 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:23.648619 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:11:23.953945 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:11:23.965346 (Thread-1): finished collecting timing info
2021-05-30 14:11:23.965509 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:11:24.571049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9a4be0>]}
2021-05-30 14:11:24.571521 (Thread-1): 19:41:24 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:11:24.571706 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:24.572383 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:24.572669 (Thread-3): 19:41:24 | 2 of 2 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:11:24.573069 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:24.573270 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:24.576270 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:11:24.576745 (Thread-3): finished collecting timing info
2021-05-30 14:11:24.578813 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:11:24.579666 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:24.579784 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:11:24.579895 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:11:25.954546 (Thread-3): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:11:25.954803 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:25.954948 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:11:27.128122 (Thread-3): SQL status: SUCCESS 1 in 1.17 seconds
2021-05-30 14:11:27.129542 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:11:27.129783 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:27.129922 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:11:27.537864 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:11:27.538966 (Thread-3): finished collecting timing info
2021-05-30 14:11:27.539191 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:11:28.461449 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9e8a60>]}
2021-05-30 14:11:28.461925 (Thread-3): 19:41:28 | 2 of 2 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 3.89s]
2021-05-30 14:11:28.462106 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:28.463706 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:11:28.463956 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:28.464075 (MainThread): On master: BEGIN
2021-05-30 14:11:28.464186 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:11:30.302434 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-30 14:11:30.302709 (MainThread): On master: COMMIT
2021-05-30 14:11:30.302940 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:30.303089 (MainThread): On master: COMMIT
2021-05-30 14:11:30.713168 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:11:30.713445 (MainThread): On master: Close
2021-05-30 14:11:31.430948 (MainThread): 19:41:31 | 
2021-05-30 14:11:31.431185 (MainThread): 19:41:31 | Finished running 2 table models in 17.63s.
2021-05-30 14:11:31.431332 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:11:31.431437 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:11:31.431534 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:11:31.436374 (MainThread): 
2021-05-30 14:11:31.436545 (MainThread): Completed successfully
2021-05-30 14:11:31.436696 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:11:31.436899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee6d75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec2d1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9a7130>]}
2021-05-30 14:11:31.437150 (MainThread): Flushing usage events
2021-05-30 14:14:37.885461 (MainThread): Running with dbt=0.19.1
2021-05-30 14:14:38.895945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:14:38.897373 (MainThread): Tracking: tracking
2021-05-30 14:14:38.897892 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6e07d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8b90580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8b90610>]}
2021-05-30 14:14:38.908643 (MainThread): Partial parsing not enabled
2021-05-30 14:14:38.910031 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:14:38.913030 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:14:38.943502 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:14:38.945321 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:14:38.946612 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:14:38.950796 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:14:38.960350 (MainThread): Parsing macros/core.sql
2021-05-30 14:14:38.963785 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:14:38.972272 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:14:38.974970 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:14:38.993668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:14:39.032860 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:14:39.057437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:14:39.078214 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:14:39.085454 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:14:39.101905 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:14:39.109847 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:14:39.116851 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:14:39.122445 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:14:39.123544 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:14:39.124684 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:14:39.126702 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:14:39.136455 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:14:39.138708 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:14:39.140553 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:14:39.182245 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:14:39.183997 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:14:39.185368 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:14:39.186893 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:14:39.193701 (MainThread): Partial parsing not enabled
2021-05-30 14:14:39.213477 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:39.221612 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:39.330507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6763700>]}
2021-05-30 14:14:39.335985 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6761eb0>]}
2021-05-30 14:14:39.336305 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:14:39.337297 (MainThread): 
2021-05-30 14:14:39.337709 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:14:39.338751 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:14:39.354381 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:14:39.354548 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:14:39.354655 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:14:40.969925 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-30 14:14:40.973709 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:14:41.791459 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:14:41.798630 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:14:41.798761 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:14:41.798860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:14:43.325992 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.53 seconds
2021-05-30 14:14:43.326945 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:14:43.940561 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:43.940738 (MainThread): On master: BEGIN
2021-05-30 14:14:43.940849 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:14:45.680445 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:14:45.680715 (MainThread): On master: COMMIT
2021-05-30 14:14:45.680948 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:45.681084 (MainThread): On master: COMMIT
2021-05-30 14:14:46.293884 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:14:46.294097 (MainThread): On master: Close
2021-05-30 14:14:46.910028 (MainThread): 19:44:46 | Concurrency: 10 threads (target='dev')
2021-05-30 14:14:46.910262 (MainThread): 19:44:46 | 
2021-05-30 14:14:46.912441 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:46.912737 (Thread-1): 19:44:46 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:14:46.913032 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:46.913158 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:46.915591 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:14:46.916044 (Thread-1): finished collecting timing info
2021-05-30 14:14:46.945164 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:14:46.946168 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:46.946276 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:14:46.946363 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:14:48.342208 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-30 14:14:48.342471 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:48.342675 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:14:49.571426 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:14:49.573000 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:14:49.573245 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:49.573392 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:14:50.083413 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:14:50.094979 (Thread-1): finished collecting timing info
2021-05-30 14:14:50.095143 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:14:50.699722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8ff0880>]}
2021-05-30 14:14:50.700218 (Thread-1): 19:44:50 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-30 14:14:50.700407 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:50.701007 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:50.701304 (Thread-3): 19:44:50 | 2 of 2 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:14:50.701661 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:50.701805 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:50.704773 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:14:50.705398 (Thread-3): finished collecting timing info
2021-05-30 14:14:50.707497 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:14:50.708374 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:50.708491 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:14:50.708606 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:14:52.235231 (Thread-3): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 14:14:52.235485 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:52.235626 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:14:53.360494 (Thread-3): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-30 14:14:53.361916 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:14:53.362156 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:53.362322 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:14:53.668300 (Thread-3): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:14:53.669372 (Thread-3): finished collecting timing info
2021-05-30 14:14:53.669592 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:14:54.797099 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fc85b0>]}
2021-05-30 14:14:54.797559 (Thread-3): 19:44:54 | 2 of 2 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.10s]
2021-05-30 14:14:54.797733 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:54.799165 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:14:54.799405 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:54.799522 (MainThread): On master: BEGIN
2021-05-30 14:14:54.799629 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:14:56.030344 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:14:56.030639 (MainThread): On master: COMMIT
2021-05-30 14:14:56.030943 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:56.031090 (MainThread): On master: COMMIT
2021-05-30 14:14:56.389170 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 14:14:56.389453 (MainThread): On master: Close
2021-05-30 14:14:57.048740 (MainThread): 19:44:57 | 
2021-05-30 14:14:57.048965 (MainThread): 19:44:57 | Finished running 2 table models in 17.71s.
2021-05-30 14:14:57.049104 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:14:57.049202 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:14:57.049292 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:14:57.053832 (MainThread): 
2021-05-30 14:14:57.053992 (MainThread): Completed successfully
2021-05-30 14:14:57.054127 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:14:57.054309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8d17580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fa4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fa4af0>]}
2021-05-30 14:14:57.054532 (MainThread): Flushing usage events
2021-05-30 14:24:34.329356 (MainThread): Running with dbt=0.19.1
2021-05-30 14:24:35.552757 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:24:35.554545 (MainThread): Tracking: tracking
2021-05-30 14:24:35.555337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18dd10bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19004d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19004d760>]}
2021-05-30 14:24:35.566823 (MainThread): Partial parsing not enabled
2021-05-30 14:24:35.568071 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:24:35.570808 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:24:35.598781 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:24:35.600491 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:24:35.601736 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:24:35.605487 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:24:35.614611 (MainThread): Parsing macros/core.sql
2021-05-30 14:24:35.618244 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:24:35.626498 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:24:35.627994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:24:35.643218 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:24:35.673659 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:24:35.692803 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:24:35.694427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:24:35.699601 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:24:35.711782 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:24:35.717643 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:24:35.723296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:24:35.727415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:24:35.728203 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:24:35.729080 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:24:35.730424 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:24:35.737895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:24:35.739539 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:24:35.740952 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:24:35.778909 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:24:35.780485 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:24:35.781766 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:24:35.783205 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:24:35.789496 (MainThread): Partial parsing not enabled
2021-05-30 14:24:35.807254 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:35.814761 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:35.917347 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18d461040>]}
2021-05-30 14:24:35.922526 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18d46a8b0>]}
2021-05-30 14:24:35.922817 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:24:35.923702 (MainThread): 
2021-05-30 14:24:35.924073 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:24:35.925063 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:24:35.940658 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:24:35.940806 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:24:35.940909 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:24:37.750577 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.81 seconds
2021-05-30 14:24:37.755049 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:24:38.456684 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:24:38.464550 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:24:38.464690 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:24:38.464788 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:24:40.103907 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.64 seconds
2021-05-30 14:24:40.105032 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:24:41.334598 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:41.334780 (MainThread): On master: BEGIN
2021-05-30 14:24:41.334893 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:24:42.971092 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:24:42.971356 (MainThread): On master: COMMIT
2021-05-30 14:24:42.971592 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:42.971726 (MainThread): On master: COMMIT
2021-05-30 14:24:43.380493 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:43.380768 (MainThread): On master: Close
2021-05-30 14:24:44.304955 (MainThread): 19:54:44 | Concurrency: 10 threads (target='dev')
2021-05-30 14:24:44.305190 (MainThread): 19:54:44 | 
2021-05-30 14:24:44.307556 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:44.307891 (Thread-1): 19:54:44 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:24:44.308237 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:44.308383 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:44.311156 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:24:44.311618 (Thread-1): finished collecting timing info
2021-05-30 14:24:44.340704 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:24:44.341690 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:44.341798 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:24:44.341889 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:24:45.837837 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:24:45.838082 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:45.838224 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:24:46.964360 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-05-30 14:24:46.965918 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:24:46.966161 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:46.966305 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:24:47.270234 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 14:24:47.281929 (Thread-1): finished collecting timing info
2021-05-30 14:24:47.282090 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:24:47.887872 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1904d8970>]}
2021-05-30 14:24:47.888357 (Thread-1): 19:54:47 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:24:47.888573 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:47.889148 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:47.889445 (Thread-3): 19:54:47 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:24:47.889813 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:47.889959 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:47.893090 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:24:47.894376 (Thread-3): finished collecting timing info
2021-05-30 14:24:47.917291 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:47.917449 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop table if exists "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" cascade
2021-05-30 14:24:47.917550 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:24:49.217072 (Thread-3): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-30 14:24:49.224868 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:24:49.225821 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:49.225942 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:24:49.626252 (Thread-3): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-30 14:24:49.626496 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:49.626635 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:24:50.446646 (Thread-3): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-30 14:24:50.448049 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:24:50.448297 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:50.448447 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:24:50.855345 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:50.856463 (Thread-3): finished collecting timing info
2021-05-30 14:24:50.856691 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:24:51.472788 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19054aa00>]}
2021-05-30 14:24:51.473236 (Thread-3): 19:54:51 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:24:51.473412 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:51.474844 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:24:51.475083 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:51.475196 (MainThread): On master: BEGIN
2021-05-30 14:24:51.475301 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:24:52.903111 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 14:24:52.903379 (MainThread): On master: COMMIT
2021-05-30 14:24:52.903640 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:52.903778 (MainThread): On master: COMMIT
2021-05-30 14:24:53.312747 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:53.313016 (MainThread): On master: Close
2021-05-30 14:24:53.928691 (MainThread): 19:54:53 | 
2021-05-30 14:24:53.928926 (MainThread): 19:54:53 | Finished running 1 table model, 1 view model in 18.00s.
2021-05-30 14:24:53.929075 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:24:53.929183 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:24:53.929291 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:24:53.933852 (MainThread): 
2021-05-30 14:24:53.934009 (MainThread): Completed successfully
2021-05-30 14:24:53.934148 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:24:53.934332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19001efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1901d76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19052c040>]}
2021-05-30 14:24:53.934564 (MainThread): Flushing usage events
2021-05-30 14:30:26.716549 (MainThread): Running with dbt=0.19.1
2021-05-30 14:30:27.559020 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:30:27.560345 (MainThread): Tracking: tracking
2021-05-30 14:30:27.560871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92a1c7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e210580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e210610>]}
2021-05-30 14:30:27.570740 (MainThread): Partial parsing not enabled
2021-05-30 14:30:27.571704 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:30:27.573897 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:30:27.600416 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:30:27.602764 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:30:27.604130 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:30:27.607765 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:30:27.617257 (MainThread): Parsing macros/core.sql
2021-05-30 14:30:27.621222 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:30:27.629534 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:30:27.631065 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:30:27.649100 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:30:27.684441 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:30:27.704475 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:30:27.706426 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:30:27.711891 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:30:27.725058 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:30:27.731334 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:30:27.737163 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:30:27.741589 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:30:27.742435 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:30:27.743374 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:30:27.744828 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:30:27.753498 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:30:27.755303 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:30:27.756828 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:30:27.796947 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:30:27.798776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:30:27.800277 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:30:27.801899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:30:27.808495 (MainThread): Partial parsing not enabled
2021-05-30 14:30:27.827842 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:27.836733 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:27.950415 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff929b1a700>]}
2021-05-30 14:30:27.956578 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff929b0feb0>]}
2021-05-30 14:30:27.956907 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:30:27.957778 (MainThread): 
2021-05-30 14:30:27.958157 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:30:27.959113 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:30:27.974831 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:30:27.974992 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:30:27.975094 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:30:31.120909 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.15 seconds
2021-05-30 14:30:31.125304 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:30:31.910441 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:30:31.919331 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:30:31.919525 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:30:31.919650 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:30:34.226034 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.31 seconds
2021-05-30 14:30:34.227001 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:30:35.830620 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:35.830801 (MainThread): On master: BEGIN
2021-05-30 14:30:35.830905 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:30:38.696580 (MainThread): SQL status: SUCCESS 1 in 2.87 seconds
2021-05-30 14:30:38.696744 (MainThread): On master: COMMIT
2021-05-30 14:30:38.696875 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:38.696941 (MainThread): On master: COMMIT
2021-05-30 14:30:40.745587 (MainThread): SQL status: SUCCESS 1 in 2.05 seconds
2021-05-30 14:30:40.745861 (MainThread): On master: Close
2021-05-30 14:30:41.872861 (MainThread): 20:00:41 | Concurrency: 10 threads (target='dev')
2021-05-30 14:30:41.873100 (MainThread): 20:00:41 | 
2021-05-30 14:30:41.875349 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:41.875688 (Thread-1): 20:00:41 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:30:41.876042 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:41.876197 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:41.879070 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:30:41.880391 (Thread-1): finished collecting timing info
2021-05-30 14:30:41.910092 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:30:41.911149 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:41.911256 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:30:41.911347 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:30:43.553093 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:30:43.553346 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:43.553487 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:30:45.127615 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 14:30:45.129180 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:30:45.129419 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:45.129533 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:30:45.662326 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-30 14:30:45.673586 (Thread-1): finished collecting timing info
2021-05-30 14:30:45.673781 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:30:47.095252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e7853a0>]}
2021-05-30 14:30:47.095732 (Thread-1): 20:00:47 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.22s]
2021-05-30 14:30:47.095921 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:47.096531 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:47.096811 (Thread-3): 20:00:47 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:30:47.097279 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:47.097434 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:47.100260 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:30:47.100788 (Thread-3): finished collecting timing info
2021-05-30 14:30:47.119777 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:30:47.121494 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:47.121603 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:30:47.121697 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:30:48.691185 (Thread-3): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 14:30:48.691439 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:48.691578 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 14:30:49.346673 (Thread-3): SQL status: SUCCESS 1 in 0.65 seconds
2021-05-30 14:30:49.348092 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:30:49.348364 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:49.348484 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:30:50.267317 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2021-05-30 14:30:50.268382 (Thread-3): finished collecting timing info
2021-05-30 14:30:50.268604 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:30:51.700162 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e5e57f0>]}
2021-05-30 14:30:51.700615 (Thread-3): 20:00:51 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 4.60s]
2021-05-30 14:30:51.700785 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:51.702367 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:30:51.702610 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:51.702723 (MainThread): On master: BEGIN
2021-05-30 14:30:51.702828 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:30:53.646505 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-30 14:30:53.646761 (MainThread): On master: COMMIT
2021-05-30 14:30:53.646982 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:53.647107 (MainThread): On master: COMMIT
2021-05-30 14:30:54.458983 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-05-30 14:30:54.459243 (MainThread): On master: Close
2021-05-30 14:30:55.184327 (MainThread): 20:00:55 | 
2021-05-30 14:30:55.184547 (MainThread): 20:00:55 | Finished running 1 table model, 1 view model in 27.23s.
2021-05-30 14:30:55.184690 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:30:55.184791 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:30:55.184882 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:30:55.189492 (MainThread): 
2021-05-30 14:30:55.189658 (MainThread): Completed successfully
2021-05-30 14:30:55.189805 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:30:55.190005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e497580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e438640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff926676550>]}
2021-05-30 14:30:55.190251 (MainThread): Flushing usage events
2021-05-30 14:35:01.209528 (MainThread): Running with dbt=0.19.1
2021-05-30 14:35:01.953991 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:35:01.955624 (MainThread): Tracking: tracking
2021-05-30 14:35:01.956076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bea05d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c4e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c4e6d0>]}
2021-05-30 14:35:01.967083 (MainThread): Partial parsing not enabled
2021-05-30 14:35:01.968083 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:35:01.970314 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:35:01.996414 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:35:01.998198 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:35:01.999456 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:35:02.002887 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:35:02.011390 (MainThread): Parsing macros/core.sql
2021-05-30 14:35:02.014661 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:35:02.022190 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:35:02.023938 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:35:02.039645 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:35:02.070173 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:35:02.089384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:35:02.091297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:35:02.096820 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:35:02.109214 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:35:02.115166 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:35:02.120640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:35:02.125174 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:35:02.125988 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:35:02.126887 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:35:02.128286 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:35:02.135947 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:35:02.137629 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:35:02.139112 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:35:02.183826 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:35:02.185515 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:35:02.186849 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:35:02.188337 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:35:02.194926 (MainThread): Partial parsing not enabled
2021-05-30 14:35:02.213341 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:02.221215 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:02.329832 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c1ef70>]}
2021-05-30 14:35:02.334997 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c1eeb0>]}
2021-05-30 14:35:02.335272 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:35:02.336171 (MainThread): 
2021-05-30 14:35:02.336521 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:35:02.337458 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:35:02.352268 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:35:02.352404 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:35:02.352504 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:35:04.637112 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.28 seconds
2021-05-30 14:35:04.641461 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:35:05.354034 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:35:05.361973 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:35:05.362108 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:35:05.362215 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:35:06.994918 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 14:35:06.995993 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:35:07.713410 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:07.713597 (MainThread): On master: BEGIN
2021-05-30 14:35:07.713719 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:35:09.351185 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:35:09.351456 (MainThread): On master: COMMIT
2021-05-30 14:35:09.351699 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:09.351836 (MainThread): On master: COMMIT
2021-05-30 14:35:09.861374 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:35:09.861656 (MainThread): On master: Close
2021-05-30 14:35:10.478516 (MainThread): 20:05:10 | Concurrency: 10 threads (target='dev')
2021-05-30 14:35:10.478749 (MainThread): 20:05:10 | 
2021-05-30 14:35:10.481024 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:10.481340 (Thread-1): 20:05:10 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:35:10.481686 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:10.481838 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:10.484542 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:35:10.485043 (Thread-1): finished collecting timing info
2021-05-30 14:35:10.514365 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:35:10.515391 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:10.515497 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:35:10.515587 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:35:12.012538 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:35:12.012793 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:12.012932 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:35:12.998785 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-05-30 14:35:13.000357 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:35:13.000603 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:13.000750 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:35:13.343678 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-30 14:35:13.354896 (Thread-1): finished collecting timing info
2021-05-30 14:35:13.355059 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:35:13.930347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c35cf0d0>]}
2021-05-30 14:35:13.930810 (Thread-1): 20:05:13 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.45s]
2021-05-30 14:35:13.930987 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:13.931562 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:13.931827 (Thread-3): 20:05:13 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:35:13.932164 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:13.932309 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:13.935065 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:35:13.935524 (Thread-3): finished collecting timing info
2021-05-30 14:35:13.953622 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:35:13.954414 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:13.954522 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:35:13.954617 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:35:15.289253 (Thread-3): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-30 14:35:15.289504 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:15.289646 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:35:15.903835 (Thread-3): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:35:15.905237 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:35:15.905503 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:15.905644 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:35:16.313926 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:35:16.315015 (Thread-3): finished collecting timing info
2021-05-30 14:35:16.315243 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:35:16.929287 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c3524820>]}
2021-05-30 14:35:16.929760 (Thread-3): 20:05:16 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.00s]
2021-05-30 14:35:16.929943 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:16.931588 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:35:16.931833 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:16.931951 (MainThread): On master: BEGIN
2021-05-30 14:35:16.932059 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:35:18.156949 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-30 14:35:18.157217 (MainThread): On master: COMMIT
2021-05-30 14:35:18.157448 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:18.157584 (MainThread): On master: COMMIT
2021-05-30 14:35:18.566351 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:35:18.566629 (MainThread): On master: Close
2021-05-30 14:35:19.286253 (MainThread): 20:05:19 | 
2021-05-30 14:35:19.286479 (MainThread): 20:05:19 | Finished running 1 table model, 1 view model in 16.95s.
2021-05-30 14:35:19.286632 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:35:19.286739 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:35:19.286837 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:35:19.291622 (MainThread): 
2021-05-30 14:35:19.291790 (MainThread): Completed successfully
2021-05-30 14:35:19.291939 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:35:19.292228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c33d7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c9c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c9c8b0>]}
2021-05-30 14:35:19.292485 (MainThread): Flushing usage events
2021-05-30 14:37:14.677648 (MainThread): Running with dbt=0.19.1
2021-05-30 14:37:15.426801 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:37:15.428201 (MainThread): Tracking: tracking
2021-05-30 14:37:15.428727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba0206d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d4f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d4f670>]}
2021-05-30 14:37:15.438051 (MainThread): Partial parsing not enabled
2021-05-30 14:37:15.438990 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:37:15.441173 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:37:15.467298 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:37:15.469049 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:37:15.470277 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:37:15.473654 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:37:15.482034 (MainThread): Parsing macros/core.sql
2021-05-30 14:37:15.485592 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:37:15.492981 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:37:15.494461 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:37:15.509698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:37:15.540998 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:37:15.559775 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:37:15.561358 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:37:15.566641 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:37:15.578707 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:37:15.585027 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:37:15.590491 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:37:15.594684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:37:15.595491 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:37:15.596383 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:37:15.597775 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:37:15.605524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:37:15.607190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:37:15.608617 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:37:15.646563 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:37:15.648153 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:37:15.649636 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:37:15.651112 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:37:15.657479 (MainThread): Partial parsing not enabled
2021-05-30 14:37:15.675701 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:15.683587 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:15.789629 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1efa0>]}
2021-05-30 14:37:15.794772 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1ee80>]}
2021-05-30 14:37:15.795051 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:37:15.795958 (MainThread): 
2021-05-30 14:37:15.796304 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:37:15.797227 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:37:15.811609 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:37:15.811748 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:37:15.811844 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:37:17.374698 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-30 14:37:17.379052 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:37:18.068548 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:37:18.076575 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:37:18.076702 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:37:18.076804 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:37:19.805966 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.73 seconds
2021-05-30 14:37:19.807106 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:37:20.523700 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:20.523889 (MainThread): On master: BEGIN
2021-05-30 14:37:20.524007 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:37:21.955407 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 14:37:21.955674 (MainThread): On master: COMMIT
2021-05-30 14:37:21.955915 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:21.956051 (MainThread): On master: COMMIT
2021-05-30 14:37:22.364971 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:22.365245 (MainThread): On master: Close
2021-05-30 14:37:23.147772 (MainThread): 20:07:23 | Concurrency: 10 threads (target='dev')
2021-05-30 14:37:23.148010 (MainThread): 20:07:23 | 
2021-05-30 14:37:23.150347 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:23.150679 (Thread-1): 20:07:23 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:37:23.151037 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:23.151191 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:23.153998 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:37:23.154472 (Thread-1): finished collecting timing info
2021-05-30 14:37:23.184059 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:37:23.185193 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:23.185329 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:37:23.185454 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:37:24.924831 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:37:24.925080 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:24.925219 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:37:26.153748 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:37:26.155176 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:37:26.155375 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:26.155492 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:37:26.563295 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:26.574097 (Thread-1): finished collecting timing info
2021-05-30 14:37:26.574252 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:37:27.384375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba23b1760>]}
2021-05-30 14:37:27.384860 (Thread-1): 20:07:27 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.23s]
2021-05-30 14:37:27.385048 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:27.385655 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:27.385937 (Thread-3): 20:07:27 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:37:27.386398 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:27.386556 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:27.389353 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:37:27.389832 (Thread-3): finished collecting timing info
2021-05-30 14:37:27.408191 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:37:27.408971 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:27.409078 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:37:27.409172 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:37:29.021422 (Thread-3): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-30 14:37:29.021668 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:29.021807 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:37:29.635092 (Thread-3): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:37:29.636493 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:37:29.636748 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:29.636893 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:37:30.044731 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:30.045816 (Thread-3): finished collecting timing info
2021-05-30 14:37:30.046037 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:37:30.866028 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d38940>]}
2021-05-30 14:37:30.866502 (Thread-3): 20:07:30 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-30 14:37:30.866680 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:30.868305 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:37:30.868546 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:30.868663 (MainThread): On master: BEGIN
2021-05-30 14:37:30.868772 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:37:32.626699 (MainThread): SQL status: SUCCESS 1 in 1.76 seconds
2021-05-30 14:37:32.626960 (MainThread): On master: COMMIT
2021-05-30 14:37:32.627189 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:32.627323 (MainThread): On master: COMMIT
2021-05-30 14:37:33.116603 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-30 14:37:33.116895 (MainThread): On master: Close
2021-05-30 14:37:33.835361 (MainThread): 20:07:33 | 
2021-05-30 14:37:33.835582 (MainThread): 20:07:33 | Finished running 1 table model, 1 view model in 18.04s.
2021-05-30 14:37:33.835721 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:37:33.835834 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:37:33.835927 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:37:33.840399 (MainThread): 
2021-05-30 14:37:33.840540 (MainThread): Completed successfully
2021-05-30 14:37:33.840663 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:37:33.840827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba23a09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1e9d0>]}
2021-05-30 14:37:33.841022 (MainThread): Flushing usage events
2021-05-30 14:41:30.416422 (MainThread): Running with dbt=0.19.1
2021-05-30 14:41:31.650252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:41:31.651857 (MainThread): Tracking: tracking
2021-05-30 14:41:31.652383 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeba07c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed551520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed5515b0>]}
2021-05-30 14:41:31.663874 (MainThread): Partial parsing not enabled
2021-05-30 14:41:31.665126 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:41:31.667921 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:41:31.695978 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:41:31.697702 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:41:31.698953 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:41:31.702550 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:41:31.712846 (MainThread): Parsing macros/core.sql
2021-05-30 14:41:31.718437 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:41:31.728281 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:41:31.730146 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:41:31.747319 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:41:31.778206 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:41:31.796823 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:41:31.798422 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:41:31.803626 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:41:31.815818 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:41:31.822010 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:41:31.827391 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:41:31.831561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:41:31.832355 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:41:31.833238 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:41:31.834609 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:41:31.842179 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:41:31.843827 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:41:31.845249 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:41:31.883116 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:41:31.884667 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:41:31.886101 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:41:31.887906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:41:31.894220 (MainThread): Partial parsing not enabled
2021-05-30 14:41:31.912527 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:31.920835 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:41:32.027749 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed51ffa0>]}
2021-05-30 14:41:32.032891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed51fee0>]}
2021-05-30 14:41:32.033179 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:41:32.034127 (MainThread): 
2021-05-30 14:41:32.034493 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:41:32.035446 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:41:32.050509 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:41:32.050648 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:41:32.050747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:41:33.904800 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.85 seconds
2021-05-30 14:41:33.909096 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:41:34.775785 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:41:34.783814 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:41:34.783948 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:41:34.784051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:41:36.206211 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-30 14:41:36.207363 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:41:37.334679 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:37.334863 (MainThread): On master: BEGIN
2021-05-30 14:41:37.334981 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:41:38.868283 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 14:41:38.868576 (MainThread): On master: COMMIT
2021-05-30 14:41:38.868825 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:38.868964 (MainThread): On master: COMMIT
2021-05-30 14:41:39.278032 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:41:39.278301 (MainThread): On master: Close
2021-05-30 14:41:40.098994 (MainThread): 20:11:40 | Concurrency: 10 threads (target='dev')
2021-05-30 14:41:40.099226 (MainThread): 20:11:40 | 
2021-05-30 14:41:40.101491 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:40.101829 (Thread-1): 20:11:40 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:41:40.102180 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:40.102335 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:40.105243 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:41:40.105721 (Thread-1): finished collecting timing info
2021-05-30 14:41:40.134929 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:41:40.136730 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:40.136840 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:41:40.136932 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:41:41.530641 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-30 14:41:41.530889 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:41.531031 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers
)


select *
from source_data
union
select * 
from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:41:42.042342 (Thread-1): Snowflake query id: 019c9811-0000-43cc-0000-b0b1000161de
2021-05-30 14:41:42.042557 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.
2021-05-30 14:41:42.042786 (Thread-1): finished collecting timing info
2021-05-30 14:41:42.042997 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:41:42.520381 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:41:43.171189 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:41:43.176690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee1d2100>]}
2021-05-30 14:41:43.177132 (Thread-1): 20:11:43 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.07s]
2021-05-30 14:41:43.177309 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:43.177987 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:41:43.178184 (Thread-3): 20:11:43 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:41:43.178452 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:41:43.179834 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:41:43.180063 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:43.180169 (MainThread): On master: BEGIN
2021-05-30 14:41:43.180266 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:41:44.704845 (MainThread): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 14:41:44.705106 (MainThread): On master: COMMIT
2021-05-30 14:41:44.705337 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:44.705473 (MainThread): On master: COMMIT
2021-05-30 14:41:45.114587 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:41:45.114855 (MainThread): On master: Close
2021-05-30 14:41:45.935805 (MainThread): 20:11:45 | 
2021-05-30 14:41:45.936021 (MainThread): 20:11:45 | Finished running 1 table model, 1 view model in 13.90s.
2021-05-30 14:41:45.936160 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:41:45.936261 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:41:45.940880 (MainThread): 
2021-05-30 14:41:45.941036 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:41:45.941171 (MainThread): 
2021-05-30 14:41:45.941304 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:41:45.941434 (MainThread):   001003 (42000): SQL compilation error:
2021-05-30 14:41:45.941535 (MainThread):   syntax error line 20 at position 0 unexpected 'customer_orders'.
2021-05-30 14:41:45.941633 (MainThread):   syntax error line 23 at position 24 unexpected 'as'.
2021-05-30 14:41:45.941727 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:41:45.941831 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:41:45.941995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeb35c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed58c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee1e3340>]}
2021-05-30 14:41:45.942213 (MainThread): Flushing usage events
2021-05-30 14:45:25.372419 (MainThread): Running with dbt=0.19.1
2021-05-30 14:45:26.207106 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:45:26.208287 (MainThread): Tracking: tracking
2021-05-30 14:45:26.208834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b82c05d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f4f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f4f6a0>]}
2021-05-30 14:45:26.220472 (MainThread): Partial parsing not enabled
2021-05-30 14:45:26.221610 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:45:26.224471 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:45:26.254085 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:45:26.256417 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:45:26.258012 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:45:26.261692 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:45:26.270503 (MainThread): Parsing macros/core.sql
2021-05-30 14:45:26.273898 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:45:26.281635 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:45:26.283179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:45:26.299377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:45:26.331658 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:45:26.350622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:45:26.352276 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:45:26.357774 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:45:26.370610 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:45:26.377447 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:45:26.383050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:45:26.387360 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:45:26.388194 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:45:26.389117 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:45:26.390690 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:45:26.398691 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:45:26.400418 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:45:26.401887 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:45:26.442040 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:45:26.443864 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:45:26.445193 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:45:26.446672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:45:26.452997 (MainThread): Partial parsing not enabled
2021-05-30 14:45:26.471867 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:26.479961 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:45:26.590845 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f1efa0>]}
2021-05-30 14:45:26.596304 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f1efd0>]}
2021-05-30 14:45:26.596612 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:45:26.597545 (MainThread): 
2021-05-30 14:45:26.597906 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:45:26.598866 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:45:26.613547 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:45:26.613703 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:45:26.613806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:45:30.388015 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.77 seconds
2021-05-30 14:45:30.392640 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:45:31.105513 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:45:31.112988 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:45:31.113155 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:45:31.113259 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:45:32.541146 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.43 seconds
2021-05-30 14:45:32.542172 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:45:33.256195 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:33.256376 (MainThread): On master: BEGIN
2021-05-30 14:45:33.256490 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:45:35.310661 (MainThread): SQL status: SUCCESS 1 in 2.05 seconds
2021-05-30 14:45:35.310891 (MainThread): On master: COMMIT
2021-05-30 14:45:35.311085 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:35.311195 (MainThread): On master: COMMIT
2021-05-30 14:45:35.810071 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-30 14:45:35.810303 (MainThread): On master: Close
2021-05-30 14:45:36.737293 (MainThread): 20:15:36 | Concurrency: 10 threads (target='dev')
2021-05-30 14:45:36.737519 (MainThread): 20:15:36 | 
2021-05-30 14:45:36.739863 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:36.740221 (Thread-1): 20:15:36 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:45:36.740571 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:36.740725 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:36.743395 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:45:36.743860 (Thread-1): finished collecting timing info
2021-05-30 14:45:36.773057 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:45:36.775128 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:36.775235 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:45:36.775327 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:45:38.680491 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2021-05-30 14:45:38.680697 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:38.680810 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:45:39.089660 (Thread-1): Snowflake query id: 019c9815-0000-43d8-0000-b0b1000151f2
2021-05-30 14:45:39.089891 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-30 14:45:39.090133 (Thread-1): finished collecting timing info
2021-05-30 14:45:39.090355 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:45:39.806686 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:45:40.570779 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:45:40.573794 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8537ef70>]}
2021-05-30 14:45:40.574224 (Thread-1): 20:15:40 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.83s]
2021-05-30 14:45:40.574420 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:40.575027 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:45:40.575318 (Thread-3): 20:15:40 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:45:40.575472 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:45:40.576654 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:45:40.576855 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:40.576948 (MainThread): On master: BEGIN
2021-05-30 14:45:40.577035 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:45:42.264296 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-30 14:45:42.264513 (MainThread): On master: COMMIT
2021-05-30 14:45:42.264694 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:42.264799 (MainThread): On master: COMMIT
2021-05-30 14:45:42.673982 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:45:42.674261 (MainThread): On master: Close
2021-05-30 14:45:43.495500 (MainThread): 20:15:43 | 
2021-05-30 14:45:43.495716 (MainThread): 20:15:43 | Finished running 1 table model, 1 view model in 16.90s.
2021-05-30 14:45:43.495853 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:45:43.495949 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:45:43.500660 (MainThread): 
2021-05-30 14:45:43.500810 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:45:43.500936 (MainThread): 
2021-05-30 14:45:43.501054 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:45:43.501160 (MainThread):   002003 (02000): SQL compilation error:
2021-05-30 14:45:43.501256 (MainThread):   Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-30 14:45:43.501349 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:45:43.501449 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:45:43.501612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f9b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b850d7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f37040>]}
2021-05-30 14:45:43.501833 (MainThread): Flushing usage events
2021-05-30 14:46:13.126493 (MainThread): Running with dbt=0.19.1
2021-05-30 14:46:13.963793 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:46:13.965678 (MainThread): Tracking: tracking
2021-05-30 14:46:13.966282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4bcc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d912580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d912610>]}
2021-05-30 14:46:13.978032 (MainThread): Partial parsing not enabled
2021-05-30 14:46:13.979406 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:46:13.982218 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:46:14.012291 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:46:14.014166 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:46:14.015535 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:46:14.019108 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:46:14.027989 (MainThread): Parsing macros/core.sql
2021-05-30 14:46:14.031864 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:46:14.039645 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:46:14.041195 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:46:14.057580 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:46:14.089370 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:46:14.110838 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:46:14.112882 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:46:14.119478 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:46:14.132609 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:46:14.138641 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:46:14.144288 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:46:14.148838 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:46:14.149709 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:46:14.150621 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:46:14.152046 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:46:14.159945 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:46:14.161847 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:46:14.163323 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:46:14.203152 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:46:14.204838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:46:14.206163 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:46:14.207651 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:46:14.214594 (MainThread): Partial parsing not enabled
2021-05-30 14:46:14.233840 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:14.242032 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:46:14.355917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d8defd0>]}
2021-05-30 14:46:14.361300 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d8dee80>]}
2021-05-30 14:46:14.361602 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:46:14.362557 (MainThread): 
2021-05-30 14:46:14.362933 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:46:14.363933 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:46:14.379519 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:46:14.379694 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:46:14.379799 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:46:16.261620 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.88 seconds
2021-05-30 14:46:16.266193 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:46:17.267079 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:46:17.274443 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:46:17.274572 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:46:17.274669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:46:18.923563 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.65 seconds
2021-05-30 14:46:18.924700 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:46:19.641702 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:19.641883 (MainThread): On master: BEGIN
2021-05-30 14:46:19.641997 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:46:22.342037 (MainThread): SQL status: SUCCESS 1 in 2.70 seconds
2021-05-30 14:46:22.342260 (MainThread): On master: COMMIT
2021-05-30 14:46:22.342450 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:22.342557 (MainThread): On master: COMMIT
2021-05-30 14:46:23.081979 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2021-05-30 14:46:23.082280 (MainThread): On master: Close
2021-05-30 14:46:23.941291 (MainThread): 20:16:23 | Concurrency: 10 threads (target='dev')
2021-05-30 14:46:23.941518 (MainThread): 20:16:23 | 
2021-05-30 14:46:23.943501 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:23.943807 (Thread-1): 20:16:23 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:46:23.944124 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:23.944249 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:23.946852 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:46:23.947299 (Thread-1): finished collecting timing info
2021-05-30 14:46:23.977083 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:46:23.979081 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:23.979190 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:46:23.979277 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:46:25.578431 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-05-30 14:46:25.578683 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:25.578825 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:46:26.110721 (Thread-1): Snowflake query id: 019c9816-0000-43d8-0000-b0b1000151fe
2021-05-30 14:46:26.110940 (Thread-1): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-30 14:46:26.111158 (Thread-1): finished collecting timing info
2021-05-30 14:46:26.111372 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:46:26.511533 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:46:27.423665 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:46:27.426503 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4dcab2b0>]}
2021-05-30 14:46:27.426901 (Thread-1): 20:16:27 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.48s]
2021-05-30 14:46:27.427068 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:27.427605 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:46:27.427873 (Thread-3): 20:16:27 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:46:27.428039 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:46:27.429286 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:46:27.429491 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:27.429589 (MainThread): On master: BEGIN
2021-05-30 14:46:27.429679 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:46:29.709623 (MainThread): SQL status: SUCCESS 1 in 2.28 seconds
2021-05-30 14:46:29.709894 (MainThread): On master: COMMIT
2021-05-30 14:46:29.710125 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:29.710261 (MainThread): On master: COMMIT
2021-05-30 14:46:30.187809 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-30 14:46:30.188089 (MainThread): On master: Close
2021-05-30 14:46:31.108952 (MainThread): 20:16:31 | 
2021-05-30 14:46:31.109173 (MainThread): 20:16:31 | Finished running 1 table model, 1 view model in 16.75s.
2021-05-30 14:46:31.109313 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:46:31.109412 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:46:31.113610 (MainThread): 
2021-05-30 14:46:31.113754 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:46:31.113875 (MainThread): 
2021-05-30 14:46:31.113989 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:46:31.114093 (MainThread):   001100 (42601): SQL compilation error:
2021-05-30 14:46:31.114182 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-30 14:46:31.114268 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:46:31.114366 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:46:31.114526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb480e6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4da97580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4dc1f7c0>]}
2021-05-30 14:46:31.114724 (MainThread): Flushing usage events
2021-05-30 14:47:45.521323 (MainThread): Running with dbt=0.19.1
2021-05-30 14:47:46.362116 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:47:46.363379 (MainThread): Tracking: tracking
2021-05-30 14:47:46.363986 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9388d10af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a84e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a84e700>]}
2021-05-30 14:47:46.375571 (MainThread): Partial parsing not enabled
2021-05-30 14:47:46.376831 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:47:46.379597 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:47:46.411673 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:47:46.413674 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:47:46.415099 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:47:46.419174 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:47:46.428529 (MainThread): Parsing macros/core.sql
2021-05-30 14:47:46.431879 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:47:46.439777 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:47:46.441317 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:47:46.457827 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:47:46.491931 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:47:46.511939 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:47:46.513595 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:47:46.519194 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:47:46.531916 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:47:46.538388 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:47:46.544056 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:47:46.548540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:47:46.549502 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:47:46.550441 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:47:46.551842 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:47:46.559661 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:47:46.561357 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:47:46.562826 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:47:46.602623 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:47:46.604353 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:47:46.605681 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:47:46.607283 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:47:46.613820 (MainThread): Partial parsing not enabled
2021-05-30 14:47:46.632712 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:46.640813 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:47:46.754425 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a81efa0>]}
2021-05-30 14:47:46.759680 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a81ef40>]}
2021-05-30 14:47:46.759960 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:47:46.760874 (MainThread): 
2021-05-30 14:47:46.761235 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:47:46.762152 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:47:46.776833 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:47:46.776989 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:47:46.777089 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:47:48.622964 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.85 seconds
2021-05-30 14:47:48.627232 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:47:49.444064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:47:49.451631 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:47:49.451802 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:47:49.451904 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:47:52.202280 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.75 seconds
2021-05-30 14:47:52.203427 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:47:53.027479 (MainThread): Using snowflake connection "master".
2021-05-30 14:47:53.027667 (MainThread): On master: BEGIN
2021-05-30 14:47:53.027785 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:47:54.970633 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-30 14:47:54.970902 (MainThread): On master: COMMIT
2021-05-30 14:47:54.971143 (MainThread): Using snowflake connection "master".
2021-05-30 14:47:54.971292 (MainThread): On master: COMMIT
2021-05-30 14:47:55.482502 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:47:55.482778 (MainThread): On master: Close
2021-05-30 14:47:56.814945 (MainThread): 20:17:56 | Concurrency: 10 threads (target='dev')
2021-05-30 14:47:56.815169 (MainThread): 20:17:56 | 
2021-05-30 14:47:56.816971 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:47:56.817286 (Thread-1): 20:17:56 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:47:56.817599 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:56.817726 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:47:56.820194 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:47:56.820643 (Thread-1): finished collecting timing info
2021-05-30 14:47:56.850435 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:47:56.851555 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:56.851669 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:47:56.851764 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:47:58.349583 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:47:58.349832 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:58.349971 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (


    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:47:59.885670 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-30 14:47:59.887226 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:47:59.887472 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:59.887586 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:48:00.296678 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:48:00.307814 (Thread-1): finished collecting timing info
2021-05-30 14:48:00.308019 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:48:00.959994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938adc2130>]}
2021-05-30 14:48:00.960446 (Thread-1): 20:18:00 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.14s]
2021-05-30 14:48:00.960624 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:48:00.961165 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:00.961448 (Thread-3): 20:18:00 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:48:00.962037 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:00.962351 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:00.965025 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:48:00.965513 (Thread-3): finished collecting timing info
2021-05-30 14:48:00.982195 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:48:00.982941 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:00.983042 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:48:00.983127 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:48:02.333429 (Thread-3): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-30 14:48:02.333684 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:02.333797 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:48:02.882843 (Thread-3): SQL status: SUCCESS 1 in 0.55 seconds
2021-05-30 14:48:02.896300 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:48:02.896604 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:02.896752 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:48:03.313396 (Thread-3): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-30 14:48:03.314481 (Thread-3): finished collecting timing info
2021-05-30 14:48:03.314710 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:48:03.934859 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938adc24c0>]}
2021-05-30 14:48:03.935338 (Thread-3): 20:18:03 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.97s]
2021-05-30 14:48:03.935524 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:03.937058 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:48:03.937307 (MainThread): Using snowflake connection "master".
2021-05-30 14:48:03.937425 (MainThread): On master: BEGIN
2021-05-30 14:48:03.937535 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:48:05.619823 (MainThread): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:48:05.620094 (MainThread): On master: COMMIT
2021-05-30 14:48:05.620334 (MainThread): Using snowflake connection "master".
2021-05-30 14:48:05.620476 (MainThread): On master: COMMIT
2021-05-30 14:48:06.317315 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2021-05-30 14:48:06.317585 (MainThread): On master: Close
2021-05-30 14:48:06.952343 (MainThread): 20:18:06 | 
2021-05-30 14:48:06.952566 (MainThread): 20:18:06 | Finished running 1 table model, 1 view model in 20.19s.
2021-05-30 14:48:06.952711 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:48:06.952815 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:48:06.952908 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:48:06.957216 (MainThread): 
2021-05-30 14:48:06.957364 (MainThread): Completed successfully
2021-05-30 14:48:06.957488 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:48:06.957659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a9d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938ad85610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938ad850a0>]}
2021-05-30 14:48:06.957865 (MainThread): Flushing usage events
2021-05-31 04:47:53.732091 (MainThread): Running with dbt=0.19.1
2021-05-31 04:47:55.143142 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:47:55.145248 (MainThread): Tracking: tracking
2021-05-31 04:47:55.145913 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba4407d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7750550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba77505e0>]}
2021-05-31 04:47:55.158914 (MainThread): Partial parsing not enabled
2021-05-31 04:47:55.160339 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:47:55.163522 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:47:55.197851 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:47:55.200232 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:47:55.201897 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:47:55.205779 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:47:55.215787 (MainThread): Parsing macros/core.sql
2021-05-31 04:47:55.219733 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:47:55.228075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:47:55.229888 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:47:55.247746 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:47:55.280359 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:47:55.300487 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:47:55.302312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:47:55.307896 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:47:55.321695 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:47:55.332367 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:47:55.339879 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:47:55.345618 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:47:55.346926 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:47:55.348241 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:47:55.350174 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:47:55.359312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:47:55.361274 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:47:55.362923 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:47:55.402601 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:47:55.405033 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:47:55.407000 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:47:55.408982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:47:55.417011 (MainThread): Partial parsing not enabled
2021-05-31 04:47:55.436537 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:47:55.478329 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79b3d60>]}
2021-05-31 04:47:55.482464 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7a570d0>]}
2021-05-31 04:47:55.482697 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:47:55.483373 (MainThread): 
2021-05-31 04:47:55.483665 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:47:55.484420 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:47:55.497457 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:47:55.497566 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:47:55.497650 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:47:58.109929 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.61 seconds
2021-05-31 04:47:58.114123 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:47:58.868682 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:47:58.876369 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:47:58.876511 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:47:58.876614 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:48:00.436898 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-31 04:48:00.438071 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:48:01.089556 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:01.089721 (MainThread): On master: BEGIN
2021-05-31 04:48:01.089817 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:48:02.444688 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-31 04:48:02.444909 (MainThread): On master: COMMIT
2021-05-31 04:48:02.445082 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:02.445175 (MainThread): On master: COMMIT
2021-05-31 04:48:03.065780 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-05-31 04:48:03.066005 (MainThread): On master: Close
2021-05-31 04:48:03.763734 (MainThread): 10:18:03 | Concurrency: 10 threads (target='dev')
2021-05-31 04:48:03.763969 (MainThread): 10:18:03 | 
2021-05-31 04:48:03.766167 (Thread-1): Began running node model.demo_dbt.customers
2021-05-31 04:48:03.766501 (Thread-1): 10:18:03 | 1 of 1 START table model PUBLIC.customers............................ [RUN]
2021-05-31 04:48:03.766848 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:03.766998 (Thread-1): Compiling model.demo_dbt.customers
2021-05-31 04:48:03.768563 (Thread-1): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:03.770705 (Thread-1): finished collecting timing info
2021-05-31 04:48:03.801642 (Thread-1): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:03.803955 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:03.804175 (Thread-1): On model.demo_dbt.customers: BEGIN
2021-05-31 04:48:03.804281 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:48:05.317450 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-31 04:48:05.317704 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:05.317842 (Thread-1): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 04:48:05.726493 (Thread-1): Snowflake query id: 019c9b60-0000-43db-0000-b0b10001b00e
2021-05-31 04:48:05.726722 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-31 04:48:05.726952 (Thread-1): finished collecting timing info
2021-05-31 04:48:05.727168 (Thread-1): On model.demo_dbt.customers: ROLLBACK
2021-05-31 04:48:06.137633 (Thread-1): On model.demo_dbt.customers: Close
2021-05-31 04:48:06.753033 (Thread-1): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:06.763535 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7b67cd0>]}
2021-05-31 04:48:06.763981 (Thread-1): 10:18:06 | 1 of 1 ERROR creating table model PUBLIC.customers................... [ERROR in 3.00s]
2021-05-31 04:48:06.764157 (Thread-1): Finished running node model.demo_dbt.customers
2021-05-31 04:48:06.765690 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:06.765952 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:06.766052 (MainThread): On master: BEGIN
2021-05-31 04:48:06.766144 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:48:08.182233 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-31 04:48:08.182464 (MainThread): On master: COMMIT
2021-05-31 04:48:08.182645 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:08.182750 (MainThread): On master: COMMIT
2021-05-31 04:48:08.594207 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:48:08.594502 (MainThread): On master: Close
2021-05-31 04:48:09.135220 (MainThread): 10:18:09 | 
2021-05-31 04:48:09.135455 (MainThread): 10:18:09 | Finished running 1 table model in 13.65s.
2021-05-31 04:48:09.135597 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:48:09.135698 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 04:48:09.140298 (MainThread): 
2021-05-31 04:48:09.140486 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:48:09.140704 (MainThread): 
2021-05-31 04:48:09.140946 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 04:48:09.141100 (MainThread):   002003 (02000): SQL compilation error:
2021-05-31 04:48:09.141199 (MainThread):   Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-31 04:48:09.141289 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:09.141385 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-31 04:48:09.141558 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79e24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba771fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79a9700>]}
2021-05-31 04:48:09.141775 (MainThread): Flushing usage events
2021-05-31 04:48:32.819535 (MainThread): Running with dbt=0.19.1
2021-05-31 04:48:33.734323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:48:33.735716 (MainThread): Tracking: tracking
2021-05-31 04:48:33.736279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05ec0fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff060f8d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff060f8d760>]}
2021-05-31 04:48:33.748190 (MainThread): Partial parsing not enabled
2021-05-31 04:48:33.749363 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:48:33.752187 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:48:33.783391 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:48:33.785197 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:48:33.786824 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:48:33.790651 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:48:33.801933 (MainThread): Parsing macros/core.sql
2021-05-31 04:48:33.807604 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:48:33.817198 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:48:33.819103 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:48:33.837127 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:48:33.869638 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:48:33.889194 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:48:33.891125 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:48:33.896593 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:48:33.909746 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:48:33.915818 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:48:33.922154 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:48:33.926540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:48:33.927363 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:48:33.928261 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:48:33.929668 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:48:33.937438 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:48:33.939134 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:48:33.940594 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:48:33.980711 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:48:33.982407 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:48:33.983733 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:48:33.985220 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:48:33.992300 (MainThread): Partial parsing not enabled
2021-05-31 04:48:34.010911 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:34.051540 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611e61f0>]}
2021-05-31 04:48:34.055103 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611bd400>]}
2021-05-31 04:48:34.055340 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:48:34.055992 (MainThread): 
2021-05-31 04:48:34.056253 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:34.057191 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:48:34.070115 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:48:34.070262 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:48:34.070353 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:48:35.729454 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.66 seconds
2021-05-31 04:48:35.733756 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:48:36.457069 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:48:36.464862 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:48:36.464993 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:48:36.465095 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:48:37.991378 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.53 seconds
2021-05-31 04:48:37.992575 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:48:38.532418 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:38.532606 (MainThread): On master: BEGIN
2021-05-31 04:48:38.532720 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:48:39.733977 (MainThread): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-31 04:48:39.734268 (MainThread): On master: COMMIT
2021-05-31 04:48:39.734511 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:39.734661 (MainThread): On master: COMMIT
2021-05-31 04:48:40.087973 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:48:40.088250 (MainThread): On master: Close
2021-05-31 04:48:40.658332 (MainThread): 10:18:40 | Concurrency: 10 threads (target='dev')
2021-05-31 04:48:40.658567 (MainThread): 10:18:40 | 
2021-05-31 04:48:40.661033 (Thread-1): Began running node model.demo_dbt.customers
2021-05-31 04:48:40.661463 (Thread-1): 10:18:40 | 1 of 1 START table model PUBLIC.customers............................ [RUN]
2021-05-31 04:48:40.661902 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:40.662045 (Thread-1): Compiling model.demo_dbt.customers
2021-05-31 04:48:40.663700 (Thread-1): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:40.664207 (Thread-1): finished collecting timing info
2021-05-31 04:48:40.694370 (Thread-1): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:40.696675 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:40.696912 (Thread-1): On model.demo_dbt.customers: BEGIN
2021-05-31 04:48:40.697030 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:48:41.925016 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 04:48:41.925268 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:41.925405 (Thread-1): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 04:48:42.259585 (Thread-1): Snowflake query id: 019c9b60-0000-43cf-0000-b0b10001c01a
2021-05-31 04:48:42.259808 (Thread-1): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-31 04:48:42.260029 (Thread-1): finished collecting timing info
2021-05-31 04:48:42.260243 (Thread-1): On model.demo_dbt.customers: ROLLBACK
2021-05-31 04:48:42.637628 (Thread-1): On model.demo_dbt.customers: Close
2021-05-31 04:48:43.527902 (Thread-1): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:43.531192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0613a88b0>]}
2021-05-31 04:48:43.531626 (Thread-1): 10:18:43 | 1 of 1 ERROR creating table model PUBLIC.customers................... [ERROR in 2.87s]
2021-05-31 04:48:43.531794 (Thread-1): Finished running node model.demo_dbt.customers
2021-05-31 04:48:43.533354 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:43.533597 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:43.533704 (MainThread): On master: BEGIN
2021-05-31 04:48:43.533799 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:48:44.858047 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 04:48:44.858311 (MainThread): On master: COMMIT
2021-05-31 04:48:44.858538 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:44.858681 (MainThread): On master: COMMIT
2021-05-31 04:48:45.205245 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:48:45.205513 (MainThread): On master: Close
2021-05-31 04:48:45.778280 (MainThread): 10:18:45 | 
2021-05-31 04:48:45.778498 (MainThread): 10:18:45 | Finished running 1 table model in 11.72s.
2021-05-31 04:48:45.778633 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:48:45.778727 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 04:48:45.783032 (MainThread): 
2021-05-31 04:48:45.783233 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:48:45.783371 (MainThread): 
2021-05-31 04:48:45.783496 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 04:48:45.783606 (MainThread):   001100 (42601): SQL compilation error:
2021-05-31 04:48:45.783704 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-31 04:48:45.783798 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:45.783900 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-31 04:48:45.784083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff06128dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff061256820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611077c0>]}
2021-05-31 04:48:45.784332 (MainThread): Flushing usage events
2021-05-31 04:48:51.774532 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-31 04:48:51.774780 (MainThread): Error sending message, disabling tracking
2021-05-31 04:53:26.307970 (MainThread): Running with dbt=0.19.1
2021-05-31 04:53:27.220163 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:53:27.221616 (MainThread): Tracking: tracking
2021-05-31 04:53:27.222177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271f0faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27434c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27434c760>]}
2021-05-31 04:53:27.233263 (MainThread): Partial parsing not enabled
2021-05-31 04:53:27.234485 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:53:27.237101 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:53:27.265759 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:53:27.267610 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:53:27.269097 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:53:27.272688 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:53:27.281828 (MainThread): Parsing macros/core.sql
2021-05-31 04:53:27.285247 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:53:27.293531 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:53:27.295126 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:53:27.311579 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:53:27.343451 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:53:27.362437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:53:27.364105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:53:27.369456 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:53:27.382396 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:53:27.388630 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:53:27.394249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:53:27.398561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:53:27.399419 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:53:27.400330 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:53:27.401760 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:53:27.409819 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:53:27.411548 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:53:27.413014 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:53:27.452762 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:53:27.454448 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:53:27.455780 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:53:27.457306 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:53:27.463770 (MainThread): Partial parsing not enabled
2021-05-31 04:53:27.482343 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:27.489725 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:53:27.525534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2745a26a0>]}
2021-05-31 04:53:27.529025 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274681fd0>]}
2021-05-31 04:53:27.529209 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:53:27.529797 (MainThread): 
2021-05-31 04:53:27.530036 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:53:27.530702 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:53:27.603189 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:53:27.603373 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:53:27.603482 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:53:29.427119 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.82 seconds
2021-05-31 04:53:29.431470 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:53:30.043486 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:53:30.051321 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:53:30.051450 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:53:30.051551 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:53:31.158972 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.11 seconds
2021-05-31 04:53:31.160158 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:53:31.784814 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:31.785004 (MainThread): On master: BEGIN
2021-05-31 04:53:31.785118 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:53:33.214598 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:53:33.214883 (MainThread): On master: COMMIT
2021-05-31 04:53:33.215119 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:33.215227 (MainThread): On master: COMMIT
2021-05-31 04:53:33.726761 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 04:53:33.727038 (MainThread): On master: Close
2021-05-31 04:53:34.547412 (MainThread): 10:23:34 | Concurrency: 10 threads (target='dev')
2021-05-31 04:53:34.547646 (MainThread): 10:23:34 | 
2021-05-31 04:53:34.549887 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:53:34.550229 (Thread-1): 10:23:34 | 1 of 2 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 04:53:34.550557 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:34.550704 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:53:34.552247 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:53:34.552716 (Thread-1): finished collecting timing info
2021-05-31 04:53:34.582342 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:53:34.583199 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:34.583305 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:53:34.583397 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:53:35.774667 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:53:35.774926 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:35.775064 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 04:53:36.183878 (Thread-1): Snowflake query id: 019c9b65-0000-43dd-0000-b0b10001a03a
2021-05-31 04:53:36.184106 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:53:36.184334 (Thread-1): finished collecting timing info
2021-05-31 04:53:36.184548 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:53:36.594043 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:53:37.209631 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:53:37.212589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274893c40>]}
2021-05-31 04:53:37.212967 (Thread-1): 10:23:37 | 1 of 2 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.66s]
2021-05-31 04:53:37.213135 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:53:37.213741 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:53:37.213922 (Thread-3): 10:23:37 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:53:37.214181 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:53:37.215472 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:53:37.215694 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:37.215803 (MainThread): On master: BEGIN
2021-05-31 04:53:37.215903 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:53:38.334608 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-31 04:53:38.334881 (MainThread): On master: COMMIT
2021-05-31 04:53:38.335114 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:38.335252 (MainThread): On master: COMMIT
2021-05-31 04:53:38.747554 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:53:38.747840 (MainThread): On master: Close
2021-05-31 04:53:39.565357 (MainThread): 10:23:39 | 
2021-05-31 04:53:39.565600 (MainThread): 10:23:39 | Finished running 2 table models in 12.04s.
2021-05-31 04:53:39.565752 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:53:39.565864 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:53:39.570320 (MainThread): 
2021-05-31 04:53:39.570491 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:53:39.570630 (MainThread): 
2021-05-31 04:53:39.570760 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:53:39.570874 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:53:39.570979 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:53:39.571084 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:53:39.571198 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:53:39.571380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27467e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2748b0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2748b0e80>]}
2021-05-31 04:53:39.571601 (MainThread): Flushing usage events
2021-05-31 04:54:17.634997 (MainThread): Running with dbt=0.19.1
2021-05-31 04:54:18.516096 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:54:18.517517 (MainThread): Tracking: tracking
2021-05-31 04:54:18.518052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83252cbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329a4f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329a4f730>]}
2021-05-31 04:54:18.529642 (MainThread): Partial parsing not enabled
2021-05-31 04:54:18.530857 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:54:18.533536 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:54:18.562961 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:54:18.564746 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:54:18.566045 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:54:18.569786 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:54:18.578778 (MainThread): Parsing macros/core.sql
2021-05-31 04:54:18.582163 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:54:18.589968 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:54:18.591509 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:54:18.608069 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:54:18.640092 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:54:18.659480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:54:18.661146 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:54:18.666529 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:54:18.679364 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:54:18.685476 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:54:18.691148 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:54:18.695498 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:54:18.696329 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:54:18.697242 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:54:18.698665 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:54:18.706590 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:54:18.708405 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:54:18.709924 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:54:18.749189 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:54:18.750889 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:54:18.752245 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:54:18.753746 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:54:18.760368 (MainThread): Partial parsing not enabled
2021-05-31 04:54:18.779406 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:18.786873 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:54:18.822400 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329b98880>]}
2021-05-31 04:54:18.825871 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329c82f40>]}
2021-05-31 04:54:18.826051 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:54:18.826635 (MainThread): 
2021-05-31 04:54:18.826861 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:54:18.827520 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:54:18.899210 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:54:18.899393 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:54:18.899503 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:54:20.401531 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.50 seconds
2021-05-31 04:54:20.405572 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:54:20.957454 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:54:20.965339 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:54:20.965470 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:54:20.965572 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:54:22.262154 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.30 seconds
2021-05-31 04:54:22.263315 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:54:22.815827 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:22.816013 (MainThread): On master: BEGIN
2021-05-31 04:54:22.816127 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:54:24.003414 (MainThread): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:54:24.003707 (MainThread): On master: COMMIT
2021-05-31 04:54:24.003911 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:24.004023 (MainThread): On master: COMMIT
2021-05-31 04:54:24.343067 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 04:54:24.343348 (MainThread): On master: Close
2021-05-31 04:54:24.923606 (MainThread): 10:24:24 | Concurrency: 10 threads (target='dev')
2021-05-31 04:54:24.923837 (MainThread): 10:24:24 | 
2021-05-31 04:54:24.926028 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:54:24.926358 (Thread-1): 10:24:24 | 1 of 2 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 04:54:24.926688 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:24.926852 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:54:24.928393 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:54:24.928894 (Thread-1): finished collecting timing info
2021-05-31 04:54:24.959254 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:54:24.960105 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:24.960216 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:54:24.960306 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:54:26.149618 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:54:26.149869 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:26.150005 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 04:54:26.559299 (Thread-1): Snowflake query id: 019c9b66-0000-43dd-0000-b0b10001a04e
2021-05-31 04:54:26.559520 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:54:26.559741 (Thread-1): finished collecting timing info
2021-05-31 04:54:26.559945 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:54:26.989540 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:54:27.563629 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:54:27.566704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f832a101b50>]}
2021-05-31 04:54:27.567122 (Thread-1): 10:24:27 | 1 of 2 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.64s]
2021-05-31 04:54:27.567304 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:54:27.567971 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:54:27.568166 (Thread-3): 10:24:27 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:54:27.568332 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:54:27.569806 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:54:27.570051 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:27.570167 (MainThread): On master: BEGIN
2021-05-31 04:54:27.570274 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:54:29.155676 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-31 04:54:29.155949 (MainThread): On master: COMMIT
2021-05-31 04:54:29.156180 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:29.156314 (MainThread): On master: COMMIT
2021-05-31 04:54:29.532393 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 04:54:29.532669 (MainThread): On master: Close
2021-05-31 04:54:30.149631 (MainThread): 10:24:30 | 
2021-05-31 04:54:30.149862 (MainThread): 10:24:30 | Finished running 2 table models in 11.32s.
2021-05-31 04:54:30.150004 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:54:30.150106 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:54:30.154518 (MainThread): 
2021-05-31 04:54:30.154682 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:54:30.154817 (MainThread): 
2021-05-31 04:54:30.154944 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:54:30.155058 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:54:30.155163 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:54:30.155264 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:54:30.155375 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:54:30.155555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329be2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329cf6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329cf6160>]}
2021-05-31 04:54:30.155784 (MainThread): Flushing usage events
2021-05-31 04:55:25.242777 (MainThread): Running with dbt=0.19.1
2021-05-31 04:55:26.013528 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:55:26.015005 (MainThread): Tracking: tracking
2021-05-31 04:55:26.015528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc007fc8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d94e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d94e700>]}
2021-05-31 04:55:26.024913 (MainThread): Partial parsing not enabled
2021-05-31 04:55:26.025883 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:55:26.028131 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:55:26.054156 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:55:26.055915 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:55:26.057157 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:55:26.060623 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:55:26.069254 (MainThread): Parsing macros/core.sql
2021-05-31 04:55:26.072469 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:55:26.079931 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:55:26.081420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:55:26.096785 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:55:26.126863 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:55:26.145879 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:55:26.147463 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:55:26.152635 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:55:26.165149 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:55:26.171305 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:55:26.176736 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:55:26.180872 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:55:26.181671 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:55:26.182552 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:55:26.183918 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:55:26.191412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:55:26.193054 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:55:26.194466 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:55:26.232513 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:55:26.234090 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:55:26.235367 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:55:26.236796 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:55:26.243044 (MainThread): Partial parsing not enabled
2021-05-31 04:55:26.261053 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:26.268230 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:55:26.305723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00da96c40>]}
2021-05-31 04:55:26.309129 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00db84490>]}
2021-05-31 04:55:26.309301 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:55:26.309862 (MainThread): 
2021-05-31 04:55:26.310086 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:55:26.310840 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:55:26.382653 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:55:26.382840 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:55:26.382940 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:55:27.899266 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.52 seconds
2021-05-31 04:55:27.903765 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:55:28.514262 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:55:28.520994 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:55:28.521124 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:55:28.521221 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:55:29.743601 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.22 seconds
2021-05-31 04:55:29.744767 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:55:30.563629 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:30.563822 (MainThread): On master: BEGIN
2021-05-31 04:55:30.563940 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:55:31.824902 (MainThread): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-31 04:55:31.825203 (MainThread): On master: COMMIT
2021-05-31 04:55:31.825451 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:31.825593 (MainThread): On master: COMMIT
2021-05-31 04:55:32.180289 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:55:32.180569 (MainThread): On master: Close
2021-05-31 04:55:32.814838 (MainThread): 10:25:32 | Concurrency: 10 threads (target='dev')
2021-05-31 04:55:32.815081 (MainThread): 10:25:32 | 
2021-05-31 04:55:32.817358 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:55:32.817700 (Thread-1): 10:25:32 | 1 of 2 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 04:55:32.818058 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:32.818215 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:55:32.819850 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:55:32.820355 (Thread-1): finished collecting timing info
2021-05-31 04:55:32.847657 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:55:32.848489 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:32.848599 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:55:32.848691 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:55:34.041463 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:55:34.041720 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:34.041860 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 04:55:34.450583 (Thread-1): Snowflake query id: 019c9b67-0000-43cf-0000-b0b10001c05a
2021-05-31 04:55:34.450814 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:55:34.451055 (Thread-1): finished collecting timing info
2021-05-31 04:55:34.451272 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:55:35.064804 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:55:35.682719 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:55:35.685835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00df0a730>]}
2021-05-31 04:55:35.686239 (Thread-1): 10:25:35 | 1 of 2 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.87s]
2021-05-31 04:55:35.686411 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:55:35.687121 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:55:35.687321 (Thread-3): 10:25:35 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:55:35.687491 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:55:35.688912 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:55:35.689138 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:35.689247 (MainThread): On master: BEGIN
2021-05-31 04:55:35.689347 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:55:37.011298 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 04:55:37.011571 (MainThread): On master: COMMIT
2021-05-31 04:55:37.011801 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:37.011936 (MainThread): On master: COMMIT
2021-05-31 04:55:37.420568 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:55:37.420851 (MainThread): On master: Close
2021-05-31 04:55:38.139379 (MainThread): 10:25:38 | 
2021-05-31 04:55:38.139620 (MainThread): 10:25:38 | Finished running 2 view models in 11.83s.
2021-05-31 04:55:38.139766 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:55:38.139870 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:55:38.144330 (MainThread): 
2021-05-31 04:55:38.144518 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:55:38.144658 (MainThread): 
2021-05-31 04:55:38.144792 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:55:38.144931 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:55:38.145043 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:55:38.145157 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:55:38.145281 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:55:38.145467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dae2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dfdea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dfded60>]}
2021-05-31 04:55:38.145709 (MainThread): Flushing usage events
2021-05-31 04:58:07.901623 (MainThread): Running with dbt=0.19.1
2021-05-31 04:58:08.711184 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:58:08.712655 (MainThread): Tracking: tracking
2021-05-31 04:58:08.713145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb0edbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb3152550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb31525e0>]}
2021-05-31 04:58:08.724341 (MainThread): Partial parsing not enabled
2021-05-31 04:58:08.725640 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:58:08.728453 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:58:08.757603 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:58:08.759388 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:58:08.760680 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:58:08.764166 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:58:08.773171 (MainThread): Parsing macros/core.sql
2021-05-31 04:58:08.776542 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:58:08.784462 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:58:08.786041 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:58:08.802292 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:58:08.833429 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:58:08.852604 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:58:08.854255 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:58:08.859620 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:58:08.872796 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:58:08.878923 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:58:08.884497 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:58:08.888807 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:58:08.889659 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:58:08.890579 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:58:08.892010 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:58:08.900646 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:58:08.902432 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:58:08.904000 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:58:08.943550 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:58:08.945256 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:58:08.946603 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:58:08.948110 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:58:08.954555 (MainThread): Partial parsing not enabled
2021-05-31 04:58:08.973035 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:08.980176 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:58:08.983216 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:09.022090 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33951f0>]}
2021-05-31 04:58:09.083862 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb311fbe0>]}
2021-05-31 04:58:09.084226 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:58:09.085074 (MainThread): 
2021-05-31 04:58:09.085470 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:58:09.086584 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:58:09.101873 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:58:09.102041 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:58:09.102145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:58:10.980060 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.88 seconds
2021-05-31 04:58:10.984366 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:58:12.083869 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:58:12.091518 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:58:12.091643 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:58:12.091743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:58:13.676088 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-31 04:58:13.677267 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:58:14.701673 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:14.701860 (MainThread): On master: BEGIN
2021-05-31 04:58:14.701976 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:58:16.133034 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:58:16.133280 (MainThread): On master: COMMIT
2021-05-31 04:58:16.133494 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:16.133610 (MainThread): On master: COMMIT
2021-05-31 04:58:16.543251 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:58:16.543534 (MainThread): On master: Close
2021-05-31 04:58:17.262131 (MainThread): 10:28:17 | Concurrency: 10 threads (target='dev')
2021-05-31 04:58:17.262367 (MainThread): 10:28:17 | 
2021-05-31 04:58:17.264704 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:58:17.264949 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 04:58:17.265351 (Thread-1): 10:28:17 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 04:58:17.265697 (Thread-2): 10:28:17 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 04:58:17.266452 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:17.266755 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:17.266921 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:58:17.267085 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 04:58:17.268451 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:58:17.269745 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 04:58:17.270269 (Thread-1): finished collecting timing info
2021-05-31 04:58:17.281019 (Thread-2): finished collecting timing info
2021-05-31 04:58:17.315499 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:58:17.317713 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 04:58:17.318554 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:17.318655 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:58:17.318745 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:58:17.320291 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:17.320397 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 04:58:17.320507 (Thread-2): Opening a new connection, currently in state init
2021-05-31 04:58:18.563542 (Thread-2): SQL status: SUCCESS 1 in 1.24 seconds
2021-05-31 04:58:18.563748 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:18.563856 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 04:58:18.835951 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 04:58:18.836167 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:18.836273 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 04:58:18.874856 (Thread-2): Snowflake query id: 019c9b6a-0000-43cf-0000-b0b10001c072
2021-05-31 04:58:18.875072 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 04:58:18.875299 (Thread-2): finished collecting timing info
2021-05-31 04:58:18.875504 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 04:58:19.219015 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 04:58:19.473225 (Thread-1): Snowflake query id: 019c9b6a-0000-43db-0000-b0b10001b072
2021-05-31 04:58:19.473441 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:58:19.473647 (Thread-1): finished collecting timing info
2021-05-31 04:58:19.473843 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:58:19.781715 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 04:58:19.784700 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb35d7610>]}
2021-05-31 04:58:19.785105 (Thread-2): 10:28:19 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 2.52s]
2021-05-31 04:58:19.785263 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 04:58:19.819358 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:58:20.435398 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:58:20.436209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb35d7610>]}
2021-05-31 04:58:20.436586 (Thread-1): 10:28:20 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 3.17s]
2021-05-31 04:58:20.436742 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:58:20.437352 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 04:58:20.437537 (Thread-4): 10:28:20 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:58:20.437691 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 04:58:20.439063 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:58:20.439256 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:20.439346 (MainThread): On master: BEGIN
2021-05-31 04:58:20.439428 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:58:21.870347 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:58:21.870618 (MainThread): On master: COMMIT
2021-05-31 04:58:21.870855 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:21.870986 (MainThread): On master: COMMIT
2021-05-31 04:58:22.332896 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-31 04:58:22.333175 (MainThread): On master: Close
2021-05-31 04:58:22.996092 (MainThread): 10:28:22 | 
2021-05-31 04:58:22.996317 (MainThread): 10:28:22 | Finished running 3 view models in 13.91s.
2021-05-31 04:58:22.996458 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:58:22.996557 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:58:22.996646 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 04:58:23.001124 (MainThread): 
2021-05-31 04:58:23.001295 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 04:58:23.001424 (MainThread): 
2021-05-31 04:58:23.001546 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 04:58:23.001652 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:58:23.001747 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 04:58:23.001840 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 04:58:23.001938 (MainThread): 
2021-05-31 04:58:23.002046 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:58:23.002202 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:58:23.002355 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:58:23.002468 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:58:23.002583 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 04:58:23.002766 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490ccd0>]}
2021-05-31 04:58:23.002988 (MainThread): Flushing usage events
2021-05-31 05:26:49.551231 (MainThread): Running with dbt=0.19.1
2021-05-31 05:26:50.592902 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 05:26:50.594319 (MainThread): Tracking: tracking
2021-05-31 05:26:50.594768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27f6c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282a0e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282a0e7c0>]}
2021-05-31 05:26:50.604487 (MainThread): Partial parsing not enabled
2021-05-31 05:26:50.605470 (MainThread): Parsing macros/catalog.sql
2021-05-31 05:26:50.607731 (MainThread): Parsing macros/adapters.sql
2021-05-31 05:26:50.633742 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 05:26:50.635480 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 05:26:50.636773 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 05:26:50.640194 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 05:26:50.649058 (MainThread): Parsing macros/core.sql
2021-05-31 05:26:50.652473 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 05:26:50.660041 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 05:26:50.661553 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 05:26:50.677320 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 05:26:50.707490 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 05:26:50.726504 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 05:26:50.728123 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 05:26:50.733407 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 05:26:50.746175 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 05:26:50.752161 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 05:26:50.757623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 05:26:50.761789 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 05:26:50.762607 (MainThread): Parsing macros/etc/query.sql
2021-05-31 05:26:50.763491 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 05:26:50.764864 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 05:26:50.772466 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 05:26:50.774133 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 05:26:50.775819 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 05:26:50.813989 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 05:26:50.815592 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 05:26:50.816896 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 05:26:50.818357 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 05:26:50.824647 (MainThread): Partial parsing not enabled
2021-05-31 05:26:50.843127 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:50.850395 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 05:26:50.853325 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:50.886586 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282c541f0>]}
2021-05-31 05:26:50.945442 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2828dedf0>]}
2021-05-31 05:26:50.945772 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 05:26:50.946567 (MainThread): 
2021-05-31 05:26:50.946940 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:26:50.948013 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 05:26:50.966473 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 05:26:50.966636 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 05:26:50.966741 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 05:26:52.796660 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-31 05:26:52.801118 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 05:26:53.595326 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:26:53.603368 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:26:53.603499 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 05:26:53.603604 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 05:26:54.843349 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.24 seconds
2021-05-31 05:26:54.844511 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 05:26:55.460563 (MainThread): Using snowflake connection "master".
2021-05-31 05:26:55.460757 (MainThread): On master: BEGIN
2021-05-31 05:26:55.460877 (MainThread): Opening a new connection, currently in state init
2021-05-31 05:26:56.683724 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 05:26:56.684004 (MainThread): On master: COMMIT
2021-05-31 05:26:56.684242 (MainThread): Using snowflake connection "master".
2021-05-31 05:26:56.684376 (MainThread): On master: COMMIT
2021-05-31 05:26:57.028399 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 05:26:57.028675 (MainThread): On master: Close
2021-05-31 05:26:57.627612 (MainThread): 10:56:57 | Concurrency: 10 threads (target='dev')
2021-05-31 05:26:57.627841 (MainThread): 10:56:57 | 
2021-05-31 05:26:57.630082 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 05:26:57.630408 (Thread-1): 10:56:57 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 05:26:57.630615 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 05:26:57.631298 (Thread-2): 10:56:57 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 05:26:57.631509 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:57.631797 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:57.631938 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 05:26:57.632050 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 05:26:57.633248 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:26:57.634383 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:26:57.634906 (Thread-1): finished collecting timing info
2021-05-31 05:26:57.635045 (Thread-2): finished collecting timing info
2021-05-31 05:26:57.669264 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:26:57.671554 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:26:57.672434 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:57.672537 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 05:26:57.672628 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 05:26:57.674246 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:57.674425 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 05:26:57.674536 (Thread-2): Opening a new connection, currently in state init
2021-05-31 05:26:58.898653 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 05:26:58.898904 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:58.899040 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 05:26:59.193116 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 05:26:59.193361 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:59.193495 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 05:26:59.209843 (Thread-1): Snowflake query id: 019c9b86-0000-43cf-0000-b0b10001c082
2021-05-31 05:26:59.210061 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:26:59.210291 (Thread-1): finished collecting timing info
2021-05-31 05:26:59.210506 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 05:26:59.502262 (Thread-2): Snowflake query id: 019c9b86-0000-43dc-0000-b0b10001d01a
2021-05-31 05:26:59.502480 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:26:59.502690 (Thread-2): finished collecting timing info
2021-05-31 05:26:59.502890 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 05:26:59.612001 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 05:26:59.967761 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 05:27:00.288084 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:27:00.291348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282edc1f0>]}
2021-05-31 05:27:00.291737 (Thread-1): 10:57:00 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.66s]
2021-05-31 05:27:00.291910 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 05:27:00.746330 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:27:00.747054 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282edc5b0>]}
2021-05-31 05:27:00.747377 (Thread-2): 10:57:00 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 3.12s]
2021-05-31 05:27:00.747518 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 05:27:00.748065 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 05:27:00.748232 (Thread-4): 10:57:00 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 05:27:00.748458 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 05:27:00.749622 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:27:00.749824 (MainThread): Using snowflake connection "master".
2021-05-31 05:27:00.749920 (MainThread): On master: BEGIN
2021-05-31 05:27:00.750008 (MainThread): Opening a new connection, currently in state closed
2021-05-31 05:27:02.320039 (MainThread): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-31 05:27:02.320307 (MainThread): On master: COMMIT
2021-05-31 05:27:02.320535 (MainThread): Using snowflake connection "master".
2021-05-31 05:27:02.320669 (MainThread): On master: COMMIT
2021-05-31 05:27:02.725569 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 05:27:02.725843 (MainThread): On master: Close
2021-05-31 05:27:03.426424 (MainThread): 10:57:03 | 
2021-05-31 05:27:03.426657 (MainThread): 10:57:03 | Finished running 3 view models in 12.48s.
2021-05-31 05:27:03.426799 (MainThread): Connection 'master' was properly closed.
2021-05-31 05:27:03.426901 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 05:27:03.426995 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 05:27:03.431531 (MainThread): 
2021-05-31 05:27:03.431698 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 05:27:03.431840 (MainThread): 
2021-05-31 05:27:03.431974 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 05:27:03.432094 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:27:03.432205 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:27:03.432313 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:27:03.432427 (MainThread): 
2021-05-31 05:27:03.432551 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 05:27:03.432668 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:27:03.432773 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:27:03.432876 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:27:03.432990 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 05:27:03.433180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282e01b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282ba2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282e39c70>]}
2021-05-31 05:27:03.433439 (MainThread): Flushing usage events
2021-05-31 05:44:52.967276 (MainThread): Running with dbt=0.19.1
2021-05-31 05:44:54.525245 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 05:44:54.527603 (MainThread): Tracking: tracking
2021-05-31 05:44:54.528506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ea805f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec34e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec34e6d0>]}
2021-05-31 05:44:54.542723 (MainThread): Partial parsing not enabled
2021-05-31 05:44:54.544824 (MainThread): Parsing macros/catalog.sql
2021-05-31 05:44:54.548433 (MainThread): Parsing macros/adapters.sql
2021-05-31 05:44:54.586073 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 05:44:54.588871 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 05:44:54.591017 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 05:44:54.596272 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 05:44:54.609217 (MainThread): Parsing macros/core.sql
2021-05-31 05:44:54.614249 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 05:44:54.625752 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 05:44:54.628403 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 05:44:54.651474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 05:44:54.697193 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 05:44:54.724894 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 05:44:54.727679 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 05:44:54.735516 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 05:44:54.756082 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 05:44:54.765588 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 05:44:54.773629 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 05:44:54.779956 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 05:44:54.781624 (MainThread): Parsing macros/etc/query.sql
2021-05-31 05:44:54.783339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 05:44:54.785559 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 05:44:54.797261 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 05:44:54.800442 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 05:44:54.802755 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 05:44:54.857919 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 05:44:54.860792 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 05:44:54.863208 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 05:44:54.865437 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 05:44:54.873943 (MainThread): Partial parsing not enabled
2021-05-31 05:44:54.900251 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:44:54.911551 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 05:44:54.916616 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:44:54.967159 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec594130>]}
2021-05-31 05:44:55.046006 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec31ecd0>]}
2021-05-31 05:44:55.046390 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 05:44:55.047288 (MainThread): 
2021-05-31 05:44:55.047821 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:44:55.049011 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 05:44:55.068212 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 05:44:55.068378 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 05:44:55.068486 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 05:44:56.689432 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-31 05:44:56.693229 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 05:44:57.269774 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:44:57.277807 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:44:57.278031 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 05:44:57.278157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 05:44:58.566817 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.29 seconds
2021-05-31 05:44:58.567713 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 05:44:59.147938 (MainThread): Using snowflake connection "master".
2021-05-31 05:44:59.148109 (MainThread): On master: BEGIN
2021-05-31 05:44:59.148215 (MainThread): Opening a new connection, currently in state init
2021-05-31 05:45:00.445703 (MainThread): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-31 05:45:00.445948 (MainThread): On master: COMMIT
2021-05-31 05:45:00.446146 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:00.446251 (MainThread): On master: COMMIT
2021-05-31 05:45:00.825221 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 05:45:00.825470 (MainThread): On master: Close
2021-05-31 05:45:01.476743 (MainThread): 11:15:01 | Concurrency: 10 threads (target='dev')
2021-05-31 05:45:01.476971 (MainThread): 11:15:01 | 
2021-05-31 05:45:01.478692 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 05:45:01.478919 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 05:45:01.479235 (Thread-1): 11:15:01 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 05:45:01.479490 (Thread-2): 11:15:01 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 05:45:01.480256 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:01.480515 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:01.480677 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 05:45:01.480820 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 05:45:01.482024 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:45:01.483194 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:45:01.483777 (Thread-2): finished collecting timing info
2021-05-31 05:45:01.512171 (Thread-1): finished collecting timing info
2021-05-31 05:45:01.512035 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:45:01.514593 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:45:01.515701 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:01.516212 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:01.516300 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 05:45:01.516418 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 05:45:01.516564 (Thread-2): Opening a new connection, currently in state init
2021-05-31 05:45:01.516701 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 05:45:02.774069 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-31 05:45:02.774265 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:02.774369 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 05:45:03.111532 (Thread-1): Snowflake query id: 019c9b99-0000-43cf-0000-b0b10001c0ca
2021-05-31 05:45:03.111709 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:45:03.111881 (Thread-1): finished collecting timing info
2021-05-31 05:45:03.112033 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 05:45:03.123854 (Thread-2): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-31 05:45:03.124046 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:03.124145 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 05:45:03.455647 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 05:45:03.633336 (Thread-2): Snowflake query id: 019c9b99-0000-43dd-0000-b0b10001a10a
2021-05-31 05:45:03.633499 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:45:03.633648 (Thread-2): finished collecting timing info
2021-05-31 05:45:03.633787 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 05:45:04.114481 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:45:04.125084 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec6abd60>]}
2021-05-31 05:45:04.125484 (Thread-1): 11:15:04 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.65s]
2021-05-31 05:45:04.125644 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 05:45:04.143216 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 05:45:04.755251 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:45:04.756162 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec6ab730>]}
2021-05-31 05:45:04.756566 (Thread-2): 11:15:04 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 3.28s]
2021-05-31 05:45:04.757285 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 05:45:04.757994 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 05:45:04.758290 (Thread-4): 11:15:04 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 05:45:04.758471 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 05:45:04.760120 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:45:04.760375 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:04.760478 (MainThread): On master: BEGIN
2021-05-31 05:45:04.760570 (MainThread): Opening a new connection, currently in state closed
2021-05-31 05:45:06.192396 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 05:45:06.192595 (MainThread): On master: COMMIT
2021-05-31 05:45:06.192761 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:06.192851 (MainThread): On master: COMMIT
2021-05-31 05:45:06.572303 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 05:45:06.572575 (MainThread): On master: Close
2021-05-31 05:45:07.323672 (MainThread): 11:15:07 | 
2021-05-31 05:45:07.323884 (MainThread): 11:15:07 | Finished running 3 view models in 12.28s.
2021-05-31 05:45:07.324008 (MainThread): Connection 'master' was properly closed.
2021-05-31 05:45:07.324091 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 05:45:07.324166 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 05:45:07.328310 (MainThread): 
2021-05-31 05:45:07.328495 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 05:45:07.328618 (MainThread): 
2021-05-31 05:45:07.328728 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 05:45:07.328836 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:45:07.329021 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:45:07.329144 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:45:07.329253 (MainThread): 
2021-05-31 05:45:07.329365 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 05:45:07.329464 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:45:07.329550 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:45:07.329633 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:45:07.329726 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 05:45:07.329893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec4e26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec674a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec674af0>]}
2021-05-31 05:45:07.330119 (MainThread): Flushing usage events
2021-05-31 07:02:01.040949 (MainThread): Running with dbt=0.19.1
2021-05-31 07:02:02.691250 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:02:02.693481 (MainThread): Tracking: tracking
2021-05-31 07:02:02.694066 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517205df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c390610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c3906a0>]}
2021-05-31 07:02:02.706586 (MainThread): Partial parsing not enabled
2021-05-31 07:02:02.707927 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:02:02.710870 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:02:02.740555 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:02:02.742592 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:02:02.744069 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:02:02.747813 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:02:02.759258 (MainThread): Parsing macros/core.sql
2021-05-31 07:02:02.764539 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:02:02.776921 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:02:02.779002 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:02:02.797837 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:02:02.828766 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:02:02.847264 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:02:02.850156 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:02:02.857898 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:02:02.872930 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:02:02.881000 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:02:02.890266 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:02:02.895886 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:02:02.897120 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:02:02.898534 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:02:02.900496 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:02:02.910172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:02:02.912403 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:02:02.914285 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:02:02.953589 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:02:02.955611 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:02:02.957373 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:02:02.959209 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:02:02.966744 (MainThread): Partial parsing not enabled
2021-05-31 07:02:02.985701 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:02:02.993877 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:02:02.998485 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:02:03.035732 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd74ee3f7-c412-4fc3-b98f-d6952265fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c5d41f0>]}
2021-05-31 07:02:03.093335 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd74ee3f7-c412-4fc3-b98f-d6952265fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c35eca0>]}
2021-05-31 07:02:03.093669 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:02:03.094467 (MainThread): 
2021-05-31 07:02:03.094839 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:02:03.095917 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:02:03.111892 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:02:03.112034 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:02:03.112137 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:02:05.001825 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.89 seconds
2021-05-31 07:02:05.006463 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:02:05.852668 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:02:05.860267 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:02:05.860393 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:02:05.860491 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:02:07.590631 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.73 seconds
2021-05-31 07:02:07.591899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:02:08.189221 (MainThread): Using snowflake connection "master".
2021-05-31 07:02:08.189404 (MainThread): On master: BEGIN
2021-05-31 07:02:08.189519 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:02:09.527433 (MainThread): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-31 07:02:09.532420 (MainThread): On master: COMMIT
2021-05-31 07:02:09.533179 (MainThread): Using snowflake connection "master".
2021-05-31 07:02:09.533459 (MainThread): On master: COMMIT
2021-05-31 07:02:09.926488 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-31 07:02:09.926759 (MainThread): On master: Close
2021-05-31 07:02:10.518213 (MainThread): 12:32:10 | Concurrency: 10 threads (target='dev')
2021-05-31 07:02:10.518436 (MainThread): 12:32:10 | 
2021-05-31 07:02:10.520615 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:02:10.520940 (Thread-1): 12:32:10 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:02:10.521145 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:02:10.521490 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:02:10.522057 (Thread-2): 12:32:10 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:02:10.522185 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:02:10.522459 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:02:10.523592 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:02:10.523727 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:02:10.524945 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:02:10.525358 (Thread-1): finished collecting timing info
2021-05-31 07:02:10.525503 (Thread-2): finished collecting timing info
2021-05-31 07:02:10.565199 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:02:10.565544 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:02:10.566348 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:02:10.566448 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:02:10.566538 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:02:10.568315 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:02:10.568418 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:02:10.568504 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:02:11.684935 (Thread-2): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-31 07:02:11.685202 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:02:11.685313 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:02:11.815335 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-31 07:02:11.815577 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:02:11.815719 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:02:12.300166 (Thread-2): Snowflake query id: 019c9be6-0000-43dc-0000-b0b10001d1f6
2021-05-31 07:02:12.301123 (Thread-2): Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 8
invalid identifier 'USER_ID'
2021-05-31 07:02:12.301522 (Thread-2): finished collecting timing info
2021-05-31 07:02:12.302125 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 07:02:12.302319 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:02:12.303566 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:02:12.303904 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:02:12.304032 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:02:12.684325 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:02:13.124574 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-31 07:02:13.132566 (Thread-1): finished collecting timing info
2021-05-31 07:02:13.132727 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:02:13.266740 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 4 at position 8
  invalid identifier 'USER_ID'
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 4 at position 8
invalid identifier 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 4 at position 8
  invalid identifier 'USER_ID'
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:02:13.280207 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74ee3f7-c412-4fc3-b98f-d6952265fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c7c4d00>]}
2021-05-31 07:02:13.280722 (Thread-2): 12:32:13 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 2.76s]
2021-05-31 07:02:13.280943 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:02:13.736386 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74ee3f7-c412-4fc3-b98f-d6952265fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c7b4580>]}
2021-05-31 07:02:13.736825 (Thread-1): 12:32:13 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 3.21s]
2021-05-31 07:02:13.736996 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:02:13.737451 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:02:13.737637 (Thread-4): 12:32:13 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:02:13.737910 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:02:13.739231 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:02:13.739477 (MainThread): Using snowflake connection "master".
2021-05-31 07:02:13.739581 (MainThread): On master: BEGIN
2021-05-31 07:02:13.739679 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:02:15.680761 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-31 07:02:15.681025 (MainThread): On master: COMMIT
2021-05-31 07:02:15.681256 (MainThread): Using snowflake connection "master".
2021-05-31 07:02:15.681392 (MainThread): On master: COMMIT
2021-05-31 07:02:16.402739 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-31 07:02:16.403011 (MainThread): On master: Close
2021-05-31 07:02:17.214347 (MainThread): 12:32:17 | 
2021-05-31 07:02:17.214572 (MainThread): 12:32:17 | Finished running 3 view models in 14.12s.
2021-05-31 07:02:17.214712 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:02:17.214813 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:02:17.214904 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:02:17.219216 (MainThread): 
2021-05-31 07:02:17.219364 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:02:17.219489 (MainThread): 
2021-05-31 07:02:17.219607 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:02:17.219729 (MainThread):   000904 (42000): SQL compilation error: error line 4 at position 8
2021-05-31 07:02:17.219823 (MainThread):   invalid identifier 'USER_ID'
2021-05-31 07:02:17.219913 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:02:17.220013 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 07:02:17.220179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c543160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c7a6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c7a6820>]}
2021-05-31 07:02:17.220379 (MainThread): Flushing usage events
2021-05-31 07:04:21.086011 (MainThread): Running with dbt=0.19.1
2021-05-31 07:04:21.826896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:04:21.829333 (MainThread): Tracking: tracking
2021-05-31 07:04:21.830352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb031d45d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03408e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03408e730>]}
2021-05-31 07:04:21.840263 (MainThread): Partial parsing not enabled
2021-05-31 07:04:21.841216 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:04:21.843308 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:04:21.869505 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:04:21.871268 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:04:21.872506 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:04:21.875974 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:04:21.884749 (MainThread): Parsing macros/core.sql
2021-05-31 07:04:21.888007 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:04:21.895600 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:04:21.897096 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:04:21.912563 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:04:21.942816 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:04:21.961701 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:04:21.963256 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:04:21.968406 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:04:21.980708 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:04:21.986745 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:04:21.992282 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:04:21.996507 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:04:21.997301 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:04:21.998184 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:04:21.999547 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:04:22.007049 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:04:22.008697 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:04:22.010206 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:04:22.048271 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:04:22.049831 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:04:22.051100 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:04:22.052528 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:04:22.058789 (MainThread): Partial parsing not enabled
2021-05-31 07:04:22.076211 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:04:22.083457 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:04:22.086314 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:04:22.119034 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08032bf1-99a9-40c8-a909-58064ab91e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0342d4130>]}
2021-05-31 07:04:22.176394 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08032bf1-99a9-40c8-a909-58064ab91e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03405ecd0>]}
2021-05-31 07:04:22.176732 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:04:22.177574 (MainThread): 
2021-05-31 07:04:22.177950 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:04:22.179032 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:04:22.194603 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:04:22.194756 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:04:22.194860 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:04:24.209794 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.01 seconds
2021-05-31 07:04:24.214175 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:04:24.905486 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:04:24.912895 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:04:24.913025 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:04:24.913123 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:04:26.336235 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-05-31 07:04:26.337546 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:04:27.055242 (MainThread): Using snowflake connection "master".
2021-05-31 07:04:27.055419 (MainThread): On master: BEGIN
2021-05-31 07:04:27.055532 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:04:28.691354 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-31 07:04:28.691627 (MainThread): On master: COMMIT
2021-05-31 07:04:28.691855 (MainThread): Using snowflake connection "master".
2021-05-31 07:04:28.691991 (MainThread): On master: COMMIT
2021-05-31 07:04:29.055856 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 07:04:29.056127 (MainThread): On master: Close
2021-05-31 07:04:29.637390 (MainThread): 12:34:29 | Concurrency: 10 threads (target='dev')
2021-05-31 07:04:29.637609 (MainThread): 12:34:29 | 
2021-05-31 07:04:29.639855 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:04:29.640180 (Thread-1): 12:34:29 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:04:29.640386 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:04:29.640668 (Thread-2): 12:34:29 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:04:29.641309 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:04:29.641448 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:04:29.642591 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:04:29.642965 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:04:29.643090 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:04:29.644153 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:04:29.644558 (Thread-2): finished collecting timing info
2021-05-31 07:04:29.650299 (Thread-1): finished collecting timing info
2021-05-31 07:04:29.688827 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:04:29.691123 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:04:29.691879 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:04:29.691975 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:04:29.692063 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:04:29.693647 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:04:29.693759 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:04:29.693846 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:04:31.406087 (Thread-2): SQL status: SUCCESS 1 in 1.71 seconds
2021-05-31 07:04:31.406671 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-05-31 07:04:31.406816 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:04:31.406987 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:04:31.407132 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:04:31.407247 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:04:31.774509 (Thread-2): Snowflake query id: 019c9be8-0000-43cf-0000-b0b10001c1a6
2021-05-31 07:04:31.774725 (Thread-2): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'ID'
2021-05-31 07:04:31.774960 (Thread-2): finished collecting timing info
2021-05-31 07:04:31.775175 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:04:31.894191 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 07:04:31.895729 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:04:31.895997 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:04:31.896110 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:04:32.253965 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:04:32.373894 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-31 07:04:32.381807 (Thread-1): finished collecting timing info
2021-05-31 07:04:32.381967 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:04:32.845726 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 3 at position 8
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 3 at position 8
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:04:32.848802 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08032bf1-99a9-40c8-a909-58064ab91e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0344cf8e0>]}
2021-05-31 07:04:32.849160 (Thread-2): 12:34:32 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 3.21s]
2021-05-31 07:04:32.849318 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:04:32.965627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08032bf1-99a9-40c8-a909-58064ab91e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0344a7520>]}
2021-05-31 07:04:32.966055 (Thread-1): 12:34:32 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 3.32s]
2021-05-31 07:04:32.966221 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:04:32.966830 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:04:32.967026 (Thread-4): 12:34:32 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:04:32.967292 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:04:32.968606 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:04:32.968862 (MainThread): Using snowflake connection "master".
2021-05-31 07:04:32.968959 (MainThread): On master: BEGIN
2021-05-31 07:04:32.969047 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:04:34.492790 (MainThread): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 07:04:34.493053 (MainThread): On master: COMMIT
2021-05-31 07:04:34.493280 (MainThread): Using snowflake connection "master".
2021-05-31 07:04:34.493499 (MainThread): On master: COMMIT
2021-05-31 07:04:35.023107 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-31 07:04:35.023377 (MainThread): On master: Close
2021-05-31 07:04:35.758635 (MainThread): 12:34:35 | 
2021-05-31 07:04:35.758854 (MainThread): 12:34:35 | Finished running 3 view models in 13.58s.
2021-05-31 07:04:35.758994 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:04:35.759093 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:04:35.759184 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:04:35.763479 (MainThread): 
2021-05-31 07:04:35.763621 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:04:35.763743 (MainThread): 
2021-05-31 07:04:35.763858 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:04:35.763960 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 8
2021-05-31 07:04:35.764055 (MainThread):   invalid identifier 'ID'
2021-05-31 07:04:35.764146 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:04:35.764249 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 07:04:35.764403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb034299af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb034284700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb034284340>]}
2021-05-31 07:04:35.764605 (MainThread): Flushing usage events
2021-05-31 07:05:43.133549 (MainThread): Running with dbt=0.19.1
2021-05-31 07:05:43.919223 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:05:43.920514 (MainThread): Tracking: tracking
2021-05-31 07:05:43.920981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82db207d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dcd515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dcd51640>]}
2021-05-31 07:05:43.932182 (MainThread): Partial parsing not enabled
2021-05-31 07:05:43.933398 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:05:43.935987 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:05:43.964063 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:05:43.965876 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:05:43.967186 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:05:43.970814 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:05:43.979786 (MainThread): Parsing macros/core.sql
2021-05-31 07:05:43.983211 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:05:43.991164 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:05:43.992823 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:05:44.009142 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:05:44.040086 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:05:44.058352 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:05:44.060069 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:05:44.065509 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:05:44.077734 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:05:44.083636 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:05:44.089045 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:05:44.093366 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:05:44.094168 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:05:44.095321 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:05:44.096701 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:05:44.104253 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:05:44.105919 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:05:44.107360 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:05:44.145686 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:05:44.147284 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:05:44.148577 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:05:44.150025 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:05:44.156296 (MainThread): Partial parsing not enabled
2021-05-31 07:05:44.174159 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:05:44.181212 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:05:44.184117 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:05:44.217399 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4428b0-84f5-4e21-a3a3-0db610024e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dcf96130>]}
2021-05-31 07:05:44.271972 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4428b0-84f5-4e21-a3a3-0db610024e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dcd1ec10>]}
2021-05-31 07:05:44.272280 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:05:44.273008 (MainThread): 
2021-05-31 07:05:44.273346 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:05:44.274312 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:05:44.288336 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:05:44.288471 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:05:44.288567 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:05:45.885928 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.60 seconds
2021-05-31 07:05:45.890225 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:05:46.627211 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:05:46.634729 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:05:46.634860 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:05:46.634959 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:05:48.056749 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-05-31 07:05:48.058065 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:05:48.645522 (MainThread): Using snowflake connection "master".
2021-05-31 07:05:48.645703 (MainThread): On master: BEGIN
2021-05-31 07:05:48.645816 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:05:50.126138 (MainThread): SQL status: SUCCESS 1 in 1.48 seconds
2021-05-31 07:05:50.126422 (MainThread): On master: COMMIT
2021-05-31 07:05:50.126660 (MainThread): Using snowflake connection "master".
2021-05-31 07:05:50.126800 (MainThread): On master: COMMIT
2021-05-31 07:05:50.691062 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-05-31 07:05:50.691380 (MainThread): On master: Close
2021-05-31 07:05:51.283741 (MainThread): 12:35:51 | Concurrency: 10 threads (target='dev')
2021-05-31 07:05:51.283970 (MainThread): 12:35:51 | 
2021-05-31 07:05:51.286215 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:05:51.286549 (Thread-1): 12:35:51 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:05:51.286754 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:05:51.287439 (Thread-2): 12:35:51 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:05:51.287717 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:05:51.288022 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:05:51.288190 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:05:51.288320 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:05:51.289615 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:05:51.290694 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:05:51.291195 (Thread-1): finished collecting timing info
2021-05-31 07:05:51.296543 (Thread-2): finished collecting timing info
2021-05-31 07:05:51.337788 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:05:51.338535 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:05:51.339406 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:05:51.339507 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:05:51.339596 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:05:51.340627 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:05:51.340734 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:05:51.340820 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:05:52.550007 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-05-31 07:05:52.550182 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:05:52.550276 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:05:52.720969 (Thread-2): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:05:52.721213 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:05:52.721348 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:05:53.251983 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-05-31 07:05:53.252605 (Thread-2): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-31 07:05:53.253837 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:05:53.254794 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:05:53.255011 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:05:53.255201 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:05:53.255331 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:05:53.255457 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:05:53.558307 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 07:05:53.566377 (Thread-2): finished collecting timing info
2021-05-31 07:05:53.566542 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:05:53.600276 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 07:05:53.601355 (Thread-1): finished collecting timing info
2021-05-31 07:05:53.601576 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:05:54.174734 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4428b0-84f5-4e21-a3a3-0db610024e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd9de730>]}
2021-05-31 07:05:54.175196 (Thread-2): 12:35:54 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 2.89s]
2021-05-31 07:05:54.175378 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:05:54.360837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4428b0-84f5-4e21-a3a3-0db610024e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd987730>]}
2021-05-31 07:05:54.361205 (Thread-1): 12:35:54 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 3.07s]
2021-05-31 07:05:54.361347 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:05:54.361838 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:05:54.362064 (Thread-4): 12:35:54 | 3 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-31 07:05:54.362452 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:05:54.362578 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 07:05:54.364960 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 07:05:54.367075 (Thread-4): finished collecting timing info
2021-05-31 07:05:54.378201 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:05:54.378324 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */
drop table if exists "DEMO_DB"."PUBLIC"."CUSTOMERS" cascade
2021-05-31 07:05:54.378413 (Thread-4): Opening a new connection, currently in state init
2021-05-31 07:05:55.603079 (Thread-4): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:05:55.604830 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 07:05:55.608812 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:05:55.609018 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 07:05:55.919140 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-31 07:05:55.919384 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:05:55.919522 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-31 07:05:56.319550 (Thread-4): Snowflake query id: 019c9be9-0000-43da-0000-b0b10001e14a
2021-05-31 07:05:56.319770 (Thread-4): Snowflake error: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:05:56.319996 (Thread-4): finished collecting timing info
2021-05-31 07:05:56.320202 (Thread-4): On model.demo_dbt.customers: ROLLBACK
2021-05-31 07:05:56.732383 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 07:05:57.553535 (Thread-4): Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:05:57.556490 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4428b0-84f5-4e21-a3a3-0db610024e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd9ded90>]}
2021-05-31 07:05:57.556869 (Thread-4): 12:35:57 | 3 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.19s]
2021-05-31 07:05:57.557008 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:05:57.558348 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:05:57.558549 (MainThread): Using snowflake connection "master".
2021-05-31 07:05:57.558641 (MainThread): On master: BEGIN
2021-05-31 07:05:57.558726 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:05:58.986361 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 07:05:58.986529 (MainThread): On master: COMMIT
2021-05-31 07:05:58.986859 (MainThread): Using snowflake connection "master".
2021-05-31 07:05:58.986955 (MainThread): On master: COMMIT
2021-05-31 07:05:59.346711 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 07:05:59.346984 (MainThread): On master: Close
2021-05-31 07:05:59.958917 (MainThread): 12:35:59 | 
2021-05-31 07:05:59.959134 (MainThread): 12:35:59 | Finished running 3 view models in 15.69s.
2021-05-31 07:05:59.959308 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:05:59.959443 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:05:59.959539 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:05:59.959624 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 07:05:59.963965 (MainThread): 
2021-05-31 07:05:59.964115 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:05:59.964243 (MainThread): 
2021-05-31 07:05:59.964362 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 07:05:59.964468 (MainThread):   002037 (42601): SQL compilation error:
2021-05-31 07:05:59.964566 (MainThread):   Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
2021-05-31 07:05:59.964658 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:05:59.964748 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:05:59.964851 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-31 07:05:59.965016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dab726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd933c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd944ac0>]}
2021-05-31 07:05:59.965248 (MainThread): Flushing usage events
2021-05-31 07:08:38.114314 (MainThread): Running with dbt=0.19.1
2021-05-31 07:08:38.874808 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:08:38.876197 (MainThread): Tracking: tracking
2021-05-31 07:08:38.876663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7745df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda9192610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda91926a0>]}
2021-05-31 07:08:38.886176 (MainThread): Partial parsing not enabled
2021-05-31 07:08:38.887144 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:08:38.889405 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:08:38.915568 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:08:38.917285 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:08:38.918536 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:08:38.922019 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:08:38.930652 (MainThread): Parsing macros/core.sql
2021-05-31 07:08:38.933962 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:08:38.941627 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:08:38.943128 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:08:38.958739 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:08:38.989135 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:08:39.008002 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:08:39.009573 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:08:39.014815 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:08:39.027157 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:08:39.033175 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:08:39.038575 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:08:39.042853 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:08:39.043659 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:08:39.044549 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:08:39.045935 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:08:39.053541 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:08:39.055216 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:08:39.056880 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:08:39.095114 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:08:39.096712 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:08:39.098008 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:08:39.099458 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:08:39.105758 (MainThread): Partial parsing not enabled
2021-05-31 07:08:39.123644 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:39.130791 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:08:39.133640 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:39.166818 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e283e223-d8dd-49f8-ab8e-247d126a4ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda93d51f0>]}
2021-05-31 07:08:39.223533 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e283e223-d8dd-49f8-ab8e-247d126a4ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda915eca0>]}
2021-05-31 07:08:39.223854 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:08:39.224621 (MainThread): 
2021-05-31 07:08:39.224955 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:08:39.225953 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:08:39.240702 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:08:39.240843 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:08:39.240942 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:08:41.080336 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.84 seconds
2021-05-31 07:08:41.084696 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:08:41.658154 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:08:41.665593 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:08:41.665719 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:08:41.665814 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:08:42.994720 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.33 seconds
2021-05-31 07:08:42.996102 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:08:43.743926 (MainThread): Using snowflake connection "master".
2021-05-31 07:08:43.744107 (MainThread): On master: BEGIN
2021-05-31 07:08:43.744220 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:08:44.971216 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 07:08:44.971495 (MainThread): On master: COMMIT
2021-05-31 07:08:44.971723 (MainThread): Using snowflake connection "master".
2021-05-31 07:08:44.971857 (MainThread): On master: COMMIT
2021-05-31 07:08:45.379822 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:08:45.380101 (MainThread): On master: Close
2021-05-31 07:08:45.984841 (MainThread): 12:38:45 | Concurrency: 10 threads (target='dev')
2021-05-31 07:08:45.985069 (MainThread): 12:38:45 | 
2021-05-31 07:08:45.987211 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:08:45.987543 (Thread-1): 12:38:45 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:08:45.987746 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:08:45.988433 (Thread-2): 12:38:45 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:08:45.988758 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:45.988901 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:08:45.990055 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:08:45.990300 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:45.990519 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:08:45.991503 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:08:45.991870 (Thread-2): finished collecting timing info
2021-05-31 07:08:45.998308 (Thread-1): finished collecting timing info
2021-05-31 07:08:46.024160 (Thread-1): Dropping relation "DEMO_DB"."PUBLIC"."STG_CUSTOMERS" because it is of type view
2021-05-31 07:08:46.024419 (Thread-2): Dropping relation "DEMO_DB"."PUBLIC"."STG_ORDERS" because it is of type view
2021-05-31 07:08:46.030587 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:46.031898 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:46.032023 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "DEMO_DB"."PUBLIC"."STG_CUSTOMERS" cascade
2021-05-31 07:08:46.032120 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "DEMO_DB"."PUBLIC"."STG_ORDERS" cascade
2021-05-31 07:08:46.032239 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:08:46.032368 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:08:47.428044 (Thread-2): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-31 07:08:47.428563 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-31 07:08:47.450548 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:08:47.447106 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:08:47.451451 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:47.451555 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:08:47.452836 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:47.452945 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:08:47.839528 (Thread-2): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-31 07:08:47.839805 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:47.839955 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:08:47.840883 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-31 07:08:47.841031 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:47.841142 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:08:49.071129 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 07:08:49.072560 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:08:49.072811 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:08:49.072941 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:08:49.091065 (Thread-2): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-31 07:08:49.092414 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:08:49.092649 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:08:49.092784 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:08:49.381570 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-31 07:08:49.392875 (Thread-1): finished collecting timing info
2021-05-31 07:08:49.393039 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:08:49.410910 (Thread-2): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-31 07:08:49.411973 (Thread-2): finished collecting timing info
2021-05-31 07:08:49.412196 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:08:50.194872 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e283e223-d8dd-49f8-ab8e-247d126a4ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97b06d0>]}
2021-05-31 07:08:50.195318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e283e223-d8dd-49f8-ab8e-247d126a4ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97dac70>]}
2021-05-31 07:08:50.195748 (Thread-2): 12:38:50 | 2 of 3 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 4.21s]
2021-05-31 07:08:50.196034 (Thread-1): 12:38:50 | 1 of 3 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 4.21s]
2021-05-31 07:08:50.196226 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:08:50.196456 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:08:50.197139 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:08:50.197382 (Thread-4): 12:38:50 | 3 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-31 07:08:50.197768 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:08:50.197890 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 07:08:50.200314 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 07:08:50.200731 (Thread-4): finished collecting timing info
2021-05-31 07:08:50.202668 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 07:08:50.204386 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:08:50.204493 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 07:08:50.204586 (Thread-4): Opening a new connection, currently in state init
2021-05-31 07:08:51.429342 (Thread-4): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:08:51.429596 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:08:51.429739 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 07:08:52.319503 (Thread-4): SQL status: SUCCESS 1 in 0.89 seconds
2021-05-31 07:08:52.320884 (Thread-4): On model.demo_dbt.customers: COMMIT
2021-05-31 07:08:52.321120 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:08:52.321262 (Thread-4): On model.demo_dbt.customers: COMMIT
2021-05-31 07:08:52.650176 (Thread-4): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-31 07:08:52.651226 (Thread-4): finished collecting timing info
2021-05-31 07:08:52.651450 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 07:08:53.478425 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e283e223-d8dd-49f8-ab8e-247d126a4ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97a5fa0>]}
2021-05-31 07:08:53.478866 (Thread-4): 12:38:53 | 3 of 3 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 3.28s]
2021-05-31 07:08:53.479034 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:08:53.480634 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:08:53.480867 (MainThread): Using snowflake connection "master".
2021-05-31 07:08:53.480979 (MainThread): On master: BEGIN
2021-05-31 07:08:53.481085 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:08:54.812742 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-31 07:08:54.813006 (MainThread): On master: COMMIT
2021-05-31 07:08:54.813234 (MainThread): Using snowflake connection "master".
2021-05-31 07:08:54.813370 (MainThread): On master: COMMIT
2021-05-31 07:08:55.349465 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-05-31 07:08:55.349724 (MainThread): On master: Close
2021-05-31 07:08:56.209198 (MainThread): 12:38:56 | 
2021-05-31 07:08:56.209411 (MainThread): 12:38:56 | Finished running 3 table models in 16.98s.
2021-05-31 07:08:56.209544 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:08:56.209642 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:08:56.209731 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:08:56.209815 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 07:08:56.213815 (MainThread): 
2021-05-31 07:08:56.213954 (MainThread): Completed successfully
2021-05-31 07:08:56.214075 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-31 07:08:56.214239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7750eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda9322670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda82675e0>]}
2021-05-31 07:08:56.214440 (MainThread): Flushing usage events
2021-05-31 07:16:56.921837 (MainThread): Running with dbt=0.19.1
2021-05-31 07:16:57.674498 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:16:57.676154 (MainThread): Tracking: tracking
2021-05-31 07:16:57.676688 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a09dcca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a25565b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2556640>]}
2021-05-31 07:16:57.686305 (MainThread): Partial parsing not enabled
2021-05-31 07:16:57.687270 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:16:57.689523 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:16:57.715773 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:16:57.717623 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:16:57.718884 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:16:57.722349 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:16:57.731070 (MainThread): Parsing macros/core.sql
2021-05-31 07:16:57.734468 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:16:57.742159 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:16:57.743747 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:16:57.759351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:16:57.789863 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:16:57.808890 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:16:57.810456 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:16:57.815812 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:16:57.828057 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:16:57.834541 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:16:57.839974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:16:57.844168 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:16:57.844973 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:16:57.845853 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:16:57.847227 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:16:57.854896 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:16:57.856694 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:16:57.858130 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:16:57.896423 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:16:57.898049 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:16:57.899402 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:16:57.900924 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:16:57.907275 (MainThread): Partial parsing not enabled
2021-05-31 07:16:57.924985 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:16:57.932131 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:16:57.935367 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:16:57.968149 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cab6c46-54a8-4fee-bced-b13be1d8fb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a27961f0>]}
2021-05-31 07:16:58.022246 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cab6c46-54a8-4fee-bced-b13be1d8fb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2521c40>]}
2021-05-31 07:16:58.022572 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:16:58.023305 (MainThread): 
2021-05-31 07:16:58.023641 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:16:58.024635 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:16:58.039558 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:16:58.039711 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:16:58.039818 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:16:59.724736 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.68 seconds
2021-05-31 07:16:59.729058 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:17:00.405256 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:17:00.412635 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:17:00.412758 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:17:00.412857 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:17:01.702103 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.29 seconds
2021-05-31 07:17:01.702643 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:17:02.313563 (MainThread): Using snowflake connection "master".
2021-05-31 07:17:02.313747 (MainThread): On master: BEGIN
2021-05-31 07:17:02.313863 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:17:03.744986 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 07:17:03.745254 (MainThread): On master: COMMIT
2021-05-31 07:17:03.745493 (MainThread): Using snowflake connection "master".
2021-05-31 07:17:03.745630 (MainThread): On master: COMMIT
2021-05-31 07:17:04.111022 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-31 07:17:04.111301 (MainThread): On master: Close
2021-05-31 07:17:04.762767 (MainThread): 12:47:04 | Concurrency: 10 threads (target='dev')
2021-05-31 07:17:04.762995 (MainThread): 12:47:04 | 
2021-05-31 07:17:04.764985 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:17:04.765214 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:17:04.765507 (Thread-1): 12:47:04 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:17:04.765786 (Thread-2): 12:47:04 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:17:04.766569 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:17:04.766828 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:17:04.766957 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:17:04.767104 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:17:04.768447 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:17:04.769660 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:17:04.770128 (Thread-2): finished collecting timing info
2021-05-31 07:17:04.770266 (Thread-1): finished collecting timing info
2021-05-31 07:17:04.817104 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:17:04.817438 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:17:04.818344 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:17:04.818445 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:17:04.818534 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:17:04.819668 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:17:04.819776 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:17:04.819862 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:17:06.202825 (Thread-2): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:17:06.203089 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:17:06.203534 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:17:06.203655 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:17:06.203818 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:17:06.205024 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:17:06.611414 (Thread-1): Snowflake query id: 019c9bf5-0000-43dd-0000-b0b10001a342
2021-05-31 07:17:06.611637 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 07:17:06.611866 (Thread-1): finished collecting timing info
2021-05-31 07:17:06.612082 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:17:06.659125 (Thread-2): Snowflake query id: 019c9bf5-0000-43dd-0000-b0b10001a346
2021-05-31 07:17:06.659352 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-31 07:17:06.659562 (Thread-2): finished collecting timing info
2021-05-31 07:17:06.659769 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:17:07.021521 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:17:07.149434 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:17:07.611389 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:17:07.615965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cab6c46-54a8-4fee-bced-b13be1d8fb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a29ca640>]}
2021-05-31 07:17:07.616393 (Thread-1): 12:47:07 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.85s]
2021-05-31 07:17:07.616577 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:17:07.880477 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:17:07.881277 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cab6c46-54a8-4fee-bced-b13be1d8fb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a29ca3d0>]}
2021-05-31 07:17:07.881646 (Thread-2): 12:47:07 | 2 of 3 ERROR creating table model PUBLIC.stg_orders.................. [ERROR in 3.11s]
2021-05-31 07:17:07.881807 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:17:07.882428 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:17:07.882634 (Thread-4): 12:47:07 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:17:07.882919 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:17:07.884385 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:17:07.884598 (MainThread): Using snowflake connection "master".
2021-05-31 07:17:07.884701 (MainThread): On master: BEGIN
2021-05-31 07:17:07.884795 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:17:09.376706 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-31 07:17:09.376975 (MainThread): On master: COMMIT
2021-05-31 07:17:09.377216 (MainThread): Using snowflake connection "master".
2021-05-31 07:17:09.377354 (MainThread): On master: COMMIT
2021-05-31 07:17:09.827925 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-05-31 07:17:09.828205 (MainThread): On master: Close
2021-05-31 07:17:10.606734 (MainThread): 12:47:10 | 
2021-05-31 07:17:10.606961 (MainThread): 12:47:10 | Finished running 3 table models in 12.58s.
2021-05-31 07:17:10.607105 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:17:10.607209 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:17:10.607305 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:17:10.611546 (MainThread): 
2021-05-31 07:17:10.611693 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 07:17:10.611820 (MainThread): 
2021-05-31 07:17:10.611941 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:17:10.612052 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 07:17:10.612150 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 07:17:10.612243 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:17:10.612343 (MainThread): 
2021-05-31 07:17:10.612464 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:17:10.612563 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 07:17:10.612653 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-31 07:17:10.612741 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:17:10.612841 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 07:17:10.613001 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a27c11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2949e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2949fd0>]}
2021-05-31 07:17:10.613205 (MainThread): Flushing usage events
2021-05-31 07:20:40.013692 (MainThread): Running with dbt=0.19.1
2021-05-31 07:20:40.911298 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:20:40.913034 (MainThread): Tracking: tracking
2021-05-31 07:20:40.913513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ee3d2fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f06565e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f0656670>]}
2021-05-31 07:20:40.924224 (MainThread): Partial parsing not enabled
2021-05-31 07:20:40.925356 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:20:40.927640 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:20:40.954637 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:20:40.956988 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:20:40.958240 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:20:40.961742 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:20:40.971885 (MainThread): Parsing macros/core.sql
2021-05-31 07:20:40.975885 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:20:40.984728 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:20:40.986377 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:20:41.002012 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:20:41.032662 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:20:41.051353 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:20:41.053020 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:20:41.058231 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:20:41.070672 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:20:41.076648 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:20:41.082089 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:20:41.086366 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:20:41.087170 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:20:41.088053 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:20:41.089429 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:20:41.097241 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:20:41.098926 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:20:41.100369 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:20:41.138421 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:20:41.140153 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:20:41.141483 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:20:41.142948 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:20:41.149236 (MainThread): Partial parsing not enabled
2021-05-31 07:20:41.167164 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:20:41.174326 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:20:41.177173 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:20:41.210385 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ee3423-7ce2-414c-b6fa-df2afe2cb82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1096130>]}
2021-05-31 07:20:41.266831 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ee3423-7ce2-414c-b6fa-df2afe2cb82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f0621c70>]}
2021-05-31 07:20:41.267162 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:20:41.267950 (MainThread): 
2021-05-31 07:20:41.268320 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:20:41.269394 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:20:41.285372 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:20:41.285526 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:20:41.285630 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:20:43.048931 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.76 seconds
2021-05-31 07:20:43.053329 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:20:43.694624 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:20:43.701933 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:20:43.702055 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:20:43.702155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:20:45.490753 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.79 seconds
2021-05-31 07:20:45.492134 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:20:46.124699 (MainThread): Using snowflake connection "master".
2021-05-31 07:20:46.124881 (MainThread): On master: BEGIN
2021-05-31 07:20:46.124997 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:20:47.320459 (MainThread): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-31 07:20:47.320725 (MainThread): On master: COMMIT
2021-05-31 07:20:47.320971 (MainThread): Using snowflake connection "master".
2021-05-31 07:20:47.321109 (MainThread): On master: COMMIT
2021-05-31 07:20:47.689349 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-31 07:20:47.689620 (MainThread): On master: Close
2021-05-31 07:20:48.479446 (MainThread): 12:50:48 | Concurrency: 10 threads (target='dev')
2021-05-31 07:20:48.479669 (MainThread): 12:50:48 | 
2021-05-31 07:20:48.481932 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:20:48.482169 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:20:48.482419 (Thread-1): 12:50:48 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:20:48.482644 (Thread-2): 12:50:48 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:20:48.483253 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:20:48.483387 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:20:48.484522 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:20:48.484965 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:20:48.485130 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:20:48.486124 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:20:48.486485 (Thread-2): finished collecting timing info
2021-05-31 07:20:48.492930 (Thread-1): finished collecting timing info
2021-05-31 07:20:48.536481 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:20:48.540706 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:20:48.541567 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:20:48.541668 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:20:48.541757 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:20:48.543319 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:20:48.543425 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:20:48.543512 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:20:50.227819 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-31 07:20:50.228074 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:20:50.228216 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:20:50.730241 (Thread-2): SQL status: SUCCESS 1 in 2.19 seconds
2021-05-31 07:20:50.730458 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:20:50.730573 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:20:50.806902 (Thread-1): Snowflake query id: 019c9bf8-0000-43da-0000-b0b10001e23e
2021-05-31 07:20:50.807120 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 07:20:50.807345 (Thread-1): finished collecting timing info
2021-05-31 07:20:50.807560 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:20:51.317400 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:20:52.167526 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:20:52.170438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ee3423-7ce2-414c-b6fa-df2afe2cb82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1292c40>]}
2021-05-31 07:20:52.170847 (Thread-1): 12:50:52 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.69s]
2021-05-31 07:20:52.171004 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:20:52.396666 (Thread-2): SQL status: SUCCESS 1 in 1.67 seconds
2021-05-31 07:20:52.398210 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:20:52.398444 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:20:52.398580 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:20:52.956432 (Thread-2): SQL status: SUCCESS 1 in 0.56 seconds
2021-05-31 07:20:52.968119 (Thread-2): finished collecting timing info
2021-05-31 07:20:52.968277 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:20:53.638193 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ee3423-7ce2-414c-b6fa-df2afe2cb82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f123dc10>]}
2021-05-31 07:20:53.638634 (Thread-2): 12:50:53 | 2 of 3 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 5.15s]
2021-05-31 07:20:53.638798 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:20:53.639457 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:20:53.639653 (Thread-4): 12:50:53 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:20:53.639868 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:20:53.641337 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:20:53.641567 (MainThread): Using snowflake connection "master".
2021-05-31 07:20:53.641689 (MainThread): On master: BEGIN
2021-05-31 07:20:53.641775 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:20:55.395937 (MainThread): SQL status: SUCCESS 1 in 1.75 seconds
2021-05-31 07:20:55.396191 (MainThread): On master: COMMIT
2021-05-31 07:20:55.396414 (MainThread): Using snowflake connection "master".
2021-05-31 07:20:55.396543 (MainThread): On master: COMMIT
2021-05-31 07:20:56.348183 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-05-31 07:20:56.348443 (MainThread): On master: Close
2021-05-31 07:20:56.978569 (MainThread): 12:50:56 | 
2021-05-31 07:20:56.978781 (MainThread): 12:50:56 | Finished running 3 table models in 15.71s.
2021-05-31 07:20:56.978912 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:20:56.979006 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:20:56.979090 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:20:56.983240 (MainThread): 
2021-05-31 07:20:56.983378 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:20:56.983495 (MainThread): 
2021-05-31 07:20:56.983603 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:20:56.983700 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 07:20:56.983789 (MainThread):   invalid identifier 'ID'
2021-05-31 07:20:56.983873 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:20:56.983969 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 07:20:56.984123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f07e2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1281d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f1281070>]}
2021-05-31 07:20:56.984326 (MainThread): Flushing usage events
2021-05-31 07:21:13.127521 (MainThread): Running with dbt=0.19.1
2021-05-31 07:21:13.863985 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:21:13.865197 (MainThread): Tracking: tracking
2021-05-31 07:21:13.865731 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00a316be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00bf93670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00bf93700>]}
2021-05-31 07:21:13.875419 (MainThread): Partial parsing not enabled
2021-05-31 07:21:13.876434 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:21:13.878589 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:21:13.904689 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:21:13.906643 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:21:13.907899 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:21:13.911354 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:21:13.920018 (MainThread): Parsing macros/core.sql
2021-05-31 07:21:13.923298 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:21:13.930944 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:21:13.932476 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:21:13.948333 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:21:13.979409 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:21:13.997668 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:21:13.999226 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:21:14.004614 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:21:14.016939 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:21:14.023001 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:21:14.028431 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:21:14.032634 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:21:14.033436 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:21:14.034335 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:21:14.035712 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:21:14.043802 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:21:14.045468 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:21:14.046895 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:21:14.084952 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:21:14.086650 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:21:14.087909 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:21:14.089323 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:21:14.095385 (MainThread): Partial parsing not enabled
2021-05-31 07:21:14.113616 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:21:14.120816 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:21:14.123682 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:21:14.157025 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e00cbb-15b8-41e4-bbbf-d6d2ec150172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00c2d71f0>]}
2021-05-31 07:21:14.211577 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e00cbb-15b8-41e4-bbbf-d6d2ec150172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00bf62d00>]}
2021-05-31 07:21:14.211888 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:21:14.212633 (MainThread): 
2021-05-31 07:21:14.212980 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:21:14.213968 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:21:14.228568 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:21:14.228705 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:21:14.228807 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:21:15.922005 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.69 seconds
2021-05-31 07:21:15.926250 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:21:16.516495 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:21:16.523755 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:21:16.523876 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:21:16.523974 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:21:18.071210 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.55 seconds
2021-05-31 07:21:18.072591 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:21:18.644130 (MainThread): Using snowflake connection "master".
2021-05-31 07:21:18.644313 (MainThread): On master: BEGIN
2021-05-31 07:21:18.644428 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:21:20.021441 (MainThread): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:21:20.021701 (MainThread): On master: COMMIT
2021-05-31 07:21:20.021939 (MainThread): Using snowflake connection "master".
2021-05-31 07:21:20.022074 (MainThread): On master: COMMIT
2021-05-31 07:21:20.391397 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-31 07:21:20.391673 (MainThread): On master: Close
2021-05-31 07:21:20.994506 (MainThread): 12:51:20 | Concurrency: 10 threads (target='dev')
2021-05-31 07:21:20.994742 (MainThread): 12:51:20 | 
2021-05-31 07:21:20.996943 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:21:20.997128 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:21:20.997436 (Thread-1): 12:51:20 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:21:20.997681 (Thread-2): 12:51:20 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:21:20.998357 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:21:20.998514 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:21:20.998811 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:21:20.999982 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:21:21.000120 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:21:21.001329 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:21:21.001625 (Thread-2): finished collecting timing info
2021-05-31 07:21:21.019315 (Thread-1): finished collecting timing info
2021-05-31 07:21:21.041132 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:21:21.045344 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:21:21.046206 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:21:21.046308 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:21:21.046398 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:21:21.047501 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:21:21.047610 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:21:21.047700 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:21:22.382440 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-31 07:21:22.384100 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:21:22.384249 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:21:22.781559 (Thread-1): Snowflake query id: 019c9bf9-0000-43dc-0000-b0b10001d37e
2021-05-31 07:21:22.781779 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 07:21:22.782012 (Thread-1): finished collecting timing info
2021-05-31 07:21:22.782225 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:21:22.859925 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-05-31 07:21:22.860168 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:21:22.860310 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:21:23.191204 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:21:23.908929 (Thread-2): SQL status: SUCCESS 1 in 1.05 seconds
2021-05-31 07:21:23.910374 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:21:23.910572 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:21:23.910685 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:21:24.171413 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:21:24.174293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e00cbb-15b8-41e4-bbbf-d6d2ec150172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00c51f550>]}
2021-05-31 07:21:24.174708 (Thread-1): 12:51:24 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.18s]
2021-05-31 07:21:24.174873 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:21:24.228321 (Thread-2): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-31 07:21:24.238608 (Thread-2): finished collecting timing info
2021-05-31 07:21:24.238788 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:21:24.934888 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e00cbb-15b8-41e4-bbbf-d6d2ec150172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00c362ac0>]}
2021-05-31 07:21:24.935338 (Thread-2): 12:51:24 | 2 of 3 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.94s]
2021-05-31 07:21:24.935509 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:21:24.936115 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:21:24.936313 (Thread-4): 12:51:24 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:21:24.936611 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:21:24.938165 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:21:24.938373 (MainThread): Using snowflake connection "master".
2021-05-31 07:21:24.938472 (MainThread): On master: BEGIN
2021-05-31 07:21:24.938564 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:21:26.263080 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 07:21:26.263348 (MainThread): On master: COMMIT
2021-05-31 07:21:26.263585 (MainThread): Using snowflake connection "master".
2021-05-31 07:21:26.263724 (MainThread): On master: COMMIT
2021-05-31 07:21:26.672123 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:21:26.672398 (MainThread): On master: Close
2021-05-31 07:21:27.391327 (MainThread): 12:51:27 | 
2021-05-31 07:21:27.391553 (MainThread): 12:51:27 | Finished running 3 table models in 13.18s.
2021-05-31 07:21:27.391696 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:21:27.391798 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:21:27.391891 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:21:27.396009 (MainThread): 
2021-05-31 07:21:27.396150 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:21:27.396273 (MainThread): 
2021-05-31 07:21:27.396392 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:21:27.396497 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 07:21:27.396592 (MainThread):   invalid identifier 'ID'
2021-05-31 07:21:27.396684 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:21:27.396786 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 07:21:27.396942 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00bff76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00bf62e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00c2236d0>]}
2021-05-31 07:21:27.397145 (MainThread): Flushing usage events
2021-05-31 07:22:14.054144 (MainThread): Running with dbt=0.19.1
2021-05-31 07:22:14.795973 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:22:14.797221 (MainThread): Tracking: tracking
2021-05-31 07:22:14.797621 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e5810ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7253700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7253790>]}
2021-05-31 07:22:14.808074 (MainThread): Partial parsing not enabled
2021-05-31 07:22:14.809041 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:22:14.811255 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:22:14.837374 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:22:14.839195 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:22:14.840577 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:22:14.844005 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:22:14.852639 (MainThread): Parsing macros/core.sql
2021-05-31 07:22:14.855969 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:22:14.863648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:22:14.865221 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:22:14.881176 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:22:14.911861 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:22:14.930106 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:22:14.931652 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:22:14.936968 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:22:14.949438 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:22:14.955430 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:22:14.960857 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:22:14.965067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:22:14.965868 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:22:14.966803 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:22:14.968185 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:22:14.976098 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:22:14.977790 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:22:14.979307 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:22:15.017929 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:22:15.019674 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:22:15.020992 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:22:15.022459 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:22:15.028736 (MainThread): Partial parsing not enabled
2021-05-31 07:22:15.046963 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:22:15.054133 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:22:15.057079 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:15.090757 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28cc7d24-a78b-4fa9-a5be-96434f314580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7482220>]}
2021-05-31 07:22:15.146846 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28cc7d24-a78b-4fa9-a5be-96434f314580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7220d90>]}
2021-05-31 07:22:15.147157 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:22:15.147907 (MainThread): 
2021-05-31 07:22:15.148257 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:22:15.149305 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:22:15.164394 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:22:15.164532 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:22:15.164635 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:22:16.951117 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.79 seconds
2021-05-31 07:22:16.955601 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:22:17.563256 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:22:17.570755 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:22:17.570883 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:22:17.570982 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:22:19.071180 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.50 seconds
2021-05-31 07:22:19.072567 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:22:19.721020 (MainThread): Using snowflake connection "master".
2021-05-31 07:22:19.721200 (MainThread): On master: BEGIN
2021-05-31 07:22:19.721315 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:22:20.897879 (MainThread): SQL status: SUCCESS 1 in 1.18 seconds
2021-05-31 07:22:20.898148 (MainThread): On master: COMMIT
2021-05-31 07:22:20.898388 (MainThread): Using snowflake connection "master".
2021-05-31 07:22:20.898534 (MainThread): On master: COMMIT
2021-05-31 07:22:21.353025 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-05-31 07:22:21.353284 (MainThread): On master: Close
2021-05-31 07:22:21.929482 (MainThread): 12:52:21 | Concurrency: 10 threads (target='dev')
2021-05-31 07:22:21.929705 (MainThread): 12:52:21 | 
2021-05-31 07:22:21.931982 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:22:21.932322 (Thread-1): 12:52:21 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:22:21.932666 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:22:21.932816 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:22:21.934214 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:22:21.934450 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:22:21.934686 (Thread-2): 12:52:21 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:22:21.934966 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:21.935082 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:22:21.936137 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:22:21.936599 (Thread-1): finished collecting timing info
2021-05-31 07:22:21.943070 (Thread-2): finished collecting timing info
2021-05-31 07:22:21.983810 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:21.986728 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:22:21.986832 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop table if exists "DEMO_DB"."PUBLIC"."STG_ORDERS" cascade
2021-05-31 07:22:21.986937 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop table if exists "DEMO_DB"."PUBLIC"."STG_CUSTOMERS" cascade
2021-05-31 07:22:21.987031 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:22:21.987113 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:22:23.504320 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 07:22:23.504867 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 07:22:23.512201 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:22:23.513237 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:22:23.514189 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:22:23.514302 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:22:23.515656 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:23.515777 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:22:23.914160 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 07:22:23.914733 (Thread-2): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 07:22:23.914876 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:22:23.915039 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:23.915190 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:22:23.915308 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:22:24.322961 (Thread-1): Snowflake query id: 019c9bfa-0000-43dd-0000-b0b10001a436
2021-05-31 07:22:24.323180 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 07:22:24.323415 (Thread-1): finished collecting timing info
2021-05-31 07:22:24.323631 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:22:24.366020 (Thread-2): SQL status: SUCCESS 1 in 0.45 seconds
2021-05-31 07:22:24.367403 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:22:24.367651 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:22:24.367795 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:22:24.732245 (Thread-2): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 07:22:24.739765 (Thread-2): finished collecting timing info
2021-05-31 07:22:24.739925 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:22:24.855624 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:22:25.317494 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cc7d24-a78b-4fa9-a5be-96434f314580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e74e6ca0>]}
2021-05-31 07:22:25.317952 (Thread-2): 12:52:25 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 3.38s]
2021-05-31 07:22:25.318138 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:22:25.457360 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:22:25.460370 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cc7d24-a78b-4fa9-a5be-96434f314580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7656be0>]}
2021-05-31 07:22:25.460724 (Thread-1): 12:52:25 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 3.53s]
2021-05-31 07:22:25.460866 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:22:25.461404 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:22:25.461569 (Thread-4): 12:52:25 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:22:25.461707 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:22:25.462955 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:22:25.463158 (MainThread): Using snowflake connection "master".
2021-05-31 07:22:25.463257 (MainThread): On master: BEGIN
2021-05-31 07:22:25.463347 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:22:26.678452 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:22:26.678716 (MainThread): On master: COMMIT
2021-05-31 07:22:26.678942 (MainThread): Using snowflake connection "master".
2021-05-31 07:22:26.679076 (MainThread): On master: COMMIT
2021-05-31 07:22:27.224556 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2021-05-31 07:22:27.224826 (MainThread): On master: Close
2021-05-31 07:22:28.113136 (MainThread): 12:52:28 | 
2021-05-31 07:22:28.113353 (MainThread): 12:52:28 | Finished running 3 view models in 12.96s.
2021-05-31 07:22:28.113493 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:22:28.113594 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:22:28.113686 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:22:28.117889 (MainThread): 
2021-05-31 07:22:28.118033 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:22:28.118154 (MainThread): 
2021-05-31 07:22:28.118271 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:22:28.118375 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 07:22:28.118470 (MainThread):   invalid identifier 'ID'
2021-05-31 07:22:28.118559 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:22:28.118660 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 07:22:28.118816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7295970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7295a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7295340>]}
2021-05-31 07:22:28.119017 (MainThread): Flushing usage events
2021-05-31 07:23:10.553646 (MainThread): Running with dbt=0.19.1
2021-05-31 07:23:11.293008 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:23:11.294113 (MainThread): Tracking: tracking
2021-05-31 07:23:11.294615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08460fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0862526d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086252760>]}
2021-05-31 07:23:11.304037 (MainThread): Partial parsing not enabled
2021-05-31 07:23:11.304958 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:23:11.307268 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:23:11.333183 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:23:11.334895 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:23:11.336151 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:23:11.339718 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:23:11.349047 (MainThread): Parsing macros/core.sql
2021-05-31 07:23:11.352326 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:23:11.360169 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:23:11.361767 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:23:11.377659 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:23:11.407771 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:23:11.425933 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:23:11.427486 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:23:11.432682 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:23:11.445397 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:23:11.451273 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:23:11.456731 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:23:11.460902 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:23:11.461711 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:23:11.462605 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:23:11.463978 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:23:11.471841 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:23:11.473626 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:23:11.475080 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:23:11.512797 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:23:11.514366 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:23:11.515637 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:23:11.517070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:23:11.523411 (MainThread): Partial parsing not enabled
2021-05-31 07:23:11.541171 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:23:11.548129 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:23:11.551027 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:23:11.584552 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d67de67-d9aa-41df-a857-89de72c792e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0865971f0>]}
2021-05-31 07:23:11.641495 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d67de67-d9aa-41df-a857-89de72c792e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086222d60>]}
2021-05-31 07:23:11.641827 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:23:11.642616 (MainThread): 
2021-05-31 07:23:11.642982 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:23:11.644047 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:23:11.659981 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:23:11.660120 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:23:11.660226 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:23:13.578805 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-05-31 07:23:13.583144 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:23:14.705218 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:23:14.712785 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:23:14.712921 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:23:14.713021 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:23:16.033456 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.32 seconds
2021-05-31 07:23:16.034783 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:23:16.752849 (MainThread): Using snowflake connection "master".
2021-05-31 07:23:16.753032 (MainThread): On master: BEGIN
2021-05-31 07:23:16.753149 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:23:18.266173 (MainThread): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-31 07:23:18.266439 (MainThread): On master: COMMIT
2021-05-31 07:23:18.266678 (MainThread): Using snowflake connection "master".
2021-05-31 07:23:18.266814 (MainThread): On master: COMMIT
2021-05-31 07:23:18.695396 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-05-31 07:23:18.695620 (MainThread): On master: Close
2021-05-31 07:23:19.308101 (MainThread): 12:53:19 | Concurrency: 10 threads (target='dev')
2021-05-31 07:23:19.308327 (MainThread): 12:53:19 | 
2021-05-31 07:23:19.310628 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:23:19.310930 (Thread-1): 12:53:19 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:23:19.311110 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:23:19.311742 (Thread-2): 12:53:19 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:23:19.311952 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:23:19.312247 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:23:19.312392 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:23:19.312508 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:23:19.313692 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:23:19.314816 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:23:19.315303 (Thread-1): finished collecting timing info
2021-05-31 07:23:19.321288 (Thread-2): finished collecting timing info
2021-05-31 07:23:19.361689 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:23:19.363284 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:23:19.364093 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:23:19.364193 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:23:19.364281 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:23:19.365797 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:23:19.365905 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:23:19.365994 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:23:20.564846 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-31 07:23:20.565096 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:23:20.565237 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:23:20.704364 (Thread-2): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-31 07:23:20.704580 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:23:20.704699 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:23:21.051053 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 07:23:21.052680 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:23:21.052884 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:23:21.053000 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:23:21.244294 (Thread-2): SQL status: SUCCESS 1 in 0.54 seconds
2021-05-31 07:23:21.245655 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:23:21.245907 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:23:21.246024 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:23:21.354398 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 07:23:21.362279 (Thread-1): finished collecting timing info
2021-05-31 07:23:21.362440 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:23:21.794288 (Thread-2): SQL status: SUCCESS 1 in 0.55 seconds
2021-05-31 07:23:21.795358 (Thread-2): finished collecting timing info
2021-05-31 07:23:21.795582 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:23:22.026518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d67de67-d9aa-41df-a857-89de72c792e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086775820>]}
2021-05-31 07:23:22.026985 (Thread-1): 12:53:22 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 2.72s]
2021-05-31 07:23:22.027167 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:23:22.435918 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d67de67-d9aa-41df-a857-89de72c792e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0867e3190>]}
2021-05-31 07:23:22.436369 (Thread-2): 12:53:22 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 3.12s]
2021-05-31 07:23:22.436535 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:23:22.437021 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:23:22.437463 (Thread-4): 12:53:22 | 3 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-31 07:23:22.437808 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:23:22.437948 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 07:23:22.440606 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 07:23:22.442580 (Thread-4): finished collecting timing info
2021-05-31 07:23:22.454921 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:23:22.455060 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */
drop table if exists "DEMO_DB"."PUBLIC"."CUSTOMERS" cascade
2021-05-31 07:23:22.455158 (Thread-4): Opening a new connection, currently in state init
2021-05-31 07:23:23.918359 (Thread-4): SQL status: SUCCESS 1 in 1.46 seconds
2021-05-31 07:23:23.920097 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 07:23:23.922193 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:23:23.922318 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 07:23:24.328567 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:23:24.328802 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:23:24.328941 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-31 07:23:24.737824 (Thread-4): Snowflake query id: 019c9bfb-0000-43da-0000-b0b10001e28e
2021-05-31 07:23:24.738042 (Thread-4): Snowflake error: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:23:24.738275 (Thread-4): finished collecting timing info
2021-05-31 07:23:24.738488 (Thread-4): On model.demo_dbt.customers: ROLLBACK
2021-05-31 07:23:25.112376 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 07:23:25.764362 (Thread-4): Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:23:25.767457 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d67de67-d9aa-41df-a857-89de72c792e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0862b47f0>]}
2021-05-31 07:23:25.767860 (Thread-4): 12:53:25 | 3 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.33s]
2021-05-31 07:23:25.768014 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:23:25.769434 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:23:25.769643 (MainThread): Using snowflake connection "master".
2021-05-31 07:23:25.769745 (MainThread): On master: BEGIN
2021-05-31 07:23:25.769837 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:23:26.990267 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:23:26.990522 (MainThread): On master: COMMIT
2021-05-31 07:23:26.990745 (MainThread): Using snowflake connection "master".
2021-05-31 07:23:26.990876 (MainThread): On master: COMMIT
2021-05-31 07:23:27.399961 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:23:27.400225 (MainThread): On master: Close
2021-05-31 07:23:28.016197 (MainThread): 12:53:28 | 
2021-05-31 07:23:28.016408 (MainThread): 12:53:28 | Finished running 3 view models in 16.37s.
2021-05-31 07:23:28.016542 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:23:28.016638 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:23:28.016725 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:23:28.016810 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 07:23:28.020994 (MainThread): 
2021-05-31 07:23:28.021131 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:23:28.021249 (MainThread): 
2021-05-31 07:23:28.021359 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 07:23:28.021458 (MainThread):   002037 (42601): SQL compilation error:
2021-05-31 07:23:28.021552 (MainThread):   Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
2021-05-31 07:23:28.021641 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:23:28.021726 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:23:28.021824 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-31 07:23:28.021977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0862baee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd083f318b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0867a7850>]}
2021-05-31 07:23:28.022177 (MainThread): Flushing usage events
2021-05-31 07:26:47.935376 (MainThread): Running with dbt=0.19.1
2021-05-31 07:26:48.662872 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:26:48.664284 (MainThread): Tracking: tracking
2021-05-31 07:26:48.664727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea60bd1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62855550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea628555e0>]}
2021-05-31 07:26:48.674952 (MainThread): Partial parsing not enabled
2021-05-31 07:26:48.675901 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:26:48.677970 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:26:48.704016 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:26:48.705935 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:26:48.707240 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:26:48.710556 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:26:48.719131 (MainThread): Parsing macros/core.sql
2021-05-31 07:26:48.722300 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:26:48.729638 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:26:48.731107 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:26:48.746465 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:26:48.777187 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:26:48.795615 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:26:48.797190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:26:48.802419 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:26:48.815106 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:26:48.821232 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:26:48.826637 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:26:48.830809 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:26:48.831611 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:26:48.832499 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:26:48.833879 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:26:48.841631 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:26:48.843297 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:26:48.844715 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:26:48.882694 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:26:48.884267 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:26:48.885635 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:26:48.887064 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:26:48.893278 (MainThread): Partial parsing not enabled
2021-05-31 07:26:48.911199 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:26:48.918108 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:26:48.921148 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:26:48.954998 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c7e1ab-80f1-4479-a346-2697e60842b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62a971f0>]}
2021-05-31 07:26:49.009828 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c7e1ab-80f1-4479-a346-2697e60842b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62823be0>]}
2021-05-31 07:26:49.010131 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:26:49.010865 (MainThread): 
2021-05-31 07:26:49.011208 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:26:49.012193 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:26:49.026671 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:26:49.026802 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:26:49.026898 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:26:50.698115 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.67 seconds
2021-05-31 07:26:50.702689 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:26:51.355133 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:26:51.362358 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:26:51.362479 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:26:51.362575 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:26:52.912840 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.55 seconds
2021-05-31 07:26:52.914230 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:26:53.632916 (MainThread): Using snowflake connection "master".
2021-05-31 07:26:53.633098 (MainThread): On master: BEGIN
2021-05-31 07:26:53.633212 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:26:54.858401 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 07:26:54.858665 (MainThread): On master: COMMIT
2021-05-31 07:26:54.858905 (MainThread): Using snowflake connection "master".
2021-05-31 07:26:54.859042 (MainThread): On master: COMMIT
2021-05-31 07:26:55.267963 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:26:55.268242 (MainThread): On master: Close
2021-05-31 07:26:55.884323 (MainThread): 12:56:55 | Concurrency: 10 threads (target='dev')
2021-05-31 07:26:55.884553 (MainThread): 12:56:55 | 
2021-05-31 07:26:55.886887 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:26:55.887212 (Thread-1): 12:56:55 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:26:55.887420 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:26:55.887741 (Thread-2): 12:56:55 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:26:55.888379 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:26:55.888521 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:26:55.889676 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:26:55.890039 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:26:55.890166 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:26:55.891243 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:26:55.891641 (Thread-2): finished collecting timing info
2021-05-31 07:26:55.897379 (Thread-1): finished collecting timing info
2021-05-31 07:26:55.937624 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:26:55.939508 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:26:55.940328 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:26:55.940427 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:26:55.940880 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:26:55.940961 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:26:55.941058 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:26:55.942306 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:26:57.316864 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:26:57.317449 (Thread-2): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 07:26:57.317594 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:26:57.317758 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:26:57.317905 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:26:57.318048 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:26:57.845550 (Thread-2): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-31 07:26:57.847126 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:26:57.847331 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:26:57.847450 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:26:57.848784 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-31 07:26:57.849743 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:26:57.849936 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:26:57.850054 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:26:58.195454 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 07:26:58.196036 (Thread-2): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 07:26:58.203568 (Thread-1): finished collecting timing info
2021-05-31 07:26:58.204202 (Thread-2): finished collecting timing info
2021-05-31 07:26:58.204369 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:26:58.204502 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:26:58.856031 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c7e1ab-80f1-4479-a346-2697e60842b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62a4df70>]}
2021-05-31 07:26:58.856492 (Thread-2): 12:56:58 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 2.97s]
2021-05-31 07:26:58.856676 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:26:58.975914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c7e1ab-80f1-4479-a346-2697e60842b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62b91940>]}
2021-05-31 07:26:58.976348 (Thread-1): 12:56:58 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 3.09s]
2021-05-31 07:26:58.976515 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:26:58.977086 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:26:58.977345 (Thread-4): 12:56:58 | 3 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-31 07:26:58.977778 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:26:58.977948 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 07:26:58.980401 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 07:26:58.980806 (Thread-4): finished collecting timing info
2021-05-31 07:26:58.992172 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:26:58.992288 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */
drop table if exists "DEMO_DB"."PUBLIC"."CUSTOMERS" cascade
2021-05-31 07:26:58.992393 (Thread-4): Opening a new connection, currently in state init
2021-05-31 07:27:00.694999 (Thread-4): SQL status: SUCCESS 1 in 1.70 seconds
2021-05-31 07:27:00.696736 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 07:27:00.698811 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:27:00.698934 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 07:27:01.042797 (Thread-4): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 07:27:01.043039 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:27:01.043178 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-31 07:27:01.407693 (Thread-4): Snowflake query id: 019c9bff-0000-43dc-0000-b0b10001d44e
2021-05-31 07:27:01.407910 (Thread-4): Snowflake error: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:27:01.408137 (Thread-4): finished collecting timing info
2021-05-31 07:27:01.408344 (Thread-4): On model.demo_dbt.customers: ROLLBACK
2021-05-31 07:27:01.802566 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 07:27:02.744418 (Thread-4): Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:27:02.747363 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c7e1ab-80f1-4479-a346-2697e60842b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62bb0460>]}
2021-05-31 07:27:02.747713 (Thread-4): 12:57:02 | 3 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.77s]
2021-05-31 07:27:02.747863 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:27:02.749317 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:27:02.749518 (MainThread): Using snowflake connection "master".
2021-05-31 07:27:02.749614 (MainThread): On master: BEGIN
2021-05-31 07:27:02.749702 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:27:04.301290 (MainThread): SQL status: SUCCESS 1 in 1.55 seconds
2021-05-31 07:27:04.301563 (MainThread): On master: COMMIT
2021-05-31 07:27:04.301791 (MainThread): Using snowflake connection "master".
2021-05-31 07:27:04.301925 (MainThread): On master: COMMIT
2021-05-31 07:27:04.894167 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-05-31 07:27:04.894443 (MainThread): On master: Close
2021-05-31 07:27:05.509199 (MainThread): 12:57:05 | 
2021-05-31 07:27:05.509424 (MainThread): 12:57:05 | Finished running 3 view models in 16.50s.
2021-05-31 07:27:05.509563 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:27:05.509662 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:27:05.509754 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:27:05.509841 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 07:27:05.513912 (MainThread): 
2021-05-31 07:27:05.514054 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:27:05.514174 (MainThread): 
2021-05-31 07:27:05.514290 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 07:27:05.514392 (MainThread):   002037 (42601): SQL compilation error:
2021-05-31 07:27:05.514487 (MainThread):   Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
2021-05-31 07:27:05.514583 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:27:05.514673 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:27:05.514777 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-31 07:27:05.514933 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea60bc7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea629e25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62bb1d00>]}
2021-05-31 07:27:05.515135 (MainThread): Flushing usage events
2021-05-31 07:28:10.184476 (MainThread): Running with dbt=0.19.1
2021-05-31 07:28:10.935238 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:28:10.936560 (MainThread): Tracking: tracking
2021-05-31 07:28:10.937121 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa61612be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa633574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa63357580>]}
2021-05-31 07:28:10.946972 (MainThread): Partial parsing not enabled
2021-05-31 07:28:10.947982 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:28:10.950133 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:28:10.976328 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:28:10.978103 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:28:10.979383 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:28:10.982975 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:28:10.991744 (MainThread): Parsing macros/core.sql
2021-05-31 07:28:10.995019 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:28:11.002625 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:28:11.004181 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:28:11.019933 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:28:11.050480 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:28:11.069940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:28:11.071520 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:28:11.076950 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:28:11.089248 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:28:11.095186 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:28:11.100644 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:28:11.105117 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:28:11.105940 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:28:11.106835 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:28:11.108216 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:28:11.115868 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:28:11.117557 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:28:11.119120 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:28:11.157541 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:28:11.159149 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:28:11.160629 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:28:11.162092 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:28:11.168390 (MainThread): Partial parsing not enabled
2021-05-31 07:28:11.186286 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:28:11.193096 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:28:11.195975 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:28:11.229320 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9178ae99-cb7e-410b-bb21-f64630040e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa635971f0>]}
2021-05-31 07:28:11.285693 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9178ae99-cb7e-410b-bb21-f64630040e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa63323b80>]}
2021-05-31 07:28:11.286024 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:28:11.286811 (MainThread): 
2021-05-31 07:28:11.287160 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:28:11.288184 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:28:11.303200 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:28:11.303351 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:28:11.303453 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:28:12.886994 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-31 07:28:12.891279 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:28:13.465979 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:28:13.473342 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:28:13.473469 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:28:13.473570 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:28:15.351998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.88 seconds
2021-05-31 07:28:15.352618 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:28:15.959882 (MainThread): Using snowflake connection "master".
2021-05-31 07:28:15.960062 (MainThread): On master: BEGIN
2021-05-31 07:28:15.960177 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:28:17.760740 (MainThread): SQL status: SUCCESS 1 in 1.80 seconds
2021-05-31 07:28:17.761002 (MainThread): On master: COMMIT
2021-05-31 07:28:17.761237 (MainThread): Using snowflake connection "master".
2021-05-31 07:28:17.761372 (MainThread): On master: COMMIT
2021-05-31 07:28:18.210395 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-05-31 07:28:18.210669 (MainThread): On master: Close
2021-05-31 07:28:18.928546 (MainThread): 12:58:18 | Concurrency: 10 threads (target='dev')
2021-05-31 07:28:18.928776 (MainThread): 12:58:18 | 
2021-05-31 07:28:18.930780 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:28:18.931063 (Thread-1): 12:58:18 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:28:18.931235 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:28:18.931527 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:28:18.931894 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:28:18.932117 (Thread-2): 12:58:18 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:28:18.933322 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:28:18.933686 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:28:18.933917 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:28:18.935113 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:28:18.935315 (Thread-1): finished collecting timing info
2021-05-31 07:28:18.953294 (Thread-2): finished collecting timing info
2021-05-31 07:28:18.980371 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:28:18.980702 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:28:18.981563 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:28:18.981666 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:28:18.981755 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:28:18.982789 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:28:18.982895 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:28:18.982984 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:28:20.258394 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-31 07:28:20.258643 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:28:20.258784 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:28:20.308755 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-31 07:28:20.308992 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:28:20.309131 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:28:20.667808 (Thread-2): Snowflake query id: 019c9c00-0000-43da-0000-b0b10001e30e
2021-05-31 07:28:20.668035 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-31 07:28:20.668275 (Thread-2): finished collecting timing info
2021-05-31 07:28:20.668493 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:28:20.670409 (Thread-1): Snowflake query id: 019c9c00-0000-43dc-0000-b0b10001d486
2021-05-31 07:28:20.670683 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 07:28:20.670883 (Thread-1): finished collecting timing info
2021-05-31 07:28:20.671069 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:28:21.028640 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:28:21.038428 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:28:21.610093 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:28:21.613031 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9178ae99-cb7e-410b-bb21-f64630040e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa62329400>]}
2021-05-31 07:28:21.613408 (Thread-2): 12:58:21 | 2 of 3 ERROR creating table model PUBLIC.stg_orders.................. [ERROR in 2.68s]
2021-05-31 07:28:21.613560 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:28:21.800404 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:28:21.801161 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9178ae99-cb7e-410b-bb21-f64630040e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa637b5670>]}
2021-05-31 07:28:21.801535 (Thread-1): 12:58:21 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.87s]
2021-05-31 07:28:21.801695 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:28:21.802329 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:28:21.802547 (Thread-4): 12:58:21 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:28:21.802727 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:28:21.803939 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:28:21.804144 (MainThread): Using snowflake connection "master".
2021-05-31 07:28:21.804242 (MainThread): On master: BEGIN
2021-05-31 07:28:21.804334 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:28:23.022903 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:28:23.023162 (MainThread): On master: COMMIT
2021-05-31 07:28:23.023391 (MainThread): Using snowflake connection "master".
2021-05-31 07:28:23.023527 (MainThread): On master: COMMIT
2021-05-31 07:28:23.432889 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 07:28:23.433165 (MainThread): On master: Close
2021-05-31 07:28:24.049174 (MainThread): 12:58:24 | 
2021-05-31 07:28:24.049393 (MainThread): 12:58:24 | Finished running 3 table models in 12.76s.
2021-05-31 07:28:24.049536 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:28:24.049638 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:28:24.049731 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:28:24.053857 (MainThread): 
2021-05-31 07:28:24.054000 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 07:28:24.054123 (MainThread): 
2021-05-31 07:28:24.054242 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:28:24.054348 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 07:28:24.054444 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-31 07:28:24.054535 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:28:24.054631 (MainThread): 
2021-05-31 07:28:24.054736 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:28:24.054835 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 07:28:24.054927 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 07:28:24.055016 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:28:24.055115 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 07:28:24.055271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa63323df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa63323d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa63395160>]}
2021-05-31 07:28:24.055477 (MainThread): Flushing usage events
2021-05-31 07:30:56.790624 (MainThread): Running with dbt=0.19.1
2021-05-31 07:30:57.533328 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:30:57.534879 (MainThread): Tracking: tracking
2021-05-31 07:30:57.535346 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a6b11c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a9793700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a9793790>]}
2021-05-31 07:30:57.545233 (MainThread): Partial parsing not enabled
2021-05-31 07:30:57.546268 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:30:57.548329 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:30:57.574064 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:30:57.575768 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:30:57.577102 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:30:57.580527 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:30:57.589054 (MainThread): Parsing macros/core.sql
2021-05-31 07:30:57.592281 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:30:57.599908 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:30:57.601407 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:30:57.616900 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:30:57.647356 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:30:57.666419 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:30:57.667993 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:30:57.673787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:30:57.686020 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:30:57.691974 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:30:57.697331 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:30:57.701460 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:30:57.702253 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:30:57.703284 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:30:57.704738 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:30:57.712265 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:30:57.713923 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:30:57.715341 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:30:57.753651 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:30:57.755310 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:30:57.756594 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:30:57.758039 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:30:57.764308 (MainThread): Partial parsing not enabled
2021-05-31 07:30:57.782230 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:30:57.789264 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:30:57.792181 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:30:57.825993 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ad429a-3b8a-4951-ba04-1d8cb40ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84aa1c3220>]}
2021-05-31 07:30:57.882548 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ad429a-3b8a-4951-ba04-1d8cb40ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a9760d90>]}
2021-05-31 07:30:57.882899 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:30:57.883661 (MainThread): 
2021-05-31 07:30:57.884018 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:30:57.885082 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:30:57.899820 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:30:57.899954 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:30:57.900053 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:30:59.693233 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.79 seconds
2021-05-31 07:30:59.697497 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:31:00.616397 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:31:00.623962 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:31:00.624086 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:31:00.624183 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:31:02.188760 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-31 07:31:02.189599 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:31:02.971147 (MainThread): Using snowflake connection "master".
2021-05-31 07:31:02.971335 (MainThread): On master: BEGIN
2021-05-31 07:31:02.971450 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:31:04.606915 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-31 07:31:04.607140 (MainThread): On master: COMMIT
2021-05-31 07:31:04.607333 (MainThread): Using snowflake connection "master".
2021-05-31 07:31:04.607441 (MainThread): On master: COMMIT
2021-05-31 07:31:05.048143 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-31 07:31:05.048427 (MainThread): On master: Close
2021-05-31 07:31:05.769763 (MainThread): 13:01:05 | Concurrency: 10 threads (target='dev')
2021-05-31 07:31:05.769996 (MainThread): 13:01:05 | 
2021-05-31 07:31:05.772204 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:31:05.772538 (Thread-1): 13:01:05 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 07:31:05.772743 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:31:05.773095 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:31:05.773718 (Thread-2): 13:01:05 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 07:31:05.773842 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:31:05.774136 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:31:05.775364 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:31:05.775503 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:31:05.776786 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:31:05.777221 (Thread-1): finished collecting timing info
2021-05-31 07:31:05.783551 (Thread-2): finished collecting timing info
2021-05-31 07:31:05.828732 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:31:05.831398 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:31:05.832188 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:31:05.832285 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:31:05.832372 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:31:05.834005 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:31:05.834107 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:31:05.834192 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:31:07.456427 (Thread-2): SQL status: SUCCESS 1 in 1.62 seconds
2021-05-31 07:31:07.456671 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:31:07.456808 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 07:31:07.606445 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2021-05-31 07:31:07.606682 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:31:07.606822 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 07:31:10.005196 (Thread-2): Snowflake query id: 019c9c03-0000-43dd-0000-b0b10001a57a
2021-05-31 07:31:10.005440 (Thread-2): Snowflake error: 003041 (42710): SQL compilation error:
Table 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:31:10.005686 (Thread-2): finished collecting timing info
2021-05-31 07:31:10.005900 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:31:10.094888 (Thread-1): Snowflake query id: 019c9c03-0000-43dd-0000-b0b10001a57e
2021-05-31 07:31:10.095109 (Thread-1): Snowflake error: 003041 (42710): SQL compilation error:
Table 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:31:10.095315 (Thread-1): finished collecting timing info
2021-05-31 07:31:10.095518 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:31:10.304711 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:31:10.435131 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:31:10.956773 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  003041 (42710): SQL compilation error:
  Table 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Table 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  003041 (42710): SQL compilation error:
  Table 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:31:10.959564 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ad429a-3b8a-4951-ba04-1d8cb40ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84aa399c10>]}
2021-05-31 07:31:10.959925 (Thread-2): 13:01:10 | 2 of 3 ERROR creating table model PUBLIC.stg_orders.................. [ERROR in 5.19s]
2021-05-31 07:31:10.960109 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:31:11.015351 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  003041 (42710): SQL compilation error:
  Table 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Table 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  003041 (42710): SQL compilation error:
  Table 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:31:11.016035 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ad429a-3b8a-4951-ba04-1d8cb40ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84aa3b9af0>]}
2021-05-31 07:31:11.016359 (Thread-1): 13:01:11 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 5.24s]
2021-05-31 07:31:11.016496 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:31:11.017110 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:31:11.017419 (Thread-4): 13:01:11 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:31:11.017691 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:31:11.018925 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:31:11.019126 (MainThread): Using snowflake connection "master".
2021-05-31 07:31:11.019222 (MainThread): On master: BEGIN
2021-05-31 07:31:11.019309 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:31:12.293395 (MainThread): SQL status: SUCCESS 1 in 1.27 seconds
2021-05-31 07:31:12.293692 (MainThread): On master: COMMIT
2021-05-31 07:31:12.293983 (MainThread): Using snowflake connection "master".
2021-05-31 07:31:12.294150 (MainThread): On master: COMMIT
2021-05-31 07:31:12.653170 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 07:31:12.653413 (MainThread): On master: Close
2021-05-31 07:31:13.214433 (MainThread): 13:01:13 | 
2021-05-31 07:31:13.214625 (MainThread): 13:01:13 | Finished running 3 table models in 15.33s.
2021-05-31 07:31:13.214743 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:31:13.214825 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:31:13.214901 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:31:13.218653 (MainThread): 
2021-05-31 07:31:13.218802 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 07:31:13.218912 (MainThread): 
2021-05-31 07:31:13.219017 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:31:13.219111 (MainThread):   003041 (42710): SQL compilation error:
2021-05-31 07:31:13.219195 (MainThread):   Table 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:31:13.219280 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:31:13.219367 (MainThread): 
2021-05-31 07:31:13.219461 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:31:13.219548 (MainThread):   003041 (42710): SQL compilation error:
2021-05-31 07:31:13.219628 (MainThread):   Table 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:31:13.219709 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:31:13.219799 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 07:31:13.219955 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a97fa040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84aa122760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84aa122b50>]}
2021-05-31 07:31:13.220151 (MainThread): Flushing usage events
2021-05-31 07:33:04.356062 (MainThread): Running with dbt=0.19.1
2021-05-31 07:33:05.100408 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:33:05.101644 (MainThread): Tracking: tracking
2021-05-31 07:33:05.102254 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02eb7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04a555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04a55670>]}
2021-05-31 07:33:05.112375 (MainThread): Partial parsing not enabled
2021-05-31 07:33:05.113344 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:33:05.115476 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:33:05.141620 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:33:05.143324 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:33:05.144554 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:33:05.148014 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:33:05.156403 (MainThread): Parsing macros/core.sql
2021-05-31 07:33:05.159572 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:33:05.166920 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:33:05.168422 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:33:05.184310 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:33:05.215231 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:33:05.234128 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:33:05.236093 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:33:05.241394 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:33:05.253643 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:33:05.259557 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:33:05.264972 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:33:05.269271 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:33:05.270072 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:33:05.271096 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:33:05.272471 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:33:05.280035 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:33:05.281700 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:33:05.283131 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:33:05.321252 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:33:05.322832 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:33:05.324116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:33:05.325563 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:33:05.331817 (MainThread): Partial parsing not enabled
2021-05-31 07:33:05.349886 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:05.356898 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:05.359804 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:05.393157 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84d6353-9171-4a55-8d28-c73dc1cf0e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04c96130>]}
2021-05-31 07:33:05.448584 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84d6353-9171-4a55-8d28-c73dc1cf0e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04a22c70>]}
2021-05-31 07:33:05.448905 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:33:05.449671 (MainThread): 
2021-05-31 07:33:05.450030 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:33:05.451049 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:33:05.465524 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:33:05.465659 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:33:05.465761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:33:07.178875 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.71 seconds
2021-05-31 07:33:07.183180 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:33:07.873966 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:33:07.881156 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:33:07.881283 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:33:07.881384 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:33:09.430558 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.55 seconds
2021-05-31 07:33:09.431707 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:33:10.001616 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:10.001793 (MainThread): On master: BEGIN
2021-05-31 07:33:10.001909 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:33:11.347805 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-31 07:33:11.348019 (MainThread): On master: COMMIT
2021-05-31 07:33:11.348207 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:11.348317 (MainThread): On master: COMMIT
2021-05-31 07:33:11.737673 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-31 07:33:11.737949 (MainThread): On master: Close
2021-05-31 07:33:12.329833 (MainThread): 13:03:12 | Concurrency: 10 threads (target='dev')
2021-05-31 07:33:12.330058 (MainThread): 13:03:12 | 
2021-05-31 07:33:12.332303 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:33:12.332638 (Thread-1): 13:03:12 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:33:12.332846 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:33:12.333156 (Thread-2): 13:03:12 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:33:12.333763 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:12.334063 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:12.334184 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:33:12.334316 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:33:12.335557 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:33:12.336954 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:33:12.337510 (Thread-1): finished collecting timing info
2021-05-31 07:33:12.343953 (Thread-2): finished collecting timing info
2021-05-31 07:33:12.384398 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:33:12.384749 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:33:12.385600 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:12.385702 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:33:12.385791 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:33:12.386831 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:12.386939 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:33:12.387026 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:33:13.572040 (Thread-2): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 07:33:13.572292 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:13.572433 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:33:13.607139 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:33:13.607373 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:13.607510 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake-dev", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:33:14.097020 (Thread-2): Snowflake query id: 019c9c05-0000-43da-0000-b0b10001e40e
2021-05-31 07:33:14.097244 (Thread-2): Snowflake error: 003041 (42710): SQL compilation error:
View 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:33:14.097485 (Thread-2): finished collecting timing info
2021-05-31 07:33:14.097702 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 07:33:14.146336 (Thread-1): Snowflake query id: 019c9c05-0000-43da-0000-b0b10001e412
2021-05-31 07:33:14.146560 (Thread-1): Snowflake error: 003041 (42710): SQL compilation error:
View 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:33:14.146778 (Thread-1): finished collecting timing info
2021-05-31 07:33:14.146987 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 07:33:14.456931 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:33:14.686385 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:33:15.098276 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  003041 (42710): SQL compilation error:
  View 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
View 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  003041 (42710): SQL compilation error:
  View 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:33:15.101220 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84d6353-9171-4a55-8d28-c73dc1cf0e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04fba880>]}
2021-05-31 07:33:15.101624 (Thread-2): 13:03:15 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 2.77s]
2021-05-31 07:33:15.101782 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:33:15.307642 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  003041 (42710): SQL compilation error:
  View 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
View 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  003041 (42710): SQL compilation error:
  View 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:33:15.308452 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84d6353-9171-4a55-8d28-c73dc1cf0e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04fce160>]}
2021-05-31 07:33:15.308827 (Thread-1): 13:03:15 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.98s]
2021-05-31 07:33:15.308993 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:33:15.309480 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:33:15.309669 (Thread-4): 13:03:15 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 07:33:15.309842 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:33:15.311313 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:33:15.311523 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:15.311624 (MainThread): On master: BEGIN
2021-05-31 07:33:15.311718 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:33:16.635064 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 07:33:16.635340 (MainThread): On master: COMMIT
2021-05-31 07:33:16.635571 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:16.635706 (MainThread): On master: COMMIT
2021-05-31 07:33:17.035302 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 07:33:17.035574 (MainThread): On master: Close
2021-05-31 07:33:17.716781 (MainThread): 13:03:17 | 
2021-05-31 07:33:17.717005 (MainThread): 13:03:17 | Finished running 3 view models in 12.27s.
2021-05-31 07:33:17.717144 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:33:17.717246 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:33:17.717338 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:33:17.721559 (MainThread): 
2021-05-31 07:33:17.721705 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 07:33:17.721832 (MainThread): 
2021-05-31 07:33:17.721953 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 07:33:17.722061 (MainThread):   003041 (42710): SQL compilation error:
2021-05-31 07:33:17.722157 (MainThread):   View 'STG_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:33:17.722252 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 07:33:17.722351 (MainThread): 
2021-05-31 07:33:17.722458 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 07:33:17.722558 (MainThread):   003041 (42710): SQL compilation error:
2021-05-31 07:33:17.722652 (MainThread):   View 'STG_CUSTOMERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-05-31 07:33:17.722744 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 07:33:17.722845 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 07:33:17.723004 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04fc5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04fb2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa04fb2550>]}
2021-05-31 07:33:17.723238 (MainThread): Flushing usage events
2021-05-31 07:33:37.443322 (MainThread): Running with dbt=0.19.1
2021-05-31 07:33:38.237335 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 07:33:38.238658 (MainThread): Tracking: tracking
2021-05-31 07:33:38.239186 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8241db8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243b155e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243b15670>]}
2021-05-31 07:33:38.248842 (MainThread): Partial parsing not enabled
2021-05-31 07:33:38.249915 (MainThread): Parsing macros/catalog.sql
2021-05-31 07:33:38.252177 (MainThread): Parsing macros/adapters.sql
2021-05-31 07:33:38.278402 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 07:33:38.280117 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 07:33:38.281474 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 07:33:38.285068 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 07:33:38.293619 (MainThread): Parsing macros/core.sql
2021-05-31 07:33:38.296877 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 07:33:38.304523 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 07:33:38.306103 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 07:33:38.322019 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 07:33:38.353612 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 07:33:38.373503 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 07:33:38.375173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 07:33:38.380583 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 07:33:38.393355 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 07:33:38.399445 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 07:33:38.405652 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 07:33:38.410533 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 07:33:38.411375 (MainThread): Parsing macros/etc/query.sql
2021-05-31 07:33:38.412298 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 07:33:38.413722 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 07:33:38.428391 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 07:33:38.431664 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 07:33:38.433988 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 07:33:38.493007 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 07:33:38.495132 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 07:33:38.496844 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 07:33:38.498762 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 07:33:38.507251 (MainThread): Partial parsing not enabled
2021-05-31 07:33:38.531177 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:38.540969 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:38.544969 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:38.584813 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e3ee22c-6ef1-4cdd-93cb-6aeab314ccf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243d56130>]}
2021-05-31 07:33:38.637891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e3ee22c-6ef1-4cdd-93cb-6aeab314ccf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243ae1c70>]}
2021-05-31 07:33:38.638163 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 07:33:38.638804 (MainThread): 
2021-05-31 07:33:38.639117 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:33:38.639954 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 07:33:38.653517 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 07:33:38.653674 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 07:33:38.653772 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 07:33:40.142387 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.49 seconds
2021-05-31 07:33:40.146319 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 07:33:41.074238 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:33:41.081389 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 07:33:41.081515 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 07:33:41.081610 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 07:33:42.251282 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.17 seconds
2021-05-31 07:33:42.252701 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 07:33:42.872908 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:42.873086 (MainThread): On master: BEGIN
2021-05-31 07:33:42.873201 (MainThread): Opening a new connection, currently in state init
2021-05-31 07:33:44.089844 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 07:33:44.090109 (MainThread): On master: COMMIT
2021-05-31 07:33:44.090345 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:44.090480 (MainThread): On master: COMMIT
2021-05-31 07:33:44.459500 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-31 07:33:44.459806 (MainThread): On master: Close
2021-05-31 07:33:45.021923 (MainThread): 13:03:45 | Concurrency: 10 threads (target='dev')
2021-05-31 07:33:45.022148 (MainThread): 13:03:45 | 
2021-05-31 07:33:45.024396 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 07:33:45.024723 (Thread-1): 13:03:45 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 07:33:45.024928 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 07:33:45.025212 (Thread-2): 13:03:45 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 07:33:45.025809 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:45.026109 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:45.026218 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 07:33:45.026337 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 07:33:45.027489 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:33:45.028607 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:33:45.029105 (Thread-1): finished collecting timing info
2021-05-31 07:33:45.034638 (Thread-2): finished collecting timing info
2021-05-31 07:33:45.075467 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 07:33:45.076939 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 07:33:45.077812 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:45.077913 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 07:33:45.078002 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 07:33:45.079056 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:45.079162 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 07:33:45.079248 (Thread-2): Opening a new connection, currently in state init
2021-05-31 07:33:46.628892 (Thread-2): SQL status: SUCCESS 1 in 1.55 seconds
2021-05-31 07:33:46.629141 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:46.629277 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 07:33:46.818808 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-31 07:33:46.819048 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:46.819184 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 07:33:47.268498 (Thread-2): SQL status: SUCCESS 1 in 0.64 seconds
2021-05-31 07:33:47.270055 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:33:47.270313 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 07:33:47.270427 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 07:33:47.318388 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-31 07:33:47.319768 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:33:47.320036 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 07:33:47.320152 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 07:33:47.608351 (Thread-2): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 07:33:47.616269 (Thread-2): finished collecting timing info
2021-05-31 07:33:47.616431 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 07:33:47.638216 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-31 07:33:47.639267 (Thread-1): finished collecting timing info
2021-05-31 07:33:47.639485 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 07:33:48.220213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e3ee22c-6ef1-4cdd-93cb-6aeab314ccf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243edcee0>]}
2021-05-31 07:33:48.220662 (Thread-1): 13:03:48 | 1 of 3 OK created view model PUBLIC.stg_customers.................... [SUCCESS 1 in 3.19s]
2021-05-31 07:33:48.220835 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 07:33:48.448619 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e3ee22c-6ef1-4cdd-93cb-6aeab314ccf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243e023a0>]}
2021-05-31 07:33:48.465637 (Thread-2): 13:03:48 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 3.42s]
2021-05-31 07:33:48.465984 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 07:33:48.466576 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 07:33:48.467139 (Thread-4): 13:03:48 | 3 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-31 07:33:48.467747 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:48.468000 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 07:33:48.471151 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 07:33:48.471726 (Thread-4): finished collecting timing info
2021-05-31 07:33:48.483385 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:48.483525 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */
drop table if exists "DEMO_DB"."PUBLIC"."CUSTOMERS" cascade
2021-05-31 07:33:48.483619 (Thread-4): Opening a new connection, currently in state init
2021-05-31 07:33:49.887018 (Thread-4): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-31 07:33:49.888799 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 07:33:49.890857 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:49.890984 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 07:33:50.326202 (Thread-4): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-31 07:33:50.326434 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 07:33:50.326574 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-31 07:33:50.655647 (Thread-4): Snowflake query id: 019c9c05-0000-43da-0000-b0b10001e436
2021-05-31 07:33:50.655862 (Thread-4): Snowflake error: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:33:50.656096 (Thread-4): finished collecting timing info
2021-05-31 07:33:50.656305 (Thread-4): On model.demo_dbt.customers: ROLLBACK
2021-05-31 07:33:51.065338 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 07:33:51.628177 (Thread-4): Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:33:51.631142 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e3ee22c-6ef1-4cdd-93cb-6aeab314ccf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243edce50>]}
2021-05-31 07:33:51.631522 (Thread-4): 13:03:51 | 3 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.16s]
2021-05-31 07:33:51.631666 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 07:33:51.632997 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 07:33:51.633206 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:51.633305 (MainThread): On master: BEGIN
2021-05-31 07:33:51.633396 (MainThread): Opening a new connection, currently in state closed
2021-05-31 07:33:53.305019 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2021-05-31 07:33:53.305282 (MainThread): On master: COMMIT
2021-05-31 07:33:53.305508 (MainThread): Using snowflake connection "master".
2021-05-31 07:33:53.305640 (MainThread): On master: COMMIT
2021-05-31 07:33:53.654650 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 07:33:53.655008 (MainThread): On master: Close
2021-05-31 07:33:54.287444 (MainThread): 13:03:54 | 
2021-05-31 07:33:54.287663 (MainThread): 13:03:54 | Finished running 3 view models in 15.65s.
2021-05-31 07:33:54.287805 (MainThread): Connection 'master' was properly closed.
2021-05-31 07:33:54.287905 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 07:33:54.287994 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 07:33:54.288079 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 07:33:54.292309 (MainThread): 
2021-05-31 07:33:54.292455 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 07:33:54.292581 (MainThread): 
2021-05-31 07:33:54.292700 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 07:33:54.292806 (MainThread):   002037 (42601): SQL compilation error:
2021-05-31 07:33:54.292900 (MainThread):   Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
2021-05-31 07:33:54.292992 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 07:33:54.293081 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 07:33:54.293182 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-31 07:33:54.293344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243e09a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243ca3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8243e94f10>]}
2021-05-31 07:33:54.293562 (MainThread): Flushing usage events
2021-05-31 08:10:07.535220 (MainThread): Running with dbt=0.19.1
2021-05-31 08:10:08.639472 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 08:10:08.641095 (MainThread): Tracking: tracking
2021-05-31 08:10:08.641567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bd6e2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfa546d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfa54760>]}
2021-05-31 08:10:08.653838 (MainThread): Partial parsing not enabled
2021-05-31 08:10:08.655308 (MainThread): Parsing macros/catalog.sql
2021-05-31 08:10:08.658060 (MainThread): Parsing macros/adapters.sql
2021-05-31 08:10:08.687922 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 08:10:08.689774 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 08:10:08.691139 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 08:10:08.694901 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 08:10:08.704029 (MainThread): Parsing macros/core.sql
2021-05-31 08:10:08.707558 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 08:10:08.715619 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 08:10:08.717273 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 08:10:08.733857 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 08:10:08.766089 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 08:10:08.785812 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 08:10:08.787574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 08:10:08.793054 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 08:10:08.805794 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 08:10:08.812001 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 08:10:08.817669 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 08:10:08.822087 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 08:10:08.822941 (MainThread): Parsing macros/etc/query.sql
2021-05-31 08:10:08.823875 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 08:10:08.825320 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 08:10:08.833281 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 08:10:08.835061 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 08:10:08.836548 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 08:10:08.875892 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 08:10:08.877569 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 08:10:08.878887 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 08:10:08.880406 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 08:10:08.887169 (MainThread): Partial parsing not enabled
2021-05-31 08:10:08.906137 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:10:08.913418 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:10:08.916444 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:08.952613 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ea33539-3846-4400-b1f1-9dfa25030965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfc951f0>]}
2021-05-31 08:10:09.010163 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ea33539-3846-4400-b1f1-9dfa25030965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfa21d60>]}
2021-05-31 08:10:09.010511 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 08:10:09.011297 (MainThread): 
2021-05-31 08:10:09.011664 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:10:09.012739 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 08:10:09.028781 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 08:10:09.028937 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 08:10:09.029040 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 08:10:10.791392 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.76 seconds
2021-05-31 08:10:10.794613 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 08:10:11.507009 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:10:11.514202 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:10:11.514323 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 08:10:11.514421 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 08:10:13.153461 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.64 seconds
2021-05-31 08:10:13.154695 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 08:10:13.762715 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:13.762827 (MainThread): On master: BEGIN
2021-05-31 08:10:13.762896 (MainThread): Opening a new connection, currently in state init
2021-05-31 08:10:15.295791 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-31 08:10:15.296057 (MainThread): On master: COMMIT
2021-05-31 08:10:15.296290 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:15.296425 (MainThread): On master: COMMIT
2021-05-31 08:10:16.014515 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-31 08:10:16.014790 (MainThread): On master: Close
2021-05-31 08:10:16.735271 (MainThread): 13:40:16 | Concurrency: 10 threads (target='dev')
2021-05-31 08:10:16.735508 (MainThread): 13:40:16 | 
2021-05-31 08:10:16.737626 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 08:10:16.737808 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 08:10:16.738140 (Thread-1): 13:40:16 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 08:10:16.738408 (Thread-2): 13:40:16 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 08:10:16.739052 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:16.739308 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:10:16.739421 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 08:10:16.739535 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 08:10:16.740802 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:10:16.741905 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:10:16.742357 (Thread-2): finished collecting timing info
2021-05-31 08:10:16.742484 (Thread-1): finished collecting timing info
2021-05-31 08:10:16.776847 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:10:16.779408 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:10:16.780552 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:16.781011 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:10:16.781087 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 08:10:16.781184 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 08:10:16.781278 (Thread-2): Opening a new connection, currently in state init
2021-05-31 08:10:16.781359 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 08:10:18.164433 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 08:10:18.164637 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:10:18.164746 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 08:10:18.290443 (Thread-2): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-31 08:10:18.290687 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:18.290827 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 08:10:18.510493 (Thread-1): Snowflake query id: 019c9c2a-0000-43dd-0000-b0b10001a61e
2021-05-31 08:10:18.510715 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 08:10:18.510950 (Thread-1): finished collecting timing info
2021-05-31 08:10:18.511163 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 08:10:18.779631 (Thread-2): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 08:10:18.781159 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:10:18.781403 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:18.781558 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:10:18.859622 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 08:10:19.080363 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 08:10:19.088404 (Thread-2): finished collecting timing info
2021-05-31 08:10:19.088572 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 08:10:19.732215 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 08:10:19.737003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea33539-3846-4400-b1f1-9dfa25030965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfe14d30>]}
2021-05-31 08:10:19.737406 (Thread-1): 13:40:19 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 3.00s]
2021-05-31 08:10:19.737587 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 08:10:19.973569 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea33539-3846-4400-b1f1-9dfa25030965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfc4fe50>]}
2021-05-31 08:10:19.973998 (Thread-2): 13:40:19 | 2 of 3 OK created view model PUBLIC.stg_orders....................... [SUCCESS 1 in 3.23s]
2021-05-31 08:10:19.974166 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 08:10:19.974733 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 08:10:19.974923 (Thread-4): 13:40:19 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 08:10:19.975138 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 08:10:19.976745 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:10:19.976952 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:19.977049 (MainThread): On master: BEGIN
2021-05-31 08:10:19.977140 (MainThread): Opening a new connection, currently in state closed
2021-05-31 08:10:21.610628 (MainThread): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-31 08:10:21.610893 (MainThread): On master: COMMIT
2021-05-31 08:10:21.611121 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:21.611256 (MainThread): On master: COMMIT
2021-05-31 08:10:22.116421 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 08:10:22.116696 (MainThread): On master: Close
2021-05-31 08:10:23.020786 (MainThread): 13:40:23 | 
2021-05-31 08:10:23.021006 (MainThread): 13:40:23 | Finished running 3 view models in 14.01s.
2021-05-31 08:10:23.021143 (MainThread): Connection 'master' was properly closed.
2021-05-31 08:10:23.021243 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 08:10:23.021337 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 08:10:23.025505 (MainThread): 
2021-05-31 08:10:23.025647 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 08:10:23.025767 (MainThread): 
2021-05-31 08:10:23.025880 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 08:10:23.025981 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 08:10:23.026075 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 08:10:23.026166 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 08:10:23.026266 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 08:10:23.026427 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfe03c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bd6c8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bfab2580>]}
2021-05-31 08:10:23.026629 (MainThread): Flushing usage events
2021-05-31 08:10:51.322163 (MainThread): Running with dbt=0.19.1
2021-05-31 08:10:52.235335 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 08:10:52.237449 (MainThread): Tracking: tracking
2021-05-31 08:10:52.238195 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd9724fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb296550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb2965e0>]}
2021-05-31 08:10:52.250109 (MainThread): Partial parsing not enabled
2021-05-31 08:10:52.251405 (MainThread): Parsing macros/catalog.sql
2021-05-31 08:10:52.254591 (MainThread): Parsing macros/adapters.sql
2021-05-31 08:10:52.286813 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 08:10:52.288892 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 08:10:52.290894 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 08:10:52.314905 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 08:10:52.327612 (MainThread): Parsing macros/core.sql
2021-05-31 08:10:52.332227 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 08:10:52.342461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 08:10:52.344420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 08:10:52.364526 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 08:10:52.397489 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 08:10:52.417289 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 08:10:52.418959 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 08:10:52.424739 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 08:10:52.437971 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 08:10:52.444156 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 08:10:52.449904 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 08:10:52.454333 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 08:10:52.455204 (MainThread): Parsing macros/etc/query.sql
2021-05-31 08:10:52.456142 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 08:10:52.457593 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 08:10:52.465583 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 08:10:52.467336 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 08:10:52.468841 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 08:10:52.508667 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 08:10:52.510340 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 08:10:52.511693 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 08:10:52.513216 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 08:10:52.519778 (MainThread): Partial parsing not enabled
2021-05-31 08:10:52.538429 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:10:52.545703 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:10:52.548771 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:10:52.581986 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1c53f1-80b4-446f-9e3a-65dd3ba48c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb4d81f0>]}
2021-05-31 08:10:52.637708 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1c53f1-80b4-446f-9e3a-65dd3ba48c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb264be0>]}
2021-05-31 08:10:52.638043 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 08:10:52.638801 (MainThread): 
2021-05-31 08:10:52.639164 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:10:52.640200 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 08:10:52.655045 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 08:10:52.655197 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 08:10:52.655299 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 08:10:54.714168 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.06 seconds
2021-05-31 08:10:54.718443 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 08:10:55.514266 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:10:55.522070 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:10:55.522240 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 08:10:55.522344 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 08:10:57.100471 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.58 seconds
2021-05-31 08:10:57.101572 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 08:10:58.161032 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:58.161164 (MainThread): On master: BEGIN
2021-05-31 08:10:58.161239 (MainThread): Opening a new connection, currently in state init
2021-05-31 08:10:59.409682 (MainThread): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-31 08:10:59.409962 (MainThread): On master: COMMIT
2021-05-31 08:10:59.410215 (MainThread): Using snowflake connection "master".
2021-05-31 08:10:59.410374 (MainThread): On master: COMMIT
2021-05-31 08:10:59.758661 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 08:10:59.758831 (MainThread): On master: Close
2021-05-31 08:11:00.334958 (MainThread): 13:41:00 | Concurrency: 10 threads (target='dev')
2021-05-31 08:11:00.335155 (MainThread): 13:41:00 | 
2021-05-31 08:11:00.336659 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 08:11:00.336842 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 08:11:00.337175 (Thread-1): 13:41:00 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 08:11:00.337429 (Thread-2): 13:41:00 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 08:11:00.338185 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:00.338401 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:00.338542 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 08:11:00.338674 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 08:11:00.339808 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:11:00.340927 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:11:00.341399 (Thread-2): finished collecting timing info
2021-05-31 08:11:00.341534 (Thread-1): finished collecting timing info
2021-05-31 08:11:00.370977 (Thread-2): Dropping relation "DEMO_DB"."PUBLIC"."STG_ORDERS" because it is of type view
2021-05-31 08:11:00.372689 (Thread-1): Dropping relation "DEMO_DB"."PUBLIC"."STG_CUSTOMERS" because it is of type view
2021-05-31 08:11:00.379280 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:00.380608 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:00.380750 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "DEMO_DB"."PUBLIC"."STG_ORDERS" cascade
2021-05-31 08:11:00.380849 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "DEMO_DB"."PUBLIC"."STG_CUSTOMERS" cascade
2021-05-31 08:11:00.380943 (Thread-2): Opening a new connection, currently in state init
2021-05-31 08:11:00.381027 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 08:11:01.898640 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 08:11:01.911687 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:11:01.912593 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:01.912700 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 08:11:02.018696 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-31 08:11:02.020390 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:11:02.021399 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:02.021521 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 08:11:02.348781 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-31 08:11:02.349028 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:02.349164 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 08:11:02.398203 (Thread-2): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 08:11:02.398449 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:02.398589 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 08:11:02.677820 (Thread-1): Snowflake query id: 019c9c2b-0000-43dc-0000-b0b10001d57a
2021-05-31 08:11:02.678050 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 08:11:02.678275 (Thread-1): finished collecting timing info
2021-05-31 08:11:02.678489 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 08:11:03.057911 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 08:11:03.626937 (Thread-2): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 08:11:03.627916 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:11:03.628090 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:03.628186 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:11:03.809538 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 08:11:03.812641 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1c53f1-80b4-446f-9e3a-65dd3ba48c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb92df40>]}
2021-05-31 08:11:03.813057 (Thread-1): 13:41:03 | 1 of 3 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.47s]
2021-05-31 08:11:03.813222 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 08:11:03.927489 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 08:11:03.938247 (Thread-2): finished collecting timing info
2021-05-31 08:11:03.938397 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 08:11:04.862826 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1c53f1-80b4-446f-9e3a-65dd3ba48c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb6a2a30>]}
2021-05-31 08:11:04.863271 (Thread-2): 13:41:04 | 2 of 3 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 4.52s]
2021-05-31 08:11:04.863444 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 08:11:04.864708 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 08:11:04.865023 (Thread-4): 13:41:04 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 08:11:04.865215 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 08:11:04.866633 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:11:04.866870 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:04.866983 (MainThread): On master: BEGIN
2021-05-31 08:11:04.867106 (MainThread): Opening a new connection, currently in state closed
2021-05-31 08:11:06.216425 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-31 08:11:06.216700 (MainThread): On master: COMMIT
2021-05-31 08:11:06.216930 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:06.217064 (MainThread): On master: COMMIT
2021-05-31 08:11:06.566209 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 08:11:06.566486 (MainThread): On master: Close
2021-05-31 08:11:07.157843 (MainThread): 13:41:07 | 
2021-05-31 08:11:07.158068 (MainThread): 13:41:07 | Finished running 3 table models in 14.52s.
2021-05-31 08:11:07.158204 (MainThread): Connection 'master' was properly closed.
2021-05-31 08:11:07.158304 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 08:11:07.158394 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 08:11:07.162594 (MainThread): 
2021-05-31 08:11:07.162743 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 08:11:07.162870 (MainThread): 
2021-05-31 08:11:07.162991 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 08:11:07.163096 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 08:11:07.163196 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 08:11:07.163291 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 08:11:07.163401 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-05-31 08:11:07.163577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb6a2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb630760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb630880>]}
2021-05-31 08:11:07.163781 (MainThread): Flushing usage events
2021-05-31 08:11:27.761227 (MainThread): Running with dbt=0.19.1
2021-05-31 08:11:28.496664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 08:11:28.497786 (MainThread): Tracking: tracking
2021-05-31 08:11:28.498371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878cb10be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878e854640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878e8546d0>]}
2021-05-31 08:11:28.508729 (MainThread): Partial parsing not enabled
2021-05-31 08:11:28.509653 (MainThread): Parsing macros/catalog.sql
2021-05-31 08:11:28.511785 (MainThread): Parsing macros/adapters.sql
2021-05-31 08:11:28.537711 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 08:11:28.539932 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 08:11:28.541281 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 08:11:28.544662 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 08:11:28.553018 (MainThread): Parsing macros/core.sql
2021-05-31 08:11:28.556334 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 08:11:28.563932 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 08:11:28.565441 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 08:11:28.581691 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 08:11:28.612173 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 08:11:28.630681 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 08:11:28.632246 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 08:11:28.637449 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 08:11:28.649937 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 08:11:28.656849 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 08:11:28.663042 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 08:11:28.667279 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 08:11:28.668087 (MainThread): Parsing macros/etc/query.sql
2021-05-31 08:11:28.668975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 08:11:28.671017 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 08:11:28.679669 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 08:11:28.681370 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 08:11:28.682809 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 08:11:28.723976 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 08:11:28.726090 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 08:11:28.727539 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 08:11:28.728992 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 08:11:28.735977 (MainThread): Partial parsing not enabled
2021-05-31 08:11:28.755759 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:28.763210 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:11:28.766418 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:28.802220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4459f320-d234-4241-a8ac-bde65fb6b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878eb97130>]}
2021-05-31 08:11:28.860396 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4459f320-d234-4241-a8ac-bde65fb6b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878e822cd0>]}
2021-05-31 08:11:28.860724 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 08:11:28.861522 (MainThread): 
2021-05-31 08:11:28.861889 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:11:28.862977 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 08:11:28.879217 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 08:11:28.879377 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 08:11:28.879481 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 08:11:30.424480 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.54 seconds
2021-05-31 08:11:30.428798 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 08:11:31.156002 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:11:31.163194 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:11:31.163312 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 08:11:31.163407 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 08:11:32.412422 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.25 seconds
2021-05-31 08:11:32.413756 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 08:11:33.023189 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:33.023370 (MainThread): On master: BEGIN
2021-05-31 08:11:33.023485 (MainThread): Opening a new connection, currently in state init
2021-05-31 08:11:34.966150 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-31 08:11:34.966421 (MainThread): On master: COMMIT
2021-05-31 08:11:34.966662 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:34.966800 (MainThread): On master: COMMIT
2021-05-31 08:11:35.580090 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-31 08:11:35.580362 (MainThread): On master: Close
2021-05-31 08:11:36.198009 (MainThread): 13:41:36 | Concurrency: 10 threads (target='dev')
2021-05-31 08:11:36.198234 (MainThread): 13:41:36 | 
2021-05-31 08:11:36.200464 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 08:11:36.200793 (Thread-1): 13:41:36 | 1 of 3 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 08:11:36.200998 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 08:11:36.201295 (Thread-2): 13:41:36 | 2 of 3 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 08:11:36.201988 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:36.202137 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 08:11:36.203335 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:11:36.203588 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:36.203794 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 08:11:36.204800 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:11:36.205187 (Thread-2): finished collecting timing info
2021-05-31 08:11:36.217427 (Thread-1): finished collecting timing info
2021-05-31 08:11:36.250658 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:11:36.250988 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:11:36.251875 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:36.252331 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:36.252437 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 08:11:36.252536 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 08:11:36.252630 (Thread-2): Opening a new connection, currently in state init
2021-05-31 08:11:36.252713 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 08:11:37.499597 (Thread-2): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-31 08:11:37.499837 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:37.499979 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 08:11:37.609135 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-05-31 08:11:37.609373 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:37.609508 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 08:11:38.828435 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-31 08:11:38.830011 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:11:38.830251 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:11:38.830397 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 08:11:38.848972 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-05-31 08:11:38.850365 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 08:11:38.850603 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:11:38.850748 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 08:11:39.128269 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 08:11:39.143310 (Thread-2): finished collecting timing info
2021-05-31 08:11:39.143507 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 08:11:39.188658 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 08:11:39.189701 (Thread-1): finished collecting timing info
2021-05-31 08:11:39.189919 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 08:11:39.710071 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4459f320-d234-4241-a8ac-bde65fb6b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec5ebb0>]}
2021-05-31 08:11:39.710518 (Thread-2): 13:41:39 | 2 of 3 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.51s]
2021-05-31 08:11:39.710694 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 08:11:39.940593 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4459f320-d234-4241-a8ac-bde65fb6b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ef06e50>]}
2021-05-31 08:11:39.941043 (Thread-1): 13:41:39 | 1 of 3 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 3.74s]
2021-05-31 08:11:39.941216 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 08:11:39.941795 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 08:11:39.942061 (Thread-4): 13:41:39 | 3 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-31 08:11:39.942402 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:11:39.942543 (Thread-4): Compiling model.demo_dbt.customers
2021-05-31 08:11:39.945174 (Thread-4): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 08:11:39.946934 (Thread-4): finished collecting timing info
2021-05-31 08:11:39.950128 (Thread-4): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 08:11:39.952163 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 08:11:39.952289 (Thread-4): On model.demo_dbt.customers: BEGIN
2021-05-31 08:11:39.952400 (Thread-4): Opening a new connection, currently in state init
2021-05-31 08:11:41.257543 (Thread-4): SQL status: SUCCESS 1 in 1.31 seconds
2021-05-31 08:11:41.257795 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 08:11:41.257937 (Thread-4): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 08:11:42.748571 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-31 08:11:42.750000 (Thread-4): On model.demo_dbt.customers: COMMIT
2021-05-31 08:11:42.750239 (Thread-4): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 08:11:42.750379 (Thread-4): On model.demo_dbt.customers: COMMIT
2021-05-31 08:11:43.055687 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-31 08:11:43.056758 (Thread-4): finished collecting timing info
2021-05-31 08:11:43.056982 (Thread-4): On model.demo_dbt.customers: Close
2021-05-31 08:11:43.774661 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4459f320-d234-4241-a8ac-bde65fb6b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec5e850>]}
2021-05-31 08:11:43.775116 (Thread-4): 13:41:43 | 3 of 3 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 3.83s]
2021-05-31 08:11:43.775289 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 08:11:43.777119 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:11:43.777355 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:43.777470 (MainThread): On master: BEGIN
2021-05-31 08:11:43.777577 (MainThread): Opening a new connection, currently in state closed
2021-05-31 08:11:45.435471 (MainThread): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 08:11:45.435742 (MainThread): On master: COMMIT
2021-05-31 08:11:45.435983 (MainThread): Using snowflake connection "master".
2021-05-31 08:11:45.436121 (MainThread): On master: COMMIT
2021-05-31 08:11:46.437373 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-05-31 08:11:46.437657 (MainThread): On master: Close
2021-05-31 08:11:47.355002 (MainThread): 13:41:47 | 
2021-05-31 08:11:47.355222 (MainThread): 13:41:47 | Finished running 3 table models in 18.49s.
2021-05-31 08:11:47.355361 (MainThread): Connection 'master' was properly closed.
2021-05-31 08:11:47.355462 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 08:11:47.355553 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 08:11:47.355641 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 08:11:47.359606 (MainThread): 
2021-05-31 08:11:47.359750 (MainThread): Completed successfully
2021-05-31 08:11:47.359877 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-31 08:11:47.360046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ea8ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec97a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec0da00>]}
2021-05-31 08:11:47.360248 (MainThread): Flushing usage events
2021-05-31 08:42:39.780445 (MainThread): Running with dbt=0.19.1
2021-05-31 08:42:41.026355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-31 08:42:41.028289 (MainThread): Tracking: tracking
2021-05-31 08:42:41.028797 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea157cfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea17a146d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea17a14760>]}
2021-05-31 08:42:41.039590 (MainThread): Partial parsing not enabled
2021-05-31 08:42:41.040558 (MainThread): Parsing macros/catalog.sql
2021-05-31 08:42:41.042776 (MainThread): Parsing macros/adapters.sql
2021-05-31 08:42:41.070497 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 08:42:41.072272 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 08:42:41.073559 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 08:42:41.077108 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 08:42:41.086545 (MainThread): Parsing macros/core.sql
2021-05-31 08:42:41.090067 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 08:42:41.098149 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 08:42:41.099649 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 08:42:41.115329 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 08:42:41.145645 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 08:42:41.164366 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 08:42:41.165908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 08:42:41.171554 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 08:42:41.186801 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 08:42:41.194407 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 08:42:41.200018 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 08:42:41.204319 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 08:42:41.205146 (MainThread): Parsing macros/etc/query.sql
2021-05-31 08:42:41.206055 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 08:42:41.207461 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 08:42:41.215429 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 08:42:41.217161 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 08:42:41.218629 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 08:42:41.257676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 08:42:41.259300 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 08:42:41.260622 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 08:42:41.262180 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 08:42:41.268588 (MainThread): Partial parsing not enabled
2021-05-31 08:42:41.286730 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:42:41.293840 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:42:41.296953 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:42:41.425835 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92811b7f-d325-4e6f-82b3-bb26dca6d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea17a462e0>]}
2021-05-31 08:42:41.430995 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92811b7f-d325-4e6f-82b3-bb26dca6d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea17cdb310>]}
2021-05-31 08:42:41.431238 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 08:42:41.432354 (MainThread): 
2021-05-31 08:42:41.432696 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:42:41.434229 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:42:41.448357 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:42:41.448517 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 08:42:41.448615 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-31 08:42:43.289362 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.84 seconds
2021-05-31 08:42:43.293219 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 08:42:43.852413 (MainThread): 14:12:43 | Concurrency: 10 threads (target='dev')
2021-05-31 08:42:43.852642 (MainThread): 14:12:43 | 
2021-05-31 08:42:43.855507 (Thread-1): Began running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:42:43.855759 (Thread-2): Began running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:42:43.855918 (Thread-1): 14:12:43 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-05-31 08:42:43.856032 (Thread-3): Began running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:42:43.856218 (Thread-4): Began running node test.demo_dbt.not_null_stg_orders_customer_id
2021-05-31 08:42:43.856376 (Thread-2): 14:12:43 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2021-05-31 08:42:43.856485 (Thread-5): Began running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:42:43.856670 (Thread-6): Began running node test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-31 08:42:43.857011 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-31 08:42:43.857189 (Thread-7): Began running node test.demo_dbt.unique_customers_customer_id
2021-05-31 08:42:43.857349 (Thread-3): 14:12:43 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2021-05-31 08:42:43.857461 (Thread-8): Began running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:42:43.857638 (Thread-9): Began running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:42:43.857815 (Thread-4): 14:12:43 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2021-05-31 08:42:43.858258 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_customers_customer_id".
2021-05-31 08:42:43.858426 (Thread-5): 14:12:43 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2021-05-31 08:42:43.858622 (Thread-6): 14:12:43 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-05-31 08:42:43.858808 (Thread-1): Compiling test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:42:43.858965 (Thread-7): 14:12:43 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2021-05-31 08:42:43.859319 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_customers_customer_id".
2021-05-31 08:42:43.859448 (Thread-8): 14:12:43 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2021-05-31 08:42:43.859611 (Thread-9): 14:12:43 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2021-05-31 08:42:43.859952 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_orders_customer_id".
2021-05-31 08:42:43.860101 (Thread-2): Compiling test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:42:43.860430 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_orders_order_id".
2021-05-31 08:42:43.860770 (Thread-6): Acquiring new snowflake connection "test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2021-05-31 08:42:43.872076 (Thread-1): Writing injected SQL for node "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-31 08:42:43.872439 (Thread-7): Acquiring new snowflake connection "test.demo_dbt.unique_customers_customer_id".
2021-05-31 08:42:43.872538 (Thread-3): Compiling test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:42:43.872803 (Thread-8): Acquiring new snowflake connection "test.demo_dbt.unique_stg_customers_customer_id".
2021-05-31 08:42:43.873064 (Thread-9): Acquiring new snowflake connection "test.demo_dbt.unique_stg_orders_order_id".
2021-05-31 08:42:43.873183 (Thread-4): Compiling test.demo_dbt.not_null_stg_orders_customer_id
2021-05-31 08:42:43.879520 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_customers_customer_id"
2021-05-31 08:42:43.879657 (Thread-5): Compiling test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:42:43.879771 (Thread-6): Compiling test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-31 08:42:43.880038 (Thread-7): Compiling test.demo_dbt.unique_customers_customer_id
2021-05-31 08:42:43.883583 (Thread-3): Writing injected SQL for node "test.demo_dbt.not_null_stg_customers_customer_id"
2021-05-31 08:42:43.883805 (Thread-8): Compiling test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:42:43.883932 (Thread-9): Compiling test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:42:43.886993 (Thread-4): Writing injected SQL for node "test.demo_dbt.not_null_stg_orders_customer_id"
2021-05-31 08:42:43.887184 (Thread-1): finished collecting timing info
2021-05-31 08:42:43.890010 (Thread-5): Writing injected SQL for node "test.demo_dbt.not_null_stg_orders_order_id"
2021-05-31 08:42:43.900029 (Thread-6): Writing injected SQL for node "test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2021-05-31 08:42:43.906437 (Thread-7): Writing injected SQL for node "test.demo_dbt.unique_customers_customer_id"
2021-05-31 08:42:43.909463 (Thread-8): Writing injected SQL for node "test.demo_dbt.unique_stg_customers_customer_id"
2021-05-31 08:42:43.909603 (Thread-2): finished collecting timing info
2021-05-31 08:42:43.912409 (Thread-9): Writing injected SQL for node "test.demo_dbt.unique_stg_orders_order_id"
2021-05-31 08:42:43.912545 (Thread-3): finished collecting timing info
2021-05-31 08:42:43.913398 (Thread-1): Using snowflake connection "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-31 08:42:43.913877 (Thread-4): finished collecting timing info
2021-05-31 08:42:43.914013 (Thread-5): finished collecting timing info
2021-05-31 08:42:43.914271 (Thread-6): finished collecting timing info
2021-05-31 08:42:43.914849 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_customers_customer_id".
2021-05-31 08:42:43.914991 (Thread-7): finished collecting timing info
2021-05-31 08:42:43.915093 (Thread-8): finished collecting timing info
2021-05-31 08:42:43.915645 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_stg_customers_customer_id".
2021-05-31 08:42:43.915838 (Thread-1): On test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: BEGIN
2021-05-31 08:42:43.915921 (Thread-9): finished collecting timing info
2021-05-31 08:42:43.916336 (Thread-4): Using snowflake connection "test.demo_dbt.not_null_stg_orders_customer_id".
2021-05-31 08:42:43.916722 (Thread-5): Using snowflake connection "test.demo_dbt.not_null_stg_orders_order_id".
2021-05-31 08:42:43.917397 (Thread-6): Using snowflake connection "test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2021-05-31 08:42:43.917507 (Thread-2): On test.demo_dbt.not_null_customers_customer_id: BEGIN
2021-05-31 08:42:43.918117 (Thread-7): Using snowflake connection "test.demo_dbt.unique_customers_customer_id".
2021-05-31 08:42:43.918697 (Thread-8): Using snowflake connection "test.demo_dbt.unique_stg_customers_customer_id".
2021-05-31 08:42:43.918819 (Thread-3): On test.demo_dbt.not_null_stg_customers_customer_id: BEGIN
2021-05-31 08:42:43.918950 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 08:42:43.919526 (Thread-9): Using snowflake connection "test.demo_dbt.unique_stg_orders_order_id".
2021-05-31 08:42:43.919646 (Thread-4): On test.demo_dbt.not_null_stg_orders_customer_id: BEGIN
2021-05-31 08:42:43.919764 (Thread-5): On test.demo_dbt.not_null_stg_orders_order_id: BEGIN
2021-05-31 08:42:43.919887 (Thread-6): On test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: BEGIN
2021-05-31 08:42:43.920000 (Thread-2): Opening a new connection, currently in state init
2021-05-31 08:42:43.920105 (Thread-7): On test.demo_dbt.unique_customers_customer_id: BEGIN
2021-05-31 08:42:43.920193 (Thread-8): On test.demo_dbt.unique_stg_customers_customer_id: BEGIN
2021-05-31 08:42:43.920296 (Thread-3): Opening a new connection, currently in state init
2021-05-31 08:42:43.921081 (Thread-9): On test.demo_dbt.unique_stg_orders_order_id: BEGIN
2021-05-31 08:42:43.921380 (Thread-4): Opening a new connection, currently in state init
2021-05-31 08:42:43.922076 (Thread-5): Opening a new connection, currently in state init
2021-05-31 08:42:43.922196 (Thread-6): Opening a new connection, currently in state init
2021-05-31 08:42:43.922580 (Thread-7): Opening a new connection, currently in state init
2021-05-31 08:42:43.923126 (Thread-8): Opening a new connection, currently in state init
2021-05-31 08:42:43.924437 (Thread-9): Opening a new connection, currently in state init
2021-05-31 08:42:45.145950 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 08:42:45.146198 (Thread-1): Using snowflake connection "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-31 08:42:45.146337 (Thread-1): On test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from DEMO_DB.PUBLIC.stg_orders

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors
2021-05-31 08:42:45.579376 (Thread-8): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 08:42:45.579732 (Thread-8): Using snowflake connection "test.demo_dbt.unique_stg_customers_customer_id".
2021-05-31 08:42:45.579898 (Thread-8): On test.demo_dbt.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from DEMO_DB.PUBLIC.stg_customers
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors
2021-05-31 08:42:45.825653 (Thread-6): SQL status: SUCCESS 1 in 1.90 seconds
2021-05-31 08:42:45.825895 (Thread-6): Using snowflake connection "test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2021-05-31 08:42:45.826033 (Thread-6): On test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_id as id from DEMO_DB.PUBLIC.stg_orders
) as child
left join (
    select customer_id as id from DEMO_DB.PUBLIC.stg_customers
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null
2021-05-31 08:42:45.905661 (Thread-9): SQL status: SUCCESS 1 in 1.98 seconds
2021-05-31 08:42:45.905902 (Thread-9): Using snowflake connection "test.demo_dbt.unique_stg_orders_order_id".
2021-05-31 08:42:45.906039 (Thread-9): On test.demo_dbt.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from DEMO_DB.PUBLIC.stg_orders
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors
2021-05-31 08:42:46.354797 (Thread-5): SQL status: SUCCESS 1 in 2.43 seconds
2021-05-31 08:42:46.355366 (Thread-4): SQL status: SUCCESS 1 in 2.43 seconds
2021-05-31 08:42:46.355511 (Thread-5): Using snowflake connection "test.demo_dbt.not_null_stg_orders_order_id".
2021-05-31 08:42:46.355681 (Thread-4): Using snowflake connection "test.demo_dbt.not_null_stg_orders_customer_id".
2021-05-31 08:42:46.355816 (Thread-5): On test.demo_dbt.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.PUBLIC.stg_orders
where order_id is null
2021-05-31 08:42:46.355933 (Thread-4): On test.demo_dbt.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_stg_orders_customer_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.PUBLIC.stg_orders
where customer_id is null
2021-05-31 08:42:46.386601 (Thread-2): SQL status: SUCCESS 1 in 2.47 seconds
2021-05-31 08:42:46.386839 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_customers_customer_id".
2021-05-31 08:42:46.386976 (Thread-2): On test.demo_dbt.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.PUBLIC.customers
where customer_id is null
2021-05-31 08:42:46.455681 (Thread-6): SQL status: SUCCESS 1 in 0.63 seconds
2021-05-31 08:42:46.456330 (Thread-6): finished collecting timing info
2021-05-31 08:42:46.456559 (Thread-6): On test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: ROLLBACK
2021-05-31 08:42:46.464403 (Thread-8): SQL status: SUCCESS 1 in 0.88 seconds
2021-05-31 08:42:46.464756 (Thread-8): finished collecting timing info
2021-05-31 08:42:46.464923 (Thread-8): On test.demo_dbt.unique_stg_customers_customer_id: ROLLBACK
2021-05-31 08:42:46.514981 (Thread-9): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-31 08:42:46.515470 (Thread-9): finished collecting timing info
2021-05-31 08:42:46.515657 (Thread-9): On test.demo_dbt.unique_stg_orders_order_id: ROLLBACK
2021-05-31 08:42:46.557323 (Thread-3): SQL status: SUCCESS 1 in 2.64 seconds
2021-05-31 08:42:46.557902 (Thread-7): SQL status: SUCCESS 1 in 2.64 seconds
2021-05-31 08:42:46.558044 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_stg_customers_customer_id".
2021-05-31 08:42:46.558206 (Thread-7): Using snowflake connection "test.demo_dbt.unique_customers_customer_id".
2021-05-31 08:42:46.558351 (Thread-3): On test.demo_dbt.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.PUBLIC.stg_customers
where customer_id is null
2021-05-31 08:42:46.558517 (Thread-7): On test.demo_dbt.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from DEMO_DB.PUBLIC.customers
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors
2021-05-31 08:42:46.765206 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 08:42:46.765696 (Thread-4): finished collecting timing info
2021-05-31 08:42:46.765914 (Thread-4): On test.demo_dbt.not_null_stg_orders_customer_id: ROLLBACK
2021-05-31 08:42:46.825145 (Thread-2): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-31 08:42:46.825649 (Thread-2): finished collecting timing info
2021-05-31 08:42:46.825869 (Thread-2): On test.demo_dbt.not_null_customers_customer_id: ROLLBACK
2021-05-31 08:42:46.878337 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-31 08:42:46.878836 (Thread-1): finished collecting timing info
2021-05-31 08:42:46.879058 (Thread-1): On test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: ROLLBACK
2021-05-31 08:42:46.894439 (Thread-9): On test.demo_dbt.unique_stg_orders_order_id: Close
2021-05-31 08:42:46.925052 (Thread-8): On test.demo_dbt.unique_stg_customers_customer_id: Close
2021-05-31 08:42:46.939268 (Thread-6): On test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: Close
2021-05-31 08:42:46.955133 (Thread-5): SQL status: SUCCESS 1 in 0.60 seconds
2021-05-31 08:42:46.955643 (Thread-5): finished collecting timing info
2021-05-31 08:42:46.955880 (Thread-5): On test.demo_dbt.not_null_stg_orders_order_id: ROLLBACK
2021-05-31 08:42:46.958337 (Thread-3): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 08:42:46.958881 (Thread-3): finished collecting timing info
2021-05-31 08:42:46.959057 (Thread-3): On test.demo_dbt.not_null_stg_customers_customer_id: ROLLBACK
2021-05-31 08:42:46.985281 (Thread-7): SQL status: SUCCESS 1 in 0.43 seconds
2021-05-31 08:42:46.985758 (Thread-7): finished collecting timing info
2021-05-31 08:42:46.985938 (Thread-7): On test.demo_dbt.unique_customers_customer_id: ROLLBACK
2021-05-31 08:42:47.185238 (Thread-2): On test.demo_dbt.not_null_customers_customer_id: Close
2021-05-31 08:42:47.264791 (Thread-4): On test.demo_dbt.not_null_stg_orders_customer_id: Close
2021-05-31 08:42:47.314465 (Thread-5): On test.demo_dbt.not_null_stg_orders_order_id: Close
2021-05-31 08:42:47.354658 (Thread-7): On test.demo_dbt.unique_customers_customer_id: Close
2021-05-31 08:42:47.414276 (Thread-3): On test.demo_dbt.not_null_stg_customers_customer_id: Close
2021-05-31 08:42:47.444715 (Thread-1): On test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: Close
2021-05-31 08:42:47.528873 (Thread-9): 14:12:47 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 3.66s]
2021-05-31 08:42:47.529283 (Thread-8): 14:12:47 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 3.66s]
2021-05-31 08:42:47.529482 (Thread-9): Finished running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:42:47.529650 (Thread-8): Finished running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:42:47.706856 (Thread-6): 14:12:47 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 3.85s]
2021-05-31 08:42:47.707091 (Thread-6): Finished running node test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-31 08:42:47.765152 (Thread-2): 14:12:47 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 3.91s]
2021-05-31 08:42:47.765347 (Thread-2): Finished running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:42:47.876669 (Thread-4): 14:12:47 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 4.02s]
2021-05-31 08:42:47.876895 (Thread-4): Finished running node test.demo_dbt.not_null_stg_orders_customer_id
2021-05-31 08:42:48.028241 (Thread-7): 14:12:48 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 4.16s]
2021-05-31 08:42:48.028656 (Thread-3): 14:12:48 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 4.17s]
2021-05-31 08:42:48.028864 (Thread-7): Finished running node test.demo_dbt.unique_customers_customer_id
2021-05-31 08:42:48.029015 (Thread-3): Finished running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:42:48.115596 (Thread-1): 14:12:48 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 4.26s]
2021-05-31 08:42:48.115810 (Thread-1): Finished running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:42:48.147264 (Thread-5): 14:12:48 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 4.29s]
2021-05-31 08:42:48.147483 (Thread-5): Finished running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:42:48.149132 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:42:48.149528 (MainThread): 14:12:48 | 
2021-05-31 08:42:48.149727 (MainThread): 14:12:48 | Finished running 9 tests in 6.72s.
2021-05-31 08:42:48.149841 (MainThread): Connection 'master' was properly closed.
2021-05-31 08:42:48.149923 (MainThread): Connection 'test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned' was properly closed.
2021-05-31 08:42:48.149999 (MainThread): Connection 'test.demo_dbt.not_null_customers_customer_id' was properly closed.
2021-05-31 08:42:48.150071 (MainThread): Connection 'test.demo_dbt.not_null_stg_customers_customer_id' was properly closed.
2021-05-31 08:42:48.150142 (MainThread): Connection 'test.demo_dbt.not_null_stg_orders_customer_id' was properly closed.
2021-05-31 08:42:48.150211 (MainThread): Connection 'test.demo_dbt.not_null_stg_orders_order_id' was properly closed.
2021-05-31 08:42:48.150279 (MainThread): Connection 'test.demo_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_' was properly closed.
2021-05-31 08:42:48.150351 (MainThread): Connection 'test.demo_dbt.unique_customers_customer_id' was properly closed.
2021-05-31 08:42:48.150421 (MainThread): Connection 'test.demo_dbt.unique_stg_customers_customer_id' was properly closed.
2021-05-31 08:42:48.150489 (MainThread): Connection 'test.demo_dbt.unique_stg_orders_order_id' was properly closed.
2021-05-31 08:42:48.155643 (MainThread): 
2021-05-31 08:42:48.155864 (MainThread): Completed successfully
2021-05-31 08:42:48.156013 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2021-05-31 08:42:48.156211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea163015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea17cb5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1802d370>]}
2021-05-31 08:42:48.156446 (MainThread): Flushing usage events
2021-05-31 08:51:15.616076 (MainThread): Running with dbt=0.19.1
2021-05-31 08:51:16.382557 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-05-31 08:51:16.384326 (MainThread): Tracking: tracking
2021-05-31 08:51:16.384803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6411cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd87545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd8754670>]}
2021-05-31 08:51:16.394489 (MainThread): Partial parsing not enabled
2021-05-31 08:51:16.395483 (MainThread): Parsing macros/catalog.sql
2021-05-31 08:51:16.397674 (MainThread): Parsing macros/adapters.sql
2021-05-31 08:51:16.424212 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 08:51:16.426131 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 08:51:16.427430 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 08:51:16.431009 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 08:51:16.439840 (MainThread): Parsing macros/core.sql
2021-05-31 08:51:16.443287 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 08:51:16.451309 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 08:51:16.452875 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 08:51:16.468889 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 08:51:16.499811 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 08:51:16.518785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 08:51:16.520353 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 08:51:16.525711 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 08:51:16.539680 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 08:51:16.546558 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 08:51:16.551984 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 08:51:16.556204 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 08:51:16.557011 (MainThread): Parsing macros/etc/query.sql
2021-05-31 08:51:16.557888 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 08:51:16.559385 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 08:51:16.567318 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 08:51:16.569103 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 08:51:16.570610 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 08:51:16.609513 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 08:51:16.611231 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 08:51:16.612655 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 08:51:16.614147 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 08:51:16.620636 (MainThread): Partial parsing not enabled
2021-05-31 08:51:16.639018 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:51:16.646305 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:51:16.649349 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:51:16.771800 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1382c8c9-794d-4e50-89ce-fe5c2f0f304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd8739730>]}
2021-05-31 08:51:16.777499 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1382c8c9-794d-4e50-89ce-fe5c2f0f304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd5dfb790>]}
2021-05-31 08:51:16.777805 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 08:51:16.779045 (MainThread): 
2021-05-31 08:51:16.779428 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 08:51:16.780887 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:51:16.797130 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 08:51:16.797296 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 08:51:16.797400 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 08:51:18.444133 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 6 in 1.65 seconds
2021-05-31 08:51:18.448782 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 08:51:19.058455 (MainThread): 14:21:19 | Concurrency: 10 threads (target='dev')
2021-05-31 08:51:19.058655 (MainThread): 14:21:19 | 
2021-05-31 08:51:19.060510 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 08:51:19.060667 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 08:51:19.060991 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 08:51:19.061303 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 08:51:19.061457 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 08:51:19.061585 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 08:51:19.062853 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 08:51:19.063899 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 08:51:19.065444 (Thread-1): finished collecting timing info
2021-05-31 08:51:19.065647 (Thread-1): finished collecting timing info
2021-05-31 08:51:19.065974 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 08:51:19.066098 (Thread-2): finished collecting timing info
2021-05-31 08:51:19.066431 (Thread-2): finished collecting timing info
2021-05-31 08:51:19.066565 (Thread-4): Began running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:51:19.066988 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 08:51:19.067096 (Thread-5): Began running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:51:19.067387 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_customers_customer_id".
2021-05-31 08:51:19.067924 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.unique_stg_customers_customer_id".
2021-05-31 08:51:19.068030 (Thread-7): Began running node model.demo_dbt.customers
2021-05-31 08:51:19.068172 (Thread-8): Began running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:51:19.068281 (Thread-4): Compiling test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:51:19.068370 (Thread-9): Began running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:51:19.068503 (Thread-10): Began running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:51:19.068602 (Thread-5): Compiling test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:51:19.068864 (Thread-7): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 08:51:19.069144 (Thread-8): Acquiring new snowflake connection "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-31 08:51:19.075844 (Thread-9): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_orders_order_id".
2021-05-31 08:51:19.076049 (Thread-4): Writing injected SQL for node "test.demo_dbt.not_null_stg_customers_customer_id"
2021-05-31 08:51:19.076371 (Thread-10): Acquiring new snowflake connection "test.demo_dbt.unique_stg_orders_order_id".
2021-05-31 08:51:19.083149 (Thread-5): Writing injected SQL for node "test.demo_dbt.unique_stg_customers_customer_id"
2021-05-31 08:51:19.083255 (Thread-7): Compiling model.demo_dbt.customers
2021-05-31 08:51:19.083368 (Thread-8): Compiling test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:51:19.083471 (Thread-9): Compiling test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:51:19.083718 (Thread-10): Compiling test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:51:19.086908 (Thread-7): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 08:51:19.087024 (Thread-4): finished collecting timing info
2021-05-31 08:51:19.097265 (Thread-8): Writing injected SQL for node "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-31 08:51:19.100965 (Thread-9): Writing injected SQL for node "test.demo_dbt.not_null_stg_orders_order_id"
2021-05-31 08:51:19.101191 (Thread-5): finished collecting timing info
2021-05-31 08:51:19.104237 (Thread-10): Writing injected SQL for node "test.demo_dbt.unique_stg_orders_order_id"
2021-05-31 08:51:19.104502 (Thread-4): finished collecting timing info
2021-05-31 08:51:19.104878 (Thread-5): finished collecting timing info
2021-05-31 08:51:19.105344 (Thread-7): finished collecting timing info
2021-05-31 08:51:19.105485 (Thread-8): finished collecting timing info
2021-05-31 08:51:19.105652 (Thread-9): finished collecting timing info
2021-05-31 08:51:19.105943 (Thread-4): Finished running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 08:51:19.106265 (Thread-5): Finished running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 08:51:19.106404 (Thread-7): finished collecting timing info
2021-05-31 08:51:19.106483 (Thread-10): finished collecting timing info
2021-05-31 08:51:19.106600 (Thread-8): finished collecting timing info
2021-05-31 08:51:19.106743 (Thread-9): finished collecting timing info
2021-05-31 08:51:19.107223 (Thread-7): Finished running node model.demo_dbt.customers
2021-05-31 08:51:19.107355 (Thread-10): finished collecting timing info
2021-05-31 08:51:19.107603 (Thread-8): Finished running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 08:51:19.107848 (Thread-9): Finished running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 08:51:19.108145 (Thread-10): Finished running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 08:51:19.108631 (Thread-1): Began running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:51:19.108759 (Thread-10): Began running node test.demo_dbt.unique_customers_customer_id
2021-05-31 08:51:19.109089 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.not_null_customers_customer_id".
2021-05-31 08:51:19.109331 (Thread-10): Acquiring new snowflake connection "test.demo_dbt.unique_customers_customer_id".
2021-05-31 08:51:19.109452 (Thread-1): Compiling test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:51:19.109597 (Thread-10): Compiling test.demo_dbt.unique_customers_customer_id
2021-05-31 08:51:19.112520 (Thread-1): Writing injected SQL for node "test.demo_dbt.not_null_customers_customer_id"
2021-05-31 08:51:19.115081 (Thread-10): Writing injected SQL for node "test.demo_dbt.unique_customers_customer_id"
2021-05-31 08:51:19.115575 (Thread-1): finished collecting timing info
2021-05-31 08:51:19.115704 (Thread-10): finished collecting timing info
2021-05-31 08:51:19.115820 (Thread-1): finished collecting timing info
2021-05-31 08:51:19.115974 (Thread-10): finished collecting timing info
2021-05-31 08:51:19.116289 (Thread-1): Finished running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 08:51:19.116798 (Thread-10): Finished running node test.demo_dbt.unique_customers_customer_id
2021-05-31 08:51:19.118122 (MainThread): Connection 'master' was properly closed.
2021-05-31 08:51:19.118244 (MainThread): Connection 'test.demo_dbt.not_null_customers_customer_id' was properly closed.
2021-05-31 08:51:19.118324 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 08:51:19.118404 (MainThread): Connection 'test.demo_dbt.not_null_stg_customers_customer_id' was properly closed.
2021-05-31 08:51:19.118479 (MainThread): Connection 'test.demo_dbt.unique_stg_customers_customer_id' was properly closed.
2021-05-31 08:51:19.118557 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 08:51:19.118633 (MainThread): Connection 'test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned' was properly closed.
2021-05-31 08:51:19.118699 (MainThread): Connection 'test.demo_dbt.not_null_stg_orders_order_id' was properly closed.
2021-05-31 08:51:19.118769 (MainThread): Connection 'test.demo_dbt.unique_customers_customer_id' was properly closed.
2021-05-31 08:51:19.122578 (MainThread): 14:21:19 | Done.
2021-05-31 08:51:19.125093 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-05-31 08:51:19.125200 (MainThread): 14:21:19 | Building catalog
2021-05-31 08:51:19.127104 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "DEMO_DB.information_schema".
2021-05-31 08:51:19.134263 (ThreadPoolExecutor-1_0): Using snowflake connection "DEMO_DB.information_schema".
2021-05-31 08:51:19.134404 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "DEMO_DB.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEMO_DB.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEMO_DB.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-05-31 08:51:19.134505 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-31 08:51:22.253237 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 21 in 3.12 seconds
2021-05-31 08:51:22.263384 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: Close
2021-05-31 08:51:23.369868 (MainThread): 14:21:23 | Catalog written to /Users/dhirajpatra/Desktop/python/demo_dbt/target/catalog.json
2021-05-31 08:51:23.370096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6411cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd87b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd8b0cd30>]}
2021-05-31 08:51:23.370312 (MainThread): Flushing usage events
2021-05-31 08:51:24.795483 (MainThread): Connection 'generate_catalog' was properly closed.
2021-05-31 08:51:24.795669 (MainThread): Connection 'DEMO_DB.information_schema' was properly closed.
2021-05-31 08:51:45.009460 (MainThread): Running with dbt=0.19.1
2021-05-31 08:51:45.771714 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-05-31 08:51:45.773037 (MainThread): Tracking: tracking
2021-05-31 08:51:45.773511 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff27e5d6d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2803524f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2803525b0>]}
2021-05-31 08:51:45.776210 (MainThread): Serving docs at 0.0.0.0:8080
2021-05-31 08:51:45.776794 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-05-31 08:51:45.776924 (MainThread): Press Ctrl+C to exit.


2021-05-31 08:53:34.453816 (MainThread): Flushing usage events
2021-05-31 08:53:36.681731 (MainThread): ctrl-c
2021-05-31 13:40:47.709287 (MainThread): Running with dbt=0.19.1
2021-05-31 13:40:49.037890 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-31 13:40:49.039489 (MainThread): Tracking: tracking
2021-05-31 13:40:49.040092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a670fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a89926d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8992760>]}
2021-05-31 13:40:49.051928 (MainThread): Partial parsing not enabled
2021-05-31 13:40:49.053149 (MainThread): Parsing macros/catalog.sql
2021-05-31 13:40:49.055973 (MainThread): Parsing macros/adapters.sql
2021-05-31 13:40:49.087662 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 13:40:49.089464 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 13:40:49.090674 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 13:40:49.094024 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 13:40:49.102932 (MainThread): Parsing macros/core.sql
2021-05-31 13:40:49.106364 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 13:40:49.113916 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 13:40:49.115415 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 13:40:49.130856 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 13:40:49.161706 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 13:40:49.180202 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 13:40:49.181744 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 13:40:49.186960 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 13:40:49.198960 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 13:40:49.205139 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 13:40:49.210505 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 13:40:49.214653 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 13:40:49.215453 (MainThread): Parsing macros/etc/query.sql
2021-05-31 13:40:49.216337 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 13:40:49.217766 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 13:40:49.225288 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 13:40:49.226943 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 13:40:49.228370 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 13:40:49.266192 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 13:40:49.267766 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 13:40:49.269166 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 13:40:49.270692 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 13:40:49.276999 (MainThread): Partial parsing not enabled
2021-05-31 13:40:49.295103 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 13:40:49.302107 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 13:40:49.305107 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 13:40:49.440719 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acb8b5c8-fdb1-4e8e-8e32-28de72642407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a89c6b20>]}
2021-05-31 13:40:49.446013 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb8b5c8-fdb1-4e8e-8e32-28de72642407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8c5d880>]}
2021-05-31 13:40:49.446323 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 13:40:49.447272 (MainThread): 
2021-05-31 13:40:49.447621 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 13:40:49.448391 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 13:40:49.462194 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 13:40:49.462324 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 13:40:49.462418 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 13:40:51.378932 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-05-31 13:40:51.383290 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 13:40:52.045900 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 13:40:52.053257 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 13:40:52.053374 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 13:40:52.053466 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 13:40:53.731681 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.68 seconds
2021-05-31 13:40:53.733036 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 13:40:54.333696 (MainThread): Using snowflake connection "master".
2021-05-31 13:40:54.333949 (MainThread): On master: BEGIN
2021-05-31 13:40:54.334087 (MainThread): Opening a new connection, currently in state init
2021-05-31 13:40:56.086464 (MainThread): SQL status: SUCCESS 1 in 1.75 seconds
2021-05-31 13:40:56.086717 (MainThread): On master: COMMIT
2021-05-31 13:40:56.086950 (MainThread): Using snowflake connection "master".
2021-05-31 13:40:56.087081 (MainThread): On master: COMMIT
2021-05-31 13:40:56.439583 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 13:40:56.439844 (MainThread): On master: Close
2021-05-31 13:40:57.112278 (MainThread): 19:10:57 | Concurrency: 10 threads (target='dev')
2021-05-31 13:40:57.112491 (MainThread): 19:10:57 | 
2021-05-31 13:40:57.114695 (Thread-1): Began running node seed.demo_dbt.raw_payments
2021-05-31 13:40:57.115010 (Thread-1): 19:10:57 | 1 of 1 START seed file PUBLIC.raw_payments........................... [RUN]
2021-05-31 13:40:57.115355 (Thread-1): Acquiring new snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:40:57.115499 (Thread-1): finished collecting timing info
2021-05-31 13:40:57.147810 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-05-31 13:40:57.147972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'acb8b5c8-fdb1-4e8e-8e32-28de72642407', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8f3ba60>]}
2021-05-31 13:40:57.149012 (Thread-1): Using snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:40:57.149102 (Thread-1): On seed.demo_dbt.raw_payments: BEGIN
2021-05-31 13:40:57.149181 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 13:40:58.954932 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-05-31 13:40:58.955169 (Thread-1): Using snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:40:58.955304 (Thread-1): On seed.demo_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "seed.demo_dbt.raw_payments"} */

    create table DEMO_DB.PUBLIC.raw_payments (id integer,order_id integer,payment_method text,amount integer)
2021-05-31 13:40:59.568697 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-31 13:40:59.591250 (Thread-1): Using snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:40:59.591364 (Thread-1): On seed.demo_dbt.raw_payments: insert into DEMO_DB.PUBLIC.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%...
2021-05-31 13:41:01.136789 (Thread-1): SQL status: SUCCESS 113 in 1.55 seconds
2021-05-31 13:41:01.141917 (Thread-1): Writing runtime SQL for node "seed.demo_dbt.raw_payments"
2021-05-31 13:41:01.148986 (Thread-1): On seed.demo_dbt.raw_payments: COMMIT
2021-05-31 13:41:01.149161 (Thread-1): Using snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:41:01.149254 (Thread-1): On seed.demo_dbt.raw_payments: COMMIT
2021-05-31 13:41:02.129785 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-05-31 13:41:02.130503 (Thread-1): finished collecting timing info
2021-05-31 13:41:02.130723 (Thread-1): On seed.demo_dbt.raw_payments: Close
2021-05-31 13:41:03.155420 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb8b5c8-fdb1-4e8e-8e32-28de72642407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8f92220>]}
2021-05-31 13:41:03.155771 (Thread-1): 19:11:03 | 1 of 1 OK loaded seed file PUBLIC.raw_payments....................... [INSERT 113 in 6.04s]
2021-05-31 13:41:03.155943 (Thread-1): Finished running node seed.demo_dbt.raw_payments
2021-05-31 13:41:03.157462 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 13:41:03.157690 (MainThread): Using snowflake connection "master".
2021-05-31 13:41:03.157796 (MainThread): On master: BEGIN
2021-05-31 13:41:03.157894 (MainThread): Opening a new connection, currently in state closed
2021-05-31 13:41:04.586121 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 13:41:04.586372 (MainThread): On master: COMMIT
2021-05-31 13:41:04.586593 (MainThread): Using snowflake connection "master".
2021-05-31 13:41:04.586723 (MainThread): On master: COMMIT
2021-05-31 13:41:05.098089 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 13:41:05.098350 (MainThread): On master: Close
2021-05-31 13:41:05.726835 (MainThread): 19:11:05 | 
2021-05-31 13:41:05.727048 (MainThread): 19:11:05 | Finished running 1 seed in 16.28s.
2021-05-31 13:41:05.727176 (MainThread): Connection 'master' was properly closed.
2021-05-31 13:41:05.727269 (MainThread): Connection 'seed.demo_dbt.raw_payments' was properly closed.
2021-05-31 13:41:05.731778 (MainThread): 
2021-05-31 13:41:05.731911 (MainThread): Completed successfully
2021-05-31 13:41:05.732028 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-31 13:41:05.732188 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8b22730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8f850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a8f85f40>]}
2021-05-31 13:41:05.732384 (MainThread): Flushing usage events
2021-05-31 13:52:33.603947 (MainThread): Running with dbt=0.19.1
2021-05-31 13:52:34.352255 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-05-31 13:52:34.353525 (MainThread): Tracking: tracking
2021-05-31 13:52:34.353971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb05c11fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb086565e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb08656670>]}
2021-05-31 13:52:34.364326 (MainThread): Partial parsing not enabled
2021-05-31 13:52:34.365259 (MainThread): Parsing macros/catalog.sql
2021-05-31 13:52:34.367344 (MainThread): Parsing macros/adapters.sql
2021-05-31 13:52:34.393279 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 13:52:34.394983 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 13:52:34.396231 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 13:52:34.399639 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 13:52:34.408191 (MainThread): Parsing macros/core.sql
2021-05-31 13:52:34.411428 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 13:52:34.418914 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 13:52:34.420416 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 13:52:34.436058 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 13:52:34.466504 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 13:52:34.485544 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 13:52:34.487102 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 13:52:34.492882 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 13:52:34.505065 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 13:52:34.510938 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 13:52:34.516341 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 13:52:34.520508 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 13:52:34.521314 (MainThread): Parsing macros/etc/query.sql
2021-05-31 13:52:34.522325 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 13:52:34.523695 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 13:52:34.531360 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 13:52:34.533014 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 13:52:34.534442 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 13:52:34.572295 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 13:52:34.573867 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 13:52:34.575155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 13:52:34.576593 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 13:52:34.582764 (MainThread): Partial parsing not enabled
2021-05-31 13:52:34.600641 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 13:52:34.607522 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 13:52:34.610374 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 13:52:34.734661 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a08a6d7f-6df6-4a8e-9577-1cfdb546db77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0868ed00>]}
2021-05-31 13:52:34.739435 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a08a6d7f-6df6-4a8e-9577-1cfdb546db77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb089ddfd0>]}
2021-05-31 13:52:34.739671 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 13:52:34.740646 (MainThread): 
2021-05-31 13:52:34.740965 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 13:52:34.742252 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 13:52:34.755777 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 13:52:34.755910 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 13:52:34.756005 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 13:52:36.703985 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 7 in 1.95 seconds
2021-05-31 13:52:36.708779 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 13:52:37.404440 (MainThread): 19:22:37 | Concurrency: 10 threads (target='dev')
2021-05-31 13:52:37.404707 (MainThread): 19:22:37 | 
2021-05-31 13:52:37.407303 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 13:52:37.407489 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 13:52:37.407787 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 13:52:37.407920 (Thread-3): Began running node seed.demo_dbt.raw_payments
2021-05-31 13:52:37.408230 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 13:52:37.408394 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 13:52:37.408661 (Thread-3): Acquiring new snowflake connection "seed.demo_dbt.raw_payments".
2021-05-31 13:52:37.408792 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 13:52:37.410116 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 13:52:37.410276 (Thread-3): Compiling seed.demo_dbt.raw_payments
2021-05-31 13:52:37.411396 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 13:52:37.412555 (Thread-3): Writing injected SQL for node "seed.demo_dbt.raw_payments"
2021-05-31 13:52:37.412814 (Thread-3): finished collecting timing info
2021-05-31 13:52:37.412972 (Thread-3): finished collecting timing info
2021-05-31 13:52:37.413265 (Thread-3): Finished running node seed.demo_dbt.raw_payments
2021-05-31 13:52:37.414340 (Thread-1): finished collecting timing info
2021-05-31 13:52:37.414488 (Thread-2): finished collecting timing info
2021-05-31 13:52:37.414622 (Thread-1): finished collecting timing info
2021-05-31 13:52:37.414770 (Thread-2): finished collecting timing info
2021-05-31 13:52:37.415066 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 13:52:37.415368 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 13:52:37.416084 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 13:52:37.416222 (Thread-6): Began running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 13:52:37.416425 (Thread-7): Began running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 13:52:37.416715 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 13:52:37.416820 (Thread-8): Began running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 13:52:37.416939 (Thread-9): Began running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 13:52:37.417056 (Thread-10): Began running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 13:52:37.417446 (Thread-6): Acquiring new snowflake connection "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-31 13:52:37.417737 (Thread-7): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_customers_customer_id".
2021-05-31 13:52:37.417869 (Thread-5): Compiling model.demo_dbt.customers
2021-05-31 13:52:37.418137 (Thread-8): Acquiring new snowflake connection "test.demo_dbt.not_null_stg_orders_order_id".
2021-05-31 13:52:37.418403 (Thread-9): Acquiring new snowflake connection "test.demo_dbt.unique_stg_customers_customer_id".
2021-05-31 13:52:37.418662 (Thread-10): Acquiring new snowflake connection "test.demo_dbt.unique_stg_orders_order_id".
2021-05-31 13:52:37.418792 (Thread-6): Compiling test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 13:52:37.418915 (Thread-7): Compiling test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 13:52:37.421939 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 13:52:37.422074 (Thread-8): Compiling test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 13:52:37.422184 (Thread-9): Compiling test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 13:52:37.422287 (Thread-10): Compiling test.demo_dbt.unique_stg_orders_order_id
2021-05-31 13:52:37.433090 (Thread-6): Writing injected SQL for node "test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-31 13:52:37.439150 (Thread-7): Writing injected SQL for node "test.demo_dbt.not_null_stg_customers_customer_id"
2021-05-31 13:52:37.441874 (Thread-8): Writing injected SQL for node "test.demo_dbt.not_null_stg_orders_order_id"
2021-05-31 13:52:37.448910 (Thread-9): Writing injected SQL for node "test.demo_dbt.unique_stg_customers_customer_id"
2021-05-31 13:52:37.449028 (Thread-5): finished collecting timing info
2021-05-31 13:52:37.451953 (Thread-10): Writing injected SQL for node "test.demo_dbt.unique_stg_orders_order_id"
2021-05-31 13:52:37.452723 (Thread-6): finished collecting timing info
2021-05-31 13:52:37.452927 (Thread-5): finished collecting timing info
2021-05-31 13:52:37.453147 (Thread-8): finished collecting timing info
2021-05-31 13:52:37.453250 (Thread-7): finished collecting timing info
2021-05-31 13:52:37.453516 (Thread-9): finished collecting timing info
2021-05-31 13:52:37.453676 (Thread-6): finished collecting timing info
2021-05-31 13:52:37.454038 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 13:52:37.454193 (Thread-8): finished collecting timing info
2021-05-31 13:52:37.454280 (Thread-10): finished collecting timing info
2021-05-31 13:52:37.454402 (Thread-7): finished collecting timing info
2021-05-31 13:52:37.454536 (Thread-9): finished collecting timing info
2021-05-31 13:52:37.454812 (Thread-6): Finished running node test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-31 13:52:37.455234 (Thread-8): Finished running node test.demo_dbt.not_null_stg_orders_order_id
2021-05-31 13:52:37.455453 (Thread-10): finished collecting timing info
2021-05-31 13:52:37.455567 (Thread-3): Began running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 13:52:37.455702 (Thread-1): Began running node test.demo_dbt.unique_customers_customer_id
2021-05-31 13:52:37.455981 (Thread-7): Finished running node test.demo_dbt.not_null_stg_customers_customer_id
2021-05-31 13:52:37.456257 (Thread-9): Finished running node test.demo_dbt.unique_stg_customers_customer_id
2021-05-31 13:52:37.456739 (Thread-10): Finished running node test.demo_dbt.unique_stg_orders_order_id
2021-05-31 13:52:37.456977 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.not_null_customers_customer_id".
2021-05-31 13:52:37.457196 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.unique_customers_customer_id".
2021-05-31 13:52:37.457596 (Thread-3): Compiling test.demo_dbt.not_null_customers_customer_id
2021-05-31 13:52:37.457699 (Thread-1): Compiling test.demo_dbt.unique_customers_customer_id
2021-05-31 13:52:37.460705 (Thread-3): Writing injected SQL for node "test.demo_dbt.not_null_customers_customer_id"
2021-05-31 13:52:37.463309 (Thread-1): Writing injected SQL for node "test.demo_dbt.unique_customers_customer_id"
2021-05-31 13:52:37.463773 (Thread-3): finished collecting timing info
2021-05-31 13:52:37.463917 (Thread-3): finished collecting timing info
2021-05-31 13:52:37.464025 (Thread-1): finished collecting timing info
2021-05-31 13:52:37.464294 (Thread-3): Finished running node test.demo_dbt.not_null_customers_customer_id
2021-05-31 13:52:37.464461 (Thread-1): finished collecting timing info
2021-05-31 13:52:37.464911 (Thread-1): Finished running node test.demo_dbt.unique_customers_customer_id
2021-05-31 13:52:37.465972 (MainThread): Connection 'master' was properly closed.
2021-05-31 13:52:37.466079 (MainThread): Connection 'test.demo_dbt.unique_customers_customer_id' was properly closed.
2021-05-31 13:52:37.466158 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 13:52:37.466231 (MainThread): Connection 'test.demo_dbt.not_null_customers_customer_id' was properly closed.
2021-05-31 13:52:37.466300 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 13:52:37.466367 (MainThread): Connection 'test.demo_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned' was properly closed.
2021-05-31 13:52:37.466432 (MainThread): Connection 'test.demo_dbt.not_null_stg_customers_customer_id' was properly closed.
2021-05-31 13:52:37.466497 (MainThread): Connection 'test.demo_dbt.not_null_stg_orders_order_id' was properly closed.
2021-05-31 13:52:37.466561 (MainThread): Connection 'test.demo_dbt.unique_stg_customers_customer_id' was properly closed.
2021-05-31 13:52:37.466624 (MainThread): Connection 'test.demo_dbt.unique_stg_orders_order_id' was properly closed.
2021-05-31 13:52:37.470897 (MainThread): 19:22:37 | Done.
2021-05-31 13:52:37.471070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb08fadfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb08f7c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb08f7c310>]}
2021-05-31 13:52:37.471279 (MainThread): Flushing usage events
2021-05-31 14:27:27.284660 (MainThread): Running with dbt=0.19.1
2021-05-31 14:27:28.517365 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 14:27:28.520381 (MainThread): Tracking: tracking
2021-05-31 14:27:28.520909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ffcff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54f53670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54f53700>]}
2021-05-31 14:27:28.532854 (MainThread): Partial parsing not enabled
2021-05-31 14:27:28.534431 (MainThread): Parsing macros/catalog.sql
2021-05-31 14:27:28.537250 (MainThread): Parsing macros/adapters.sql
2021-05-31 14:27:28.564820 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 14:27:28.566492 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 14:27:28.567712 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 14:27:28.571386 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 14:27:28.581069 (MainThread): Parsing macros/core.sql
2021-05-31 14:27:28.584800 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 14:27:28.592308 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 14:27:28.593822 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 14:27:28.609083 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 14:27:28.639300 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 14:27:28.657558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 14:27:28.659102 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 14:27:28.664394 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 14:27:28.676828 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 14:27:28.682813 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 14:27:28.688357 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 14:27:28.692455 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 14:27:28.693255 (MainThread): Parsing macros/etc/query.sql
2021-05-31 14:27:28.694138 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 14:27:28.695492 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 14:27:28.703110 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 14:27:28.704884 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 14:27:28.706286 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 14:27:28.743493 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 14:27:28.745026 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 14:27:28.746274 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 14:27:28.747671 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 14:27:28.753905 (MainThread): Partial parsing not enabled
2021-05-31 14:27:28.771490 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:27:28.778250 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:27:28.781746 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:27:28.784669 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:27:28.917325 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9187a5d-3e20-4cff-9aa7-df74fb3a1e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef553574c0>]}
2021-05-31 14:27:28.922575 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9187a5d-3e20-4cff-9aa7-df74fb3a1e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef551de8b0>]}
2021-05-31 14:27:28.922820 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 14:27:28.923742 (MainThread): 
2021-05-31 14:27:28.924050 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:27:28.924986 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 14:27:28.939055 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 14:27:28.939191 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 14:27:28.939290 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 14:27:30.503912 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-31 14:27:30.508333 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 14:27:31.139883 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:27:31.147788 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:27:31.147925 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 14:27:31.148049 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 14:27:32.422054 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.27 seconds
2021-05-31 14:27:32.423494 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 14:27:33.038886 (MainThread): Using snowflake connection "master".
2021-05-31 14:27:33.039074 (MainThread): On master: BEGIN
2021-05-31 14:27:33.039202 (MainThread): Opening a new connection, currently in state init
2021-05-31 14:27:35.641402 (MainThread): SQL status: SUCCESS 1 in 2.60 seconds
2021-05-31 14:27:35.641672 (MainThread): On master: COMMIT
2021-05-31 14:27:35.641909 (MainThread): Using snowflake connection "master".
2021-05-31 14:27:35.642045 (MainThread): On master: COMMIT
2021-05-31 14:27:36.108004 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-31 14:27:36.108290 (MainThread): On master: Close
2021-05-31 14:27:36.724806 (MainThread): 19:57:36 | Concurrency: 10 threads (target='dev')
2021-05-31 14:27:36.725041 (MainThread): 19:57:36 | 
2021-05-31 14:27:36.727336 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 14:27:36.727576 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 14:27:36.727861 (Thread-1): 19:57:36 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 14:27:36.727977 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:27:36.728580 (Thread-2): 19:57:36 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 14:27:36.728928 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:27:36.729166 (Thread-3): 19:57:36 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 14:27:36.729535 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:27:36.729703 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 14:27:36.730010 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:27:36.730152 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 14:27:36.731499 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:27:36.731644 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 14:27:36.732926 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:27:36.736689 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:27:36.737053 (Thread-1): finished collecting timing info
2021-05-31 14:27:36.753577 (Thread-2): finished collecting timing info
2021-05-31 14:27:36.766927 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:27:36.768694 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:27:36.768799 (Thread-3): finished collecting timing info
2021-05-31 14:27:36.770672 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:27:36.771507 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:27:36.771617 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 14:27:36.771708 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 14:27:36.773323 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:27:36.773434 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 14:27:36.773527 (Thread-2): Opening a new connection, currently in state init
2021-05-31 14:27:36.775279 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:27:36.775592 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 14:27:36.776011 (Thread-3): Opening a new connection, currently in state init
2021-05-31 14:27:38.771088 (Thread-2): SQL status: SUCCESS 1 in 2.00 seconds
2021-05-31 14:27:38.771341 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:27:38.771480 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 14:27:38.843326 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2021-05-31 14:27:38.843565 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:27:38.843702 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 14:27:38.888849 (Thread-3): SQL status: SUCCESS 1 in 2.11 seconds
2021-05-31 14:27:38.889085 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:27:38.889221 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,

sum(amount) as total_amount
from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 14:27:39.384790 (Thread-1): Snowflake query id: 019c9da3-0000-43df-0000-b0b100020036
2021-05-31 14:27:39.385007 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 14:27:39.385224 (Thread-1): finished collecting timing info
2021-05-31 14:27:39.385429 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 14:27:39.896909 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 14:27:39.958917 (Thread-2): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 14:27:39.960892 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:27:39.961091 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:27:39.961205 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:27:40.256400 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 14:27:40.268075 (Thread-2): finished collecting timing info
2021-05-31 14:27:40.268241 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 14:27:40.453217 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 14:27:40.462769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9187a5d-3e20-4cff-9aa7-df74fb3a1e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54fdf610>]}
2021-05-31 14:27:40.463215 (Thread-1): 19:57:40 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.73s]
2021-05-31 14:27:40.463398 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 14:27:40.785556 (Thread-3): SQL status: SUCCESS 1 in 1.90 seconds
2021-05-31 14:27:40.786997 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:27:40.787239 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:27:40.787380 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:27:40.816929 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9187a5d-3e20-4cff-9aa7-df74fb3a1e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef55523610>]}
2021-05-31 14:27:40.817391 (Thread-2): 19:57:40 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 4.09s]
2021-05-31 14:27:40.817664 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 14:27:40.818061 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 14:27:40.818243 (Thread-5): 19:57:40 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 14:27:40.818409 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 14:27:41.083032 (Thread-3): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 14:27:41.084069 (Thread-3): finished collecting timing info
2021-05-31 14:27:41.084316 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 14:27:41.939819 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9187a5d-3e20-4cff-9aa7-df74fb3a1e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef551fa9a0>]}
2021-05-31 14:27:41.940277 (Thread-3): 19:57:41 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 5.21s]
2021-05-31 14:27:41.940455 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:27:41.942104 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:27:41.942355 (MainThread): Using snowflake connection "master".
2021-05-31 14:27:41.942472 (MainThread): On master: BEGIN
2021-05-31 14:27:41.942582 (MainThread): Opening a new connection, currently in state closed
2021-05-31 14:27:43.685711 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-31 14:27:43.685979 (MainThread): On master: COMMIT
2021-05-31 14:27:43.686211 (MainThread): Using snowflake connection "master".
2021-05-31 14:27:43.686364 (MainThread): On master: COMMIT
2021-05-31 14:27:44.081251 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-31 14:27:44.081513 (MainThread): On master: Close
2021-05-31 14:27:44.636295 (MainThread): 19:57:44 | 
2021-05-31 14:27:44.636522 (MainThread): 19:57:44 | Finished running 4 table models in 15.71s.
2021-05-31 14:27:44.636671 (MainThread): Connection 'master' was properly closed.
2021-05-31 14:27:44.636776 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 14:27:44.636874 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 14:27:44.636967 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 14:27:44.642291 (MainThread): 
2021-05-31 14:27:44.642460 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 14:27:44.642601 (MainThread): 
2021-05-31 14:27:44.642745 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 14:27:44.642868 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 14:27:44.642976 (MainThread):   invalid identifier 'ID'
2021-05-31 14:27:44.643081 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 14:27:44.643202 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-05-31 14:27:44.643385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef550e2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef55533a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef55533bb0>]}
2021-05-31 14:27:44.643633 (MainThread): Flushing usage events
2021-05-31 14:30:37.766322 (MainThread): Running with dbt=0.19.1
2021-05-31 14:30:38.519823 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 14:30:38.521250 (MainThread): Tracking: tracking
2021-05-31 14:30:38.521774 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbad110d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaeb52670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaeb52700>]}
2021-05-31 14:30:38.531276 (MainThread): Partial parsing not enabled
2021-05-31 14:30:38.532197 (MainThread): Parsing macros/catalog.sql
2021-05-31 14:30:38.534253 (MainThread): Parsing macros/adapters.sql
2021-05-31 14:30:38.560603 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 14:30:38.562403 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 14:30:38.563624 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 14:30:38.567053 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 14:30:38.575550 (MainThread): Parsing macros/core.sql
2021-05-31 14:30:38.578722 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 14:30:38.586196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 14:30:38.587964 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 14:30:38.603735 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 14:30:38.643420 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 14:30:38.672753 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 14:30:38.674718 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 14:30:38.703187 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 14:30:38.718990 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 14:30:38.745485 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 14:30:38.765863 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 14:30:38.784420 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 14:30:38.785582 (MainThread): Parsing macros/etc/query.sql
2021-05-31 14:30:38.786907 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 14:30:38.788788 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 14:30:38.798662 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 14:30:38.800804 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 14:30:38.802632 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 14:30:38.844172 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 14:30:38.845782 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 14:30:38.847063 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 14:30:38.848493 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 14:30:38.854913 (MainThread): Partial parsing not enabled
2021-05-31 14:30:38.873002 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:30:38.880065 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:30:38.883723 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:30:38.886747 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:30:39.012441 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaee574c0>]}
2021-05-31 14:30:39.017206 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaeddeaf0>]}
2021-05-31 14:30:39.017436 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 14:30:39.018366 (MainThread): 
2021-05-31 14:30:39.018678 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:30:39.019680 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 14:30:39.033102 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 14:30:39.033235 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 14:30:39.033333 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 14:30:41.043199 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.01 seconds
2021-05-31 14:30:41.047477 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 14:30:41.762265 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:30:41.769867 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:30:41.769989 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 14:30:41.770088 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 14:30:43.192877 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.42 seconds
2021-05-31 14:30:43.194363 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 14:30:44.013253 (MainThread): Using snowflake connection "master".
2021-05-31 14:30:44.013443 (MainThread): On master: BEGIN
2021-05-31 14:30:44.013576 (MainThread): Opening a new connection, currently in state init
2021-05-31 14:30:45.649905 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-31 14:30:45.650176 (MainThread): On master: COMMIT
2021-05-31 14:30:45.650418 (MainThread): Using snowflake connection "master".
2021-05-31 14:30:45.650556 (MainThread): On master: COMMIT
2021-05-31 14:30:46.263354 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-31 14:30:46.263621 (MainThread): On master: Close
2021-05-31 14:30:46.982740 (MainThread): 20:00:46 | Concurrency: 10 threads (target='dev')
2021-05-31 14:30:46.982977 (MainThread): 20:00:46 | 
2021-05-31 14:30:46.985231 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 14:30:46.985554 (Thread-1): 20:00:46 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 14:30:46.985760 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 14:30:46.986042 (Thread-2): 20:00:46 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 14:30:46.986690 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:30:46.986956 (Thread-3): 20:00:46 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 14:30:46.987330 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:30:46.987600 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:30:46.987726 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 14:30:46.988014 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:30:46.988192 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 14:30:46.989513 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:30:46.989663 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 14:30:46.990891 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:30:46.994377 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:30:46.994745 (Thread-2): finished collecting timing info
2021-05-31 14:30:47.005889 (Thread-3): finished collecting timing info
2021-05-31 14:30:47.006072 (Thread-1): finished collecting timing info
2021-05-31 14:30:47.031057 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:30:47.034750 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:30:47.036341 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:30:47.037210 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:30:47.037312 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 14:30:47.037403 (Thread-2): Opening a new connection, currently in state init
2021-05-31 14:30:47.039118 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:30:47.039239 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 14:30:47.039331 (Thread-3): Opening a new connection, currently in state init
2021-05-31 14:30:47.041042 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:30:47.041157 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 14:30:47.041305 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 14:30:48.532375 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-31 14:30:48.532631 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:30:48.532783 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 14:30:48.698372 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 14:30:48.698532 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:30:48.698626 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,

sum(amount) as total_amount
from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 14:30:49.336678 (Thread-2): SQL status: SUCCESS 1 in 2.30 seconds
2021-05-31 14:30:49.336920 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:30:49.337073 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 14:30:50.434558 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2021-05-31 14:30:50.436138 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 14:30:50.436417 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:30:50.436540 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 14:30:50.973944 (Thread-3): SQL status: SUCCESS 1 in 2.28 seconds
2021-05-31 14:30:50.975200 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:30:50.975409 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:30:50.975536 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:30:51.172162 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2021-05-31 14:30:51.183988 (Thread-1): finished collecting timing info
2021-05-31 14:30:51.184158 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 14:30:51.558182 (Thread-3): SQL status: SUCCESS 1 in 0.58 seconds
2021-05-31 14:30:51.559248 (Thread-3): finished collecting timing info
2021-05-31 14:30:51.559472 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 14:30:51.909939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaefd2a60>]}
2021-05-31 14:30:51.910418 (Thread-1): 20:00:51 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 4.92s]
2021-05-31 14:30:51.910607 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 14:30:52.145264 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaed4bb50>]}
2021-05-31 14:30:52.145713 (Thread-3): 20:00:52 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 5.16s]
2021-05-31 14:30:52.145891 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:30:52.621908 (Thread-2): SQL status: SUCCESS 1 in 3.28 seconds
2021-05-31 14:30:52.623310 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:30:52.623559 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:30:52.623709 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:30:53.022263 (Thread-2): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 14:30:53.023310 (Thread-2): finished collecting timing info
2021-05-31 14:30:53.023533 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 14:30:53.639275 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaefdc2e0>]}
2021-05-31 14:30:53.639756 (Thread-2): 20:00:53 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 6.65s]
2021-05-31 14:30:53.639933 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 14:30:53.640637 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 14:30:53.640923 (Thread-5): 20:00:53 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-05-31 14:30:53.641389 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:30:53.641538 (Thread-5): Compiling model.demo_dbt.customers
2021-05-31 14:30:53.644497 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 14:30:53.646594 (Thread-5): finished collecting timing info
2021-05-31 14:30:53.649899 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 14:30:53.653213 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:30:53.653390 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-05-31 14:30:53.653505 (Thread-5): Opening a new connection, currently in state init
2021-05-31 14:30:56.197353 (Thread-5): SQL status: SUCCESS 1 in 2.54 seconds
2021-05-31 14:30:56.197608 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:30:56.197758 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 14:30:57.835465 (Thread-5): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-31 14:30:57.836918 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 14:30:57.837182 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:30:57.837303 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 14:30:58.552428 (Thread-5): SQL status: SUCCESS 1 in 0.71 seconds
2021-05-31 14:30:58.553648 (Thread-5): finished collecting timing info
2021-05-31 14:30:58.553900 (Thread-5): On model.demo_dbt.customers: Close
2021-05-31 14:30:59.681188 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f757cfa7-c467-4cbe-9c08-7c072a387526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaefdc1c0>]}
2021-05-31 14:30:59.681661 (Thread-5): 20:00:59 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 6.04s]
2021-05-31 14:30:59.681841 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 14:30:59.683455 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:30:59.683705 (MainThread): Using snowflake connection "master".
2021-05-31 14:30:59.683829 (MainThread): On master: BEGIN
2021-05-31 14:30:59.683943 (MainThread): Opening a new connection, currently in state closed
2021-05-31 14:31:01.522328 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-31 14:31:01.522601 (MainThread): On master: COMMIT
2021-05-31 14:31:01.522836 (MainThread): Using snowflake connection "master".
2021-05-31 14:31:01.522977 (MainThread): On master: COMMIT
2021-05-31 14:31:06.846131 (MainThread): SQL status: SUCCESS 1 in 5.32 seconds
2021-05-31 14:31:06.846409 (MainThread): On master: Close
2021-05-31 14:31:08.282300 (MainThread): 20:01:08 | 
2021-05-31 14:31:08.282528 (MainThread): 20:01:08 | Finished running 4 table models in 29.26s.
2021-05-31 14:31:08.282674 (MainThread): Connection 'master' was properly closed.
2021-05-31 14:31:08.282780 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 14:31:08.282877 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 14:31:08.282969 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 14:31:08.283059 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 14:31:08.288260 (MainThread): 
2021-05-31 14:31:08.288427 (MainThread): Completed successfully
2021-05-31 14:31:08.288571 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-31 14:31:08.288761 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaee327c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaece1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaefa1b20>]}
2021-05-31 14:31:08.288992 (MainThread): Flushing usage events
2021-05-31 14:38:45.099555 (MainThread): Running with dbt=0.19.1
2021-05-31 14:38:45.844050 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 14:38:45.845784 (MainThread): Tracking: tracking
2021-05-31 14:38:45.846259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9631b10d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9633d546a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9633d54730>]}
2021-05-31 14:38:45.855775 (MainThread): Partial parsing not enabled
2021-05-31 14:38:45.856559 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 14:38:45.858155 (MainThread): Parsing macros/catalog.sql
2021-05-31 14:38:45.860136 (MainThread): Parsing macros/adapters.sql
2021-05-31 14:38:45.886004 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 14:38:45.887752 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 14:38:45.889030 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 14:38:45.892541 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 14:38:45.901197 (MainThread): Parsing macros/core.sql
2021-05-31 14:38:45.904446 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 14:38:45.912024 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 14:38:45.913538 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 14:38:45.929093 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 14:38:45.959904 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 14:38:45.978653 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 14:38:45.980222 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 14:38:45.985486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 14:38:45.997676 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 14:38:46.003838 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 14:38:46.009281 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 14:38:46.013480 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 14:38:46.014355 (MainThread): Parsing macros/etc/query.sql
2021-05-31 14:38:46.015250 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 14:38:46.016632 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 14:38:46.024418 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 14:38:46.026869 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 14:38:46.028340 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 14:38:46.066900 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 14:38:46.068598 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 14:38:46.069907 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 14:38:46.071363 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 14:38:46.077579 (MainThread): Partial parsing not enabled
2021-05-31 14:38:46.095899 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:38:46.103114 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:38:46.107600 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:38:46.110513 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:38:46.242369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33154ee6-c18c-498d-a96e-a510f20cf4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9633d3f670>]}
2021-05-31 14:38:46.247307 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33154ee6-c18c-498d-a96e-a510f20cf4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9633dd9a00>]}
2021-05-31 14:38:46.247551 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 14:38:46.248485 (MainThread): 
2021-05-31 14:38:46.248802 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:38:46.249757 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 14:38:46.263925 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 14:38:46.264060 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 14:38:46.264157 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 14:38:47.900601 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.64 seconds
2021-05-31 14:38:47.905044 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 14:38:48.473791 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:38:48.481550 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:38:48.481673 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 14:38:48.481770 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 14:38:49.568698 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.09 seconds
2021-05-31 14:38:49.570086 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 14:38:50.195263 (MainThread): Using snowflake connection "master".
2021-05-31 14:38:50.195451 (MainThread): On master: BEGIN
2021-05-31 14:38:50.195573 (MainThread): Opening a new connection, currently in state init
2021-05-31 14:38:52.059267 (MainThread): SQL status: SUCCESS 1 in 1.86 seconds
2021-05-31 14:38:52.059535 (MainThread): On master: COMMIT
2021-05-31 14:38:52.059773 (MainThread): Using snowflake connection "master".
2021-05-31 14:38:52.059909 (MainThread): On master: COMMIT
2021-05-31 14:38:52.530944 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-31 14:38:52.531223 (MainThread): On master: Close
2021-05-31 14:38:53.164597 (MainThread): 20:08:53 | Concurrency: 10 threads (target='dev')
2021-05-31 14:38:53.164836 (MainThread): 20:08:53 | 
2021-05-31 14:38:53.167248 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 14:38:53.167606 (Thread-1): 20:08:53 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 14:38:53.167813 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 14:38:53.168115 (Thread-2): 20:08:53 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 14:38:53.168719 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:38:53.169047 (Thread-3): 20:08:53 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 14:38:53.169359 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:38:53.169701 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:38:53.169830 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 14:38:53.170095 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:38:53.170244 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 14:38:53.171590 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:38:53.171738 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 14:38:53.173087 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:38:53.177038 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:38:53.177418 (Thread-1): finished collecting timing info
2021-05-31 14:38:53.207211 (Thread-2): finished collecting timing info
2021-05-31 14:38:53.214001 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:38:53.217903 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:38:53.218144 (Thread-3): finished collecting timing info
2021-05-31 14:38:53.219923 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:38:53.220487 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:38:53.220592 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 14:38:53.220683 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 14:38:53.222531 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:38:53.223012 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:38:53.223087 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 14:38:53.223254 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 14:38:53.223364 (Thread-3): Opening a new connection, currently in state init
2021-05-31 14:38:53.223451 (Thread-2): Opening a new connection, currently in state init
2021-05-31 14:38:54.910084 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-31 14:38:54.910334 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:38:54.910478 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 14:38:54.926845 (Thread-3): SQL status: SUCCESS 1 in 1.70 seconds
2021-05-31 14:38:54.927089 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:38:54.927229 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 14:38:54.990074 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2021-05-31 14:38:54.990313 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:38:54.990449 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 14:38:55.430650 (Thread-1): Snowflake query id: 019c9dae-0000-43e2-0000-b0b1000210d2
2021-05-31 14:38:55.430870 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 14:38:55.431094 (Thread-1): finished collecting timing info
2021-05-31 14:38:55.431302 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 14:38:55.634935 (Thread-2): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-31 14:38:55.636393 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:38:55.636597 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:38:55.636715 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:38:55.751549 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 14:38:55.868879 (Thread-3): SQL status: SUCCESS 1 in 0.94 seconds
2021-05-31 14:38:55.870183 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:38:55.870389 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:38:55.870505 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:38:55.924122 (Thread-2): SQL status: SUCCESS 1 in 0.29 seconds
2021-05-31 14:38:55.935919 (Thread-2): finished collecting timing info
2021-05-31 14:38:55.936089 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 14:38:56.317970 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 14:38:56.321176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33154ee6-c18c-498d-a96e-a510f20cf4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9634379040>]}
2021-05-31 14:38:56.321555 (Thread-1): 20:08:56 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.15s]
2021-05-31 14:38:56.321729 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 14:38:56.334484 (Thread-3): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-31 14:38:56.335472 (Thread-3): finished collecting timing info
2021-05-31 14:38:56.335651 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 14:38:56.646649 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33154ee6-c18c-498d-a96e-a510f20cf4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96343930d0>]}
2021-05-31 14:38:56.647145 (Thread-2): 20:08:56 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.48s]
2021-05-31 14:38:56.647320 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 14:38:56.647701 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 14:38:56.647886 (Thread-5): 20:08:56 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 14:38:56.648062 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 14:38:57.055136 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33154ee6-c18c-498d-a96e-a510f20cf4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96343a5f70>]}
2021-05-31 14:38:57.055599 (Thread-3): 20:08:57 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 3.89s]
2021-05-31 14:38:57.055776 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:38:57.057432 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:38:57.057685 (MainThread): Using snowflake connection "master".
2021-05-31 14:38:57.057805 (MainThread): On master: BEGIN
2021-05-31 14:38:57.057931 (MainThread): Opening a new connection, currently in state closed
2021-05-31 14:38:58.364990 (MainThread): SQL status: SUCCESS 1 in 1.31 seconds
2021-05-31 14:38:58.365260 (MainThread): On master: COMMIT
2021-05-31 14:38:58.365488 (MainThread): Using snowflake connection "master".
2021-05-31 14:38:58.365625 (MainThread): On master: COMMIT
2021-05-31 14:38:58.998570 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-05-31 14:38:58.998850 (MainThread): On master: Close
2021-05-31 14:38:59.615111 (MainThread): 20:08:59 | 
2021-05-31 14:38:59.615338 (MainThread): 20:08:59 | Finished running 4 table models in 13.37s.
2021-05-31 14:38:59.615483 (MainThread): Connection 'master' was properly closed.
2021-05-31 14:38:59.615587 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 14:38:59.615682 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 14:38:59.615773 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 14:38:59.620732 (MainThread): 
2021-05-31 14:38:59.620889 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 14:38:59.621023 (MainThread): 
2021-05-31 14:38:59.621151 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 14:38:59.621266 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 14:38:59.621461 (MainThread):   invalid identifier 'ID'
2021-05-31 14:38:59.621598 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 14:38:59.621729 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-05-31 14:38:59.621924 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9633fe5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96343712e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96341b4970>]}
2021-05-31 14:38:59.622146 (MainThread): Flushing usage events
2021-05-31 14:39:22.186335 (MainThread): Running with dbt=0.19.1
2021-05-31 14:39:22.919209 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 14:39:22.920733 (MainThread): Tracking: tracking
2021-05-31 14:39:22.921179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3f316f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40f945b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40f94640>]}
2021-05-31 14:39:22.931729 (MainThread): Partial parsing not enabled
2021-05-31 14:39:22.932560 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 14:39:22.934443 (MainThread): Parsing macros/catalog.sql
2021-05-31 14:39:22.936428 (MainThread): Parsing macros/adapters.sql
2021-05-31 14:39:22.961311 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 14:39:22.963005 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 14:39:22.964393 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 14:39:22.968188 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 14:39:22.976504 (MainThread): Parsing macros/core.sql
2021-05-31 14:39:22.979710 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 14:39:22.987196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 14:39:22.988769 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 14:39:23.004624 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 14:39:23.035433 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 14:39:23.053992 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 14:39:23.055546 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 14:39:23.060740 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 14:39:23.073286 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 14:39:23.079256 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 14:39:23.084838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 14:39:23.088997 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 14:39:23.089794 (MainThread): Parsing macros/etc/query.sql
2021-05-31 14:39:23.090675 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 14:39:23.092040 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 14:39:23.099733 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 14:39:23.101500 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 14:39:23.102927 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 14:39:23.140956 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 14:39:23.142545 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 14:39:23.143830 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 14:39:23.145272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 14:39:23.151566 (MainThread): Partial parsing not enabled
2021-05-31 14:39:23.169735 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:39:23.176738 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:39:23.181322 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:39:23.184241 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:39:23.310126 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41174a90>]}
2021-05-31 14:39:23.315000 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41018a60>]}
2021-05-31 14:39:23.315230 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 14:39:23.316171 (MainThread): 
2021-05-31 14:39:23.316484 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:39:23.317433 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 14:39:23.331199 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 14:39:23.331348 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 14:39:23.331447 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 14:39:24.803351 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.47 seconds
2021-05-31 14:39:24.807409 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 14:39:25.343450 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:39:25.350852 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 14:39:25.350978 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 14:39:25.351076 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 14:39:26.598030 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.25 seconds
2021-05-31 14:39:26.599566 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 14:39:27.262979 (MainThread): Using snowflake connection "master".
2021-05-31 14:39:27.263178 (MainThread): On master: BEGIN
2021-05-31 14:39:27.263291 (MainThread): Opening a new connection, currently in state init
2021-05-31 14:39:28.644543 (MainThread): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-31 14:39:28.644814 (MainThread): On master: COMMIT
2021-05-31 14:39:28.645053 (MainThread): Using snowflake connection "master".
2021-05-31 14:39:28.645188 (MainThread): On master: COMMIT
2021-05-31 14:39:29.000572 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 14:39:29.000835 (MainThread): On master: Close
2021-05-31 14:39:29.719816 (MainThread): 20:09:29 | Concurrency: 10 threads (target='dev')
2021-05-31 14:39:29.720040 (MainThread): 20:09:29 | 
2021-05-31 14:39:29.722292 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 14:39:29.722628 (Thread-1): 20:09:29 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 14:39:29.722833 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 14:39:29.723139 (Thread-2): 20:09:29 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 14:39:29.723330 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:39:29.723935 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:39:29.724237 (Thread-3): 20:09:29 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 14:39:29.724373 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 14:39:29.724681 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:39:29.725002 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:39:29.726318 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:39:29.726463 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 14:39:29.726594 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 14:39:29.727989 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:39:29.731659 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:39:29.731985 (Thread-1): finished collecting timing info
2021-05-31 14:39:29.738047 (Thread-3): finished collecting timing info
2021-05-31 14:39:29.748448 (Thread-2): finished collecting timing info
2021-05-31 14:39:29.789601 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 14:39:29.792773 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 14:39:29.794865 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 14:39:29.795679 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:39:29.795816 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 14:39:29.796092 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 14:39:29.797747 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:39:29.798390 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:39:29.798477 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 14:39:29.798715 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 14:39:29.799125 (Thread-2): Opening a new connection, currently in state init
2021-05-31 14:39:29.799243 (Thread-3): Opening a new connection, currently in state init
2021-05-31 14:39:31.138395 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-31 14:39:31.138651 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:39:31.138793 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 14:39:31.242978 (Thread-3): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-31 14:39:31.243221 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:39:31.243367 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 14:39:31.463201 (Thread-2): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 14:39:31.463472 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:39:31.463613 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 14:39:32.278588 (Thread-3): SQL status: SUCCESS 1 in 1.04 seconds
2021-05-31 14:39:32.280201 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:39:32.280458 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 14:39:32.280605 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 14:39:32.489995 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-31 14:39:32.491416 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 14:39:32.491666 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 14:39:32.491784 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 14:39:32.564877 (Thread-3): SQL status: SUCCESS 1 in 0.28 seconds
2021-05-31 14:39:32.576754 (Thread-3): finished collecting timing info
2021-05-31 14:39:32.576949 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 14:39:32.580288 (Thread-2): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-31 14:39:32.581255 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:39:32.581633 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 14:39:32.581753 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 14:39:32.790268 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 14:39:32.791357 (Thread-1): finished collecting timing info
2021-05-31 14:39:32.791583 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 14:39:33.098933 (Thread-2): SQL status: SUCCESS 1 in 0.52 seconds
2021-05-31 14:39:33.100021 (Thread-2): finished collecting timing info
2021-05-31 14:39:33.100247 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 14:39:33.225547 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a412a59d0>]}
2021-05-31 14:39:33.226014 (Thread-3): 20:09:33 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 3.50s]
2021-05-31 14:39:33.226204 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 14:39:33.434077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41470f10>]}
2021-05-31 14:39:33.434510 (Thread-1): 20:09:33 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 3.71s]
2021-05-31 14:39:33.434674 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 14:39:33.657772 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4147a820>]}
2021-05-31 14:39:33.658228 (Thread-2): 20:09:33 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.93s]
2021-05-31 14:39:33.658401 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 14:39:33.659021 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 14:39:33.659417 (Thread-5): 20:09:33 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-05-31 14:39:33.659775 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 14:39:33.659917 (Thread-5): Compiling model.demo_dbt.customers
2021-05-31 14:39:33.662794 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 14:39:33.663260 (Thread-5): finished collecting timing info
2021-05-31 14:39:33.665622 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 14:39:33.667543 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:39:33.667657 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-05-31 14:39:33.667756 (Thread-5): Opening a new connection, currently in state init
2021-05-31 14:39:35.199418 (Thread-5): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-31 14:39:35.199666 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:39:35.199813 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 14:39:36.168240 (Thread-5): SQL status: SUCCESS 1 in 0.97 seconds
2021-05-31 14:39:36.169588 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 14:39:36.169788 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 14:39:36.169903 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 14:39:36.477647 (Thread-5): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-31 14:39:36.478732 (Thread-5): finished collecting timing info
2021-05-31 14:39:36.478959 (Thread-5): On model.demo_dbt.customers: Close
2021-05-31 14:39:37.170933 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6922d11-4f04-40fb-a9be-2695398bd3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41740640>]}
2021-05-31 14:39:37.171393 (Thread-5): 20:09:37 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 3.51s]
2021-05-31 14:39:37.171570 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 14:39:37.173127 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 14:39:37.173373 (MainThread): Using snowflake connection "master".
2021-05-31 14:39:37.173496 (MainThread): On master: BEGIN
2021-05-31 14:39:37.173603 (MainThread): Opening a new connection, currently in state closed
2021-05-31 14:39:38.670780 (MainThread): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-31 14:39:38.671048 (MainThread): On master: COMMIT
2021-05-31 14:39:38.671274 (MainThread): Using snowflake connection "master".
2021-05-31 14:39:38.671410 (MainThread): On master: COMMIT
2021-05-31 14:39:39.035466 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 14:39:39.035743 (MainThread): On master: Close
2021-05-31 14:39:39.653155 (MainThread): 20:09:39 | 
2021-05-31 14:39:39.653383 (MainThread): 20:09:39 | Finished running 4 table models in 16.34s.
2021-05-31 14:39:39.653526 (MainThread): Connection 'master' was properly closed.
2021-05-31 14:39:39.653630 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 14:39:39.653724 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 14:39:39.653815 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 14:39:39.653903 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 14:39:39.658987 (MainThread): 
2021-05-31 14:39:39.659149 (MainThread): Completed successfully
2021-05-31 14:39:39.659293 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-31 14:39:39.659489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41224400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41233fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a414adbe0>]}
2021-05-31 14:39:39.659725 (MainThread): Flushing usage events
2021-05-31 15:27:01.095277 (MainThread): Running with dbt=0.19.1
2021-05-31 15:27:02.369359 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 15:27:02.371724 (MainThread): Tracking: tracking
2021-05-31 15:27:02.372297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9840dd0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9843352610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98433526a0>]}
2021-05-31 15:27:02.383172 (MainThread): Partial parsing not enabled
2021-05-31 15:27:02.384481 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 15:27:02.388022 (MainThread): Parsing macros/catalog.sql
2021-05-31 15:27:02.389866 (MainThread): Parsing macros/adapters.sql
2021-05-31 15:27:02.416109 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 15:27:02.417866 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 15:27:02.419120 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 15:27:02.422494 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 15:27:02.431979 (MainThread): Parsing macros/core.sql
2021-05-31 15:27:02.435747 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 15:27:02.444626 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 15:27:02.446265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 15:27:02.462131 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 15:27:02.493043 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 15:27:02.511374 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 15:27:02.512922 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 15:27:02.518981 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 15:27:02.531269 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 15:27:02.537186 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 15:27:02.542615 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 15:27:02.546897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 15:27:02.547707 (MainThread): Parsing macros/etc/query.sql
2021-05-31 15:27:02.548686 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 15:27:02.550071 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 15:27:02.557632 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 15:27:02.559303 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 15:27:02.560725 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 15:27:02.599053 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 15:27:02.600641 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 15:27:02.601922 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 15:27:02.603375 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 15:27:02.609576 (MainThread): Partial parsing not enabled
2021-05-31 15:27:02.627532 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:02.634810 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:02.646727 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:02.650406 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:02.783768 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b83db5-a893-4364-9d3e-4bb991b07867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9843554f10>]}
2021-05-31 15:27:02.789083 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b83db5-a893-4364-9d3e-4bb991b07867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98435540a0>]}
2021-05-31 15:27:02.789354 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 15:27:02.790329 (MainThread): 
2021-05-31 15:27:02.790668 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 15:27:02.791663 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 15:27:02.799268 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 15:27:02.799430 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 15:27:02.799533 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 15:27:04.534423 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.73 seconds
2021-05-31 15:27:04.538736 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 15:27:05.458571 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 15:27:05.465896 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 15:27:05.466020 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 15:27:05.466116 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 15:27:07.093764 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.63 seconds
2021-05-31 15:27:07.095234 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 15:27:08.119189 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:08.119371 (MainThread): On master: BEGIN
2021-05-31 15:27:08.119483 (MainThread): Opening a new connection, currently in state init
2021-05-31 15:27:09.655328 (MainThread): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-31 15:27:09.655598 (MainThread): On master: COMMIT
2021-05-31 15:27:09.655850 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:09.655989 (MainThread): On master: COMMIT
2021-05-31 15:27:10.165335 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 15:27:10.165605 (MainThread): On master: Close
2021-05-31 15:27:10.884468 (MainThread): 20:57:10 | Concurrency: 10 threads (target='dev')
2021-05-31 15:27:10.884690 (MainThread): 20:57:10 | 
2021-05-31 15:27:10.886925 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 15:27:10.887092 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 15:27:10.887291 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:10.887551 (Thread-1): 20:57:10 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 15:27:10.888093 (Thread-2): 20:57:10 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 15:27:10.888305 (Thread-3): 20:57:10 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 15:27:10.888616 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:10.889021 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:10.889293 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:10.889396 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 15:27:10.889505 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 15:27:10.889607 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:10.890763 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 15:27:10.891994 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 15:27:10.895911 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:10.896238 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-05-31 15:27:10.896355 (Thread-3): Opening a new connection, currently in state init
2021-05-31 15:27:10.897872 (Thread-2): finished collecting timing info
2021-05-31 15:27:10.904163 (Thread-1): finished collecting timing info
2021-05-31 15:27:10.948898 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 15:27:10.953055 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 15:27:10.954003 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:10.954104 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 15:27:10.954191 (Thread-2): Opening a new connection, currently in state init
2021-05-31 15:27:10.955715 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:10.955820 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 15:27:10.955904 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 15:27:12.419979 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-05-31 15:27:12.420261 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:12.420398 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 15:27:12.773357 (Thread-1): Snowflake query id: 019c9ddf-0000-43e3-0000-b0b1000220fa
2021-05-31 15:27:12.773575 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 15:27:12.773797 (Thread-1): finished collecting timing info
2021-05-31 15:27:12.774008 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 15:27:12.933300 (Thread-2): SQL status: SUCCESS 1 in 1.98 seconds
2021-05-31 15:27:12.933540 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:12.933699 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 15:27:13.123185 (Thread-3): SQL status: SUCCESS 4 in 2.23 seconds
2021-05-31 15:27:13.124146 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 15:27:13.126066 (Thread-3): finished collecting timing info
2021-05-31 15:27:13.128803 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 15:27:13.129954 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:13.130082 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 15:27:13.163466 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 15:27:13.546722 (Thread-3): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-31 15:27:13.547019 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:13.547153 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 15:27:13.853340 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 15:27:13.859800 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b83db5-a893-4364-9d3e-4bb991b07867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9844821910>]}
2021-05-31 15:27:13.860320 (Thread-1): 20:57:13 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.97s]
2021-05-31 15:27:13.860542 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 15:27:13.952462 (Thread-2): SQL status: SUCCESS 1 in 1.02 seconds
2021-05-31 15:27:13.953737 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 15:27:13.953928 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:13.954039 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 15:27:14.466212 (Thread-2): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 15:27:14.477236 (Thread-2): finished collecting timing info
2021-05-31 15:27:14.477398 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 15:27:14.672521 (Thread-3): SQL status: SUCCESS 1 in 1.13 seconds
2021-05-31 15:27:14.673908 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 15:27:14.674145 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:14.674295 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 15:27:14.972446 (Thread-3): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 15:27:14.974163 (Thread-3): finished collecting timing info
2021-05-31 15:27:14.974365 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 15:27:15.044482 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b83db5-a893-4364-9d3e-4bb991b07867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9843557250>]}
2021-05-31 15:27:15.045006 (Thread-2): 20:57:15 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 4.16s]
2021-05-31 15:27:15.045189 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 15:27:15.045560 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 15:27:15.045764 (Thread-5): 20:57:15 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 15:27:15.045920 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 15:27:15.594613 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b83db5-a893-4364-9d3e-4bb991b07867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984488cdc0>]}
2021-05-31 15:27:15.595056 (Thread-3): 20:57:15 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 4.71s]
2021-05-31 15:27:15.595223 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:15.596895 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 15:27:15.597132 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:15.597243 (MainThread): On master: BEGIN
2021-05-31 15:27:15.597346 (MainThread): Opening a new connection, currently in state closed
2021-05-31 15:27:16.822185 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 15:27:16.822450 (MainThread): On master: COMMIT
2021-05-31 15:27:16.822675 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:16.822809 (MainThread): On master: COMMIT
2021-05-31 15:27:17.435659 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-31 15:27:17.435937 (MainThread): On master: Close
2021-05-31 15:27:18.256952 (MainThread): 20:57:18 | 
2021-05-31 15:27:18.257170 (MainThread): 20:57:18 | Finished running 4 table models in 15.47s.
2021-05-31 15:27:18.257308 (MainThread): Connection 'master' was properly closed.
2021-05-31 15:27:18.257408 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 15:27:18.257500 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 15:27:18.257588 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 15:27:18.262439 (MainThread): 
2021-05-31 15:27:18.262585 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 15:27:18.262707 (MainThread): 
2021-05-31 15:27:18.262824 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 15:27:18.262929 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 15:27:18.263025 (MainThread):   invalid identifier 'ID'
2021-05-31 15:27:18.263118 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 15:27:18.263227 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-05-31 15:27:18.263387 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98434e5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984485c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984486c370>]}
2021-05-31 15:27:18.263590 (MainThread): Flushing usage events
2021-05-31 15:27:37.795127 (MainThread): Running with dbt=0.19.1
2021-05-31 15:27:38.526004 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 15:27:38.527553 (MainThread): Tracking: tracking
2021-05-31 15:27:38.528008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4a210d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4cf53640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4cf536d0>]}
2021-05-31 15:27:38.537701 (MainThread): Partial parsing not enabled
2021-05-31 15:27:38.538513 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 15:27:38.541572 (MainThread): Parsing macros/catalog.sql
2021-05-31 15:27:38.543355 (MainThread): Parsing macros/adapters.sql
2021-05-31 15:27:38.575413 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 15:27:38.578546 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 15:27:38.580410 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 15:27:38.585158 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 15:27:38.594255 (MainThread): Parsing macros/core.sql
2021-05-31 15:27:38.597689 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 15:27:38.605498 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 15:27:38.607056 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 15:27:38.623154 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 15:27:38.654784 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 15:27:38.673491 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 15:27:38.675082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 15:27:38.680576 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 15:27:38.692863 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 15:27:38.698873 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 15:27:38.704292 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 15:27:38.708492 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 15:27:38.709293 (MainThread): Parsing macros/etc/query.sql
2021-05-31 15:27:38.710190 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 15:27:38.711566 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 15:27:38.719897 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 15:27:38.721566 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 15:27:38.722991 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 15:27:38.761868 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 15:27:38.763598 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 15:27:38.764968 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 15:27:38.766427 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 15:27:38.772723 (MainThread): Partial parsing not enabled
2021-05-31 15:27:38.790996 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:38.798190 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:38.810341 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:38.814064 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:38.940568 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d765a90>]}
2021-05-31 15:27:38.946052 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d4ecf10>]}
2021-05-31 15:27:38.946283 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 15:27:38.947210 (MainThread): 
2021-05-31 15:27:38.947549 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 15:27:38.948474 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 15:27:38.955431 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 15:27:38.955563 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 15:27:38.955668 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 15:27:40.699665 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.74 seconds
2021-05-31 15:27:40.703989 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 15:27:41.341872 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 15:27:41.349010 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 15:27:41.349137 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 15:27:41.349234 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 15:27:42.830994 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.48 seconds
2021-05-31 15:27:42.832476 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 15:27:43.448444 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:43.448633 (MainThread): On master: BEGIN
2021-05-31 15:27:43.448749 (MainThread): Opening a new connection, currently in state init
2021-05-31 15:27:45.336088 (MainThread): SQL status: SUCCESS 1 in 1.89 seconds
2021-05-31 15:27:45.336358 (MainThread): On master: COMMIT
2021-05-31 15:27:45.336599 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:45.336738 (MainThread): On master: COMMIT
2021-05-31 15:27:45.738750 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 15:27:45.739025 (MainThread): On master: Close
2021-05-31 15:27:46.518546 (MainThread): 20:57:46 | Concurrency: 10 threads (target='dev')
2021-05-31 15:27:46.518772 (MainThread): 20:57:46 | 
2021-05-31 15:27:46.521061 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 15:27:46.521302 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 15:27:46.521561 (Thread-1): 20:57:46 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 15:27:46.521671 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:46.522251 (Thread-2): 20:57:46 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 15:27:46.522607 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:46.522808 (Thread-3): 20:57:46 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 15:27:46.523122 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:46.523263 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 15:27:46.523547 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:46.523702 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 15:27:46.524909 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 15:27:46.525040 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:46.526221 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 15:27:46.530315 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:46.530655 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-05-31 15:27:46.530780 (Thread-3): Opening a new connection, currently in state init
2021-05-31 15:27:46.532148 (Thread-1): finished collecting timing info
2021-05-31 15:27:46.544366 (Thread-2): finished collecting timing info
2021-05-31 15:27:46.567729 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 15:27:46.571568 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 15:27:46.572699 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:46.572804 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 15:27:46.572895 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 15:27:46.574527 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:46.574639 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 15:27:46.574729 (Thread-2): Opening a new connection, currently in state init
2021-05-31 15:27:47.941435 (Thread-2): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-31 15:27:47.941679 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:47.941819 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 15:27:47.953937 (Thread-3): SQL status: SUCCESS 4 in 1.42 seconds
2021-05-31 15:27:47.954866 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 15:27:47.955358 (Thread-3): finished collecting timing info
2021-05-31 15:27:47.957847 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 15:27:47.958723 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:47.958829 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 15:27:48.360544 (Thread-3): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 15:27:48.360786 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:48.360929 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 15:27:48.464463 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-05-31 15:27:48.464704 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:48.464839 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 15:27:49.281965 (Thread-2): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-31 15:27:49.283491 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 15:27:49.283735 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 15:27:49.283886 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 15:27:49.383501 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-05-31 15:27:49.384744 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 15:27:49.384941 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 15:27:49.385057 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 15:27:49.583232 (Thread-2): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-31 15:27:49.594315 (Thread-2): finished collecting timing info
2021-05-31 15:27:49.594481 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 15:27:49.723768 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 15:27:49.724803 (Thread-1): finished collecting timing info
2021-05-31 15:27:49.725026 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 15:27:50.023534 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 15:27:50.024913 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 15:27:50.025158 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 15:27:50.025298 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 15:27:50.177612 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d7e1610>]}
2021-05-31 15:27:50.178070 (Thread-2): 20:57:50 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.65s]
2021-05-31 15:27:50.178251 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 15:27:50.511841 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 15:27:50.512882 (Thread-3): finished collecting timing info
2021-05-31 15:27:50.513060 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 15:27:50.514088 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4e8de430>]}
2021-05-31 15:27:50.515078 (Thread-1): 20:57:50 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 3.99s]
2021-05-31 15:27:50.515265 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 15:27:50.515737 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 15:27:50.516083 (Thread-5): 20:57:50 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-05-31 15:27:50.516467 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:50.516624 (Thread-5): Compiling model.demo_dbt.customers
2021-05-31 15:27:50.519130 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 15:27:50.520676 (Thread-5): finished collecting timing info
2021-05-31 15:27:50.522869 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 15:27:50.524597 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:50.524705 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-05-31 15:27:50.524802 (Thread-5): Opening a new connection, currently in state init
2021-05-31 15:27:51.145208 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d2751c0>]}
2021-05-31 15:27:51.145670 (Thread-3): 20:57:51 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 4.62s]
2021-05-31 15:27:51.145844 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 15:27:51.944289 (Thread-5): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-31 15:27:51.944531 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:51.944673 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 15:27:52.766268 (Thread-5): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-31 15:27:52.767687 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 15:27:52.767936 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 15:27:52.768085 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 15:27:53.096097 (Thread-5): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-31 15:27:53.097158 (Thread-5): finished collecting timing info
2021-05-31 15:27:53.097381 (Thread-5): On model.demo_dbt.customers: Close
2021-05-31 15:27:53.902433 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed7b760-cd99-49ba-b953-2ed83852e211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4e8c2e20>]}
2021-05-31 15:27:53.902868 (Thread-5): 20:57:53 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 3.39s]
2021-05-31 15:27:53.903037 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 15:27:53.904687 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 15:27:53.904930 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:53.905047 (MainThread): On master: BEGIN
2021-05-31 15:27:53.905155 (MainThread): Opening a new connection, currently in state closed
2021-05-31 15:27:55.490677 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-31 15:27:55.490945 (MainThread): On master: COMMIT
2021-05-31 15:27:55.491176 (MainThread): Using snowflake connection "master".
2021-05-31 15:27:55.491313 (MainThread): On master: COMMIT
2021-05-31 15:27:55.849994 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-31 15:27:55.850261 (MainThread): On master: Close
2021-05-31 15:27:56.501016 (MainThread): 20:57:56 | 
2021-05-31 15:27:56.501240 (MainThread): 20:57:56 | Finished running 4 table models in 17.55s.
2021-05-31 15:27:56.501393 (MainThread): Connection 'master' was properly closed.
2021-05-31 15:27:56.501499 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 15:27:56.501591 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 15:27:56.501677 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 15:27:56.501762 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 15:27:56.506304 (MainThread): 
2021-05-31 15:27:56.506450 (MainThread): Completed successfully
2021-05-31 15:27:56.506578 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-31 15:27:56.506748 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d2fc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d2d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4e825850>]}
2021-05-31 15:27:56.506960 (MainThread): Flushing usage events
2021-05-31 16:04:11.061875 (MainThread): Running with dbt=0.19.1
2021-05-31 16:04:12.350845 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 16:04:12.353002 (MainThread): Tracking: tracking
2021-05-31 16:04:12.353697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5697cfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56ba4f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56ba4f7c0>]}
2021-05-31 16:04:12.365235 (MainThread): Partial parsing not enabled
2021-05-31 16:04:12.366125 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 16:04:12.370445 (MainThread): Parsing macros/catalog.sql
2021-05-31 16:04:12.372758 (MainThread): Parsing macros/adapters.sql
2021-05-31 16:04:12.400131 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 16:04:12.401861 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 16:04:12.403119 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 16:04:12.406448 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 16:04:12.415807 (MainThread): Parsing macros/core.sql
2021-05-31 16:04:12.419322 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 16:04:12.426972 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 16:04:12.428478 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 16:04:12.444028 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 16:04:12.475492 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 16:04:12.494789 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 16:04:12.496390 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 16:04:12.501863 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 16:04:12.514163 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 16:04:12.520620 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 16:04:12.526086 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 16:04:12.530292 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 16:04:12.531101 (MainThread): Parsing macros/etc/query.sql
2021-05-31 16:04:12.532005 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 16:04:12.533509 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 16:04:12.541205 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 16:04:12.542928 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 16:04:12.544366 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 16:04:12.583395 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 16:04:12.585105 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 16:04:12.586525 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 16:04:12.587983 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 16:04:12.594304 (MainThread): Partial parsing not enabled
2021-05-31 16:04:12.612475 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:04:12.619675 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:04:12.631682 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 16:04:12.635403 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:04:12.637390 (MainThread): Acquiring new snowflake connection "model.demo_dbt.raw_payments".
2021-05-31 16:04:12.764505 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56ba8a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56ba8a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc56bd90c10>]}
2021-05-31 16:04:12.764771 (MainThread): Flushing usage events
2021-05-31 16:04:14.222249 (MainThread): Connection 'model.demo_dbt.raw_payments' was properly closed.
2021-05-31 16:04:14.222471 (MainThread): Encountered an error:
2021-05-31 16:04:14.222671 (MainThread): Compilation Error
  dbt found two resources with the name "raw_payments". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("raw_payments") is used. To fix this,
  change the name of one of these resources:
  - model.demo_dbt.raw_payments (models/raw_payments.sql)
  - seed.demo_dbt.raw_payments (data/raw_payments.csv)
2021-05-31 16:04:14.229660 (MainThread): Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 445, in load_all
    _check_manifest(manifest, root_config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 558, in _check_manifest
    _check_resource_uniqueness(manifest, config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 535, in _check_resource_uniqueness
    dbt.exceptions.raise_duplicate_resource_name(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 779, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "raw_payments". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("raw_payments") is used. To fix this,
  change the name of one of these resources:
  - model.demo_dbt.raw_payments (models/raw_payments.sql)
  - seed.demo_dbt.raw_payments (data/raw_payments.csv)

2021-05-31 16:04:52.227204 (MainThread): Running with dbt=0.19.1
2021-05-31 16:04:52.962384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 16:04:52.964011 (MainThread): Tracking: tracking
2021-05-31 16:04:52.964531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa11d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f1d54610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f1d546a0>]}
2021-05-31 16:04:52.973926 (MainThread): Partial parsing not enabled
2021-05-31 16:04:52.974656 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 16:04:52.977678 (MainThread): Parsing macros/catalog.sql
2021-05-31 16:04:52.979464 (MainThread): Parsing macros/adapters.sql
2021-05-31 16:04:53.005239 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 16:04:53.006934 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 16:04:53.008164 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 16:04:53.011523 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 16:04:53.020392 (MainThread): Parsing macros/core.sql
2021-05-31 16:04:53.023654 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 16:04:53.031143 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 16:04:53.032617 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 16:04:53.048044 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 16:04:53.079620 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 16:04:53.098519 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 16:04:53.100114 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 16:04:53.105477 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 16:04:53.117797 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 16:04:53.123934 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 16:04:53.129354 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 16:04:53.133569 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 16:04:53.134382 (MainThread): Parsing macros/etc/query.sql
2021-05-31 16:04:53.135263 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 16:04:53.136629 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 16:04:53.144202 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 16:04:53.145868 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 16:04:53.147296 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 16:04:53.185315 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 16:04:53.187035 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 16:04:53.188355 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 16:04:53.189918 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 16:04:53.196218 (MainThread): Partial parsing not enabled
2021-05-31 16:04:53.214503 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:04:53.221797 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:04:53.233842 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 16:04:53.237531 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:04:53.362933 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '229b51f8-c5be-4c01-85d4-e9e4ebf0e451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f1fec4f0>]}
2021-05-31 16:04:53.368539 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '229b51f8-c5be-4c01-85d4-e9e4ebf0e451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f3048ac0>]}
2021-05-31 16:04:53.368836 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 16:04:53.369808 (MainThread): 
2021-05-31 16:04:53.370127 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 16:04:53.371079 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 16:04:53.378048 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 16:04:53.378164 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 16:04:53.378256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 16:04:55.511795 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.13 seconds
2021-05-31 16:04:55.516131 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 16:04:56.172171 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 16:04:56.179397 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 16:04:56.179519 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 16:04:56.179616 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 16:04:58.070931 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.89 seconds
2021-05-31 16:04:58.072417 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 16:04:59.679348 (MainThread): Using snowflake connection "master".
2021-05-31 16:04:59.679529 (MainThread): On master: BEGIN
2021-05-31 16:04:59.679644 (MainThread): Opening a new connection, currently in state init
2021-05-31 16:05:01.143017 (MainThread): SQL status: SUCCESS 1 in 1.46 seconds
2021-05-31 16:05:01.143283 (MainThread): On master: COMMIT
2021-05-31 16:05:01.143524 (MainThread): Using snowflake connection "master".
2021-05-31 16:05:01.143658 (MainThread): On master: COMMIT
2021-05-31 16:05:01.859603 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-31 16:05:01.859874 (MainThread): On master: Close
2021-05-31 16:05:02.567384 (MainThread): 21:35:02 | Concurrency: 10 threads (target='dev')
2021-05-31 16:05:02.567613 (MainThread): 21:35:02 | 
2021-05-31 16:05:02.569881 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 16:05:02.570070 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 16:05:02.570280 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 16:05:02.570565 (Thread-1): 21:35:02 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 16:05:02.571094 (Thread-2): 21:35:02 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 16:05:02.571288 (Thread-3): 21:35:02 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 16:05:02.571589 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:05:02.571849 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:05:02.572054 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 16:05:02.572294 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:05:02.572429 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 16:05:02.573708 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 16:05:02.573864 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 16:05:02.575019 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 16:05:02.578926 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:05:02.579219 (Thread-1): finished collecting timing info
2021-05-31 16:05:02.579324 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-05-31 16:05:02.602213 (Thread-3): Opening a new connection, currently in state init
2021-05-31 16:05:02.608054 (Thread-2): finished collecting timing info
2021-05-31 16:05:02.608188 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 16:05:02.611287 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 16:05:02.612405 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:05:02.612512 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 16:05:02.612602 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 16:05:02.614614 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:05:02.615160 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 16:05:02.615294 (Thread-2): Opening a new connection, currently in state init
2021-05-31 16:05:04.274160 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-05-31 16:05:04.274412 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:05:04.274553 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 16:05:04.634124 (Thread-1): Snowflake query id: 019c9e05-0000-43cf-0000-b0b100023032
2021-05-31 16:05:04.634326 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-05-31 16:05:04.634547 (Thread-1): finished collecting timing info
2021-05-31 16:05:04.634756 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 16:05:04.744377 (Thread-3): SQL status: SUCCESS 4 in 2.14 seconds
2021-05-31 16:05:04.745442 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 16:05:04.746966 (Thread-3): finished collecting timing info
2021-05-31 16:05:04.749691 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 16:05:04.753340 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:05:04.753528 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 16:05:04.973923 (Thread-2): SQL status: SUCCESS 1 in 2.36 seconds
2021-05-31 16:05:04.974163 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:05:04.974298 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 16:05:05.013899 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 16:05:05.083873 (Thread-3): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-31 16:05:05.084110 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:05:05.084246 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 16:05:06.164762 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 16:05:06.170361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '229b51f8-c5be-4c01-85d4-e9e4ebf0e451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f3534f40>]}
2021-05-31 16:05:06.170732 (Thread-1): 21:35:06 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.60s]
2021-05-31 16:05:06.170889 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 16:05:06.672962 (Thread-2): SQL status: SUCCESS 1 in 1.70 seconds
2021-05-31 16:05:06.674218 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 16:05:06.674409 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:05:06.674519 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 16:05:07.389241 (Thread-2): SQL status: SUCCESS 1 in 0.71 seconds
2021-05-31 16:05:07.400319 (Thread-2): finished collecting timing info
2021-05-31 16:05:07.400481 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 16:05:08.004659 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '229b51f8-c5be-4c01-85d4-e9e4ebf0e451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f351cfa0>]}
2021-05-31 16:05:08.005081 (Thread-2): 21:35:08 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 5.43s]
2021-05-31 16:05:08.005252 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 16:05:08.005607 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 16:05:08.005785 (Thread-5): 21:35:08 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 16:05:08.005948 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 16:05:09.418069 (Thread-3): SQL status: SUCCESS 1 in 4.33 seconds
2021-05-31 16:05:09.419515 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 16:05:09.419803 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:05:09.419925 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 16:05:09.831185 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 16:05:09.832241 (Thread-3): finished collecting timing info
2021-05-31 16:05:09.832463 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 16:05:10.693002 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '229b51f8-c5be-4c01-85d4-e9e4ebf0e451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f351cc40>]}
2021-05-31 16:05:10.693509 (Thread-3): 21:35:10 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 8.12s]
2021-05-31 16:05:10.693759 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 16:05:10.695346 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 16:05:10.695595 (MainThread): Using snowflake connection "master".
2021-05-31 16:05:10.695710 (MainThread): On master: BEGIN
2021-05-31 16:05:10.695818 (MainThread): Opening a new connection, currently in state closed
2021-05-31 16:05:12.489484 (MainThread): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-31 16:05:12.489743 (MainThread): On master: COMMIT
2021-05-31 16:05:12.489939 (MainThread): Using snowflake connection "master".
2021-05-31 16:05:12.490047 (MainThread): On master: COMMIT
2021-05-31 16:05:13.269395 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-05-31 16:05:13.269678 (MainThread): On master: Close
2021-05-31 16:05:13.941052 (MainThread): 21:35:13 | 
2021-05-31 16:05:13.941278 (MainThread): 21:35:13 | Finished running 4 table models in 20.57s.
2021-05-31 16:05:13.941422 (MainThread): Connection 'master' was properly closed.
2021-05-31 16:05:13.941525 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 16:05:13.941617 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 16:05:13.941703 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 16:05:13.946810 (MainThread): 
2021-05-31 16:05:13.946958 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 16:05:13.947075 (MainThread): 
2021-05-31 16:05:13.947187 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 16:05:13.947285 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-05-31 16:05:13.947376 (MainThread):   invalid identifier 'ID'
2021-05-31 16:05:13.947463 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 16:05:13.947561 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-05-31 16:05:13.947717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f1efcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f35ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f35ac490>]}
2021-05-31 16:05:13.947912 (MainThread): Flushing usage events
2021-05-31 16:06:10.682122 (MainThread): Running with dbt=0.19.1
2021-05-31 16:06:11.418097 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 16:06:11.419931 (MainThread): Tracking: tracking
2021-05-31 16:06:11.420394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee60fd0d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63b55670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63b55700>]}
2021-05-31 16:06:11.429882 (MainThread): Partial parsing not enabled
2021-05-31 16:06:11.430790 (MainThread): Parsing macros/get_payment_methods.sql
2021-05-31 16:06:11.433845 (MainThread): Parsing macros/catalog.sql
2021-05-31 16:06:11.435888 (MainThread): Parsing macros/adapters.sql
2021-05-31 16:06:11.461533 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 16:06:11.463250 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 16:06:11.464482 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 16:06:11.467775 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 16:06:11.476557 (MainThread): Parsing macros/core.sql
2021-05-31 16:06:11.479813 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 16:06:11.487417 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 16:06:11.489008 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 16:06:11.504524 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 16:06:11.535305 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 16:06:11.554785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 16:06:11.556496 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 16:06:11.561711 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 16:06:11.573929 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 16:06:11.579936 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 16:06:11.585345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 16:06:11.589783 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 16:06:11.590595 (MainThread): Parsing macros/etc/query.sql
2021-05-31 16:06:11.591502 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 16:06:11.592894 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 16:06:11.600547 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 16:06:11.602366 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 16:06:11.603797 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 16:06:11.642243 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 16:06:11.643835 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 16:06:11.645127 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 16:06:11.646589 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 16:06:11.652946 (MainThread): Partial parsing not enabled
2021-05-31 16:06:11.670885 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:06:11.677749 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:11.692085 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 16:06:11.695721 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:06:11.820815 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63d55220>]}
2021-05-31 16:06:11.825829 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63d55cd0>]}
2021-05-31 16:06:11.826056 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-05-31 16:06:11.826947 (MainThread): 
2021-05-31 16:06:11.827252 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 16:06:11.828167 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 16:06:11.835159 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 16:06:11.835276 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 16:06:11.835371 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 16:06:13.538188 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.70 seconds
2021-05-31 16:06:13.542482 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 16:06:14.350320 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 16:06:14.357822 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 16:06:14.357951 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 16:06:14.358051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 16:06:15.997208 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.64 seconds
2021-05-31 16:06:15.998696 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 16:06:16.614190 (MainThread): Using snowflake connection "master".
2021-05-31 16:06:16.614372 (MainThread): On master: BEGIN
2021-05-31 16:06:16.614487 (MainThread): Opening a new connection, currently in state init
2021-05-31 16:06:17.942896 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-31 16:06:17.943168 (MainThread): On master: COMMIT
2021-05-31 16:06:17.943407 (MainThread): Using snowflake connection "master".
2021-05-31 16:06:17.943541 (MainThread): On master: COMMIT
2021-05-31 16:06:18.353493 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 16:06:18.353764 (MainThread): On master: Close
2021-05-31 16:06:18.968771 (MainThread): 21:36:18 | Concurrency: 10 threads (target='dev')
2021-05-31 16:06:18.968992 (MainThread): 21:36:18 | 
2021-05-31 16:06:18.971257 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 16:06:18.971475 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 16:06:18.971764 (Thread-1): 21:36:18 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 16:06:18.971887 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-05-31 16:06:18.972513 (Thread-2): 21:36:18 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-05-31 16:06:18.972813 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:06:18.973042 (Thread-3): 21:36:18 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-05-31 16:06:18.973336 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:06:18.973474 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 16:06:18.973762 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:18.973886 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 16:06:18.975058 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 16:06:18.975208 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-05-31 16:06:18.976437 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 16:06:18.980626 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:18.980904 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-05-31 16:06:18.981045 (Thread-1): finished collecting timing info
2021-05-31 16:06:18.981154 (Thread-3): Opening a new connection, currently in state init
2021-05-31 16:06:18.999193 (Thread-2): finished collecting timing info
2021-05-31 16:06:19.022663 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 16:06:19.023253 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 16:06:19.024683 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:06:19.024787 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 16:06:19.024874 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 16:06:19.025909 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:06:19.026015 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 16:06:19.026106 (Thread-2): Opening a new connection, currently in state init
2021-05-31 16:06:20.653352 (Thread-2): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-31 16:06:20.653606 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:06:20.653747 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-05-31 16:06:20.673476 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-05-31 16:06:20.674374 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:06:20.674640 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 16:06:21.023242 (Thread-3): SQL status: SUCCESS 4 in 2.04 seconds
2021-05-31 16:06:21.024166 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 16:06:21.024665 (Thread-3): finished collecting timing info
2021-05-31 16:06:21.027198 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-05-31 16:06:21.028121 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:21.028234 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-05-31 16:06:21.425241 (Thread-3): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 16:06:21.425480 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:21.425618 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-05-31 16:06:21.452994 (Thread-2): SQL status: SUCCESS 1 in 0.80 seconds
2021-05-31 16:06:21.454559 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 16:06:21.454793 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 16:06:21.454932 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-05-31 16:06:21.482808 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-05-31 16:06:21.484201 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 16:06:21.484440 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 16:06:21.484587 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-05-31 16:06:21.833943 (Thread-2): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 16:06:21.845549 (Thread-2): finished collecting timing info
2021-05-31 16:06:21.845713 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 16:06:21.972673 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-31 16:06:21.973740 (Thread-1): finished collecting timing info
2021-05-31 16:06:21.973966 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 16:06:22.454415 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63d59d90>]}
2021-05-31 16:06:22.454893 (Thread-2): 21:36:22 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.48s]
2021-05-31 16:06:22.455075 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 16:06:22.723586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63f49dc0>]}
2021-05-31 16:06:22.724016 (Thread-1): 21:36:22 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 3.75s]
2021-05-31 16:06:22.724181 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 16:06:22.724569 (Thread-5): Began running node model.demo_dbt.customers
2021-05-31 16:06:22.724850 (Thread-5): 21:36:22 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-05-31 16:06:22.725195 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 16:06:22.725332 (Thread-5): Compiling model.demo_dbt.customers
2021-05-31 16:06:22.728020 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 16:06:22.729947 (Thread-5): finished collecting timing info
2021-05-31 16:06:22.732232 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 16:06:22.734038 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 16:06:22.734146 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-05-31 16:06:22.734243 (Thread-5): Opening a new connection, currently in state init
2021-05-31 16:06:23.267631 (Thread-3): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-31 16:06:23.269099 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 16:06:23.269381 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-05-31 16:06:23.269504 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-05-31 16:06:23.581856 (Thread-3): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-31 16:06:23.582931 (Thread-3): finished collecting timing info
2021-05-31 16:06:23.583158 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-05-31 16:06:24.041733 (Thread-5): SQL status: SUCCESS 1 in 1.31 seconds
2021-05-31 16:06:24.041968 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 16:06:24.042104 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 16:06:24.396002 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63f0c4c0>]}
2021-05-31 16:06:24.396447 (Thread-3): 21:36:24 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 5.42s]
2021-05-31 16:06:24.396622 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-05-31 16:06:24.905934 (Thread-5): SQL status: SUCCESS 1 in 0.86 seconds
2021-05-31 16:06:24.907328 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 16:06:24.907571 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 16:06:24.907714 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-05-31 16:06:25.315612 (Thread-5): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 16:06:25.316695 (Thread-5): finished collecting timing info
2021-05-31 16:06:25.316922 (Thread-5): On model.demo_dbt.customers: Close
2021-05-31 16:06:25.989644 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdb1889-8532-4c4b-87fd-6614d488f03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63fcefa0>]}
2021-05-31 16:06:25.990218 (Thread-5): 21:36:25 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 3.26s]
2021-05-31 16:06:25.990497 (Thread-5): Finished running node model.demo_dbt.customers
2021-05-31 16:06:25.992505 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 16:06:25.992876 (MainThread): Using snowflake connection "master".
2021-05-31 16:06:25.993020 (MainThread): On master: BEGIN
2021-05-31 16:06:25.993144 (MainThread): Opening a new connection, currently in state closed
2021-05-31 16:06:27.465993 (MainThread): SQL status: SUCCESS 1 in 1.47 seconds
2021-05-31 16:06:27.466256 (MainThread): On master: COMMIT
2021-05-31 16:06:27.466497 (MainThread): Using snowflake connection "master".
2021-05-31 16:06:27.466635 (MainThread): On master: COMMIT
2021-05-31 16:06:28.387426 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-05-31 16:06:28.387704 (MainThread): On master: Close
2021-05-31 16:06:29.004103 (MainThread): 21:36:29 | 
2021-05-31 16:06:29.004317 (MainThread): 21:36:29 | Finished running 4 table models in 17.18s.
2021-05-31 16:06:29.004458 (MainThread): Connection 'master' was properly closed.
2021-05-31 16:06:29.004559 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 16:06:29.004650 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 16:06:29.004737 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-05-31 16:06:29.004824 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 16:06:29.009582 (MainThread): 
2021-05-31 16:06:29.009727 (MainThread): Completed successfully
2021-05-31 16:06:29.009857 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-31 16:06:29.010030 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee64137970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63ce58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63e5ba60>]}
2021-05-31 16:06:29.010257 (MainThread): Flushing usage events
2021-06-01 07:46:11.922640 (MainThread): Running with dbt=0.19.1
2021-06-01 07:46:13.512499 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-01 07:46:13.514044 (MainThread): Tracking: tracking
2021-06-01 07:46:13.514660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9909fd0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c215640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c2156d0>]}
2021-06-01 07:46:13.527094 (MainThread): Partial parsing not enabled
2021-06-01 07:46:13.528026 (MainThread): Parsing macros/get_payment_methods.sql
2021-06-01 07:46:13.533172 (MainThread): Parsing macros/catalog.sql
2021-06-01 07:46:13.535688 (MainThread): Parsing macros/adapters.sql
2021-06-01 07:46:13.563752 (MainThread): Parsing macros/materializations/merge.sql
2021-06-01 07:46:13.565769 (MainThread): Parsing macros/materializations/view.sql
2021-06-01 07:46:13.567434 (MainThread): Parsing macros/materializations/table.sql
2021-06-01 07:46:13.571640 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-01 07:46:13.583970 (MainThread): Parsing macros/core.sql
2021-06-01 07:46:13.589700 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-01 07:46:13.600169 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-01 07:46:13.602407 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-01 07:46:13.622599 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-01 07:46:13.656206 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-01 07:46:13.675795 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-01 07:46:13.677607 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-01 07:46:13.683309 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-01 07:46:13.696721 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-01 07:46:13.703870 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-01 07:46:13.710836 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-01 07:46:13.716225 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-01 07:46:13.717406 (MainThread): Parsing macros/etc/query.sql
2021-06-01 07:46:13.718731 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-01 07:46:13.720388 (MainThread): Parsing macros/etc/datetime.sql
2021-06-01 07:46:13.728917 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-01 07:46:13.731044 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-01 07:46:13.732925 (MainThread): Parsing macros/adapters/common.sql
2021-06-01 07:46:13.773300 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-01 07:46:13.775193 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-01 07:46:13.776716 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-01 07:46:13.778449 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-01 07:46:13.784973 (MainThread): Partial parsing not enabled
2021-06-01 07:46:13.803688 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:46:13.810904 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:13.824155 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 07:46:13.829513 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:13.964423 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01e6810f-08b3-4d0b-86d0-07636817c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c4abf40>]}
2021-06-01 07:46:13.971136 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01e6810f-08b3-4d0b-86d0-07636817c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c612700>]}
2021-06-01 07:46:13.971439 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-06-01 07:46:13.972744 (MainThread): 
2021-06-01 07:46:13.973233 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 07:46:13.974348 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-06-01 07:46:13.983505 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-06-01 07:46:13.983696 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-06-01 07:46:13.983801 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-01 07:46:16.512825 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.53 seconds
2021-06-01 07:46:16.516431 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-06-01 07:46:17.194913 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 07:46:17.200920 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 07:46:17.201050 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-06-01 07:46:17.201137 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-01 07:46:18.980602 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.78 seconds
2021-06-01 07:46:18.997224 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-06-01 07:46:20.075015 (MainThread): Using snowflake connection "master".
2021-06-01 07:46:20.075191 (MainThread): On master: BEGIN
2021-06-01 07:46:20.075303 (MainThread): Opening a new connection, currently in state init
2021-06-01 07:46:22.259401 (MainThread): SQL status: SUCCESS 1 in 2.18 seconds
2021-06-01 07:46:22.259652 (MainThread): On master: COMMIT
2021-06-01 07:46:22.259894 (MainThread): Using snowflake connection "master".
2021-06-01 07:46:22.260032 (MainThread): On master: COMMIT
2021-06-01 07:46:23.558811 (MainThread): SQL status: SUCCESS 1 in 1.30 seconds
2021-06-01 07:46:23.559080 (MainThread): On master: Close
2021-06-01 07:46:24.150102 (MainThread): 13:16:24 | Concurrency: 10 threads (target='dev')
2021-06-01 07:46:24.150326 (MainThread): 13:16:24 | 
2021-06-01 07:46:24.152562 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-06-01 07:46:24.152860 (Thread-1): 13:16:24 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-06-01 07:46:24.153036 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-06-01 07:46:24.153268 (Thread-2): 13:16:24 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-06-01 07:46:24.153411 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-06-01 07:46:24.153933 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:46:24.154076 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-06-01 07:46:24.155282 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-06-01 07:46:24.155623 (Thread-3): 13:16:24 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-06-01 07:46:24.155936 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:24.156050 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-06-01 07:46:24.157191 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-06-01 07:46:24.157517 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:24.157632 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-06-01 07:46:24.161272 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:24.161389 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-06-01 07:46:24.161490 (Thread-3): Opening a new connection, currently in state init
2021-06-01 07:46:24.163069 (Thread-1): finished collecting timing info
2021-06-01 07:46:24.163210 (Thread-2): finished collecting timing info
2021-06-01 07:46:24.209366 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-06-01 07:46:24.209793 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-06-01 07:46:24.210706 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:24.210808 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-06-01 07:46:24.210897 (Thread-2): Opening a new connection, currently in state init
2021-06-01 07:46:24.211935 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:46:24.212039 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-06-01 07:46:24.212125 (Thread-1): Opening a new connection, currently in state closed
2021-06-01 07:46:25.937451 (Thread-2): SQL status: SUCCESS 1 in 1.73 seconds
2021-06-01 07:46:25.937699 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:25.937843 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-06-01 07:46:26.127334 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2021-06-01 07:46:26.127575 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:46:26.127719 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-06-01 07:46:26.257164 (Thread-3): SQL status: SUCCESS 4 in 2.10 seconds
2021-06-01 07:46:26.258034 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 07:46:26.259302 (Thread-3): finished collecting timing info
2021-06-01 07:46:26.262148 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 07:46:26.263182 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:26.263308 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-06-01 07:46:26.496845 (Thread-1): Snowflake query id: 019ca1b2-0000-43ef-0000-b0b100025022
2021-06-01 07:46:26.497059 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-06-01 07:46:26.497273 (Thread-1): finished collecting timing info
2021-06-01 07:46:26.497479 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-06-01 07:46:27.035573 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-06-01 07:46:27.038157 (Thread-3): SQL status: SUCCESS 1 in 0.77 seconds
2021-06-01 07:46:27.038497 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:27.038634 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-06-01 07:46:27.727627 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-06-01 07:46:27.738736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e6810f-08b3-4d0b-86d0-07636817c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c89fd30>]}
2021-06-01 07:46:27.739097 (Thread-1): 13:16:27 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.58s]
2021-06-01 07:46:27.739268 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-06-01 07:46:30.619403 (Thread-2): SQL status: SUCCESS 1 in 4.68 seconds
2021-06-01 07:46:30.620805 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 07:46:30.621002 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:30.621114 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 07:46:30.944317 (Thread-2): SQL status: SUCCESS 1 in 0.32 seconds
2021-06-01 07:46:30.954760 (Thread-2): finished collecting timing info
2021-06-01 07:46:30.954924 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-06-01 07:46:31.524559 (Thread-3): SQL status: SUCCESS 1 in 4.49 seconds
2021-06-01 07:46:31.526015 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 07:46:31.526253 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:31.526368 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 07:46:31.736665 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e6810f-08b3-4d0b-86d0-07636817c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c3a6940>]}
2021-06-01 07:46:31.737093 (Thread-2): 13:16:31 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 7.58s]
2021-06-01 07:46:31.737261 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-06-01 07:46:31.737621 (Thread-5): Began running node model.demo_dbt.customers
2021-06-01 07:46:31.737800 (Thread-5): 13:16:31 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-06-01 07:46:31.738033 (Thread-5): Finished running node model.demo_dbt.customers
2021-06-01 07:46:31.843844 (Thread-3): SQL status: SUCCESS 1 in 0.32 seconds
2021-06-01 07:46:31.844710 (Thread-3): finished collecting timing info
2021-06-01 07:46:31.844892 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-06-01 07:46:32.456142 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e6810f-08b3-4d0b-86d0-07636817c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c86fd00>]}
2021-06-01 07:46:32.456579 (Thread-3): 13:16:32 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 8.30s]
2021-06-01 07:46:32.456749 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-06-01 07:46:32.458278 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 07:46:32.458519 (MainThread): Using snowflake connection "master".
2021-06-01 07:46:32.458635 (MainThread): On master: BEGIN
2021-06-01 07:46:32.458741 (MainThread): Opening a new connection, currently in state closed
2021-06-01 07:46:34.305930 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2021-06-01 07:46:34.306203 (MainThread): On master: COMMIT
2021-06-01 07:46:34.306435 (MainThread): Using snowflake connection "master".
2021-06-01 07:46:34.306572 (MainThread): On master: COMMIT
2021-06-01 07:46:36.968335 (MainThread): SQL status: SUCCESS 1 in 2.66 seconds
2021-06-01 07:46:36.968603 (MainThread): On master: Close
2021-06-01 07:46:37.732917 (MainThread): 13:16:37 | 
2021-06-01 07:46:37.736903 (MainThread): 13:16:37 | Finished running 4 table models in 23.76s.
2021-06-01 07:46:37.737474 (MainThread): Connection 'master' was properly closed.
2021-06-01 07:46:37.737770 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-06-01 07:46:37.737967 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-06-01 07:46:37.738654 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-06-01 07:46:37.759235 (MainThread): 
2021-06-01 07:46:37.759478 (MainThread): Completed with 1 error and 0 warnings:
2021-06-01 07:46:37.759655 (MainThread): 
2021-06-01 07:46:37.759821 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-06-01 07:46:37.759969 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-06-01 07:46:37.760105 (MainThread):   invalid identifier 'ID'
2021-06-01 07:46:37.760240 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-06-01 07:46:37.760361 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-06-01 07:46:37.760552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c80f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c6a7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c897040>]}
2021-06-01 07:46:37.760785 (MainThread): Flushing usage events
2021-06-01 07:46:57.206281 (MainThread): Running with dbt=0.19.1
2021-06-01 07:46:57.964563 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-01 07:46:57.965899 (MainThread): Tracking: tracking
2021-06-01 07:46:57.966361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedfdf11f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee022565b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee02256640>]}
2021-06-01 07:46:57.975966 (MainThread): Partial parsing not enabled
2021-06-01 07:46:57.976729 (MainThread): Parsing macros/get_payment_methods.sql
2021-06-01 07:46:57.979808 (MainThread): Parsing macros/catalog.sql
2021-06-01 07:46:57.981594 (MainThread): Parsing macros/adapters.sql
2021-06-01 07:46:58.007938 (MainThread): Parsing macros/materializations/merge.sql
2021-06-01 07:46:58.009687 (MainThread): Parsing macros/materializations/view.sql
2021-06-01 07:46:58.010907 (MainThread): Parsing macros/materializations/table.sql
2021-06-01 07:46:58.014582 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-01 07:46:58.023543 (MainThread): Parsing macros/core.sql
2021-06-01 07:46:58.027223 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-01 07:46:58.035144 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-01 07:46:58.036652 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-01 07:46:58.053846 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-01 07:46:58.087299 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-01 07:46:58.106820 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-01 07:46:58.108436 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-01 07:46:58.114101 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-01 07:46:58.127543 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-01 07:46:58.133625 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-01 07:46:58.139376 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-01 07:46:58.143677 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-01 07:46:58.144504 (MainThread): Parsing macros/etc/query.sql
2021-06-01 07:46:58.145425 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-01 07:46:58.146841 (MainThread): Parsing macros/etc/datetime.sql
2021-06-01 07:46:58.154776 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-01 07:46:58.156620 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-01 07:46:58.158135 (MainThread): Parsing macros/adapters/common.sql
2021-06-01 07:46:58.198014 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-01 07:46:58.199690 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-01 07:46:58.201048 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-01 07:46:58.202582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-01 07:46:58.209203 (MainThread): Partial parsing not enabled
2021-06-01 07:46:58.228151 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:46:58.235462 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:46:58.247865 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 07:46:58.251429 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:46:58.376685 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee027519d0>]}
2021-06-01 07:46:58.381397 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0275a640>]}
2021-06-01 07:46:58.381624 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-06-01 07:46:58.382535 (MainThread): 
2021-06-01 07:46:58.382843 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 07:46:58.383741 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-06-01 07:46:58.390559 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-06-01 07:46:58.390684 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-06-01 07:46:58.390782 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-01 07:47:00.579596 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.19 seconds
2021-06-01 07:47:00.583958 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-06-01 07:47:01.431137 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 07:47:01.438582 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 07:47:01.438704 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-06-01 07:47:01.438802 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-01 07:47:03.181847 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.74 seconds
2021-06-01 07:47:03.183334 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-06-01 07:47:04.208404 (MainThread): Using snowflake connection "master".
2021-06-01 07:47:04.208583 (MainThread): On master: BEGIN
2021-06-01 07:47:04.208697 (MainThread): Opening a new connection, currently in state init
2021-06-01 07:47:06.356370 (MainThread): SQL status: SUCCESS 1 in 2.15 seconds
2021-06-01 07:47:06.356636 (MainThread): On master: COMMIT
2021-06-01 07:47:06.356875 (MainThread): Using snowflake connection "master".
2021-06-01 07:47:06.357014 (MainThread): On master: COMMIT
2021-06-01 07:47:06.970262 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-06-01 07:47:06.970531 (MainThread): On master: Close
2021-06-01 07:47:07.995727 (MainThread): 13:17:07 | Concurrency: 10 threads (target='dev')
2021-06-01 07:47:07.995954 (MainThread): 13:17:07 | 
2021-06-01 07:47:07.998174 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-06-01 07:47:07.998389 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-06-01 07:47:07.998645 (Thread-1): 13:17:07 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-06-01 07:47:07.998742 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-06-01 07:47:07.999259 (Thread-2): 13:17:07 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-06-01 07:47:07.999512 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:47:07.999705 (Thread-3): 13:17:07 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-06-01 07:47:07.999965 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:47:08.000114 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-06-01 07:47:08.000308 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-06-01 07:47:08.000526 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:47:08.001642 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-06-01 07:47:08.002723 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-06-01 07:47:08.002846 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-06-01 07:47:08.006975 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:47:08.007101 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-06-01 07:47:08.007205 (Thread-3): Opening a new connection, currently in state init
2021-06-01 07:47:08.007897 (Thread-1): finished collecting timing info
2021-06-01 07:47:08.019759 (Thread-2): finished collecting timing info
2021-06-01 07:47:08.039346 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-06-01 07:47:08.043522 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-06-01 07:47:08.044972 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:47:08.045142 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-06-01 07:47:08.045528 (Thread-2): Opening a new connection, currently in state init
2021-06-01 07:47:08.046346 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:47:08.047035 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-06-01 07:47:08.047821 (Thread-1): Opening a new connection, currently in state closed
2021-06-01 07:47:09.754295 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-06-01 07:47:09.754546 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:47:09.754688 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-06-01 07:47:09.813500 (Thread-2): SQL status: SUCCESS 1 in 1.77 seconds
2021-06-01 07:47:09.813733 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:47:09.813872 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-06-01 07:47:09.883756 (Thread-3): SQL status: SUCCESS 4 in 1.88 seconds
2021-06-01 07:47:09.884823 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 07:47:09.885402 (Thread-3): finished collecting timing info
2021-06-01 07:47:09.887903 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 07:47:09.888875 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:47:09.888975 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-06-01 07:47:10.353252 (Thread-3): SQL status: SUCCESS 1 in 0.46 seconds
2021-06-01 07:47:10.353495 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:47:10.353632 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (

select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-06-01 07:47:10.833012 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-06-01 07:47:10.834555 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-06-01 07:47:10.834813 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 07:47:10.834925 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-06-01 07:47:11.182639 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-06-01 07:47:11.193435 (Thread-1): finished collecting timing info
2021-06-01 07:47:11.193567 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-06-01 07:47:11.532409 (Thread-2): SQL status: SUCCESS 1 in 1.72 seconds
2021-06-01 07:47:11.533799 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 07:47:11.534044 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 07:47:11.534186 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 07:47:11.886473 (Thread-2): SQL status: SUCCESS 1 in 0.35 seconds
2021-06-01 07:47:11.887549 (Thread-2): finished collecting timing info
2021-06-01 07:47:11.887746 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-06-01 07:47:11.889325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0288b1c0>]}
2021-06-01 07:47:11.889833 (Thread-1): 13:17:11 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 3.89s]
2021-06-01 07:47:11.890022 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-06-01 07:47:12.232368 (Thread-3): SQL status: SUCCESS 1 in 1.88 seconds
2021-06-01 07:47:12.233749 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 07:47:12.234000 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 07:47:12.234114 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 07:47:12.705551 (Thread-3): SQL status: SUCCESS 1 in 0.47 seconds
2021-06-01 07:47:12.706590 (Thread-3): finished collecting timing info
2021-06-01 07:47:12.706764 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-06-01 07:47:12.707795 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee02792100>]}
2021-06-01 07:47:12.708179 (Thread-2): 13:17:12 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 4.71s]
2021-06-01 07:47:12.708957 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-06-01 07:47:12.709467 (Thread-5): Began running node model.demo_dbt.customers
2021-06-01 07:47:12.709947 (Thread-5): 13:17:12 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-06-01 07:47:12.710642 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 07:47:12.710766 (Thread-5): Compiling model.demo_dbt.customers
2021-06-01 07:47:12.713040 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-06-01 07:47:12.714489 (Thread-5): finished collecting timing info
2021-06-01 07:47:12.716863 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-06-01 07:47:12.718476 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 07:47:12.718563 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-06-01 07:47:12.718641 (Thread-5): Opening a new connection, currently in state init
2021-06-01 07:47:13.730425 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee027929a0>]}
2021-06-01 07:47:13.730892 (Thread-3): 13:17:13 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 5.73s]
2021-06-01 07:47:13.731068 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-06-01 07:47:14.855101 (Thread-5): SQL status: SUCCESS 1 in 2.14 seconds
2021-06-01 07:47:14.855352 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 07:47:14.855495 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-06-01 07:47:15.776676 (Thread-5): SQL status: SUCCESS 1 in 0.92 seconds
2021-06-01 07:47:15.778066 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-06-01 07:47:15.778307 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 07:47:15.778448 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-06-01 07:47:16.186295 (Thread-5): SQL status: SUCCESS 1 in 0.41 seconds
2021-06-01 07:47:16.187347 (Thread-5): finished collecting timing info
2021-06-01 07:47:16.187571 (Thread-5): On model.demo_dbt.customers: Close
2021-06-01 07:47:17.242794 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3e00b7-c5ed-4498-a69d-1b38d29e1f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee02792e80>]}
2021-06-01 07:47:17.243237 (Thread-5): 13:17:17 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 4.53s]
2021-06-01 07:47:17.243404 (Thread-5): Finished running node model.demo_dbt.customers
2021-06-01 07:47:17.245008 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 07:47:17.245249 (MainThread): Using snowflake connection "master".
2021-06-01 07:47:17.245365 (MainThread): On master: BEGIN
2021-06-01 07:47:17.245475 (MainThread): Opening a new connection, currently in state closed
2021-06-01 07:47:19.565294 (MainThread): SQL status: SUCCESS 1 in 2.32 seconds
2021-06-01 07:47:19.565558 (MainThread): On master: COMMIT
2021-06-01 07:47:19.565791 (MainThread): Using snowflake connection "master".
2021-06-01 07:47:19.565930 (MainThread): On master: COMMIT
2021-06-01 07:47:19.957624 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-06-01 07:47:19.957889 (MainThread): On master: Close
2021-06-01 07:47:21.269161 (MainThread): 13:17:21 | 
2021-06-01 07:47:21.269382 (MainThread): 13:17:21 | Finished running 4 table models in 22.89s.
2021-06-01 07:47:21.269519 (MainThread): Connection 'master' was properly closed.
2021-06-01 07:47:21.269619 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-06-01 07:47:21.269709 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-06-01 07:47:21.269796 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-06-01 07:47:21.269882 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-06-01 07:47:21.274551 (MainThread): 
2021-06-01 07:47:21.274694 (MainThread): Completed successfully
2021-06-01 07:47:21.274823 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-01 07:47:21.274991 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee024f2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee024f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0285a940>]}
2021-06-01 07:47:21.275202 (MainThread): Flushing usage events
2021-06-01 08:41:24.254714 (MainThread): Running with dbt=0.19.1
2021-06-01 08:41:25.439267 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-01 08:41:25.439558 (MainThread): Tracking: tracking
2021-06-01 08:41:25.439680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe197843b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1935d0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1978532b0>]}
2021-06-01 08:41:25.440815 (MainThread): Set downloads directory='/var/folders/8h/pp_mk1p90rxczqlkb_xlg6f00000gp/T/dbt-downloads-ai7vadyp'
2021-06-01 08:41:25.441022 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-01 08:41:27.025240 (MainThread): STDOUT: "b''"
2021-06-01 08:41:27.025730 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-01 08:41:27.026773 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-01 08:41:27.026912 (MainThread): Executing "git rev-parse HEAD"
2021-06-01 08:41:27.041567 (MainThread): STDOUT: "b'909f55977f63b4347425a476f8c8d0a014e920cb\n'"
2021-06-01 08:41:27.042089 (MainThread): STDERR: "b''"
2021-06-01 08:41:27.042573 (MainThread):   Checking out branch 0.1.21.
2021-06-01 08:41:27.042658 (MainThread): Executing "git remote set-branches origin 0.1.21"
2021-06-01 08:41:27.057894 (MainThread): STDOUT: "b''"
2021-06-01 08:41:27.058894 (MainThread): STDERR: "b''"
2021-06-01 08:41:27.059029 (MainThread): Executing "git fetch --tags --depth 1 origin 0.1.21"
2021-06-01 08:41:28.432538 (MainThread): STDOUT: "b''"
2021-06-01 08:41:28.432983 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.1.21     -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n'"
2021-06-01 08:41:28.433465 (MainThread): Executing "git tag --list"
2021-06-01 08:41:28.450382 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n'"
2021-06-01 08:41:28.450888 (MainThread): STDERR: "b''"
2021-06-01 08:41:28.451359 (MainThread): Executing "git reset --hard tags/0.1.21"
2021-06-01 08:41:28.492913 (MainThread): STDOUT: "b'HEAD is now at eeea5cc Merge pull request #113 from fishtown-analytics/fix/cast-in-union-tables\n'"
2021-06-01 08:41:28.493680 (MainThread): STDERR: "b''"
2021-06-01 08:41:28.494129 (MainThread): Executing "git rev-parse HEAD"
2021-06-01 08:41:28.508696 (MainThread): STDOUT: "b'eeea5cccc8c6f135345af819df4604f97df814ad\n'"
2021-06-01 08:41:28.509216 (MainThread): STDERR: "b''"
2021-06-01 08:41:28.509866 (MainThread):   Checked out at eeea5cc.
2021-06-01 08:41:28.511766 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1935d0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe197843e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1978436a0>]}
2021-06-01 08:41:28.512184 (MainThread): Flushing usage events
2021-06-01 08:41:30.005534 (MainThread): Encountered an error:
2021-06-01 08:41:30.005827 (MainThread): Runtime Error
  Invalid config version: 1, expected 2

Error encountered in /var/folders/8h/pp_mk1p90rxczqlkb_xlg6f00000gp/T/dbt-downloads-ai7vadyp/859fd0fa21176efee375a447937f7a46/dbt_project.yml
2021-06-01 08:41:30.012768 (MainThread): Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/deps.py", line 53, in run
    final_deps = resolve_packages(packages, self.config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/resolver.py", line 137, in resolve_packages
    target = final[package].resolved().fetch_metadata(config, renderer)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/base.py", line 85, in fetch_metadata
    self._cached_metadata = self._fetch_metadata(project, renderer)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/git.py", line 82, in _fetch_metadata
    loaded = Project.from_project_root(path, renderer)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 632, in from_project_root
    partial = cls.partial_load(project_root, verify_version=verify_version)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 599, in partial_load
    return PartialProject.from_project_root(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 452, in from_project_root
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Invalid config version: 1, expected 2

Error encountered in /var/folders/8h/pp_mk1p90rxczqlkb_xlg6f00000gp/T/dbt-downloads-ai7vadyp/859fd0fa21176efee375a447937f7a46/dbt_project.yml

2021-06-01 08:43:03.415260 (MainThread): Running with dbt=0.19.1
2021-06-01 08:43:04.253830 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-01 08:43:04.254099 (MainThread): Tracking: tracking
2021-06-01 08:43:04.254218 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b6583ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b4c51f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b6592190>]}
2021-06-01 08:43:04.255101 (MainThread): Set downloads directory='/var/folders/8h/pp_mk1p90rxczqlkb_xlg6f00000gp/T/dbt-downloads-0c8lazuk'
2021-06-01 08:43:04.255301 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-06-01 08:43:04.750005 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-06-01 08:43:04.750324 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-01 08:43:05.130554 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-01 08:43:05.132503 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.5.json
2021-06-01 08:43:05.510006 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.5.json 200
2021-06-01 08:43:05.510330 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-01 08:43:05.879980 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-01 08:43:05.881894 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.5.json
2021-06-01 08:43:06.249042 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.5.json 200
2021-06-01 08:43:06.249403 (MainThread): Installing fishtown-analytics/dbt_utils@0.6.5
2021-06-01 08:43:07.090854 (MainThread):   Installed from version 0.6.5

2021-06-01 08:43:07.091149 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a57300ee-b55f-44bd-a2e4-f6f0c0e9e7de', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aefa65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b6b27670>]}
2021-06-01 08:43:07.092181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b65f64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b4c51f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aefa65b0>]}
2021-06-01 08:43:07.092464 (MainThread): Flushing usage events
2021-06-01 08:45:51.306860 (MainThread): Running with dbt=0.19.1
2021-06-01 08:45:52.047244 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-01 08:45:52.048635 (MainThread): Tracking: tracking
2021-06-01 08:45:52.049184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba410be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc1536d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc153760>]}
2021-06-01 08:45:52.063642 (MainThread): Partial parsing not enabled
2021-06-01 08:45:52.064411 (MainThread): Parsing macros/get_payment_methods.sql
2021-06-01 08:45:52.067991 (MainThread): Parsing macros/catalog.sql
2021-06-01 08:45:52.069767 (MainThread): Parsing macros/adapters.sql
2021-06-01 08:45:52.095394 (MainThread): Parsing macros/materializations/merge.sql
2021-06-01 08:45:52.097056 (MainThread): Parsing macros/materializations/view.sql
2021-06-01 08:45:52.098271 (MainThread): Parsing macros/materializations/table.sql
2021-06-01 08:45:52.101481 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-01 08:45:52.111350 (MainThread): Parsing macros/core.sql
2021-06-01 08:45:52.115141 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-01 08:45:52.124085 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-01 08:45:52.125661 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-01 08:45:52.141055 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-01 08:45:52.171911 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-01 08:45:52.190440 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-01 08:45:52.192050 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-01 08:45:52.197217 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-01 08:45:52.209735 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-01 08:45:52.215571 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-01 08:45:52.220931 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-01 08:45:52.225250 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-01 08:45:52.226065 (MainThread): Parsing macros/etc/query.sql
2021-06-01 08:45:52.226964 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-01 08:45:52.228353 (MainThread): Parsing macros/etc/datetime.sql
2021-06-01 08:45:52.236258 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-01 08:45:52.237932 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-01 08:45:52.239438 (MainThread): Parsing macros/adapters/common.sql
2021-06-01 08:45:52.277482 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-01 08:45:52.279073 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-01 08:45:52.280371 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-01 08:45:52.281820 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-01 08:45:52.285374 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-01 08:45:52.286429 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-01 08:45:52.287654 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-01 08:45:52.289896 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-01 08:45:52.295550 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-01 08:45:52.296582 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-01 08:45:52.298080 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-01 08:45:52.300261 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-01 08:45:52.301315 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-01 08:45:52.303459 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-01 08:45:52.312426 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-01 08:45:52.314199 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-01 08:45:52.315567 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-06-01 08:45:52.317072 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-01 08:45:52.318654 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-01 08:45:52.320147 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-01 08:45:52.321097 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-01 08:45:52.324205 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-01 08:45:52.328969 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-01 08:45:52.329699 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-01 08:45:52.332452 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-01 08:45:52.334154 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-01 08:45:52.335545 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-01 08:45:52.337368 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-01 08:45:52.360717 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-01 08:45:52.361821 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-01 08:45:52.363158 (MainThread): Parsing macros/logger/log_info.sql
2021-06-01 08:45:52.364256 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-01 08:45:52.365885 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-01 08:45:52.368194 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-01 08:45:52.369661 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-06-01 08:45:52.371350 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-01 08:45:52.373119 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-01 08:45:52.375785 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-01 08:45:52.377453 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-01 08:45:52.378975 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-06-01 08:45:52.380832 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-06-01 08:45:52.382477 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-01 08:45:52.384336 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-01 08:45:52.386425 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-01 08:45:52.390760 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-01 08:45:52.394520 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-01 08:45:52.397173 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-06-01 08:45:52.400189 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-01 08:45:52.402414 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-01 08:45:52.406355 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-01 08:45:52.417057 (MainThread): Parsing macros/sql/date_spine.sql
2021-06-01 08:45:52.422610 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-01 08:45:52.424594 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-01 08:45:52.428490 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-01 08:45:52.433049 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-01 08:45:52.436268 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-01 08:45:52.438008 (MainThread): Parsing macros/sql/star.sql
2021-06-01 08:45:52.441340 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-01 08:45:52.448808 (MainThread): Parsing macros/sql/union.sql
2021-06-01 08:45:52.456504 (MainThread): Parsing macros/sql/groupby.sql
2021-06-01 08:45:52.457837 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-01 08:45:52.461036 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-01 08:45:52.462665 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-01 08:45:52.464278 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-01 08:45:52.470279 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-01 08:45:52.474613 (MainThread): Parsing macros/sql/pivot.sql
2021-06-01 08:45:52.478302 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-01 08:45:52.480458 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-06-01 08:45:52.490287 (MainThread): Partial parsing not enabled
2021-06-01 08:45:52.515273 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:45:52.522836 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:45:52.544434 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 08:45:52.548266 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:45:52.725598 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ad4efc-0327-4108-aa60-d429f09b8a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc7c2190>]}
2021-06-01 08:45:52.733635 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ad4efc-0327-4108-aa60-d429f09b8a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc44b0d0>]}
2021-06-01 08:45:52.733853 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-06-01 08:45:52.734648 (MainThread): 
2021-06-01 08:45:52.734977 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 08:45:52.735649 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-06-01 08:45:52.741000 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-06-01 08:45:52.741087 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-06-01 08:45:52.741236 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-01 08:45:54.665903 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-06-01 08:45:54.670229 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-06-01 08:45:55.486533 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 08:45:55.495873 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 08:45:55.496056 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-06-01 08:45:55.496170 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-01 08:45:57.036600 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.54 seconds
2021-06-01 08:45:57.037888 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-06-01 08:45:58.011211 (MainThread): Using snowflake connection "master".
2021-06-01 08:45:58.011409 (MainThread): On master: BEGIN
2021-06-01 08:45:58.011527 (MainThread): Opening a new connection, currently in state init
2021-06-01 08:46:00.026024 (MainThread): SQL status: SUCCESS 1 in 2.01 seconds
2021-06-01 08:46:00.026249 (MainThread): On master: COMMIT
2021-06-01 08:46:00.026456 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:00.026569 (MainThread): On master: COMMIT
2021-06-01 08:46:00.397895 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-01 08:46:00.398114 (MainThread): On master: Close
2021-06-01 08:46:01.014894 (MainThread): 14:16:01 | Concurrency: 10 threads (target='dev')
2021-06-01 08:46:01.015124 (MainThread): 14:16:01 | 
2021-06-01 08:46:01.017508 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-06-01 08:46:01.017746 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-06-01 08:46:01.018026 (Thread-1): 14:16:01 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-06-01 08:46:01.018149 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:01.018738 (Thread-2): 14:16:01 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-06-01 08:46:01.019148 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:01.019362 (Thread-3): 14:16:01 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-06-01 08:46:01.019700 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:01.019852 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-06-01 08:46:01.020141 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:01.020273 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-06-01 08:46:01.022128 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-06-01 08:46:01.022285 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:01.024039 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-06-01 08:46:01.029766 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:01.030034 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-06-01 08:46:01.030157 (Thread-3): Opening a new connection, currently in state init
2021-06-01 08:46:01.031781 (Thread-1): finished collecting timing info
2021-06-01 08:46:01.056065 (Thread-2): finished collecting timing info
2021-06-01 08:46:01.069795 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-06-01 08:46:01.076404 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-06-01 08:46:01.077436 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:01.077627 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-06-01 08:46:01.077746 (Thread-1): Opening a new connection, currently in state closed
2021-06-01 08:46:01.079428 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:01.079539 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-06-01 08:46:01.079627 (Thread-2): Opening a new connection, currently in state init
2021-06-01 08:46:02.587941 (Thread-3): SQL status: SUCCESS 4 in 1.56 seconds
2021-06-01 08:46:02.589973 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:02.590107 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-06-01 08:46:02.604160 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-06-01 08:46:02.604401 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:02.604568 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-06-01 08:46:02.653011 (Thread-2): SQL status: SUCCESS 1 in 1.57 seconds
2021-06-01 08:46:02.653176 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:02.653269 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-06-01 08:46:03.060995 (Thread-3): SQL status: SUCCESS 1 in 0.47 seconds
2021-06-01 08:46:03.061243 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:03.061378 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */
select
                payment_method as value

            from "DEMO_DB"."PUBLIC"."RAW_PAYMENTS"
            group by 1
            order by count(*) desc
2021-06-01 08:46:03.203180 (Thread-1): Snowflake query id: 019ca1ee-0000-43dc-0000-b0b100026082
2021-06-01 08:46:03.203401 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'
2021-06-01 08:46:03.203622 (Thread-1): finished collecting timing info
2021-06-01 08:46:03.203832 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-06-01 08:46:03.592912 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-06-01 08:46:04.030962 (Thread-2): SQL status: SUCCESS 1 in 1.38 seconds
2021-06-01 08:46:04.032374 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 08:46:04.032606 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:04.032724 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 08:46:04.045647 (Thread-3): SQL status: SUCCESS 4 in 0.98 seconds
2021-06-01 08:46:04.046481 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 08:46:04.046998 (Thread-3): finished collecting timing info
2021-06-01 08:46:04.050023 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 08:46:04.051245 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:04.051410 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (-- 


select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-06-01 08:46:04.205186 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 4
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 4
  invalid identifier 'ID'
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-06-01 08:46:04.211121 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ad4efc-0327-4108-aa60-d429f09b8a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc7f0a60>]}
2021-06-01 08:46:04.211547 (Thread-1): 14:16:04 | 1 of 4 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 3.19s]
2021-06-01 08:46:04.211725 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-06-01 08:46:04.372551 (Thread-2): SQL status: SUCCESS 1 in 0.34 seconds
2021-06-01 08:46:04.384397 (Thread-2): finished collecting timing info
2021-06-01 08:46:04.384570 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-06-01 08:46:05.008989 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ad4efc-0327-4108-aa60-d429f09b8a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc5600a0>]}
2021-06-01 08:46:05.009447 (Thread-2): 14:16:05 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 3.99s]
2021-06-01 08:46:05.009621 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-06-01 08:46:05.010059 (Thread-5): Began running node model.demo_dbt.customers
2021-06-01 08:46:05.010280 (Thread-5): 14:16:05 | 4 of 4 SKIP relation PUBLIC.customers................................ [SKIP]
2021-06-01 08:46:05.010449 (Thread-5): Finished running node model.demo_dbt.customers
2021-06-01 08:46:05.929985 (Thread-3): SQL status: SUCCESS 1 in 1.88 seconds
2021-06-01 08:46:05.931831 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 08:46:05.932053 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:05.932166 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 08:46:06.338540 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-06-01 08:46:06.339614 (Thread-3): finished collecting timing info
2021-06-01 08:46:06.339843 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-06-01 08:46:06.952882 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ad4efc-0327-4108-aa60-d429f09b8a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bdd70370>]}
2021-06-01 08:46:06.953264 (Thread-3): 14:16:06 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 5.93s]
2021-06-01 08:46:06.953408 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:06.954912 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 08:46:06.955138 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:06.955235 (MainThread): On master: BEGIN
2021-06-01 08:46:06.955325 (MainThread): Opening a new connection, currently in state closed
2021-06-01 08:46:08.572433 (MainThread): SQL status: SUCCESS 1 in 1.62 seconds
2021-06-01 08:46:08.572786 (MainThread): On master: COMMIT
2021-06-01 08:46:08.573030 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:08.573588 (MainThread): On master: COMMIT
2021-06-01 08:46:09.010014 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-06-01 08:46:09.010289 (MainThread): On master: Close
2021-06-01 08:46:11.010744 (MainThread): 14:16:11 | 
2021-06-01 08:46:11.010984 (MainThread): 14:16:11 | Finished running 4 table models in 18.28s.
2021-06-01 08:46:11.011123 (MainThread): Connection 'master' was properly closed.
2021-06-01 08:46:11.011222 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-06-01 08:46:11.011312 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-06-01 08:46:11.011399 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-06-01 08:46:11.087167 (MainThread): 
2021-06-01 08:46:11.087404 (MainThread): Completed with 1 error and 0 warnings:
2021-06-01 08:46:11.087533 (MainThread): 
2021-06-01 08:46:11.087669 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-06-01 08:46:11.087866 (MainThread):   000904 (42000): SQL compilation error: error line 3 at position 4
2021-06-01 08:46:11.087978 (MainThread):   invalid identifier 'ID'
2021-06-01 08:46:11.088080 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-06-01 08:46:11.088189 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
2021-06-01 08:46:11.088363 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc2605b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc7f4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bc7f4040>]}
2021-06-01 08:46:11.088580 (MainThread): Flushing usage events
2021-06-01 08:46:21.096472 (MainThread): Running with dbt=0.19.1
2021-06-01 08:46:21.849359 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-01 08:46:21.850566 (MainThread): Tracking: tracking
2021-06-01 08:46:21.850988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf682d2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf69e4e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf69e4e730>]}
2021-06-01 08:46:21.866056 (MainThread): Partial parsing not enabled
2021-06-01 08:46:21.866838 (MainThread): Parsing macros/get_payment_methods.sql
2021-06-01 08:46:21.869980 (MainThread): Parsing macros/catalog.sql
2021-06-01 08:46:21.871941 (MainThread): Parsing macros/adapters.sql
2021-06-01 08:46:21.898120 (MainThread): Parsing macros/materializations/merge.sql
2021-06-01 08:46:21.899881 (MainThread): Parsing macros/materializations/view.sql
2021-06-01 08:46:21.901153 (MainThread): Parsing macros/materializations/table.sql
2021-06-01 08:46:21.904694 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-01 08:46:21.913523 (MainThread): Parsing macros/core.sql
2021-06-01 08:46:21.916843 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-01 08:46:21.924541 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-01 08:46:21.926032 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-01 08:46:21.941495 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-01 08:46:21.972072 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-01 08:46:21.990257 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-01 08:46:21.991982 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-01 08:46:21.997407 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-01 08:46:22.009685 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-01 08:46:22.015569 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-01 08:46:22.020956 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-01 08:46:22.025275 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-01 08:46:22.026075 (MainThread): Parsing macros/etc/query.sql
2021-06-01 08:46:22.026960 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-01 08:46:22.028321 (MainThread): Parsing macros/etc/datetime.sql
2021-06-01 08:46:22.036130 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-01 08:46:22.037920 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-01 08:46:22.039366 (MainThread): Parsing macros/adapters/common.sql
2021-06-01 08:46:22.077678 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-01 08:46:22.079291 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-01 08:46:22.080735 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-01 08:46:22.082204 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-01 08:46:22.086032 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-01 08:46:22.087094 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-01 08:46:22.088325 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-01 08:46:22.090783 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-01 08:46:22.096441 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-01 08:46:22.097479 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-01 08:46:22.098850 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-01 08:46:22.101035 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-01 08:46:22.102089 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-01 08:46:22.104488 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-01 08:46:22.113126 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-01 08:46:22.114916 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-01 08:46:22.116292 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-06-01 08:46:22.117686 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-01 08:46:22.119260 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-01 08:46:22.120775 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-01 08:46:22.121856 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-01 08:46:22.125222 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-01 08:46:22.130080 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-01 08:46:22.130826 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-01 08:46:22.133664 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-01 08:46:22.135427 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-01 08:46:22.136877 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-01 08:46:22.138856 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-01 08:46:22.161969 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-01 08:46:22.163072 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-01 08:46:22.164255 (MainThread): Parsing macros/logger/log_info.sql
2021-06-01 08:46:22.165362 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-01 08:46:22.167055 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-01 08:46:22.169452 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-01 08:46:22.171042 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-06-01 08:46:22.172791 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-01 08:46:22.174434 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-01 08:46:22.176906 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-01 08:46:22.178593 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-01 08:46:22.180117 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-06-01 08:46:22.182018 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-06-01 08:46:22.183705 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-01 08:46:22.185607 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-01 08:46:22.187028 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-01 08:46:22.190069 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-01 08:46:22.192150 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-01 08:46:22.194185 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-06-01 08:46:22.196496 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-01 08:46:22.198201 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-01 08:46:22.201596 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-01 08:46:22.209873 (MainThread): Parsing macros/sql/date_spine.sql
2021-06-01 08:46:22.214145 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-01 08:46:22.215672 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-01 08:46:22.218765 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-01 08:46:22.222854 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-01 08:46:22.226038 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-01 08:46:22.227557 (MainThread): Parsing macros/sql/star.sql
2021-06-01 08:46:22.230488 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-01 08:46:22.237468 (MainThread): Parsing macros/sql/union.sql
2021-06-01 08:46:22.244786 (MainThread): Parsing macros/sql/groupby.sql
2021-06-01 08:46:22.246042 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-01 08:46:22.249059 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-01 08:46:22.250548 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-01 08:46:22.252055 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-01 08:46:22.258057 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-01 08:46:22.262034 (MainThread): Parsing macros/sql/pivot.sql
2021-06-01 08:46:22.265735 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-01 08:46:22.267809 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-06-01 08:46:22.277101 (MainThread): Partial parsing not enabled
2021-06-01 08:46:22.301247 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:22.308625 (MainThread): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:22.329616 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 08:46:22.333342 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:22.518277 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6a7c3100>]}
2021-06-01 08:46:22.526186 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6a7f1fa0>]}
2021-06-01 08:46:22.526386 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-06-01 08:46:22.527140 (MainThread): 
2021-06-01 08:46:22.527452 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 08:46:22.528243 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-06-01 08:46:22.533574 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-06-01 08:46:22.533657 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-06-01 08:46:22.533725 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-01 08:46:24.565367 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.03 seconds
2021-06-01 08:46:24.569674 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-06-01 08:46:25.693872 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 08:46:25.702117 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-06-01 08:46:25.702257 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-06-01 08:46:25.702354 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-01 08:46:27.732122 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 2.03 seconds
2021-06-01 08:46:27.733601 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-06-01 08:46:28.764767 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:28.764954 (MainThread): On master: BEGIN
2021-06-01 08:46:28.765074 (MainThread): Opening a new connection, currently in state init
2021-06-01 08:46:30.503337 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-06-01 08:46:30.503607 (MainThread): On master: COMMIT
2021-06-01 08:46:30.503835 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:30.503969 (MainThread): On master: COMMIT
2021-06-01 08:46:31.117989 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-06-01 08:46:31.118256 (MainThread): On master: Close
2021-06-01 08:46:32.041990 (MainThread): 14:16:32 | Concurrency: 10 threads (target='dev')
2021-06-01 08:46:32.042228 (MainThread): 14:16:32 | 
2021-06-01 08:46:32.044476 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-06-01 08:46:32.044796 (Thread-1): 14:16:32 | 1 of 4 START table model PUBLIC.stg_customers........................ [RUN]
2021-06-01 08:46:32.045001 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-06-01 08:46:32.045290 (Thread-2): 14:16:32 | 2 of 4 START table model PUBLIC.stg_orders........................... [RUN]
2021-06-01 08:46:32.045489 (Thread-3): Began running node model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:32.046127 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:32.046285 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-06-01 08:46:32.048015 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-06-01 08:46:32.048398 (Thread-3): 14:16:32 | 3 of 4 START table model PUBLIC.order_payment_method_amounts......... [RUN]
2021-06-01 08:46:32.048756 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:32.049200 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:32.049303 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-06-01 08:46:32.049397 (Thread-1): finished collecting timing info
2021-06-01 08:46:32.049783 (Thread-3): Compiling model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:32.051301 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-06-01 08:46:32.072673 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:32.087879 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-06-01 08:46:32.088192 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */

    
select distinct
payment_method
from DEMO_DB.PUBLIC.raw_payments
order by 1
2021-06-01 08:46:32.088524 (Thread-2): finished collecting timing info
2021-06-01 08:46:32.088790 (Thread-3): Opening a new connection, currently in state init
2021-06-01 08:46:32.091677 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-06-01 08:46:32.093787 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:32.094230 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-06-01 08:46:32.094823 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:32.094949 (Thread-1): Opening a new connection, currently in state closed
2021-06-01 08:46:32.095253 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-06-01 08:46:32.097091 (Thread-2): Opening a new connection, currently in state init
2021-06-01 08:46:34.087736 (Thread-3): SQL status: SUCCESS 4 in 2.00 seconds
2021-06-01 08:46:34.089780 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:34.089917 (Thread-3): On model.demo_dbt.order_payment_method_amounts: BEGIN
2021-06-01 08:46:34.118629 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2021-06-01 08:46:34.118975 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:34.119511 (Thread-2): SQL status: SUCCESS 1 in 2.02 seconds
2021-06-01 08:46:34.119648 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-06-01 08:46:34.119787 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:34.120369 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_orders  as
      (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
      );
2021-06-01 08:46:34.804112 (Thread-3): SQL status: SUCCESS 1 in 0.71 seconds
2021-06-01 08:46:34.804399 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:34.804542 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */
select
                payment_method as value

            from "DEMO_DB"."PUBLIC"."RAW_PAYMENTS"
            group by 1
            order by count(*) desc
2021-06-01 08:46:35.520932 (Thread-3): SQL status: SUCCESS 4 in 0.72 seconds
2021-06-01 08:46:35.521870 (Thread-3): Writing injected SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 08:46:35.522538 (Thread-3): finished collecting timing info
2021-06-01 08:46:35.525382 (Thread-3): Writing runtime SQL for node "model.demo_dbt.order_payment_method_amounts"
2021-06-01 08:46:35.526370 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:35.526498 (Thread-3): On model.demo_dbt.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.order_payment_method_amounts"} */


      create or replace transient table DEMO_DB.PUBLIC.order_payment_method_amounts  as
      (-- 


select
order_id,



sum(amount) as total_amount

from DEMO_DB.PUBLIC.raw_payments
group by 1
      );
2021-06-01 08:46:36.341047 (Thread-1): SQL status: SUCCESS 1 in 2.22 seconds
2021-06-01 08:46:36.341662 (Thread-2): SQL status: SUCCESS 1 in 2.22 seconds
2021-06-01 08:46:36.342970 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-06-01 08:46:36.343940 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 08:46:36.344151 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-06-01 08:46:36.344333 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-06-01 08:46:36.344457 (Thread-1): On model.demo_dbt.stg_customers: COMMIT
2021-06-01 08:46:36.344574 (Thread-2): On model.demo_dbt.stg_orders: COMMIT
2021-06-01 08:46:36.751475 (Thread-2): SQL status: SUCCESS 1 in 0.41 seconds
2021-06-01 08:46:36.763064 (Thread-2): finished collecting timing info
2021-06-01 08:46:36.763224 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-06-01 08:46:36.785292 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-06-01 08:46:36.786355 (Thread-1): finished collecting timing info
2021-06-01 08:46:36.786581 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-06-01 08:46:37.245021 (Thread-3): SQL status: SUCCESS 1 in 1.72 seconds
2021-06-01 08:46:37.246425 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 08:46:37.246676 (Thread-3): Using snowflake connection "model.demo_dbt.order_payment_method_amounts".
2021-06-01 08:46:37.246809 (Thread-3): On model.demo_dbt.order_payment_method_amounts: COMMIT
2021-06-01 08:46:37.570837 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c4fb160>]}
2021-06-01 08:46:37.571305 (Thread-2): 14:16:37 | 2 of 4 OK created table model PUBLIC.stg_orders...................... [SUCCESS 1 in 5.52s]
2021-06-01 08:46:37.571490 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-06-01 08:46:37.714711 (Thread-3): SQL status: SUCCESS 1 in 0.47 seconds
2021-06-01 08:46:37.715758 (Thread-3): finished collecting timing info
2021-06-01 08:46:37.715978 (Thread-3): On model.demo_dbt.order_payment_method_amounts: Close
2021-06-01 08:46:37.857505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6a7f1370>]}
2021-06-01 08:46:37.858199 (Thread-1): 14:16:37 | 1 of 4 OK created table model PUBLIC.stg_customers................... [SUCCESS 1 in 5.81s]
2021-06-01 08:46:37.858408 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-06-01 08:46:37.859059 (Thread-5): Began running node model.demo_dbt.customers
2021-06-01 08:46:37.859421 (Thread-5): 14:16:37 | 4 of 4 START table model PUBLIC.customers............................ [RUN]
2021-06-01 08:46:37.859888 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-06-01 08:46:37.860099 (Thread-5): Compiling model.demo_dbt.customers
2021-06-01 08:46:37.931773 (Thread-5): Writing injected SQL for node "model.demo_dbt.customers"
2021-06-01 08:46:37.932367 (Thread-5): finished collecting timing info
2021-06-01 08:46:37.934902 (Thread-5): Writing runtime SQL for node "model.demo_dbt.customers"
2021-06-01 08:46:37.936959 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 08:46:37.937079 (Thread-5): On model.demo_dbt.customers: BEGIN
2021-06-01 08:46:37.937182 (Thread-5): Opening a new connection, currently in state init
2021-06-01 08:46:38.800807 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c6633d0>]}
2021-06-01 08:46:38.801299 (Thread-3): 14:16:38 | 3 of 4 OK created table model PUBLIC.order_payment_method_amounts.... [SUCCESS 1 in 6.75s]
2021-06-01 08:46:38.801834 (Thread-3): Finished running node model.demo_dbt.order_payment_method_amounts
2021-06-01 08:46:39.593643 (Thread-5): SQL status: SUCCESS 1 in 1.66 seconds
2021-06-01 08:46:39.593888 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 08:46:39.594016 (Thread-5): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select * from DEMO_DB.PUBLIC.stg_customers

),

orders as (

    select * from DEMO_DB.PUBLIC.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-06-01 08:46:42.902061 (Thread-5): SQL status: SUCCESS 1 in 3.31 seconds
2021-06-01 08:46:42.903463 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-06-01 08:46:42.903705 (Thread-5): Using snowflake connection "model.demo_dbt.customers".
2021-06-01 08:46:42.903846 (Thread-5): On model.demo_dbt.customers: COMMIT
2021-06-01 08:46:43.303025 (Thread-5): SQL status: SUCCESS 1 in 0.40 seconds
2021-06-01 08:46:43.304143 (Thread-5): finished collecting timing info
2021-06-01 08:46:43.304373 (Thread-5): On model.demo_dbt.customers: Close
2021-06-01 08:46:44.423783 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ee161-4ce0-414c-952e-ef611c7a3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c663070>]}
2021-06-01 08:46:44.424246 (Thread-5): 14:16:44 | 4 of 4 OK created table model PUBLIC.customers....................... [SUCCESS 1 in 6.56s]
2021-06-01 08:46:44.424421 (Thread-5): Finished running node model.demo_dbt.customers
2021-06-01 08:46:44.426115 (MainThread): Acquiring new snowflake connection "master".
2021-06-01 08:46:44.426354 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:44.426468 (MainThread): On master: BEGIN
2021-06-01 08:46:44.426572 (MainThread): Opening a new connection, currently in state closed
2021-06-01 08:46:46.067848 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-06-01 08:46:46.068115 (MainThread): On master: COMMIT
2021-06-01 08:46:46.068343 (MainThread): Using snowflake connection "master".
2021-06-01 08:46:46.068476 (MainThread): On master: COMMIT
2021-06-01 08:46:46.560063 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-06-01 08:46:46.560339 (MainThread): On master: Close
2021-06-01 08:46:47.605969 (MainThread): 14:16:47 | 
2021-06-01 08:46:47.606196 (MainThread): 14:16:47 | Finished running 4 table models in 25.08s.
2021-06-01 08:46:47.606343 (MainThread): Connection 'master' was properly closed.
2021-06-01 08:46:47.606452 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-06-01 08:46:47.606549 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-06-01 08:46:47.606641 (MainThread): Connection 'model.demo_dbt.order_payment_method_amounts' was properly closed.
2021-06-01 08:46:47.606731 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-06-01 08:46:47.615073 (MainThread): 
2021-06-01 08:46:47.615233 (MainThread): Completed successfully
2021-06-01 08:46:47.615371 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-01 08:46:47.615552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c498220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c289280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6c603250>]}
2021-06-01 08:46:47.615775 (MainThread): Flushing usage events
