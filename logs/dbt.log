2021-05-29 08:42:27.010542 (MainThread): Running with dbt=0.19.1
2021-05-29 08:42:28.262550 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:42:28.264388 (MainThread): Tracking: tracking
2021-05-29 08:42:28.264938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e66cfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e820d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e820d7c0>]}
2021-05-29 08:42:28.275812 (MainThread): Partial parsing not enabled
2021-05-29 08:42:28.276888 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:42:28.279154 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:42:28.308603 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:42:28.310828 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:42:28.312414 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:42:28.316397 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:42:28.327286 (MainThread): Parsing macros/core.sql
2021-05-29 08:42:28.331479 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:42:28.344200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:42:28.346911 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:42:28.375228 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:42:28.434499 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:42:28.462287 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:42:28.465889 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:42:28.477675 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:42:28.495935 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:42:28.503881 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:42:28.511748 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:42:28.519432 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:42:28.520642 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:42:28.522111 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:42:28.524224 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:42:28.534761 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:42:28.536975 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:42:28.538878 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:42:28.609763 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:42:28.613438 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:42:28.615391 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:42:28.617819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:42:28.631264 (MainThread): Partial parsing not enabled
2021-05-29 08:42:28.665018 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:28.678061 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:28.682547 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:28.819739 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e600b370>]}
2021-05-29 08:42:28.824139 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e600e8b0>]}
2021-05-29 08:42:28.824424 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:42:28.825284 (MainThread): 
2021-05-29 08:42:28.825605 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:42:28.826617 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:42:28.842083 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:42:28.842246 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:42:28.842345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:42:30.711734 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.87 seconds
2021-05-29 08:42:30.716062 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:42:31.736710 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:42:31.743927 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:42:31.744098 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:42:31.744203 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:42:33.908333 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.16 seconds
2021-05-29 08:42:33.909484 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:42:34.704544 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:34.704741 (MainThread): On master: BEGIN
2021-05-29 08:42:34.704856 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:42:36.236443 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 08:42:36.236660 (MainThread): On master: COMMIT
2021-05-29 08:42:36.236854 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:36.236962 (MainThread): On master: COMMIT
2021-05-29 08:42:36.748619 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:42:36.748888 (MainThread): On master: Close
2021-05-29 08:42:38.025786 (MainThread): 14:12:38 | Concurrency: 10 threads (target='dev')
2021-05-29 08:42:38.026006 (MainThread): 14:12:38 | 
2021-05-29 08:42:38.028207 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:38.028522 (Thread-1): 14:12:38 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:42:38.028738 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:42:38.029013 (Thread-2): 14:12:38 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:42:38.029345 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:38.029484 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:38.031911 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:42:38.032294 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:38.032424 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:42:38.033627 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:42:38.034039 (Thread-1): finished collecting timing info
2021-05-29 08:42:38.046146 (Thread-2): finished collecting timing info
2021-05-29 08:42:38.075106 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:42:38.078965 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:42:38.079979 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:38.080076 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:42:38.080162 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:42:38.082986 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:38.083294 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:42:38.083410 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:42:39.771957 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-29 08:42:39.772206 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:42:39.772339 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `demo_dbt`.demo_db.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `demo_dbt`.demo_db.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:42:39.871166 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 08:42:39.871358 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:39.871472 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:42:40.261153 (Thread-2): Snowflake query id: 019c910a-0000-439c-0000-0000b0b1e0f5
2021-05-29 08:42:40.261362 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DEMO_DBT`"' does not exist or not authorized.
2021-05-29 08:42:40.261578 (Thread-2): finished collecting timing info
2021-05-29 08:42:40.261783 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:42:40.637392 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:42:41.210508 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 08:42:41.212071 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:42:41.212328 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:42:41.212437 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:42:41.442441 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DBT`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DEMO_DBT`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DBT`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:42:41.447365 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8432a30>]}
2021-05-29 08:42:41.447866 (Thread-2): 14:12:41 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.42s]
2021-05-29 08:42:41.448037 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:42:42.351387 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-05-29 08:42:42.362825 (Thread-1): finished collecting timing info
2021-05-29 08:42:42.362981 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:42:43.170038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e841dc10>]}
2021-05-29 08:42:43.170492 (Thread-1): 14:12:43 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.14s]
2021-05-29 08:42:43.170655 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:42:43.171222 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:43.171662 (Thread-4): 14:12:43 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:42:43.171976 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:43.172089 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:43.174082 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:42:43.174513 (Thread-4): finished collecting timing info
2021-05-29 08:42:43.192843 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:42:43.193670 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:43.193772 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:42:43.193861 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:42:44.777075 (Thread-4): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 08:42:44.777320 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:44.777454 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:42:45.236111 (Thread-4): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-29 08:42:45.237239 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:42:45.237438 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:42:45.237548 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:42:45.526310 (Thread-4): SQL status: SUCCESS 1 in 0.29 seconds
2021-05-29 08:42:45.527373 (Thread-4): finished collecting timing info
2021-05-29 08:42:45.527624 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:42:46.116730 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a57c50-2dd7-4ebe-9273-5bae0881f129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8476130>]}
2021-05-29 08:42:46.117173 (Thread-4): 14:12:46 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.94s]
2021-05-29 08:42:46.117339 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:42:46.118790 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:42:46.119026 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:46.119138 (MainThread): On master: BEGIN
2021-05-29 08:42:46.119242 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:42:47.713589 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-29 08:42:47.713802 (MainThread): On master: COMMIT
2021-05-29 08:42:47.713961 (MainThread): Using snowflake connection "master".
2021-05-29 08:42:47.714048 (MainThread): On master: COMMIT
2021-05-29 08:42:48.110650 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 08:42:48.110914 (MainThread): On master: Close
2021-05-29 08:42:48.727103 (MainThread): 14:12:48 | 
2021-05-29 08:42:48.727316 (MainThread): 14:12:48 | Finished running 2 table models, 1 view model in 19.90s.
2021-05-29 08:42:48.727451 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:42:48.727547 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:42:48.727633 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:42:48.727714 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:42:48.732261 (MainThread): 
2021-05-29 08:42:48.732416 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:42:48.732541 (MainThread): 
2021-05-29 08:42:48.732653 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:42:48.732793 (MainThread):   002003 (02000): SQL compilation error:
2021-05-29 08:42:48.732929 (MainThread):   Database '"`DEMO_DBT`"' does not exist or not authorized.
2021-05-29 08:42:48.733036 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:42:48.733141 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:42:48.733333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e8397730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e81f7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e81f7910>]}
2021-05-29 08:42:48.733556 (MainThread): Flushing usage events
2021-05-29 08:43:53.439169 (MainThread): Running with dbt=0.19.1
2021-05-29 08:43:54.289817 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:43:54.291347 (MainThread): Tracking: tracking
2021-05-29 08:43:54.291944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9626ac7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a050580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a050610>]}
2021-05-29 08:43:54.303050 (MainThread): Partial parsing not enabled
2021-05-29 08:43:54.304292 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:43:54.307021 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:43:54.337671 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:43:54.339435 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:43:54.340712 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:43:54.344626 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:43:54.354416 (MainThread): Parsing macros/core.sql
2021-05-29 08:43:54.357808 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:43:54.365594 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:43:54.367141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:43:54.383707 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:43:54.416685 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:43:54.435297 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:43:54.436897 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:43:54.442233 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:43:54.455214 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:43:54.461628 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:43:54.467643 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:43:54.472661 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:43:54.473597 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:43:54.474773 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:43:54.476479 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:43:54.485161 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:43:54.487088 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:43:54.488615 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:43:54.531643 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:43:54.533367 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:43:54.534725 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:43:54.536223 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:43:54.542841 (MainThread): Partial parsing not enabled
2021-05-29 08:43:54.562208 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:43:54.569786 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:43:54.572754 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:43:54.688618 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962651a790>]}
2021-05-29 08:43:54.693412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962652b6d0>]}
2021-05-29 08:43:54.693684 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:43:54.694526 (MainThread): 
2021-05-29 08:43:54.694849 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:43:54.695815 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:43:54.709973 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:43:54.710134 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:43:54.710251 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:43:56.303111 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.59 seconds
2021-05-29 08:43:56.307155 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:43:56.919270 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:43:56.926472 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:43:56.926596 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:43:56.926687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:43:58.350076 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 08:43:58.351053 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:43:59.171446 (MainThread): Using snowflake connection "master".
2021-05-29 08:43:59.171646 (MainThread): On master: BEGIN
2021-05-29 08:43:59.171764 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:44:00.704959 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 08:44:00.705225 (MainThread): On master: COMMIT
2021-05-29 08:44:00.705455 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:00.705592 (MainThread): On master: COMMIT
2021-05-29 08:44:01.114914 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:01.115177 (MainThread): On master: Close
2021-05-29 08:44:02.243427 (MainThread): 14:14:02 | Concurrency: 10 threads (target='dev')
2021-05-29 08:44:02.243652 (MainThread): 14:14:02 | 
2021-05-29 08:44:02.245909 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:02.246188 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:44:02.246472 (Thread-1): 14:14:02 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:44:02.246742 (Thread-2): 14:14:02 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:44:02.247072 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:02.247535 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:02.250047 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:44:02.250486 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:02.250783 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:44:02.251900 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:44:02.252302 (Thread-1): finished collecting timing info
2021-05-29 08:44:02.258328 (Thread-2): finished collecting timing info
2021-05-29 08:44:02.303283 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:44:02.303620 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:44:02.305500 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:02.306146 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:02.306242 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:44:02.306364 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:44:02.306467 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:44:02.306551 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:44:03.641718 (Thread-2): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 08:44:03.641970 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:44:03.642112 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `DEMO_DB`.public.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `DEMO_DB`.public.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:44:03.711768 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-05-29 08:44:03.711993 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:03.712125 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:44:04.030663 (Thread-2): Snowflake query id: 019c910c-0000-43c0-0000-b0b1000100c2
2021-05-29 08:44:04.030880 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DEMO_DB`"' does not exist or not authorized.
2021-05-29 08:44:04.031056 (Thread-2): finished collecting timing info
2021-05-29 08:44:04.031218 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:44:04.494167 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:44:05.108958 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 08:44:05.110226 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:44:05.110419 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:44:05.110535 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:44:05.111813 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DB`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DEMO_DB`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DEMO_DB`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:44:05.115791 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a266760>]}
2021-05-29 08:44:05.116170 (Thread-2): 14:14:05 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.87s]
2021-05-29 08:44:05.116345 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:44:05.415277 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 08:44:05.426934 (Thread-1): finished collecting timing info
2021-05-29 08:44:05.427129 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:44:06.134527 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a263ac0>]}
2021-05-29 08:44:06.134955 (Thread-1): 14:14:06 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.89s]
2021-05-29 08:44:06.135121 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:44:06.135695 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:06.135955 (Thread-4): 14:14:06 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:44:06.136390 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:06.136536 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:06.138763 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:44:06.139178 (Thread-4): finished collecting timing info
2021-05-29 08:44:06.157494 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:44:06.158317 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:06.158417 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:44:06.158504 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:44:08.282225 (Thread-4): SQL status: SUCCESS 1 in 2.12 seconds
2021-05-29 08:44:08.282448 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:08.282563 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:44:08.795542 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:44:08.796732 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:44:08.796951 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:44:08.797048 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:44:09.204521 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:09.205407 (Thread-4): finished collecting timing info
2021-05-29 08:44:09.205585 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:44:09.820778 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c2e98-ba4b-4182-8660-41b03a418c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a2d7ca0>]}
2021-05-29 08:44:09.821236 (Thread-4): 14:14:09 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.68s]
2021-05-29 08:44:09.821406 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:44:09.822854 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:44:09.823051 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:09.823141 (MainThread): On master: BEGIN
2021-05-29 08:44:09.823224 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:44:11.661822 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 08:44:11.662079 (MainThread): On master: COMMIT
2021-05-29 08:44:11.662314 (MainThread): Using snowflake connection "master".
2021-05-29 08:44:11.662448 (MainThread): On master: COMMIT
2021-05-29 08:44:12.070616 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 08:44:12.070864 (MainThread): On master: Close
2021-05-29 08:44:12.789352 (MainThread): 14:14:12 | 
2021-05-29 08:44:12.789563 (MainThread): 14:14:12 | Finished running 2 table models, 1 view model in 18.09s.
2021-05-29 08:44:12.789701 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:44:12.789798 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:44:12.789885 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:44:12.789975 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:44:12.794187 (MainThread): 
2021-05-29 08:44:12.794325 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:44:12.794442 (MainThread): 
2021-05-29 08:44:12.794552 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:44:12.794650 (MainThread):   002003 (02000): SQL compilation error:
2021-05-29 08:44:12.794740 (MainThread):   Database '"`DEMO_DB`"' does not exist or not authorized.
2021-05-29 08:44:12.794827 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:44:12.794925 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:44:12.795093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a1d85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9626ad2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962a02fc70>]}
2021-05-29 08:44:12.795286 (MainThread): Flushing usage events
2021-05-29 08:45:35.537067 (MainThread): Running with dbt=0.19.1
2021-05-29 08:45:36.418492 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 08:45:36.419897 (MainThread): Tracking: tracking
2021-05-29 08:45:36.420403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb981dc7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984c50550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984c505e0>]}
2021-05-29 08:45:36.431955 (MainThread): Partial parsing not enabled
2021-05-29 08:45:36.433161 (MainThread): Parsing macros/catalog.sql
2021-05-29 08:45:36.435849 (MainThread): Parsing macros/adapters.sql
2021-05-29 08:45:36.469033 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 08:45:36.471370 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 08:45:36.473017 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 08:45:36.477348 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 08:45:36.488176 (MainThread): Parsing macros/core.sql
2021-05-29 08:45:36.492346 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 08:45:36.502043 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 08:45:36.503840 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 08:45:36.520713 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 08:45:36.552900 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 08:45:36.572167 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 08:45:36.573827 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 08:45:36.579315 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 08:45:36.592590 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 08:45:36.598957 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 08:45:36.604803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 08:45:36.609194 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 08:45:36.610048 (MainThread): Parsing macros/etc/query.sql
2021-05-29 08:45:36.610975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 08:45:36.612424 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 08:45:36.620907 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 08:45:36.622744 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 08:45:36.624282 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 08:45:36.664163 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 08:45:36.666043 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 08:45:36.667431 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 08:45:36.669079 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 08:45:36.675536 (MainThread): Partial parsing not enabled
2021-05-29 08:45:36.694626 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:36.702115 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:36.705035 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:36.830119 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7e20>]}
2021-05-29 08:45:36.835257 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7760>]}
2021-05-29 08:45:36.835543 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 08:45:36.836429 (MainThread): 
2021-05-29 08:45:36.836777 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:45:36.837786 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 08:45:36.852761 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 08:45:36.852922 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 08:45:36.853020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 08:45:38.659894 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.81 seconds
2021-05-29 08:45:38.663088 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 08:45:39.241051 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:45:39.247208 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 08:45:39.247349 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 08:45:39.247436 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 08:45:41.027938 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.78 seconds
2021-05-29 08:45:41.028899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 08:45:41.879160 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:41.879307 (MainThread): On master: BEGIN
2021-05-29 08:45:41.879418 (MainThread): Opening a new connection, currently in state init
2021-05-29 08:45:43.647518 (MainThread): SQL status: SUCCESS 1 in 1.77 seconds
2021-05-29 08:45:43.647783 (MainThread): On master: COMMIT
2021-05-29 08:45:43.648027 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:43.648163 (MainThread): On master: COMMIT
2021-05-29 08:45:44.086866 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-29 08:45:44.087127 (MainThread): On master: Close
2021-05-29 08:45:44.857616 (MainThread): 14:15:44 | Concurrency: 10 threads (target='dev')
2021-05-29 08:45:44.857834 (MainThread): 14:15:44 | 
2021-05-29 08:45:44.859966 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:44.860247 (Thread-1): 14:15:44 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 08:45:44.860414 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 08:45:44.860704 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:44.860923 (Thread-2): 14:15:44 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 08:45:44.861069 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:44.861578 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:44.863778 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:45:44.863926 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 08:45:44.865365 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 08:45:44.865794 (Thread-1): finished collecting timing info
2021-05-29 08:45:44.872258 (Thread-2): finished collecting timing info
2021-05-29 08:45:44.915157 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 08:45:44.915493 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 08:45:44.917359 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:44.918014 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:44.918103 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 08:45:44.918209 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 08:45:44.918300 (Thread-2): Opening a new connection, currently in state init
2021-05-29 08:45:44.918378 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 08:45:46.645094 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-29 08:45:46.645344 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:46.645480 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 08:45:46.704606 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 08:45:46.704795 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 08:45:46.704900 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 08:45:47.093599 (Thread-2): Snowflake query id: 019c910d-0000-43c0-0000-b0b1000100e6
2021-05-29 08:45:47.093809 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 08:45:47.094028 (Thread-2): finished collecting timing info
2021-05-29 08:45:47.094234 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 08:45:47.604316 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-05-29 08:45:47.605888 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:45:47.606087 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 08:45:47.606195 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 08:45:47.944316 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 08:45:47.956162 (Thread-1): finished collecting timing info
2021-05-29 08:45:47.956361 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 08:45:48.974392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e63790>]}
2021-05-29 08:45:48.974983 (Thread-1): 14:15:48 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.11s]
2021-05-29 08:45:48.975145 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 08:45:48.975469 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:48.975691 (Thread-4): 14:15:48 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 08:45:48.975987 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:48.976103 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:48.978224 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:45:48.978694 (Thread-4): finished collecting timing info
2021-05-29 08:45:48.997374 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 08:45:48.999251 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:48.999557 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 08:45:48.999797 (Thread-4): Opening a new connection, currently in state init
2021-05-29 08:45:50.270127 (Thread-4): SQL status: SUCCESS 1 in 1.27 seconds
2021-05-29 08:45:50.270628 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 08:45:50.270746 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:50.272043 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 08:45:51.396576 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:45:51.399760 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e5dc40>]}
2021-05-29 08:45:51.400155 (Thread-2): 14:15:51 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 6.54s]
2021-05-29 08:45:51.400312 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 08:45:53.442601 (Thread-4): SQL status: SUCCESS 1 in 3.17 seconds
2021-05-29 08:45:53.443980 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:45:53.444221 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 08:45:53.444354 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 08:45:53.954609 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 08:45:53.955688 (Thread-4): finished collecting timing info
2021-05-29 08:45:53.955904 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 08:45:54.775503 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5477c691-e72c-4ee4-813a-0402a53aa1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984ede910>]}
2021-05-29 08:45:54.775943 (Thread-4): 14:15:54 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 5.80s]
2021-05-29 08:45:54.776109 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 08:45:54.777692 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 08:45:54.777928 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:54.778036 (MainThread): On master: BEGIN
2021-05-29 08:45:54.778137 (MainThread): Opening a new connection, currently in state closed
2021-05-29 08:45:56.737744 (MainThread): SQL status: SUCCESS 1 in 1.96 seconds
2021-05-29 08:45:56.737915 (MainThread): On master: COMMIT
2021-05-29 08:45:56.738062 (MainThread): Using snowflake connection "master".
2021-05-29 08:45:56.738144 (MainThread): On master: COMMIT
2021-05-29 08:45:57.128315 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-29 08:45:57.128586 (MainThread): On master: Close
2021-05-29 08:45:58.256788 (MainThread): 14:15:58 | 
2021-05-29 08:45:58.257003 (MainThread): 14:15:58 | Finished running 2 table models, 1 view model in 21.42s.
2021-05-29 08:45:58.257140 (MainThread): Connection 'master' was properly closed.
2021-05-29 08:45:58.257237 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 08:45:58.257324 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 08:45:58.257406 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 08:45:58.261892 (MainThread): 
2021-05-29 08:45:58.262031 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 08:45:58.262146 (MainThread): 
2021-05-29 08:45:58.262260 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 08:45:58.262359 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 08:45:58.262449 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 08:45:58.262534 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 08:45:58.262631 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 08:45:58.262813 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9815e7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb985005190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb984e5dc40>]}
2021-05-29 08:45:58.263019 (MainThread): Flushing usage events
2021-05-29 10:23:43.885901 (MainThread): Running with dbt=0.19.1
2021-05-29 10:23:45.172857 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:23:45.174517 (MainThread): Tracking: tracking
2021-05-29 10:23:45.175086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab41c5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab6550610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab65506a0>]}
2021-05-29 10:23:45.187257 (MainThread): Partial parsing not enabled
2021-05-29 10:23:45.188494 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:23:45.191254 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:23:45.220650 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:23:45.222390 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:23:45.223641 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:23:45.227180 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:23:45.236738 (MainThread): Parsing macros/core.sql
2021-05-29 10:23:45.240383 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:23:45.248109 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:23:45.249604 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:23:45.265223 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:23:45.297116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:23:45.315542 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:23:45.317131 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:23:45.322388 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:23:45.335296 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:23:45.341331 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:23:45.346848 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:23:45.351087 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:23:45.352040 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:23:45.353106 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:23:45.354519 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:23:45.362551 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:23:45.364258 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:23:45.365710 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:23:45.404352 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:23:45.405924 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:23:45.407189 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:23:45.408718 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:23:45.414964 (MainThread): Partial parsing not enabled
2021-05-29 10:23:45.433013 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:23:45.440968 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:23:45.443861 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:23:45.492685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab6716f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab66f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab687cb50>]}
2021-05-29 10:23:45.492883 (MainThread): Flushing usage events
2021-05-29 10:23:47.355669 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:23:47.355901 (MainThread): Encountered an error:
2021-05-29 10:23:47.356091 (MainThread): Compilation Error in model customers (models/customers.sql)
  Model 'model.demo_dbt.customers' (models/customers.sql) depends on a node named 'stg_customers' which was not found
2021-05-29 10:23:47.362406 (MainThread): Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 740, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 483, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Model 'model.demo_dbt.customers' (models/customers.sql) depends on a node named 'stg_customers' which was not found

2021-05-29 10:30:18.648566 (MainThread): Running with dbt=0.19.1
2021-05-29 10:30:19.445018 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:30:19.446479 (MainThread): Tracking: tracking
2021-05-29 10:30:19.447014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f986505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98650640>]}
2021-05-29 10:30:19.456936 (MainThread): Partial parsing not enabled
2021-05-29 10:30:19.458106 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:30:19.460315 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:30:19.486365 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:30:19.488099 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:30:19.489344 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:30:19.492843 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:30:19.501383 (MainThread): Parsing macros/core.sql
2021-05-29 10:30:19.504653 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:30:19.512537 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:30:19.514040 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:30:19.529467 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:30:19.560145 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:30:19.579898 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:30:19.581537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:30:19.586718 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:30:19.598761 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:30:19.604632 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:30:19.610365 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:30:19.614543 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:30:19.615346 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:30:19.616233 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:30:19.617613 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:30:19.625283 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:30:19.627000 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:30:19.628423 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:30:19.666264 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:30:19.667832 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:30:19.669109 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:30:19.670534 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:30:19.676968 (MainThread): Partial parsing not enabled
2021-05-29 10:30:19.695029 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:19.702534 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:19.705225 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:19.815282 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95233e80>]}
2021-05-29 10:30:19.820404 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f952337c0>]}
2021-05-29 10:30:19.820683 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:30:19.821579 (MainThread): 
2021-05-29 10:30:19.821944 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:30:19.822937 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:30:19.837101 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:30:19.837244 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:30:19.837343 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:30:21.908828 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.07 seconds
2021-05-29 10:30:21.913297 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:30:22.653181 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:30:22.661164 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:30:22.661298 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:30:22.661403 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:30:24.392367 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.73 seconds
2021-05-29 10:30:24.393507 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:30:25.212091 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:25.212283 (MainThread): On master: BEGIN
2021-05-29 10:30:25.212402 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:30:26.848501 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-29 10:30:26.848766 (MainThread): On master: COMMIT
2021-05-29 10:30:26.849008 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:26.849146 (MainThread): On master: COMMIT
2021-05-29 10:30:27.334740 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 10:30:27.335008 (MainThread): On master: Close
2021-05-29 10:30:28.006002 (MainThread): 16:00:28 | Concurrency: 10 threads (target='dev')
2021-05-29 10:30:28.006249 (MainThread): 16:00:28 | 
2021-05-29 10:30:28.008635 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:28.008876 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:30:28.009163 (Thread-1): 16:00:28 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:30:28.009419 (Thread-2): 16:00:28 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:30:28.009789 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:28.010438 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:28.010568 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:28.010704 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:30:28.013334 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:30:28.015725 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:30:28.016253 (Thread-1): finished collecting timing info
2021-05-29 10:30:28.034217 (Thread-2): finished collecting timing info
2021-05-29 10:30:28.062397 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:30:28.066111 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:30:28.067875 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:28.067976 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:30:28.068063 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:30:28.069818 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:28.069924 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:30:28.070010 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:30:29.921253 (Thread-2): SQL status: SUCCESS 1 in 1.85 seconds
2021-05-29 10:30:29.921544 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:30:29.921696 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:30:29.922702 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-05-29 10:30:29.923595 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:29.923752 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:30:30.534894 (Thread-2): Snowflake query id: 019c9176-0000-43c0-0000-b0b1000100fe
2021-05-29 10:30:30.535115 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:30:30.535342 (Thread-2): finished collecting timing info
2021-05-29 10:30:30.535558 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:30:31.148999 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:30:32.172791 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2021-05-29 10:30:32.174390 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:30:32.174644 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:30:32.174761 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:30:32.584434 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:30:32.596927 (Thread-1): finished collecting timing info
2021-05-29 10:30:32.597097 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:30:32.589220 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:30:32.603899 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9861ef70>]}
2021-05-29 10:30:32.604294 (Thread-2): 16:00:32 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 4.59s]
2021-05-29 10:30:32.604450 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:30:33.362385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98881eb0>]}
2021-05-29 10:30:33.362860 (Thread-1): 16:00:33 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.35s]
2021-05-29 10:30:33.363038 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:30:33.363550 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:33.364016 (Thread-4): 16:00:33 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:30:33.364382 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:33.364532 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:33.367046 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:30:33.367550 (Thread-4): finished collecting timing info
2021-05-29 10:30:33.386807 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:30:33.387612 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:33.387723 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:30:33.387815 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:30:38.111420 (Thread-4): SQL status: SUCCESS 1 in 4.72 seconds
2021-05-29 10:30:38.111678 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:38.111820 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:30:39.649678 (Thread-4): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 10:30:39.651095 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:30:39.651349 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:30:39.651468 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:30:40.057414 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:30:40.058520 (Thread-4): finished collecting timing info
2021-05-29 10:30:40.058746 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:30:41.083252 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcefacc-aa5c-4b6d-8553-64c6e3fc9868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b82fb80>]}
2021-05-29 10:30:41.083727 (Thread-4): 16:00:41 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 7.72s]
2021-05-29 10:30:41.083911 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:30:41.085482 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:30:41.085733 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:41.085851 (MainThread): On master: BEGIN
2021-05-29 10:30:41.085962 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:30:44.255329 (MainThread): SQL status: SUCCESS 1 in 3.17 seconds
2021-05-29 10:30:44.255602 (MainThread): On master: COMMIT
2021-05-29 10:30:44.255835 (MainThread): Using snowflake connection "master".
2021-05-29 10:30:44.255971 (MainThread): On master: COMMIT
2021-05-29 10:30:44.767347 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 10:30:44.767629 (MainThread): On master: Close
2021-05-29 10:30:45.485997 (MainThread): 16:00:45 | 
2021-05-29 10:30:45.486233 (MainThread): 16:00:45 | Finished running 2 table models, 1 view model in 25.66s.
2021-05-29 10:30:45.486379 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:30:45.486483 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:30:45.486577 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:30:45.486667 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:30:45.492211 (MainThread): 
2021-05-29 10:30:45.492384 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:30:45.492531 (MainThread): 
2021-05-29 10:30:45.492669 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:30:45.492791 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:30:45.492905 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:30:45.493018 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:30:45.493141 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:30:45.493332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f95233e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b8043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9b804640>]}
2021-05-29 10:30:45.493600 (MainThread): Flushing usage events
2021-05-29 10:44:03.379168 (MainThread): Running with dbt=0.19.1
2021-05-29 10:44:04.152589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:44:04.155316 (MainThread): Tracking: tracking
2021-05-29 10:44:04.155852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02ab06cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c5925b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c592640>]}
2021-05-29 10:44:04.165454 (MainThread): Partial parsing not enabled
2021-05-29 10:44:04.166440 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:44:04.168657 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:44:04.194820 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:44:04.196691 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:44:04.197965 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:44:04.201451 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:44:04.210508 (MainThread): Parsing macros/core.sql
2021-05-29 10:44:04.214072 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:44:04.221746 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:44:04.223250 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:44:04.238767 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:44:04.269679 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:44:04.288778 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:44:04.290946 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:44:04.296485 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:44:04.308659 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:44:04.315016 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:44:04.320518 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:44:04.324687 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:44:04.325486 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:44:04.326372 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:44:04.327746 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:44:04.335316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:44:04.336976 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:44:04.338540 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:44:04.376927 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:44:04.378533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:44:04.379830 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:44:04.381434 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:44:04.387761 (MainThread): Partial parsing not enabled
2021-05-29 10:44:04.405759 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:04.413390 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:04.416367 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:04.526510 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a461e80>]}
2021-05-29 10:44:04.531467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a4617c0>]}
2021-05-29 10:44:04.531749 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:44:04.532602 (MainThread): 
2021-05-29 10:44:04.532945 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:44:04.533930 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:44:04.548496 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:44:04.548660 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:44:04.548763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:44:06.170204 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-29 10:44:06.174604 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:44:06.888517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:44:06.896757 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:44:06.896899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:44:06.897012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:44:08.002622 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.11 seconds
2021-05-29 10:44:08.003785 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:44:08.624874 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:08.625068 (MainThread): On master: BEGIN
2021-05-29 10:44:08.625187 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:44:10.061237 (MainThread): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 10:44:10.061517 (MainThread): On master: COMMIT
2021-05-29 10:44:10.061760 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:10.061907 (MainThread): On master: COMMIT
2021-05-29 10:44:10.480938 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-29 10:44:10.481305 (MainThread): On master: Close
2021-05-29 10:44:11.087377 (MainThread): 16:14:11 | Concurrency: 10 threads (target='dev')
2021-05-29 10:44:11.087618 (MainThread): 16:14:11 | 
2021-05-29 10:44:11.090002 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:11.090343 (Thread-1): 16:14:11 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:44:11.090705 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:11.090859 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:11.091425 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:44:11.093946 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:44:11.094151 (Thread-2): 16:14:11 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:44:11.094647 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:11.094779 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:44:11.096970 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:44:11.097342 (Thread-1): finished collecting timing info
2021-05-29 10:44:11.122273 (Thread-2): finished collecting timing info
2021-05-29 10:44:11.130171 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:44:11.130425 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:44:11.132521 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:11.132640 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:44:11.132730 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:44:11.134560 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:11.134669 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:44:11.134760 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:44:12.429862 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-29 10:44:12.430111 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:12.430252 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:44:12.927563 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-05-29 10:44:12.927799 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:44:12.927932 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:44:13.336634 (Thread-2): Snowflake query id: 019c9184-0000-43c0-0000-b0b100010126
2021-05-29 10:44:13.336859 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:44:13.337085 (Thread-2): finished collecting timing info
2021-05-29 10:44:13.337307 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:44:13.779264 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-29 10:44:13.780867 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:44:13.781120 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:44:13.781298 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:44:14.085609 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:44:14.098039 (Thread-1): finished collecting timing info
2021-05-29 10:44:14.098214 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:44:14.528523 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:44:14.795932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c6e5640>]}
2021-05-29 10:44:14.796426 (Thread-1): 16:14:14 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.71s]
2021-05-29 10:44:14.796617 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:44:14.797007 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:14.797275 (Thread-4): 16:14:14 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:44:14.797620 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:14.797763 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:14.800294 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:44:14.800793 (Thread-4): finished collecting timing info
2021-05-29 10:44:14.819842 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:44:14.820648 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:14.820753 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:44:14.820844 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:44:15.809605 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:44:15.814443 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d15ae50>]}
2021-05-29 10:44:15.814887 (Thread-2): 16:14:15 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 4.72s]
2021-05-29 10:44:15.815066 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:44:16.017093 (Thread-4): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-29 10:44:16.017340 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:16.017479 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:44:16.511232 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 10:44:16.512638 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:44:16.512888 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:44:16.513039 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:44:16.921056 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:44:16.922144 (Thread-4): finished collecting timing info
2021-05-29 10:44:16.922369 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:44:17.537555 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f6e166-d210-4da0-ae40-897a125a11ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d45fac0>]}
2021-05-29 10:44:17.538028 (Thread-4): 16:14:17 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.74s]
2021-05-29 10:44:17.538206 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:44:17.539828 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:44:17.540077 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:17.540195 (MainThread): On master: BEGIN
2021-05-29 10:44:17.540306 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:44:18.866481 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:44:18.866759 (MainThread): On master: COMMIT
2021-05-29 10:44:18.866989 (MainThread): Using snowflake connection "master".
2021-05-29 10:44:18.867136 (MainThread): On master: COMMIT
2021-05-29 10:44:19.277096 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:44:19.277380 (MainThread): On master: Close
2021-05-29 10:44:19.892337 (MainThread): 16:14:19 | 
2021-05-29 10:44:19.892565 (MainThread): 16:14:19 | Finished running 2 table models, 1 view model in 15.36s.
2021-05-29 10:44:19.892708 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:44:19.892813 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:44:19.892908 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:44:19.892999 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:44:19.898467 (MainThread): 
2021-05-29 10:44:19.898638 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:44:19.898777 (MainThread): 
2021-05-29 10:44:19.898911 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:44:19.899030 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:44:19.899135 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:44:19.899239 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:44:19.899356 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:44:19.899550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c5c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d0a2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d0a2eb0>]}
2021-05-29 10:44:19.899772 (MainThread): Flushing usage events
2021-05-29 10:45:27.822755 (MainThread): Running with dbt=0.19.1
2021-05-29 10:45:28.576876 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:45:28.578059 (MainThread): Tracking: tracking
2021-05-29 10:45:28.578733 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9360906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93624525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9362452640>]}
2021-05-29 10:45:28.588651 (MainThread): Partial parsing not enabled
2021-05-29 10:45:28.589697 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:45:28.591851 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:45:28.618177 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:45:28.619997 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:45:28.621276 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:45:28.624786 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:45:28.633539 (MainThread): Parsing macros/core.sql
2021-05-29 10:45:28.636881 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:45:28.644897 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:45:28.646437 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:45:28.662190 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:45:28.693399 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:45:28.713048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:45:28.714695 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:45:28.720063 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:45:28.732419 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:45:28.738587 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:45:28.744224 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:45:28.748521 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:45:28.749351 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:45:28.750263 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:45:28.751676 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:45:28.759496 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:45:28.761202 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:45:28.762666 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:45:28.801559 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:45:28.803356 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:45:28.804816 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:45:28.806466 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:45:28.812943 (MainThread): Partial parsing not enabled
2021-05-29 10:45:28.830868 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:28.838519 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:28.841475 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:28.951988 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936022fe80>]}
2021-05-29 10:45:28.957116 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936022f7c0>]}
2021-05-29 10:45:28.957395 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:45:28.958291 (MainThread): 
2021-05-29 10:45:28.958649 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:45:28.959665 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:45:28.974416 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:45:28.974573 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:45:28.974679 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:45:30.971788 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.00 seconds
2021-05-29 10:45:30.976206 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:45:31.675302 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:45:31.683532 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:45:31.683677 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:45:31.683791 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:45:33.104750 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 10:45:33.105921 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:45:34.131276 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:34.131466 (MainThread): On master: BEGIN
2021-05-29 10:45:34.131582 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:45:35.664707 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:45:35.664985 (MainThread): On master: COMMIT
2021-05-29 10:45:35.665223 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:35.665362 (MainThread): On master: COMMIT
2021-05-29 10:45:36.037552 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-05-29 10:45:36.037843 (MainThread): On master: Close
2021-05-29 10:45:36.690584 (MainThread): 16:15:36 | Concurrency: 10 threads (target='dev')
2021-05-29 10:45:36.690819 (MainThread): 16:15:36 | 
2021-05-29 10:45:36.693131 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:36.693462 (Thread-1): 16:15:36 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:45:36.693810 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:36.693973 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:36.694543 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:45:36.697083 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:45:36.697296 (Thread-2): 16:15:36 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:45:36.697788 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:36.697937 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:45:36.700290 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:45:36.700741 (Thread-1): finished collecting timing info
2021-05-29 10:45:36.706343 (Thread-2): finished collecting timing info
2021-05-29 10:45:36.753300 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:45:36.757093 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:45:36.758185 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:36.758287 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:45:36.758377 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:45:36.759616 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:36.759722 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:45:36.759809 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:45:38.056274 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-29 10:45:38.056531 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:38.056672 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:45:38.166109 (Thread-2): SQL status: SUCCESS 1 in 1.41 seconds
2021-05-29 10:45:38.166361 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:45:38.166510 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
select * from customers
      );
2021-05-29 10:45:38.505662 (Thread-2): Snowflake query id: 019c9185-0000-43c7-0000-b0b100014042
2021-05-29 10:45:38.505879 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 0 unexpected 'select'.
2021-05-29 10:45:38.506099 (Thread-2): finished collecting timing info
2021-05-29 10:45:38.506305 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:45:38.940925 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:45:39.658930 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-05-29 10:45:39.660493 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:45:39.660744 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:45:39.660856 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:45:39.687353 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 60 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:45:39.690441 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936266dc70>]}
2021-05-29 10:45:39.690812 (Thread-2): 16:15:39 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.99s]
2021-05-29 10:45:39.690980 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:45:39.955132 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-05-29 10:45:39.968158 (Thread-1): finished collecting timing info
2021-05-29 10:45:39.968354 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:45:40.684302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936265ddf0>]}
2021-05-29 10:45:40.684774 (Thread-1): 16:15:40 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 10:45:40.684947 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:45:40.685564 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:40.685838 (Thread-4): 16:15:40 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:45:40.686287 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:40.686438 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:40.688947 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:45:40.689435 (Thread-4): finished collecting timing info
2021-05-29 10:45:40.709090 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:45:40.709906 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:40.710011 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:45:40.710102 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:45:42.627608 (Thread-4): SQL status: SUCCESS 1 in 1.92 seconds
2021-05-29 10:45:42.627848 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:42.627983 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:45:43.242667 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:45:43.243994 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:45:43.244202 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:45:43.244318 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:45:43.651539 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:45:43.652636 (Thread-4): finished collecting timing info
2021-05-29 10:45:43.652858 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:45:44.677168 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58267a7d-4bb9-44d6-8744-797926b9f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93626b3670>]}
2021-05-29 10:45:44.677635 (Thread-4): 16:15:44 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 10:45:44.677808 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:45:44.679457 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:45:44.679703 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:44.679817 (MainThread): On master: BEGIN
2021-05-29 10:45:44.679921 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:45:46.413195 (MainThread): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-29 10:45:46.413460 (MainThread): On master: COMMIT
2021-05-29 10:45:46.413691 (MainThread): Using snowflake connection "master".
2021-05-29 10:45:46.413831 (MainThread): On master: COMMIT
2021-05-29 10:45:46.800866 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-05-29 10:45:46.801140 (MainThread): On master: Close
2021-05-29 10:45:47.439380 (MainThread): 16:15:47 | 
2021-05-29 10:45:47.439607 (MainThread): 16:15:47 | Finished running 2 table models, 1 view model in 18.48s.
2021-05-29 10:45:47.439750 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:45:47.439854 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:45:47.439947 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:45:47.440036 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:45:47.445558 (MainThread): 
2021-05-29 10:45:47.445719 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:45:47.445854 (MainThread): 
2021-05-29 10:45:47.445982 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:45:47.446122 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:45:47.446220 (MainThread):   syntax error line 60 at position 0 unexpected 'select'.
2021-05-29 10:45:47.446316 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:45:47.446429 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:45:47.446602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93626ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93627dea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93627dec70>]}
2021-05-29 10:45:47.446825 (MainThread): Flushing usage events
2021-05-29 10:46:32.420554 (MainThread): Running with dbt=0.19.1
2021-05-29 10:46:33.169275 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:46:33.171478 (MainThread): Tracking: tracking
2021-05-29 10:46:33.171949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37eacdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38174f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38174f610>]}
2021-05-29 10:46:33.181427 (MainThread): Partial parsing not enabled
2021-05-29 10:46:33.182360 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:46:33.184519 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:46:33.210913 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:46:33.212653 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:46:33.213909 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:46:33.217349 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:46:33.225953 (MainThread): Parsing macros/core.sql
2021-05-29 10:46:33.229215 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:46:33.237196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:46:33.238737 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:46:33.254616 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:46:33.285022 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:46:33.304652 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:46:33.306442 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:46:33.311840 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:46:33.324018 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:46:33.329967 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:46:33.335378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:46:33.339864 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:46:33.340677 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:46:33.341571 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:46:33.342959 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:46:33.350636 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:46:33.352361 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:46:33.353814 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:46:33.391731 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:46:33.393328 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:46:33.394629 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:46:33.396076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:46:33.402283 (MainThread): Partial parsing not enabled
2021-05-29 10:46:33.420667 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:33.427817 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:33.430567 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:33.541234 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e52d790>]}
2021-05-29 10:46:33.546272 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e5406d0>]}
2021-05-29 10:46:33.546542 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:46:33.547407 (MainThread): 
2021-05-29 10:46:33.547756 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:46:33.548747 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:46:33.563030 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:46:33.563173 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:46:33.563270 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:46:35.261218 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.70 seconds
2021-05-29 10:46:35.265603 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:46:35.903203 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:46:35.910745 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:46:35.910876 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:46:35.910974 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:46:37.209416 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.30 seconds
2021-05-29 10:46:37.210580 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:46:37.924748 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:37.924939 (MainThread): On master: BEGIN
2021-05-29 10:46:37.925060 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:46:39.151578 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-29 10:46:39.151873 (MainThread): On master: COMMIT
2021-05-29 10:46:39.152124 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:39.152262 (MainThread): On master: COMMIT
2021-05-29 10:46:39.765560 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:46:39.765834 (MainThread): On master: Close
2021-05-29 10:46:40.379494 (MainThread): 16:16:40 | Concurrency: 10 threads (target='dev')
2021-05-29 10:46:40.379734 (MainThread): 16:16:40 | 
2021-05-29 10:46:40.382074 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:40.382408 (Thread-1): 16:16:40 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:46:40.382773 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:40.382926 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:40.383494 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:46:40.385970 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:46:40.386173 (Thread-2): 16:16:40 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:46:40.386657 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:40.386795 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:46:40.388097 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:46:40.388531 (Thread-1): finished collecting timing info
2021-05-29 10:46:40.394976 (Thread-2): finished collecting timing info
2021-05-29 10:46:40.440079 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:46:40.444322 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:46:40.445329 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:40.445429 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:46:40.445516 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:46:40.446783 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:40.446890 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:46:40.446978 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:46:41.814791 (Thread-2): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-29 10:46:41.816438 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:46:41.816597 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

)

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
select * from customers
      );
2021-05-29 10:46:42.222838 (Thread-2): Snowflake query id: 019c9186-0000-43c5-0000-b0b1000130d2
2021-05-29 10:46:42.223067 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:46:42.223302 (Thread-2): finished collecting timing info
2021-05-29 10:46:42.224224 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:46:42.226109 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2021-05-29 10:46:42.226457 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:42.226598 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:46:42.633648 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:46:43.347815 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:46:43.350817 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381969490>]}
2021-05-29 10:46:43.351225 (Thread-2): 16:16:43 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.96s]
2021-05-29 10:46:43.351393 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:46:43.465619 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-05-29 10:46:43.467215 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:46:43.467441 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:46:43.467555 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:46:43.963781 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-29 10:46:43.977063 (Thread-1): finished collecting timing info
2021-05-29 10:46:43.977262 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:46:44.683678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38195df70>]}
2021-05-29 10:46:44.684149 (Thread-1): 16:16:44 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.30s]
2021-05-29 10:46:44.684329 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:46:44.685010 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:44.685329 (Thread-4): 16:16:44 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:46:44.685785 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:44.685939 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:44.688452 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:46:44.688931 (Thread-4): finished collecting timing info
2021-05-29 10:46:44.707908 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:46:44.708730 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:44.708840 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:46:44.708931 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:46:46.318863 (Thread-4): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-29 10:46:46.319115 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:46.319253 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:46:46.933587 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:46:46.934985 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:46:46.935228 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:46:46.935371 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:46:47.493184 (Thread-4): SQL status: SUCCESS 1 in 0.56 seconds
2021-05-29 10:46:47.494282 (Thread-4): finished collecting timing info
2021-05-29 10:46:47.494508 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:46:48.164156 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcaf7d3-7d42-4a14-a06d-32261e9aa1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381991100>]}
2021-05-29 10:46:48.164643 (Thread-4): 16:16:48 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-29 10:46:48.164821 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:46:48.166347 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:46:48.166586 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:48.166698 (MainThread): On master: BEGIN
2021-05-29 10:46:48.166802 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:46:49.802330 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-29 10:46:49.802601 (MainThread): On master: COMMIT
2021-05-29 10:46:49.802830 (MainThread): Using snowflake connection "master".
2021-05-29 10:46:49.802964 (MainThread): On master: COMMIT
2021-05-29 10:46:50.202086 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 10:46:50.202372 (MainThread): On master: Close
2021-05-29 10:46:50.929158 (MainThread): 16:16:50 | 
2021-05-29 10:46:50.929388 (MainThread): 16:16:50 | Finished running 2 table models, 1 view model in 17.38s.
2021-05-29 10:46:50.929532 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:46:50.929636 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:46:50.929732 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:46:50.929822 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:46:50.935281 (MainThread): 
2021-05-29 10:46:50.935457 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:46:50.935632 (MainThread): 
2021-05-29 10:46:50.935779 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:46:50.935906 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:46:50.936020 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:46:50.936132 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:46:50.936255 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:46:50.936526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37e52d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381969220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff381ada3a0>]}
2021-05-29 10:46:50.936794 (MainThread): Flushing usage events
2021-05-29 10:47:26.819912 (MainThread): Running with dbt=0.19.1
2021-05-29 10:47:27.613351 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:47:27.614986 (MainThread): Tracking: tracking
2021-05-29 10:47:27.615650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4de705e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e024e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e024e6d0>]}
2021-05-29 10:47:27.625359 (MainThread): Partial parsing not enabled
2021-05-29 10:47:27.626401 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:47:27.628640 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:47:27.654967 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:47:27.656914 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:47:27.658172 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:47:27.661628 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:47:27.670486 (MainThread): Parsing macros/core.sql
2021-05-29 10:47:27.673764 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:47:27.681470 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:47:27.683000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:47:27.698924 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:47:27.729227 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:47:27.748295 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:47:27.749913 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:47:27.755149 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:47:27.767839 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:47:27.773837 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:47:27.779254 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:47:27.783419 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:47:27.784231 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:47:27.785112 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:47:27.786491 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:47:27.794101 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:47:27.795772 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:47:27.797346 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:47:27.835528 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:47:27.837114 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:47:27.838404 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:47:27.839851 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:47:27.846061 (MainThread): Partial parsing not enabled
2021-05-29 10:47:27.863866 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:27.871098 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:27.873912 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:27.984249 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e00f3eb0>]}
2021-05-29 10:47:27.989286 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e021e2e0>]}
2021-05-29 10:47:27.989579 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:47:27.990456 (MainThread): 
2021-05-29 10:47:27.990807 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:47:27.991816 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:47:28.006742 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:47:28.006919 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:47:28.007030 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:47:29.839186 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-29 10:47:29.843683 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:47:30.660429 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:47:30.668509 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:47:30.668650 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:47:30.668757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:47:32.193252 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.52 seconds
2021-05-29 10:47:32.194407 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:47:33.219421 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:33.219614 (MainThread): On master: BEGIN
2021-05-29 10:47:33.219733 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:47:34.753107 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:47:34.753377 (MainThread): On master: COMMIT
2021-05-29 10:47:34.753615 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:34.753752 (MainThread): On master: COMMIT
2021-05-29 10:47:35.162716 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:47:35.162989 (MainThread): On master: Close
2021-05-29 10:47:35.882318 (MainThread): 16:17:35 | Concurrency: 10 threads (target='dev')
2021-05-29 10:47:35.882557 (MainThread): 16:17:35 | 
2021-05-29 10:47:35.884852 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:35.885090 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:47:35.885373 (Thread-1): 16:17:35 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:47:35.885637 (Thread-2): 16:17:35 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:47:35.885997 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:35.886693 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:35.886839 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:35.886991 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:47:35.889518 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:47:35.890799 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:47:35.891293 (Thread-1): finished collecting timing info
2021-05-29 10:47:35.897488 (Thread-2): finished collecting timing info
2021-05-29 10:47:35.945360 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:47:35.948430 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:47:35.949465 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:35.949574 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:47:35.949667 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:47:35.950907 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:35.951015 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:47:35.951102 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:47:37.231756 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-29 10:47:37.232004 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:37.232143 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:47:37.341793 (Thread-2): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-29 10:47:37.342038 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:47:37.342185 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
      );
2021-05-29 10:47:37.722126 (Thread-2): Snowflake query id: 019c9187-0000-43c0-0000-b0b100010196
2021-05-29 10:47:37.722349 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:47:37.722576 (Thread-2): finished collecting timing info
2021-05-29 10:47:37.722787 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:47:38.131706 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:47:38.261243 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-05-29 10:47:38.262826 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:47:38.263087 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:47:38.263206 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:47:38.580911 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-29 10:47:38.593724 (Thread-1): finished collecting timing info
2021-05-29 10:47:38.593906 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:47:38.692886 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:47:38.696044 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e051e670>]}
2021-05-29 10:47:38.696459 (Thread-2): 16:17:38 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.81s]
2021-05-29 10:47:38.696645 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:47:39.162768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e051d310>]}
2021-05-29 10:47:39.163222 (Thread-1): 16:17:39 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.28s]
2021-05-29 10:47:39.163401 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:47:39.164028 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:39.164426 (Thread-4): 16:17:39 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:47:39.164783 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:39.164924 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:39.167412 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:47:39.167874 (Thread-4): finished collecting timing info
2021-05-29 10:47:39.187456 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:47:39.188254 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:39.188362 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:47:39.188453 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:47:40.691984 (Thread-4): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 10:47:40.692235 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:40.692379 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:47:41.159338 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-29 10:47:41.160741 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:47:41.160989 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:47:41.161127 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:47:41.511256 (Thread-4): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-29 10:47:41.512371 (Thread-4): finished collecting timing info
2021-05-29 10:47:41.512597 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:47:42.127764 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f6fa-ad88-49be-b60d-20c64afc20eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e0928fd0>]}
2021-05-29 10:47:42.128248 (Thread-4): 16:17:42 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.96s]
2021-05-29 10:47:42.128433 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:47:42.130099 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:47:42.130346 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:42.130467 (MainThread): On master: BEGIN
2021-05-29 10:47:42.130580 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:47:43.661658 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-29 10:47:43.661929 (MainThread): On master: COMMIT
2021-05-29 10:47:43.662159 (MainThread): Using snowflake connection "master".
2021-05-29 10:47:43.662296 (MainThread): On master: COMMIT
2021-05-29 10:47:44.072313 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:47:44.072589 (MainThread): On master: Close
2021-05-29 10:47:44.892375 (MainThread): 16:17:44 | 
2021-05-29 10:47:44.892604 (MainThread): 16:17:44 | Finished running 2 table models, 1 view model in 16.90s.
2021-05-29 10:47:44.892749 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:47:44.892853 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:47:44.892947 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:47:44.893039 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:47:44.897954 (MainThread): 
2021-05-29 10:47:44.898130 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:47:44.898275 (MainThread): 
2021-05-29 10:47:44.898411 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:47:44.898531 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:47:44.898649 (MainThread):   syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:47:44.898759 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:47:44.898881 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:47:44.899067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e03e26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e04eb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e02a0250>]}
2021-05-29 10:47:44.899301 (MainThread): Flushing usage events
2021-05-29 10:48:05.828839 (MainThread): Running with dbt=0.19.1
2021-05-29 10:48:06.582810 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:48:06.583959 (MainThread): Tracking: tracking
2021-05-29 10:48:06.584461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd565c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aa0e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aa0e6a0>]}
2021-05-29 10:48:06.593970 (MainThread): Partial parsing not enabled
2021-05-29 10:48:06.594986 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:48:06.597112 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:48:06.625160 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:48:06.626942 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:48:06.628244 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:48:06.631820 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:48:06.640716 (MainThread): Parsing macros/core.sql
2021-05-29 10:48:06.644066 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:48:06.655962 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:48:06.657984 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:48:06.680668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:48:06.722264 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:48:06.746363 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:48:06.748458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:48:06.755328 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:48:06.770498 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:48:06.776830 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:48:06.782542 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:48:06.787077 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:48:06.787956 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:48:06.788913 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:48:06.790370 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:48:06.798435 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:48:06.800351 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:48:06.801881 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:48:06.842066 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:48:06.843758 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:48:06.845155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:48:06.846658 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:48:06.853249 (MainThread): Partial parsing not enabled
2021-05-29 10:48:06.872447 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:06.879828 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:06.882725 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:06.997606 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5542ee20>]}
2021-05-29 10:48:07.002421 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5542e730>]}
2021-05-29 10:48:07.002692 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:48:07.003563 (MainThread): 
2021-05-29 10:48:07.003938 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:48:07.005063 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:48:07.019356 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:48:07.019502 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:48:07.019604 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:48:08.603442 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-29 10:48:08.607892 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:48:09.263901 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:48:09.271898 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:48:09.272032 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:48:09.272159 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:48:10.694912 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-29 10:48:10.714871 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:48:11.311334 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:11.311518 (MainThread): On master: BEGIN
2021-05-29 10:48:11.311631 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:48:12.640232 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:48:12.640497 (MainThread): On master: COMMIT
2021-05-29 10:48:12.640734 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:12.640866 (MainThread): On master: COMMIT
2021-05-29 10:48:13.049764 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:48:13.050036 (MainThread): On master: Close
2021-05-29 10:48:13.651423 (MainThread): 16:18:13 | Concurrency: 10 threads (target='dev')
2021-05-29 10:48:13.651654 (MainThread): 16:18:13 | 
2021-05-29 10:48:13.654057 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:13.654388 (Thread-1): 16:18:13 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:48:13.654596 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:48:13.654977 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:13.655191 (Thread-2): 16:18:13 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:48:13.655358 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:13.656026 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:13.658560 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:48:13.658722 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:48:13.660137 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:48:13.660692 (Thread-2): finished collecting timing info
2021-05-29 10:48:13.667161 (Thread-1): finished collecting timing info
2021-05-29 10:48:13.714661 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:48:13.717913 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:48:13.718837 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:13.719480 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:13.719560 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:48:13.719656 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:48:13.719745 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:48:13.719822 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:48:15.303330 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 10:48:15.303907 (Thread-2): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-29 10:48:15.304055 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:15.304214 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:48:15.304360 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:48:15.304495 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

)

-- orders as (

--     select
--         id as order_id,
--         user_id as customer_id,
--         order_date,
--         status

--     from orders

-- ),

-- customer_orders as (

--     select
--         customer_id,

--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1

-- ),


-- final as (

--     select
--         customers.customer_id,
--         customers.first_name,
--         customers.last_name,
--         customer_orders.first_order_date,
--         customer_orders.most_recent_order_date,
--         coalesce(customer_orders.number_of_orders, 0) as number_of_orders

--     from customers

--     left join customer_orders using (customer_id)

-- )

-- select * from final
      );
2021-05-29 10:48:15.711479 (Thread-2): Snowflake query id: 019c9188-0000-43c5-0000-b0b100013126
2021-05-29 10:48:15.711698 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:48:15.711920 (Thread-2): finished collecting timing info
2021-05-29 10:48:15.712126 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:48:16.121294 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:48:16.467383 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-05-29 10:48:16.469013 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:48:16.469239 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:48:16.469353 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:48:16.737568 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 58 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:48:16.740726 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac29f10>]}
2021-05-29 10:48:16.741120 (Thread-2): 16:18:16 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.09s]
2021-05-29 10:48:16.741292 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:48:16.767383 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:48:16.779853 (Thread-1): finished collecting timing info
2021-05-29 10:48:16.780063 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:48:17.455011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ace25e0>]}
2021-05-29 10:48:17.455478 (Thread-1): 16:18:17 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.80s]
2021-05-29 10:48:17.455648 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:48:17.456247 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:17.456518 (Thread-4): 16:18:17 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:48:17.456966 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:17.457122 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:17.459612 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:48:17.460069 (Thread-4): finished collecting timing info
2021-05-29 10:48:17.478952 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:48:17.479732 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:17.479832 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:48:17.479918 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:48:19.295579 (Thread-4): SQL status: SUCCESS 1 in 1.82 seconds
2021-05-29 10:48:19.295817 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:19.295947 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:48:19.911293 (Thread-4): SQL status: SUCCESS 1 in 0.62 seconds
2021-05-29 10:48:19.912704 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:48:19.912963 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:48:19.913130 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:48:20.215034 (Thread-4): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:48:20.216121 (Thread-4): finished collecting timing info
2021-05-29 10:48:20.216336 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:48:20.834261 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9799294e-caf4-4010-91e0-d1f53eaee8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac50880>]}
2021-05-29 10:48:20.834740 (Thread-4): 16:18:20 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-29 10:48:20.834914 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:48:20.836984 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:48:20.837224 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:20.837334 (MainThread): On master: BEGIN
2021-05-29 10:48:20.837435 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:48:22.265545 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-29 10:48:22.265805 (MainThread): On master: COMMIT
2021-05-29 10:48:22.266038 (MainThread): Using snowflake connection "master".
2021-05-29 10:48:22.266172 (MainThread): On master: COMMIT
2021-05-29 10:48:22.675105 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 10:48:22.675375 (MainThread): On master: Close
2021-05-29 10:48:23.291417 (MainThread): 16:18:23 | 
2021-05-29 10:48:23.291639 (MainThread): 16:18:23 | Finished running 2 table models, 1 view model in 16.29s.
2021-05-29 10:48:23.291775 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:48:23.291871 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:48:23.291964 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:48:23.292404 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:48:23.297027 (MainThread): 
2021-05-29 10:48:23.297173 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:48:23.297299 (MainThread): 
2021-05-29 10:48:23.297417 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:48:23.297550 (MainThread):   001003 (42000): SQL compilation error:
2021-05-29 10:48:23.297646 (MainThread):   syntax error line 58 at position 6 unexpected ')'.
2021-05-29 10:48:23.297734 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:48:23.297834 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:48:23.297992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5aba2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac31b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ac31610>]}
2021-05-29 10:48:23.298200 (MainThread): Flushing usage events
2021-05-29 10:50:52.228849 (MainThread): Running with dbt=0.19.1
2021-05-29 10:50:52.993966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:50:52.995346 (MainThread): Tracking: tracking
2021-05-29 10:50:52.995846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd0307c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1e50580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1e50610>]}
2021-05-29 10:50:53.005842 (MainThread): Partial parsing not enabled
2021-05-29 10:50:53.006931 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:50:53.009092 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:50:53.035886 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:50:53.038113 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:50:53.039361 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:50:53.042775 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:50:53.051192 (MainThread): Parsing macros/core.sql
2021-05-29 10:50:53.054578 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:50:53.062020 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:50:53.063805 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:50:53.079570 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:50:53.109979 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:50:53.128678 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:50:53.130300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:50:53.135553 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:50:53.148478 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:50:53.154509 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:50:53.160067 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:50:53.164284 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:50:53.165097 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:50:53.165987 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:50:53.167381 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:50:53.175454 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:50:53.177163 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:50:53.178619 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:50:53.216771 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:50:53.218329 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:50:53.219735 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:50:53.221191 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:50:53.227377 (MainThread): Partial parsing not enabled
2021-05-29 10:50:53.245142 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:50:53.252141 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:50:53.255008 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:50:53.368998 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcfb2d790>]}
2021-05-29 10:50:53.374517 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcfb406d0>]}
2021-05-29 10:50:53.374836 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:50:53.375762 (MainThread): 
2021-05-29 10:50:53.376139 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:50:53.377219 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:50:53.392571 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:50:53.392725 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:50:53.392832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:50:55.346695 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.95 seconds
2021-05-29 10:50:55.350972 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:50:56.065572 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:50:56.073578 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:50:56.073722 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:50:56.073834 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:50:57.664979 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.59 seconds
2021-05-29 10:50:57.666137 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:50:58.518543 (MainThread): Using snowflake connection "master".
2021-05-29 10:50:58.518733 (MainThread): On master: BEGIN
2021-05-29 10:50:58.518853 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:51:00.363040 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 10:51:00.363309 (MainThread): On master: COMMIT
2021-05-29 10:51:00.363536 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:00.363670 (MainThread): On master: COMMIT
2021-05-29 10:51:00.977503 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 10:51:00.977780 (MainThread): On master: Close
2021-05-29 10:51:01.724711 (MainThread): 16:21:01 | Concurrency: 10 threads (target='dev')
2021-05-29 10:51:01.724942 (MainThread): 16:21:01 | 
2021-05-29 10:51:01.727377 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:01.727703 (Thread-1): 16:21:01 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:51:01.727885 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:51:01.728257 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:01.728521 (Thread-2): 16:21:01 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 10:51:01.728692 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:01.731518 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:51:01.732071 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:01.732225 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:51:01.733370 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:51:01.733789 (Thread-1): finished collecting timing info
2021-05-29 10:51:01.740247 (Thread-2): finished collecting timing info
2021-05-29 10:51:01.786427 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:51:01.790149 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:51:01.791973 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:01.792078 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:51:01.792169 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:51:01.793388 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:01.793493 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:51:01.793580 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:51:03.041327 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-29 10:51:03.041581 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:03.041722 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:51:03.121422 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 10:51:03.121659 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:51:03.121793 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 10:51:03.461069 (Thread-2): Snowflake query id: 019c918b-0000-43c5-0000-b0b10001313e
2021-05-29 10:51:03.461295 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:51:03.461516 (Thread-2): finished collecting timing info
2021-05-29 10:51:03.461725 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:51:03.793262 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:51:03.971170 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-05-29 10:51:03.972762 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:51:03.973022 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:51:03.973140 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:51:04.270845 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:51:04.283518 (Thread-1): finished collecting timing info
2021-05-29 10:51:04.283694 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:51:04.353038 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:51:04.356212 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd206a760>]}
2021-05-29 10:51:04.356623 (Thread-2): 16:21:04 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.63s]
2021-05-29 10:51:04.356802 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:51:04.871746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd209b880>]}
2021-05-29 10:51:04.872205 (Thread-1): 16:21:04 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.14s]
2021-05-29 10:51:04.872379 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:51:04.872990 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:04.873274 (Thread-4): 16:21:04 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:51:04.873635 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:04.873783 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:04.876405 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:51:04.876897 (Thread-4): finished collecting timing info
2021-05-29 10:51:04.897041 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:51:04.897879 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:04.897992 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:51:04.898101 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:51:06.454580 (Thread-4): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-29 10:51:06.454830 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:06.454969 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:51:06.982051 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-29 10:51:06.983455 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:51:06.983701 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:51:06.983842 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:51:07.326292 (Thread-4): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 10:51:07.327401 (Thread-4): finished collecting timing info
2021-05-29 10:51:07.327629 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:51:07.940819 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bab0ba-dbcb-445c-902b-712274130a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd2064370>]}
2021-05-29 10:51:07.941293 (Thread-4): 16:21:07 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.07s]
2021-05-29 10:51:07.941469 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:51:07.943017 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:51:07.943264 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:07.943383 (MainThread): On master: BEGIN
2021-05-29 10:51:07.943494 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:51:09.421253 (MainThread): SQL status: SUCCESS 1 in 1.48 seconds
2021-05-29 10:51:09.421522 (MainThread): On master: COMMIT
2021-05-29 10:51:09.421747 (MainThread): Using snowflake connection "master".
2021-05-29 10:51:09.421881 (MainThread): On master: COMMIT
2021-05-29 10:51:09.783880 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-29 10:51:09.784157 (MainThread): On master: Close
2021-05-29 10:51:10.408724 (MainThread): 16:21:10 | 
2021-05-29 10:51:10.408954 (MainThread): 16:21:10 | Finished running 2 table models, 1 view model in 17.03s.
2021-05-29 10:51:10.409105 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:51:10.409210 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:51:10.409305 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:51:10.409396 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:51:10.414226 (MainThread): 
2021-05-29 10:51:10.414399 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:51:10.414545 (MainThread): 
2021-05-29 10:51:10.414687 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:51:10.414817 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:51:10.414931 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:51:10.415040 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:51:10.415163 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:51:10.415357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd1fe05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd21189a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd2118a00>]}
2021-05-29 10:51:10.415607 (MainThread): Flushing usage events
2021-05-29 10:52:42.579349 (MainThread): Running with dbt=0.19.1
2021-05-29 10:52:43.335419 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 10:52:43.336819 (MainThread): Tracking: tracking
2021-05-29 10:52:43.337297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eccad0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece70d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece70d700>]}
2021-05-29 10:52:43.346569 (MainThread): Partial parsing not enabled
2021-05-29 10:52:43.347589 (MainThread): Parsing macros/catalog.sql
2021-05-29 10:52:43.349933 (MainThread): Parsing macros/adapters.sql
2021-05-29 10:52:43.375808 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 10:52:43.377557 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 10:52:43.378867 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 10:52:43.382299 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 10:52:43.390722 (MainThread): Parsing macros/core.sql
2021-05-29 10:52:43.393953 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 10:52:43.401906 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 10:52:43.403429 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 10:52:43.419137 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 10:52:43.449369 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 10:52:43.468995 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 10:52:43.470762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 10:52:43.476015 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 10:52:43.488130 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 10:52:43.494023 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 10:52:43.499429 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 10:52:43.504073 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 10:52:43.504876 (MainThread): Parsing macros/etc/query.sql
2021-05-29 10:52:43.505754 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 10:52:43.507131 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 10:52:43.514654 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 10:52:43.516315 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 10:52:43.517738 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 10:52:43.556188 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 10:52:43.557873 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 10:52:43.559167 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 10:52:43.560613 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 10:52:43.566925 (MainThread): Partial parsing not enabled
2021-05-29 10:52:43.585017 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:43.592132 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:43.594913 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:43.704157 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc40a730>]}
2021-05-29 10:52:43.709051 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc404820>]}
2021-05-29 10:52:43.709319 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 10:52:43.710163 (MainThread): 
2021-05-29 10:52:43.710504 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:52:43.711528 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 10:52:43.725739 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 10:52:43.725885 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 10:52:43.725988 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 10:52:45.527896 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.80 seconds
2021-05-29 10:52:45.532303 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 10:52:46.246772 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:52:46.254947 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 10:52:46.255081 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 10:52:46.255186 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 10:52:47.887606 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-29 10:52:47.888768 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 10:52:48.609813 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:48.610007 (MainThread): On master: BEGIN
2021-05-29 10:52:48.610128 (MainThread): Opening a new connection, currently in state init
2021-05-29 10:52:50.032301 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-29 10:52:50.032577 (MainThread): On master: COMMIT
2021-05-29 10:52:50.032818 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:50.032964 (MainThread): On master: COMMIT
2021-05-29 10:52:50.544359 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-29 10:52:50.544642 (MainThread): On master: Close
2021-05-29 10:52:51.365576 (MainThread): 16:22:51 | Concurrency: 10 threads (target='dev')
2021-05-29 10:52:51.365813 (MainThread): 16:22:51 | 
2021-05-29 10:52:51.368092 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:51.368275 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 10:52:51.368603 (Thread-1): 16:22:51 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 10:52:51.368856 (Thread-2): 16:22:51 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 10:52:51.369221 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:51.369952 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:51.370095 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:51.370262 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 10:52:51.372882 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:52:51.374234 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 10:52:51.374828 (Thread-1): finished collecting timing info
2021-05-29 10:52:51.381288 (Thread-2): finished collecting timing info
2021-05-29 10:52:51.428873 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 10:52:51.430531 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 10:52:51.431488 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:51.431589 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 10:52:51.431679 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 10:52:51.434161 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:51.434271 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 10:52:51.434359 (Thread-2): Opening a new connection, currently in state init
2021-05-29 10:52:53.103877 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-05-29 10:52:53.104134 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:53.104278 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 10:52:53.244387 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-05-29 10:52:53.244635 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 10:52:53.244774 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 10:52:53.718361 (Thread-2): Snowflake query id: 019c918c-0000-43c0-0000-b0b1000101ea
2021-05-29 10:52:53.718580 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:52:53.718815 (Thread-2): finished collecting timing info
2021-05-29 10:52:53.719032 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 10:52:54.073916 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 10:52:54.573506 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-05-29 10:52:54.575120 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:52:54.575346 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 10:52:54.575467 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 10:52:54.745441 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:52:54.748602 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece926220>]}
2021-05-29 10:52:54.749024 (Thread-2): 16:22:54 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.38s]
2021-05-29 10:52:54.749196 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 10:52:54.883607 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 10:52:54.895264 (Thread-1): finished collecting timing info
2021-05-29 10:52:54.895429 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 10:52:55.565041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece93a430>]}
2021-05-29 10:52:55.565515 (Thread-1): 16:22:55 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.20s]
2021-05-29 10:52:55.565693 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 10:52:55.566199 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:55.566639 (Thread-4): 16:22:55 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 10:52:55.566995 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:55.567139 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:55.569553 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:52:55.570095 (Thread-4): finished collecting timing info
2021-05-29 10:52:55.572202 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 10:52:55.573031 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:55.573147 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 10:52:55.573249 (Thread-4): Opening a new connection, currently in state init
2021-05-29 10:52:57.200260 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-29 10:52:57.200521 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:57.200663 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 10:52:58.223894 (Thread-4): SQL status: SUCCESS 1 in 1.02 seconds
2021-05-29 10:52:58.225310 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:52:58.225559 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 10:52:58.225697 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 10:52:58.521178 (Thread-4): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 10:52:58.522287 (Thread-4): finished collecting timing info
2021-05-29 10:52:58.522518 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 10:52:59.353969 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f976331e-7b2e-4081-a194-aa6ee11bda41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecef2a4f0>]}
2021-05-29 10:52:59.354448 (Thread-4): 16:22:59 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-29 10:52:59.354630 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 10:52:59.356275 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 10:52:59.356528 (MainThread): Using snowflake connection "master".
2021-05-29 10:52:59.356649 (MainThread): On master: BEGIN
2021-05-29 10:52:59.356762 (MainThread): Opening a new connection, currently in state closed
2021-05-29 10:53:00.650010 (MainThread): SQL status: SUCCESS 1 in 1.29 seconds
2021-05-29 10:53:00.650281 (MainThread): On master: COMMIT
2021-05-29 10:53:00.650516 (MainThread): Using snowflake connection "master".
2021-05-29 10:53:00.650654 (MainThread): On master: COMMIT
2021-05-29 10:53:01.091621 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-05-29 10:53:01.091903 (MainThread): On master: Close
2021-05-29 10:53:01.709015 (MainThread): 16:23:01 | 
2021-05-29 10:53:01.709254 (MainThread): 16:23:01 | Finished running 2 view models, 1 table model in 18.00s.
2021-05-29 10:53:01.709401 (MainThread): Connection 'master' was properly closed.
2021-05-29 10:53:01.709508 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 10:53:01.709606 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 10:53:01.709698 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 10:53:01.714645 (MainThread): 
2021-05-29 10:53:01.714812 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 10:53:01.714955 (MainThread): 
2021-05-29 10:53:01.715092 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 10:53:01.715217 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 10:53:01.715326 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 10:53:01.715433 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 10:53:01.715552 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 10:53:01.715739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecc404490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece777ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ece777430>]}
2021-05-29 10:53:01.715998 (MainThread): Flushing usage events
2021-05-29 11:04:38.356033 (MainThread): Running with dbt=0.19.1
2021-05-29 11:04:39.685436 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:04:39.686936 (MainThread): Tracking: tracking
2021-05-29 11:04:39.687572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a3505e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a574e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a574e6d0>]}
2021-05-29 11:04:39.698595 (MainThread): Partial parsing not enabled
2021-05-29 11:04:39.699802 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:04:39.702635 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:04:39.730299 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:04:39.731993 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:04:39.733212 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:04:39.736579 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:04:39.746820 (MainThread): Parsing macros/core.sql
2021-05-29 11:04:39.750160 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:04:39.757713 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:04:39.759186 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:04:39.774992 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:04:39.805030 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:04:39.823918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:04:39.825517 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:04:39.830755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:04:39.843297 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:04:39.849351 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:04:39.855133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:04:39.859308 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:04:39.860112 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:04:39.860998 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:04:39.862376 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:04:39.869948 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:04:39.871641 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:04:39.873311 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:04:39.911304 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:04:39.912842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:04:39.914092 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:04:39.915503 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:04:39.921763 (MainThread): Partial parsing not enabled
2021-05-29 11:04:39.939578 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:39.946520 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:39.949315 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:40.059943 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a55f3eb0>]}
2021-05-29 11:04:40.064973 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a571e2e0>]}
2021-05-29 11:04:40.065256 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:04:40.066162 (MainThread): 
2021-05-29 11:04:40.066520 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:04:40.067559 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:04:40.082775 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:04:40.082922 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:04:40.083020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:04:42.013964 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.93 seconds
2021-05-29 11:04:42.018393 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:04:42.604827 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:04:42.613520 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:04:42.613728 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:04:42.613840 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:04:43.870766 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.26 seconds
2021-05-29 11:04:43.871947 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:04:44.473493 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:44.473677 (MainThread): On master: BEGIN
2021-05-29 11:04:44.473793 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:04:45.700421 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-29 11:04:45.700683 (MainThread): On master: COMMIT
2021-05-29 11:04:45.700925 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:45.701057 (MainThread): On master: COMMIT
2021-05-29 11:04:46.108383 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:04:46.108660 (MainThread): On master: Close
2021-05-29 11:04:46.724988 (MainThread): 16:34:46 | Concurrency: 10 threads (target='dev')
2021-05-29 11:04:46.725218 (MainThread): 16:34:46 | 
2021-05-29 11:04:46.727561 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:46.727877 (Thread-1): 16:34:46 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:04:46.728092 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:04:46.728370 (Thread-2): 16:34:46 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 11:04:46.728719 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:46.728879 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:46.731651 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:04:46.732072 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:46.732209 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:04:46.733458 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:04:46.734886 (Thread-1): finished collecting timing info
2021-05-29 11:04:46.741198 (Thread-2): finished collecting timing info
2021-05-29 11:04:46.788450 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:04:46.789910 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:04:46.790954 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:46.791053 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:04:46.791142 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:04:46.792802 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:46.792906 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:04:46.792992 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:04:48.108567 (Thread-2): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-29 11:04:48.108814 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:04:48.108965 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-29 11:04:48.207775 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-29 11:04:48.208016 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:48.208146 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:04:48.566033 (Thread-2): Snowflake query id: 019c9198-0000-43c7-0000-b0b1000140ea
2021-05-29 11:04:48.566246 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-29 11:04:48.566471 (Thread-2): finished collecting timing info
2021-05-29 11:04:48.566675 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:04:49.180597 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:04:49.587282 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-29 11:04:49.588863 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:04:49.589095 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:04:49.589207 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:04:49.799411 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:04:49.804867 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5aee670>]}
2021-05-29 11:04:49.805390 (Thread-2): 16:34:49 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.07s]
2021-05-29 11:04:49.805607 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:04:49.917028 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-29 11:04:49.928749 (Thread-1): finished collecting timing info
2021-05-29 11:04:49.928901 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:04:50.718976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5ae35b0>]}
2021-05-29 11:04:50.719436 (Thread-1): 16:34:50 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.99s]
2021-05-29 11:04:50.719614 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:04:50.720124 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:50.720419 (Thread-4): 16:34:50 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:04:50.720781 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:50.720924 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:50.723349 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:04:50.723974 (Thread-4): finished collecting timing info
2021-05-29 11:04:50.726126 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:04:50.726963 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:50.727072 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:04:50.727170 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:04:52.355900 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-29 11:04:52.356140 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:52.356276 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:04:52.835312 (Thread-4): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-29 11:04:52.836711 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:04:52.836955 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:04:52.837088 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:04:53.173631 (Thread-4): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-29 11:04:53.174696 (Thread-4): finished collecting timing info
2021-05-29 11:04:53.174902 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:04:53.756750 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c0d873-4152-4b31-a846-1621805e00b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5aec400>]}
2021-05-29 11:04:53.757205 (Thread-4): 16:34:53 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.04s]
2021-05-29 11:04:53.757379 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:04:53.759050 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:04:53.759296 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:53.759409 (MainThread): On master: BEGIN
2021-05-29 11:04:53.759516 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:04:55.324592 (MainThread): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-29 11:04:55.324845 (MainThread): On master: COMMIT
2021-05-29 11:04:55.325066 (MainThread): Using snowflake connection "master".
2021-05-29 11:04:55.325193 (MainThread): On master: COMMIT
2021-05-29 11:04:55.734161 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:04:55.734434 (MainThread): On master: Close
2021-05-29 11:04:56.453195 (MainThread): 16:34:56 | 
2021-05-29 11:04:56.453385 (MainThread): 16:34:56 | Finished running 2 view models, 1 table model in 16.39s.
2021-05-29 11:04:56.453503 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:04:56.453584 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:04:56.453657 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:04:56.453727 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:04:56.457855 (MainThread): 
2021-05-29 11:04:56.458030 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:04:56.458151 (MainThread): 
2021-05-29 11:04:56.458262 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:04:56.458360 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:04:56.458449 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-29 11:04:56.458534 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:04:56.458633 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:04:56.458806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a59d76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5b2ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a5b1c970>]}
2021-05-29 11:04:56.459023 (MainThread): Flushing usage events
2021-05-29 11:06:00.154580 (MainThread): Running with dbt=0.19.1
2021-05-29 11:06:00.902123 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:06:00.903596 (MainThread): Tracking: tracking
2021-05-29 11:06:00.904049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20d7f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f34c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f34c6d0>]}
2021-05-29 11:06:00.913446 (MainThread): Partial parsing not enabled
2021-05-29 11:06:00.914408 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:06:00.916578 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:06:00.942959 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:06:00.944810 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:06:00.946040 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:06:00.949410 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:06:00.957798 (MainThread): Parsing macros/core.sql
2021-05-29 11:06:00.961288 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:06:00.968795 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:06:00.970282 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:06:00.985715 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:06:01.017405 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:06:01.037337 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:06:01.038954 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:06:01.044344 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:06:01.056505 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:06:01.062657 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:06:01.068135 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:06:01.072482 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:06:01.073291 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:06:01.074251 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:06:01.075639 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:06:01.083288 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:06:01.084974 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:06:01.086412 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:06:01.124865 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:06:01.126574 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:06:01.127888 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:06:01.129347 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:06:01.135718 (MainThread): Partial parsing not enabled
2021-05-29 11:06:01.154132 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:01.162173 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:01.164964 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:01.279094 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f2f3eb0>]}
2021-05-29 11:06:01.284133 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f31e2e0>]}
2021-05-29 11:06:01.284415 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:06:01.285315 (MainThread): 
2021-05-29 11:06:01.285679 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:06:01.286675 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:06:01.301015 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:06:01.301165 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:06:01.301267 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:06:02.995433 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.69 seconds
2021-05-29 11:06:02.999672 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:06:03.782517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:06:03.790280 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:06:03.790407 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:06:03.790520 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:06:05.437505 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.65 seconds
2021-05-29 11:06:05.438666 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:06:06.010398 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:06.010587 (MainThread): On master: BEGIN
2021-05-29 11:06:06.010705 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:06:07.500683 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-29 11:06:07.500951 (MainThread): On master: COMMIT
2021-05-29 11:06:07.501192 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:07.501327 (MainThread): On master: COMMIT
2021-05-29 11:06:07.910139 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:06:07.910413 (MainThread): On master: Close
2021-05-29 11:06:08.526482 (MainThread): 16:36:08 | Concurrency: 10 threads (target='dev')
2021-05-29 11:06:08.526719 (MainThread): 16:36:08 | 
2021-05-29 11:06:08.529050 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:08.529386 (Thread-1): 16:36:08 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:06:08.529604 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:06:08.529899 (Thread-2): 16:36:08 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:06:08.530285 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:08.530452 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:08.531028 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:08.531180 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:06:08.533753 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:06:08.536372 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:06:08.536797 (Thread-2): finished collecting timing info
2021-05-29 11:06:08.542656 (Thread-1): finished collecting timing info
2021-05-29 11:06:08.590066 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:06:08.592948 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:06:08.594416 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:08.594523 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:06:08.594614 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:06:08.596409 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:08.596523 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:06:08.596610 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:06:09.966208 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-29 11:06:09.966460 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:09.966595 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:06:10.034768 (Thread-2): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:06:10.034972 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:06:10.035081 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-29 11:06:10.572165 (Thread-2): Snowflake query id: 019c919a-0000-43c0-0000-b0b100010212
2021-05-29 11:06:10.572390 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:06:10.572616 (Thread-2): finished collecting timing info
2021-05-29 11:06:10.572829 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:06:11.186934 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:06:11.224777 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-29 11:06:11.226372 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:06:11.226623 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:06:11.226739 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:06:11.534689 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 11:06:11.547180 (Thread-1): finished collecting timing info
2021-05-29 11:06:11.547348 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:06:11.803462 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:06:11.806571 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f79cfa0>]}
2021-05-29 11:06:11.806975 (Thread-2): 16:36:11 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.28s]
2021-05-29 11:06:11.807166 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:06:12.316514 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3a0250>]}
2021-05-29 11:06:12.316978 (Thread-1): 16:36:12 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-29 11:06:12.317154 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:06:12.317790 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:12.318085 (Thread-4): 16:36:12 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:06:12.318544 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:12.318696 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:12.321162 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:06:12.321643 (Thread-4): finished collecting timing info
2021-05-29 11:06:12.340498 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:06:12.341293 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:12.341402 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:06:12.341494 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:06:13.849697 (Thread-4): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-29 11:06:13.849953 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:13.850092 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:06:14.463475 (Thread-4): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 11:06:14.464793 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:06:14.464998 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:06:14.465114 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:06:14.771791 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-29 11:06:14.772893 (Thread-4): finished collecting timing info
2021-05-29 11:06:14.773114 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:06:15.796430 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bed110-48b0-4f5f-990f-3a3995cbfa6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd210c1dfa0>]}
2021-05-29 11:06:15.796898 (Thread-4): 16:36:15 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-29 11:06:15.797078 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:06:15.798603 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:06:15.798853 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:15.798970 (MainThread): On master: BEGIN
2021-05-29 11:06:15.799078 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:06:17.638201 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-29 11:06:17.638474 (MainThread): On master: COMMIT
2021-05-29 11:06:17.638715 (MainThread): Using snowflake connection "master".
2021-05-29 11:06:17.638851 (MainThread): On master: COMMIT
2021-05-29 11:06:18.252579 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-29 11:06:18.252856 (MainThread): On master: Close
2021-05-29 11:06:19.073880 (MainThread): 16:36:19 | 
2021-05-29 11:06:19.074117 (MainThread): 16:36:19 | Finished running 2 table models, 1 view model in 17.79s.
2021-05-29 11:06:19.074271 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:06:19.074376 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:06:19.074472 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:06:19.074563 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:06:19.079261 (MainThread): 
2021-05-29 11:06:19.079419 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:06:19.079553 (MainThread): 
2021-05-29 11:06:19.079683 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:06:19.079799 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:06:19.079904 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:06:19.080004 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:06:19.080118 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:06:19.080396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3889d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f3a0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f7d5a30>]}
2021-05-29 11:06:19.080652 (MainThread): Flushing usage events
2021-05-29 11:11:05.669223 (MainThread): Running with dbt=0.19.1
2021-05-29 11:11:06.447776 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:11:06.449329 (MainThread): Tracking: tracking
2021-05-29 11:11:06.449765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa285b06c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2899925b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289992640>]}
2021-05-29 11:11:06.459584 (MainThread): Partial parsing not enabled
2021-05-29 11:11:06.460550 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:11:06.462673 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:11:06.488676 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:11:06.490613 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:11:06.491885 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:11:06.495479 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:11:06.504050 (MainThread): Parsing macros/core.sql
2021-05-29 11:11:06.507333 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:11:06.514982 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:11:06.516506 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:11:06.532255 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:11:06.562393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:11:06.581608 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:11:06.583318 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:11:06.589099 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:11:06.601488 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:11:06.607432 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:11:06.612881 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:11:06.617089 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:11:06.618228 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:11:06.619126 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:11:06.620503 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:11:06.628187 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:11:06.629880 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:11:06.631327 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:11:06.669499 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:11:06.671110 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:11:06.672530 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:11:06.673991 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:11:06.680284 (MainThread): Partial parsing not enabled
2021-05-29 11:11:06.698326 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:06.705997 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:06.708722 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:06.818543 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa285449e80>]}
2021-05-29 11:11:06.823545 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2854497c0>]}
2021-05-29 11:11:06.823821 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:11:06.824684 (MainThread): 
2021-05-29 11:11:06.825030 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:11:06.826014 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:11:06.840561 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:11:06.840712 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:11:06.840810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:11:08.763309 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-05-29 11:11:08.767742 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:11:09.380701 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:11:09.388971 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:11:09.389120 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:11:09.389236 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:11:11.219542 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-29 11:11:11.220682 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:11:12.041459 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:12.041651 (MainThread): On master: BEGIN
2021-05-29 11:11:12.041770 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:11:13.394376 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-29 11:11:13.394656 (MainThread): On master: COMMIT
2021-05-29 11:11:13.394899 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:13.395037 (MainThread): On master: COMMIT
2021-05-29 11:11:13.779816 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:11:13.780099 (MainThread): On master: Close
2021-05-29 11:11:14.375693 (MainThread): 16:41:14 | Concurrency: 10 threads (target='dev')
2021-05-29 11:11:14.375933 (MainThread): 16:41:14 | 
2021-05-29 11:11:14.378208 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:14.378395 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:11:14.378716 (Thread-1): 16:41:14 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:11:14.378966 (Thread-2): 16:41:14 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:11:14.379322 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:14.379997 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:14.380154 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:14.380285 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:11:14.382830 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:11:14.385108 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:11:14.385617 (Thread-1): finished collecting timing info
2021-05-29 11:11:14.385770 (Thread-2): finished collecting timing info
2021-05-29 11:11:14.432026 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:11:14.434199 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:11:14.435182 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:14.435283 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:11:14.435371 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:11:14.437572 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:14.437679 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:11:14.437766 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:11:15.832746 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 11:11:15.832997 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:15.833135 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:11:15.892660 (Thread-2): SQL status: SUCCESS 1 in 1.45 seconds
2021-05-29 11:11:15.892904 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:11:15.893041 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-29 11:11:16.223386 (Thread-2): Snowflake query id: 019c919f-0000-43c7-0000-b0b100014196
2021-05-29 11:11:16.223608 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:11:16.223829 (Thread-2): finished collecting timing info
2021-05-29 11:11:16.224042 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:11:16.646833 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:11:17.365934 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:11:17.369090 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289ba85e0>]}
2021-05-29 11:11:17.369516 (Thread-2): 16:41:17 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.99s]
2021-05-29 11:11:17.369702 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:11:17.370956 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 11:11:17.372144 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:11:17.372337 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:11:17.372452 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:11:17.671104 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 11:11:17.683897 (Thread-1): finished collecting timing info
2021-05-29 11:11:17.684073 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:11:18.253385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289ba3ee0>]}
2021-05-29 11:11:18.253840 (Thread-1): 16:41:18 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.87s]
2021-05-29 11:11:18.254015 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:11:18.254619 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:18.254891 (Thread-4): 16:41:18 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:11:18.255344 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:18.255486 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:18.257902 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:11:18.258383 (Thread-4): finished collecting timing info
2021-05-29 11:11:18.276809 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:11:18.277583 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:18.277688 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:11:18.277779 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:11:19.718902 (Thread-4): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:11:19.719142 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:19.719272 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:11:20.389422 (Thread-4): SQL status: SUCCESS 1 in 0.67 seconds
2021-05-29 11:11:20.390751 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:11:20.390958 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:11:20.391072 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:11:20.743192 (Thread-4): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-29 11:11:20.744270 (Thread-4): finished collecting timing info
2021-05-29 11:11:20.744487 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:11:21.462083 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d79-34ab-4f5e-81f7-c745cedc0473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bedc40>]}
2021-05-29 11:11:21.462555 (Thread-4): 16:41:21 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.21s]
2021-05-29 11:11:21.462729 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:11:21.464336 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:11:21.464578 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:21.464692 (MainThread): On master: BEGIN
2021-05-29 11:11:21.464795 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:11:23.008444 (MainThread): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-29 11:11:23.008708 (MainThread): On master: COMMIT
2021-05-29 11:11:23.008935 (MainThread): Using snowflake connection "master".
2021-05-29 11:11:23.009065 (MainThread): On master: COMMIT
2021-05-29 11:11:23.405641 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 11:11:23.405914 (MainThread): On master: Close
2021-05-29 11:11:24.009919 (MainThread): 16:41:24 | 
2021-05-29 11:11:24.010146 (MainThread): 16:41:24 | Finished running 2 table models, 1 view model in 17.18s.
2021-05-29 11:11:24.010284 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:11:24.010383 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:11:24.010473 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:11:24.010562 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:11:24.015300 (MainThread): 
2021-05-29 11:11:24.015454 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:11:24.015583 (MainThread): 
2021-05-29 11:11:24.015706 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:11:24.015814 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-29 11:11:24.015914 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-29 11:11:24.016009 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:11:24.016120 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:11:24.016289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bd0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289b21610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa289bec220>]}
2021-05-29 11:11:24.016519 (MainThread): Flushing usage events
2021-05-29 11:13:50.764569 (MainThread): Running with dbt=0.19.1
2021-05-29 11:13:51.605237 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:13:51.606801 (MainThread): Tracking: tracking
2021-05-29 11:13:51.607350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf6c47d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8790580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8790610>]}
2021-05-29 11:13:51.618911 (MainThread): Partial parsing not enabled
2021-05-29 11:13:51.620077 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:13:51.622677 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:13:51.651524 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:13:51.653745 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:13:51.655254 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:13:51.659015 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:13:51.668285 (MainThread): Parsing macros/core.sql
2021-05-29 11:13:51.672157 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:13:51.680061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:13:51.681636 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:13:51.697875 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:13:51.730353 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:13:51.749521 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:13:51.751173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:13:51.756560 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:13:51.769372 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:13:51.775645 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:13:51.781299 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:13:51.785752 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:13:51.786602 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:13:51.787575 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:13:51.789209 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:13:51.797363 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:13:51.799096 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:13:51.800573 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:13:51.840316 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:13:51.842029 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:13:51.843364 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:13:51.844910 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:13:51.851414 (MainThread): Partial parsing not enabled
2021-05-29 11:13:51.871217 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:51.878773 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:51.881717 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:13:51.997616 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf657a790>]}
2021-05-29 11:13:52.002584 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf658f6d0>]}
2021-05-29 11:13:52.002898 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:13:52.003897 (MainThread): 
2021-05-29 11:13:52.004308 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:13:52.005360 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:13:52.019698 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:13:52.019855 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:13:52.019956 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:13:53.729681 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.71 seconds
2021-05-29 11:13:53.733633 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:13:54.540922 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:13:54.548129 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:13:54.548268 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:13:54.548368 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:13:55.879455 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.33 seconds
2021-05-29 11:13:55.880743 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:13:56.904837 (MainThread): Using snowflake connection "master".
2021-05-29 11:13:56.905035 (MainThread): On master: BEGIN
2021-05-29 11:13:56.905174 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:13:58.234157 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 11:13:58.234398 (MainThread): On master: COMMIT
2021-05-29 11:13:58.234597 (MainThread): Using snowflake connection "master".
2021-05-29 11:13:58.234717 (MainThread): On master: COMMIT
2021-05-29 11:13:58.615536 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:13:58.615815 (MainThread): On master: Close
2021-05-29 11:13:59.456918 (MainThread): 16:43:59 | Concurrency: 10 threads (target='dev')
2021-05-29 11:13:59.457149 (MainThread): 16:43:59 | 
2021-05-29 11:13:59.459399 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:13:59.459729 (Thread-1): 16:43:59 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:13:59.460078 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:59.460230 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:13:59.460746 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:13:59.460982 (Thread-2): 16:43:59 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-29 11:13:59.463197 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:13:59.463497 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:59.463721 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:13:59.464938 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:13:59.465308 (Thread-1): finished collecting timing info
2021-05-29 11:13:59.471161 (Thread-2): finished collecting timing info
2021-05-29 11:13:59.516918 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:13:59.521262 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:13:59.522235 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:13:59.522337 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:13:59.522426 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:13:59.524439 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:13:59.524547 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:13:59.524635 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:14:00.965356 (Thread-2): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:14:00.965832 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-05-29 11:14:00.966009 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:14:00.966135 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:14:00.966252 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-29 11:14:00.966372 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:14:01.282822 (Thread-2): Snowflake query id: 019c91a2-0000-43c7-0000-b0b1000141b2
2021-05-29 11:14:01.283004 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:14:01.283188 (Thread-2): finished collecting timing info
2021-05-29 11:14:01.283357 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:14:01.716051 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:14:02.003625 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-05-29 11:14:02.005227 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:14:02.005492 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:14:02.005605 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:14:02.331281 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-05-29 11:14:02.343008 (Thread-1): finished collecting timing info
2021-05-29 11:14:02.343193 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:14:02.335797 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:14:02.347858 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf9238c70>]}
2021-05-29 11:14:02.348225 (Thread-2): 16:44:02 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.88s]
2021-05-29 11:14:02.348376 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:14:03.014675 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91afb50>]}
2021-05-29 11:14:03.015136 (Thread-1): 16:44:03 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.55s]
2021-05-29 11:14:03.015303 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:14:03.015933 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:03.016220 (Thread-4): 16:44:03 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:14:03.016577 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:03.016723 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:03.019170 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:14:03.019625 (Thread-4): finished collecting timing info
2021-05-29 11:14:03.038412 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:14:03.039259 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:03.039367 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:14:03.039460 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:14:04.378671 (Thread-4): SQL status: SUCCESS 1 in 1.34 seconds
2021-05-29 11:14:04.378921 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:04.379063 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:14:05.095299 (Thread-4): SQL status: SUCCESS 1 in 0.72 seconds
2021-05-29 11:14:05.096905 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:14:05.097186 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:14:05.097317 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:14:05.506051 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-29 11:14:05.507159 (Thread-4): finished collecting timing info
2021-05-29 11:14:05.507386 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:14:06.223860 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d453ae-5567-4f0c-b3db-d00648c1e750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf9260700>]}
2021-05-29 11:14:06.224333 (Thread-4): 16:44:06 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.21s]
2021-05-29 11:14:06.224506 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:14:06.226174 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:14:06.226419 (MainThread): Using snowflake connection "master".
2021-05-29 11:14:06.226539 (MainThread): On master: BEGIN
2021-05-29 11:14:06.226650 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:14:07.789938 (MainThread): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-29 11:14:07.790212 (MainThread): On master: COMMIT
2021-05-29 11:14:07.790445 (MainThread): Using snowflake connection "master".
2021-05-29 11:14:07.790581 (MainThread): On master: COMMIT
2021-05-29 11:14:08.167553 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-29 11:14:08.167834 (MainThread): On master: Close
2021-05-29 11:14:08.850849 (MainThread): 16:44:08 | 
2021-05-29 11:14:08.851081 (MainThread): 16:44:08 | Finished running 2 table models, 1 view model in 16.85s.
2021-05-29 11:14:08.851230 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:14:08.851332 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:14:08.851424 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:14:08.851512 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:14:08.856131 (MainThread): 
2021-05-29 11:14:08.856284 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:14:08.856412 (MainThread): 
2021-05-29 11:14:08.856535 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:14:08.856656 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 11:14:08.856752 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:14:08.856846 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:14:08.856950 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:14:08.857116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91185e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91f9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf91f99a0>]}
2021-05-29 11:14:08.857331 (MainThread): Flushing usage events
2021-05-29 11:46:38.033212 (MainThread): Running with dbt=0.19.1
2021-05-29 11:46:39.505945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 11:46:39.508254 (MainThread): Tracking: tracking
2021-05-29 11:46:39.508808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb743608c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745152580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745152610>]}
2021-05-29 11:46:39.521576 (MainThread): Partial parsing not enabled
2021-05-29 11:46:39.523284 (MainThread): Parsing macros/catalog.sql
2021-05-29 11:46:39.526410 (MainThread): Parsing macros/adapters.sql
2021-05-29 11:46:39.560409 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 11:46:39.562905 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 11:46:39.564881 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 11:46:39.569602 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 11:46:39.580297 (MainThread): Parsing macros/core.sql
2021-05-29 11:46:39.584258 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 11:46:39.592460 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 11:46:39.594232 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 11:46:39.611562 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 11:46:39.646258 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 11:46:39.666078 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 11:46:39.667905 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 11:46:39.673621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 11:46:39.687339 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 11:46:39.694199 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 11:46:39.700283 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 11:46:39.704958 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 11:46:39.705979 (MainThread): Parsing macros/etc/query.sql
2021-05-29 11:46:39.707331 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 11:46:39.708979 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 11:46:39.717575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 11:46:39.719514 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 11:46:39.721230 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 11:46:39.762009 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 11:46:39.763949 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 11:46:39.765524 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 11:46:39.767085 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 11:46:39.773626 (MainThread): Partial parsing not enabled
2021-05-29 11:46:39.794425 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:39.803727 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:39.808810 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:39.935101 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273a790>]}
2021-05-29 11:46:39.940907 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273aeb0>]}
2021-05-29 11:46:39.941232 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 11:46:39.942167 (MainThread): 
2021-05-29 11:46:39.942541 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:46:39.943618 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 11:46:39.958988 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 11:46:39.959153 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 11:46:39.959256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 11:46:42.008418 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.05 seconds
2021-05-29 11:46:42.011724 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 11:46:43.049127 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:46:43.056776 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 11:46:43.056908 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 11:46:43.057017 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 11:46:44.245511 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.19 seconds
2021-05-29 11:46:44.246591 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 11:46:45.087367 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:45.087550 (MainThread): On master: BEGIN
2021-05-29 11:46:45.087654 (MainThread): Opening a new connection, currently in state init
2021-05-29 11:46:46.484637 (MainThread): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-29 11:46:46.484906 (MainThread): On master: COMMIT
2021-05-29 11:46:46.485134 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:46.485271 (MainThread): On master: COMMIT
2021-05-29 11:46:46.944196 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-29 11:46:46.944480 (MainThread): On master: Close
2021-05-29 11:46:47.636135 (MainThread): 17:16:47 | Concurrency: 10 threads (target='dev')
2021-05-29 11:46:47.636361 (MainThread): 17:16:47 | 
2021-05-29 11:46:47.638444 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:47.638624 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 11:46:47.638944 (Thread-1): 17:16:47 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 11:46:47.639210 (Thread-2): 17:16:47 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 11:46:47.639613 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:47.640178 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:47.640374 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:47.640503 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 11:46:47.642761 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:46:47.643985 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 11:46:47.645189 (Thread-1): finished collecting timing info
2021-05-29 11:46:47.645327 (Thread-2): finished collecting timing info
2021-05-29 11:46:47.692528 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 11:46:47.696106 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 11:46:47.697888 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:47.697990 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 11:46:47.698079 (Thread-2): Opening a new connection, currently in state init
2021-05-29 11:46:47.699316 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:47.699424 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 11:46:47.699514 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 11:46:49.202848 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 11:46:49.203102 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:49.203254 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 11:46:49.422761 (Thread-2): SQL status: SUCCESS 1 in 1.72 seconds
2021-05-29 11:46:49.423006 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 11:46:49.423145 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 11:46:49.821744 (Thread-2): Snowflake query id: 019c91c2-0000-43c5-0000-b0b100013246
2021-05-29 11:46:49.821969 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:46:49.822207 (Thread-2): finished collecting timing info
2021-05-29 11:46:49.822444 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 11:46:50.432154 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 11:46:50.704107 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-29 11:46:50.705509 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:46:50.705719 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 11:46:50.705838 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 11:46:51.064514 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:46:51.079681 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745462850>]}
2021-05-29 11:46:51.080109 (Thread-2): 17:16:51 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.44s]
2021-05-29 11:46:51.080336 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 11:46:51.201454 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-29 11:46:51.213486 (Thread-1): finished collecting timing info
2021-05-29 11:46:51.213785 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 11:46:52.103001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb745311910>]}
2021-05-29 11:46:52.103458 (Thread-1): 17:16:52 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.46s]
2021-05-29 11:46:52.103636 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 11:46:52.104430 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:52.104707 (Thread-4): 17:16:52 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 11:46:52.105122 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:52.105265 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:52.107515 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:46:52.107963 (Thread-4): finished collecting timing info
2021-05-29 11:46:52.109995 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 11:46:52.110744 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:52.110851 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 11:46:52.110945 (Thread-4): Opening a new connection, currently in state init
2021-05-29 11:46:53.600839 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-29 11:46:53.601094 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:53.601237 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 11:46:54.090956 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-29 11:46:54.092346 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:46:54.092590 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 11:46:54.092732 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 11:46:54.411186 (Thread-4): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-29 11:46:54.412197 (Thread-4): finished collecting timing info
2021-05-29 11:46:54.412391 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 11:46:55.002130 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7985ad-dd06-4a8f-a039-0684ff186939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7454a1790>]}
2021-05-29 11:46:55.002612 (Thread-4): 17:16:55 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.90s]
2021-05-29 11:46:55.002789 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 11:46:55.004276 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 11:46:55.004518 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:55.004637 (MainThread): On master: BEGIN
2021-05-29 11:46:55.004745 (MainThread): Opening a new connection, currently in state closed
2021-05-29 11:46:56.179385 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-05-29 11:46:56.179667 (MainThread): On master: COMMIT
2021-05-29 11:46:56.179913 (MainThread): Using snowflake connection "master".
2021-05-29 11:46:56.180024 (MainThread): On master: COMMIT
2021-05-29 11:46:56.608341 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-05-29 11:46:56.608618 (MainThread): On master: Close
2021-05-29 11:46:57.220477 (MainThread): 17:16:57 | 
2021-05-29 11:46:57.220696 (MainThread): 17:16:57 | Finished running 2 view models, 1 table model in 17.28s.
2021-05-29 11:46:57.220831 (MainThread): Connection 'master' was properly closed.
2021-05-29 11:46:57.220930 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 11:46:57.221021 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 11:46:57.221108 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 11:46:57.227084 (MainThread): 
2021-05-29 11:46:57.227285 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 11:46:57.227419 (MainThread): 
2021-05-29 11:46:57.227557 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 11:46:57.227681 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 11:46:57.227790 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 11:46:57.227881 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 11:46:57.227985 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 11:46:57.228160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74273a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7453d75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74704a670>]}
2021-05-29 11:46:57.228380 (MainThread): Flushing usage events
2021-05-29 12:29:08.393114 (MainThread): Running with dbt=0.19.1
2021-05-29 12:29:09.679752 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 12:29:09.682120 (MainThread): Tracking: tracking
2021-05-29 12:29:09.683053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab84a8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba24e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba24e7f0>]}
2021-05-29 12:29:09.697853 (MainThread): Partial parsing not enabled
2021-05-29 12:29:09.699238 (MainThread): Parsing macros/catalog.sql
2021-05-29 12:29:09.702280 (MainThread): Parsing macros/adapters.sql
2021-05-29 12:29:09.738331 (MainThread): Parsing macros/materializations/merge.sql
2021-05-29 12:29:09.740573 (MainThread): Parsing macros/materializations/view.sql
2021-05-29 12:29:09.742266 (MainThread): Parsing macros/materializations/table.sql
2021-05-29 12:29:09.747262 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-29 12:29:09.759915 (MainThread): Parsing macros/core.sql
2021-05-29 12:29:09.764657 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-29 12:29:09.774464 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-29 12:29:09.776459 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-29 12:29:09.797474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-29 12:29:09.837440 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-29 12:29:09.861715 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-29 12:29:09.863757 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-29 12:29:09.870680 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-29 12:29:09.887440 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-29 12:29:09.895238 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-29 12:29:09.902196 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-29 12:29:09.907640 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-29 12:29:09.908654 (MainThread): Parsing macros/etc/query.sql
2021-05-29 12:29:09.909761 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-29 12:29:09.911728 (MainThread): Parsing macros/etc/datetime.sql
2021-05-29 12:29:09.922111 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-29 12:29:09.924743 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-29 12:29:09.927017 (MainThread): Parsing macros/adapters/common.sql
2021-05-29 12:29:09.977513 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-29 12:29:09.979636 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-29 12:29:09.981303 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-29 12:29:09.983158 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-29 12:29:09.991315 (MainThread): Partial parsing not enabled
2021-05-29 12:29:10.016063 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:10.025473 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:10.029159 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:10.169731 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab7f043a0>]}
2021-05-29 12:29:10.176567 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba2e5220>]}
2021-05-29 12:29:10.176971 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-29 12:29:10.178054 (MainThread): 
2021-05-29 12:29:10.178533 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 12:29:10.179725 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-29 12:29:10.195586 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-29 12:29:10.195757 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-29 12:29:10.195861 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 12:29:11.779663 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-29 12:29:11.783227 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-29 12:29:12.381424 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 12:29:12.388971 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-29 12:29:12.389188 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-29 12:29:12.389303 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 12:29:13.717125 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.33 seconds
2021-05-29 12:29:13.718062 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-29 12:29:14.310259 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:14.310495 (MainThread): On master: BEGIN
2021-05-29 12:29:14.310623 (MainThread): Opening a new connection, currently in state init
2021-05-29 12:29:15.685935 (MainThread): SQL status: SUCCESS 1 in 1.38 seconds
2021-05-29 12:29:15.686186 (MainThread): On master: COMMIT
2021-05-29 12:29:15.686371 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:15.686473 (MainThread): On master: COMMIT
2021-05-29 12:29:16.085975 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-29 12:29:16.086207 (MainThread): On master: Close
2021-05-29 12:29:16.856659 (MainThread): 17:59:16 | Concurrency: 10 threads (target='dev')
2021-05-29 12:29:16.856876 (MainThread): 17:59:16 | 
2021-05-29 12:29:16.858544 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:16.858703 (Thread-2): Began running node model.demo_dbt.customers
2021-05-29 12:29:16.858992 (Thread-1): 17:59:16 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-29 12:29:16.859218 (Thread-2): 17:59:16 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-29 12:29:16.859573 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:16.860006 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:16.862169 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 12:29:16.862592 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:16.862716 (Thread-2): Compiling model.demo_dbt.customers
2021-05-29 12:29:16.863795 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-29 12:29:16.863903 (Thread-1): finished collecting timing info
2021-05-29 12:29:16.886230 (Thread-2): finished collecting timing info
2021-05-29 12:29:16.902275 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-29 12:29:16.915331 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-29 12:29:16.917554 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:16.919263 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:16.919408 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-29 12:29:16.919576 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-29 12:29:16.919717 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 12:29:16.919844 (Thread-2): Opening a new connection, currently in state init
2021-05-29 12:29:18.184150 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-29 12:29:18.184364 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:18.184477 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-29 12:29:18.234301 (Thread-2): SQL status: SUCCESS 1 in 1.31 seconds
2021-05-29 12:29:18.234483 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-29 12:29:18.234583 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-05-29 12:29:18.562988 (Thread-2): Snowflake query id: 019c91ed-0000-43c7-0000-b0b100014216
2021-05-29 12:29:18.563159 (Thread-2): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 12:29:18.563328 (Thread-2): finished collecting timing info
2021-05-29 12:29:18.563479 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-29 12:29:18.914000 (Thread-2): On model.demo_dbt.customers: Close
2021-05-29 12:29:19.514133 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-29 12:29:19.515379 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 12:29:19.515600 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-29 12:29:19.515700 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-29 12:29:19.595648 (Thread-2): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 12:29:19.601513 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba46fdf0>]}
2021-05-29 12:29:19.601950 (Thread-2): 17:59:19 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 2.74s]
2021-05-29 12:29:19.602115 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-29 12:29:19.813294 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-29 12:29:19.823982 (Thread-1): finished collecting timing info
2021-05-29 12:29:19.824153 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-29 12:29:20.384669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba2809a0>]}
2021-05-29 12:29:20.385066 (Thread-1): 17:59:20 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.53s]
2021-05-29 12:29:20.385290 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-29 12:29:20.385828 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:20.386130 (Thread-4): 17:59:20 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-29 12:29:20.386469 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:20.386626 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:20.389229 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 12:29:20.390048 (Thread-4): finished collecting timing info
2021-05-29 12:29:20.392679 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-29 12:29:20.393649 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:20.393768 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-29 12:29:20.393863 (Thread-4): Opening a new connection, currently in state init
2021-05-29 12:29:21.712242 (Thread-4): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-29 12:29:21.712463 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:21.712576 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-29 12:29:22.311724 (Thread-4): SQL status: SUCCESS 1 in 0.60 seconds
2021-05-29 12:29:22.312776 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 12:29:22.312956 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-29 12:29:22.313049 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-29 12:29:22.791857 (Thread-4): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-29 12:29:22.793108 (Thread-4): finished collecting timing info
2021-05-29 12:29:22.793392 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-29 12:29:23.373737 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c07103c-1816-4464-af53-274e89a1b98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba5cbd90>]}
2021-05-29 12:29:23.374171 (Thread-4): 17:59:23 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.99s]
2021-05-29 12:29:23.374336 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-29 12:29:23.375978 (MainThread): Acquiring new snowflake connection "master".
2021-05-29 12:29:23.376239 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:23.376351 (MainThread): On master: BEGIN
2021-05-29 12:29:23.376453 (MainThread): Opening a new connection, currently in state closed
2021-05-29 12:29:25.370617 (MainThread): SQL status: SUCCESS 1 in 1.99 seconds
2021-05-29 12:29:25.370882 (MainThread): On master: COMMIT
2021-05-29 12:29:25.371119 (MainThread): Using snowflake connection "master".
2021-05-29 12:29:25.371250 (MainThread): On master: COMMIT
2021-05-29 12:29:25.790275 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-29 12:29:25.790549 (MainThread): On master: Close
2021-05-29 12:29:26.381125 (MainThread): 17:59:26 | 
2021-05-29 12:29:26.381324 (MainThread): 17:59:26 | Finished running 2 view models, 1 table model in 16.20s.
2021-05-29 12:29:26.381451 (MainThread): Connection 'master' was properly closed.
2021-05-29 12:29:26.381536 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-29 12:29:26.381611 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-29 12:29:26.381682 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-29 12:29:26.386423 (MainThread): 
2021-05-29 12:29:26.386638 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 12:29:26.386827 (MainThread): 
2021-05-29 12:29:26.386988 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-29 12:29:26.387122 (MainThread):   001100 (42601): SQL compilation error:
2021-05-29 12:29:26.387236 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-29 12:29:26.387332 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-29 12:29:26.387454 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-29 12:29:26.387665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba21db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba3d8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaba490190>]}
2021-05-29 12:29:26.387935 (MainThread): Flushing usage events
2021-05-30 13:45:42.969214 (MainThread): Running with dbt=0.19.1
2021-05-30 13:45:44.698517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:45:44.700613 (MainThread): Tracking: tracking
2021-05-30 13:45:44.701129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d1623b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d398f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d398f7f0>]}
2021-05-30 13:45:44.713420 (MainThread): Partial parsing not enabled
2021-05-30 13:45:44.714919 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:45:44.717942 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:45:44.748094 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:45:44.750032 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:45:44.751502 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:45:44.755115 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:45:44.765111 (MainThread): Parsing macros/core.sql
2021-05-30 13:45:44.769290 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:45:44.777892 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:45:44.779872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:45:44.798344 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:45:44.831401 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:45:44.850010 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:45:44.851811 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:45:44.857521 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:45:44.870474 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:45:44.877367 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:45:44.883874 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:45:44.888529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:45:44.889754 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:45:44.890953 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:45:44.892621 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:45:44.900686 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:45:44.902647 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:45:44.904308 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:45:44.944906 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:45:44.947387 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:45:44.948900 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:45:44.950566 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:45:44.958005 (MainThread): Partial parsing not enabled
2021-05-30 13:45:44.981848 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:44.991268 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:44.995543 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:45:45.126416 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d107c3a0>]}
2021-05-30 13:45:45.134763 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3b26220>]}
2021-05-30 13:45:45.135160 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:45:45.136180 (MainThread): 
2021-05-30 13:45:45.136583 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:45:45.137677 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:45:45.153863 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:45:45.154018 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:45:45.154116 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:45:47.607409 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.45 seconds
2021-05-30 13:45:47.612044 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:45:48.427544 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:45:48.435205 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:45:48.435325 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:45:48.435418 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:45:50.574945 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.14 seconds
2021-05-30 13:45:50.576101 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:45:51.396865 (MainThread): Using snowflake connection "master".
2021-05-30 13:45:51.397048 (MainThread): On master: BEGIN
2021-05-30 13:45:51.397163 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:45:52.929956 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:45:52.930226 (MainThread): On master: COMMIT
2021-05-30 13:45:52.930462 (MainThread): Using snowflake connection "master".
2021-05-30 13:45:52.930604 (MainThread): On master: COMMIT
2021-05-30 13:45:54.211645 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-30 13:45:54.211915 (MainThread): On master: Close
2021-05-30 13:45:55.696555 (MainThread): 19:15:55 | Concurrency: 10 threads (target='dev')
2021-05-30 13:45:55.696785 (MainThread): 19:15:55 | 
2021-05-30 13:45:55.699150 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:45:55.699480 (Thread-1): 19:15:55 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:45:55.699694 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:45:55.699976 (Thread-2): 19:15:55 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 13:45:55.700346 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:55.700512 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:45:55.701179 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:55.701324 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:45:55.702634 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:45:55.705189 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:45:55.706225 (Thread-2): finished collecting timing info
2021-05-30 13:45:55.706419 (Thread-1): finished collecting timing info
2021-05-30 13:45:55.746819 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:45:55.758340 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:45:55.759298 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:55.759404 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:45:55.759490 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:45:55.761155 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:55.761264 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:45:55.761886 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:45:57.891261 (Thread-2): SQL status: SUCCESS 1 in 2.13 seconds
2021-05-30 13:45:57.891506 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:45:57.891638 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from jaffle_shop.orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from jaffle_shop.customers

left join customer_orders using (customer_id)
  );
2021-05-30 13:45:58.509924 (Thread-1): SQL status: SUCCESS 1 in 2.75 seconds
2021-05-30 13:45:58.510161 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:45:58.510294 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:45:58.971188 (Thread-2): Snowflake query id: 019c97d9-0000-438f-0000-b0b100017016
2021-05-30 13:45:58.971405 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
2021-05-30 13:45:58.971635 (Thread-2): finished collecting timing info
2021-05-30 13:45:58.971841 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:45:59.381218 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:46:00.098051 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-30 13:46:00.099634 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:00.099882 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:00.099998 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:00.399363 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 13:46:00.410928 (Thread-1): finished collecting timing info
2021-05-30 13:46:00.411086 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:46:01.011207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39c0bb0>]}
2021-05-30 13:46:01.011688 (Thread-1): 19:16:01 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.31s]
2021-05-30 13:46:01.011874 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:01.012309 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:01.012594 (Thread-4): 19:16:01 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:46:01.012971 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:01.013105 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:01.015558 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:01.016101 (Thread-4): finished collecting timing info
2021-05-30 13:46:01.018361 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:01.019167 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:01.019276 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:46:01.019372 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:46:01.781042 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:01.781953 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d4057d90>]}
2021-05-30 13:46:01.782355 (Thread-2): 19:16:01 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 6.08s]
2021-05-30 13:46:01.782529 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:46:02.453120 (Thread-4): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 13:46:02.453358 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:02.453490 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:46:03.273725 (Thread-4): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-30 13:46:03.275117 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:03.275358 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:03.275514 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:03.682834 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:46:03.683913 (Thread-4): finished collecting timing info
2021-05-30 13:46:03.684129 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:46:04.400630 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a94814e-e0d0-4ec3-aa61-e55a323216c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3cee730>]}
2021-05-30 13:46:04.401109 (Thread-4): 19:16:04 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.39s]
2021-05-30 13:46:04.401544 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:04.403255 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:04.403508 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:04.403629 (MainThread): On master: BEGIN
2021-05-30 13:46:04.403740 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:46:06.139615 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 13:46:06.139892 (MainThread): On master: COMMIT
2021-05-30 13:46:06.140123 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:06.140259 (MainThread): On master: COMMIT
2021-05-30 13:46:06.651494 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:06.651773 (MainThread): On master: Close
2021-05-30 13:46:07.370375 (MainThread): 19:16:07 | 
2021-05-30 13:46:07.370611 (MainThread): 19:16:07 | Finished running 1 table model, 2 view models in 22.23s.
2021-05-30 13:46:07.370762 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:46:07.370868 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:46:07.370975 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:46:07.371063 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:46:07.375654 (MainThread): 
2021-05-30 13:46:07.375807 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:46:07.375938 (MainThread): 
2021-05-30 13:46:07.376063 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:46:07.376172 (MainThread):   002003 (02000): SQL compilation error:
2021-05-30 13:46:07.376273 (MainThread):   Schema 'DEMO_DB.JAFFLE_SHOP' does not exist or not authorized.
2021-05-30 13:46:07.376370 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:07.376484 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:46:07.376660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d3c18760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39d25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d39d21f0>]}
2021-05-30 13:46:07.376886 (MainThread): Flushing usage events
2021-05-30 13:46:33.915979 (MainThread): Running with dbt=0.19.1
2021-05-30 13:46:34.679984 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:46:34.681555 (MainThread): Tracking: tracking
2021-05-30 13:46:34.681971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb1205e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b4e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b4e6d0>]}
2021-05-30 13:46:34.691111 (MainThread): Partial parsing not enabled
2021-05-30 13:46:34.692292 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:46:34.694522 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:46:34.720425 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:46:34.722150 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:46:34.723385 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:46:34.727007 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:46:34.735308 (MainThread): Parsing macros/core.sql
2021-05-30 13:46:34.738525 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:46:34.746131 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:46:34.747642 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:46:34.763369 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:46:34.793678 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:46:34.812317 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:46:34.813927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:46:34.819273 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:46:34.831835 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:46:34.837784 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:46:34.843189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:46:34.847349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:46:34.848141 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:46:34.849025 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:46:34.850405 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:46:34.857969 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:46:34.859835 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:46:34.861257 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:46:34.899295 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:46:34.900898 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:46:34.902206 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:46:34.903650 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:46:34.909946 (MainThread): Partial parsing not enabled
2021-05-30 13:46:34.928703 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:34.935796 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:34.938594 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:35.047984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2af3eb0>]}
2021-05-30 13:46:35.052957 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2b1e2e0>]}
2021-05-30 13:46:35.053232 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:46:35.054118 (MainThread): 
2021-05-30 13:46:35.054462 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:35.055449 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:46:35.070233 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:46:35.070388 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:46:35.070490 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:46:36.556170 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.49 seconds
2021-05-30 13:46:36.559834 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:46:37.478150 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:46:37.486089 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:46:37.486221 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:46:37.486325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:46:39.345240 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.86 seconds
2021-05-30 13:46:39.346410 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:46:40.032262 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:40.032454 (MainThread): On master: BEGIN
2021-05-30 13:46:40.032574 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:46:41.671996 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 13:46:41.672266 (MainThread): On master: COMMIT
2021-05-30 13:46:41.672513 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:41.672649 (MainThread): On master: COMMIT
2021-05-30 13:46:42.286230 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 13:46:42.286511 (MainThread): On master: Close
2021-05-30 13:46:43.005286 (MainThread): 19:16:43 | Concurrency: 10 threads (target='dev')
2021-05-30 13:46:43.005522 (MainThread): 19:16:43 | 
2021-05-30 13:46:43.007954 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:43.008291 (Thread-1): 19:16:43 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:46:43.008650 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:43.008805 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:43.009420 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:46:43.011969 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:46:43.012188 (Thread-2): 19:16:43 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 13:46:43.012696 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:43.012857 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:46:43.014124 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:46:43.014553 (Thread-1): finished collecting timing info
2021-05-30 13:46:43.021004 (Thread-2): finished collecting timing info
2021-05-30 13:46:43.061470 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:46:43.065546 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:46:43.066904 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:43.067003 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:46:43.067092 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:46:43.068815 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:43.068920 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:46:43.069007 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:46:44.643224 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 13:46:44.643514 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:44.643667 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:46:44.644652 (Thread-2): SQL status: SUCCESS 1 in 1.58 seconds
2021-05-30 13:46:44.645574 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:46:44.645716 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-30 13:46:45.153241 (Thread-2): Snowflake query id: 019c97da-0000-43cc-0000-b0b100016032
2021-05-30 13:46:45.153461 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 13:46:45.153689 (Thread-2): finished collecting timing info
2021-05-30 13:46:45.153899 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:46:45.503832 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:46:46.177522 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:46:46.179118 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:46.179351 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:46:46.179469 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:46:46.194877 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:46.198013 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f60bb0>]}
2021-05-30 13:46:46.198415 (Thread-2): 19:16:46 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 3.19s]
2021-05-30 13:46:46.198593 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:46:46.690514 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:46.703342 (Thread-1): finished collecting timing info
2021-05-30 13:46:46.703516 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:46:47.314815 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f653a0>]}
2021-05-30 13:46:47.315271 (Thread-1): 19:16:47 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.31s]
2021-05-30 13:46:47.315438 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:46:47.315940 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:47.316413 (Thread-4): 19:16:47 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:46:47.316763 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:47.316903 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:47.319277 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:47.319715 (Thread-4): finished collecting timing info
2021-05-30 13:46:47.321604 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:46:47.322337 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:47.322440 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:46:47.322530 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:46:49.863581 (Thread-4): SQL status: SUCCESS 1 in 2.54 seconds
2021-05-30 13:46:49.863832 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:49.863970 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:46:50.376686 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 13:46:50.378086 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:50.378331 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:46:50.378471 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:46:50.786402 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:46:50.787505 (Thread-4): finished collecting timing info
2021-05-30 13:46:50.787731 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:46:51.401988 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a3d5da-0b4f-4f2e-81fa-2f9eb473397c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f6e520>]}
2021-05-30 13:46:51.402461 (Thread-4): 19:16:51 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 4.09s]
2021-05-30 13:46:51.402636 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:46:51.404214 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:46:51.404458 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:51.404574 (MainThread): On master: BEGIN
2021-05-30 13:46:51.404682 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:46:53.140895 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 13:46:53.141167 (MainThread): On master: COMMIT
2021-05-30 13:46:53.141398 (MainThread): Using snowflake connection "master".
2021-05-30 13:46:53.141535 (MainThread): On master: COMMIT
2021-05-30 13:46:53.560098 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-30 13:46:53.560371 (MainThread): On master: Close
2021-05-30 13:46:54.576257 (MainThread): 19:16:54 | 
2021-05-30 13:46:54.576491 (MainThread): 19:16:54 | Finished running 2 view models, 1 table model in 19.52s.
2021-05-30 13:46:54.576641 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:46:54.576747 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:46:54.576843 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:46:54.576935 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:46:54.581625 (MainThread): 
2021-05-30 13:46:54.581802 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:46:54.581940 (MainThread): 
2021-05-30 13:46:54.582075 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:46:54.582199 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:46:54.582306 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 13:46:54.582408 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:46:54.582584 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:46:54.582825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2dd66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb302ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb2f75bb0>]}
2021-05-30 13:46:54.583070 (MainThread): Flushing usage events
2021-05-30 13:48:10.896414 (MainThread): Running with dbt=0.19.1
2021-05-30 13:48:11.637150 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:48:11.638777 (MainThread): Tracking: tracking
2021-05-30 13:48:11.639211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb906cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd4505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd450640>]}
2021-05-30 13:48:11.648157 (MainThread): Partial parsing not enabled
2021-05-30 13:48:11.649118 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:48:11.651210 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:48:11.677146 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:48:11.678923 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:48:11.680287 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:48:11.683607 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:48:11.692264 (MainThread): Parsing macros/core.sql
2021-05-30 13:48:11.695446 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:48:11.702818 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:48:11.704436 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:48:11.719652 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:48:11.749437 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:48:11.768249 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:48:11.769828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:48:11.775108 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:48:11.786967 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:48:11.793397 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:48:11.798754 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:48:11.802850 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:48:11.803670 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:48:11.804653 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:48:11.806003 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:48:11.813403 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:48:11.815040 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:48:11.816431 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:48:11.853910 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:48:11.855701 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:48:11.856952 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:48:11.858352 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:48:11.864415 (MainThread): Partial parsing not enabled
2021-05-30 13:48:11.881986 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:11.889918 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:11.892692 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:12.002795 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb24de80>]}
2021-05-30 13:48:12.008886 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb24d7c0>]}
2021-05-30 13:48:12.009248 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:48:12.010212 (MainThread): 
2021-05-30 13:48:12.010588 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:48:12.011615 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:48:12.026069 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:48:12.026229 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:48:12.026334 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:48:13.882418 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.86 seconds
2021-05-30 13:48:13.886941 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:48:14.551137 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:48:14.558835 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:48:14.558969 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:48:14.559072 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:48:15.910595 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.35 seconds
2021-05-30 13:48:15.911763 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:48:16.602877 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:16.603053 (MainThread): On master: BEGIN
2021-05-30 13:48:16.603163 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:48:18.161377 (MainThread): SQL status: SUCCESS 1 in 1.56 seconds
2021-05-30 13:48:18.161652 (MainThread): On master: COMMIT
2021-05-30 13:48:18.161898 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:18.162049 (MainThread): On master: COMMIT
2021-05-30 13:48:18.519740 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 13:48:18.520015 (MainThread): On master: Close
2021-05-30 13:48:19.158019 (MainThread): 19:18:19 | Concurrency: 10 threads (target='dev')
2021-05-30 13:48:19.158259 (MainThread): 19:18:19 | 
2021-05-30 13:48:19.160666 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:19.160986 (Thread-1): 19:18:19 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:48:19.161336 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:19.161485 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:19.161648 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:48:19.164487 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:48:19.164688 (Thread-2): 19:18:19 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-30 13:48:19.165145 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:19.165281 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:48:19.167445 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:48:19.167887 (Thread-2): finished collecting timing info
2021-05-30 13:48:19.173894 (Thread-1): finished collecting timing info
2021-05-30 13:48:19.221085 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:48:19.223303 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:48:19.224355 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:19.224462 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:48:19.224551 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:48:19.226774 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:19.226883 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:48:19.226973 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:48:20.488623 (Thread-2): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:48:20.488856 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:48:20.488977 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (

with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-30 13:48:20.489420 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:48:20.489921 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:20.490168 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:48:20.897273 (Thread-2): Snowflake query id: 019c97dc-0000-438f-0000-b0b100017046
2021-05-30 13:48:20.897495 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:48:20.897714 (Thread-2): finished collecting timing info
2021-05-30 13:48:20.897922 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:48:21.248540 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:48:21.458633 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-05-30 13:48:21.460063 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:48:21.460262 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:48:21.460377 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:48:21.778372 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-05-30 13:48:21.790821 (Thread-1): finished collecting timing info
2021-05-30 13:48:21.790988 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:48:21.810339 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:48:21.813355 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd77e8b0>]}
2021-05-30 13:48:21.813731 (Thread-2): 19:18:21 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 2.65s]
2021-05-30 13:48:21.813887 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:48:22.537331 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd77e0a0>]}
2021-05-30 13:48:22.537800 (Thread-1): 19:18:22 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-30 13:48:22.537978 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:48:22.538477 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:22.538756 (Thread-4): 19:18:22 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 13:48:22.539262 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:22.539426 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:22.541930 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:48:22.542416 (Thread-4): finished collecting timing info
2021-05-30 13:48:22.561255 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:48:22.562057 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:22.562162 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:48:22.562252 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:48:24.051950 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-05-30 13:48:24.052135 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:24.052242 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 13:48:24.581992 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-30 13:48:24.582808 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:48:24.582952 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:48:24.583021 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:48:25.053971 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-05-30 13:48:25.055046 (Thread-4): finished collecting timing info
2021-05-30 13:48:25.055261 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:48:25.916413 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321d4182-c007-4f05-91a9-4b64107f6527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd762d90>]}
2021-05-30 13:48:25.916883 (Thread-4): 19:18:25 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-05-30 13:48:25.917060 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:48:25.918639 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:48:25.918872 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:25.918981 (MainThread): On master: BEGIN
2021-05-30 13:48:25.919081 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:48:27.450150 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 13:48:27.450409 (MainThread): On master: COMMIT
2021-05-30 13:48:27.450635 (MainThread): Using snowflake connection "master".
2021-05-30 13:48:27.450764 (MainThread): On master: COMMIT
2021-05-30 13:48:27.859331 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:48:27.859598 (MainThread): On master: Close
2021-05-30 13:48:28.783639 (MainThread): 19:18:28 | 
2021-05-30 13:48:28.783863 (MainThread): 19:18:28 | Finished running 2 table models, 1 view model in 16.77s.
2021-05-30 13:48:28.784002 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:48:28.784100 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:48:28.784189 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:48:28.784274 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:48:28.789085 (MainThread): 
2021-05-30 13:48:28.789248 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:48:28.789389 (MainThread): 
2021-05-30 13:48:28.789523 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 13:48:28.789641 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:48:28.789778 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:48:28.789885 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 13:48:28.790091 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:48:28.790315 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fd6e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fe0326a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fe034b20>]}
2021-05-30 13:48:28.790569 (MainThread): Flushing usage events
2021-05-30 13:55:41.051162 (MainThread): Running with dbt=0.19.1
2021-05-30 13:55:41.783087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 13:55:41.785313 (MainThread): Tracking: tracking
2021-05-30 13:55:41.786126 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56d205e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed4d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed4d730>]}
2021-05-30 13:55:41.795731 (MainThread): Partial parsing not enabled
2021-05-30 13:55:41.796666 (MainThread): Parsing macros/catalog.sql
2021-05-30 13:55:41.798807 (MainThread): Parsing macros/adapters.sql
2021-05-30 13:55:41.824546 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 13:55:41.826244 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 13:55:41.827619 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 13:55:41.830963 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 13:55:41.839438 (MainThread): Parsing macros/core.sql
2021-05-30 13:55:41.842602 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 13:55:41.850200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 13:55:41.851974 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 13:55:41.867238 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 13:55:41.897127 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 13:55:41.916178 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 13:55:41.918016 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 13:55:41.923413 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 13:55:41.935550 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 13:55:41.941420 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 13:55:41.946792 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 13:55:41.951236 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 13:55:41.952110 (MainThread): Parsing macros/etc/query.sql
2021-05-30 13:55:41.953004 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 13:55:41.954381 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 13:55:41.961958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 13:55:41.963624 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 13:55:41.965055 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 13:55:42.003148 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 13:55:42.004741 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 13:55:42.006032 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 13:55:42.007485 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 13:55:42.013700 (MainThread): Partial parsing not enabled
2021-05-30 13:55:42.031838 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:42.039605 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:42.041728 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:42.154386 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ecf3eb0>]}
2021-05-30 13:55:42.159373 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed1e2e0>]}
2021-05-30 13:55:42.159649 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 13:55:42.160517 (MainThread): 
2021-05-30 13:55:42.160859 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:55:42.161844 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 13:55:42.175859 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 13:55:42.175990 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 13:55:42.176084 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 13:55:43.801644 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 13:55:43.810107 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 13:55:44.421523 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:55:44.429729 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 13:55:44.429871 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 13:55:44.429982 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 13:55:45.851944 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-30 13:55:45.853098 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 13:55:46.468774 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:46.468963 (MainThread): On master: BEGIN
2021-05-30 13:55:46.469082 (MainThread): Opening a new connection, currently in state init
2021-05-30 13:55:47.695345 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 13:55:47.695616 (MainThread): On master: COMMIT
2021-05-30 13:55:47.695853 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:47.695999 (MainThread): On master: COMMIT
2021-05-30 13:55:48.099040 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-30 13:55:48.099343 (MainThread): On master: Close
2021-05-30 13:55:48.680805 (MainThread): 19:25:48 | Concurrency: 10 threads (target='dev')
2021-05-30 13:55:48.681044 (MainThread): 19:25:48 | 
2021-05-30 13:55:48.683407 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:48.683645 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 13:55:48.683943 (Thread-1): 19:25:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 13:55:48.684229 (Thread-2): 19:25:48 | 2 of 3 START table model PUBLIC.customers............................ [RUN]
2021-05-30 13:55:48.684649 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:48.685385 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:48.685552 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:48.685718 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 13:55:48.688268 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:55:48.689576 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 13:55:48.690179 (Thread-1): finished collecting timing info
2021-05-30 13:55:48.714027 (Thread-2): finished collecting timing info
2021-05-30 13:55:48.729664 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 13:55:48.731379 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 13:55:48.732823 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:48.732924 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 13:55:48.733014 (Thread-2): Opening a new connection, currently in state init
2021-05-30 13:55:48.734749 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:48.734855 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 13:55:48.734942 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 13:55:50.255737 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 13:55:50.256219 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 13:55:50.256336 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 13:55:50.256466 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:50.256584 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
      );
2021-05-30 13:55:50.256702 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 13:55:50.664340 (Thread-2): Snowflake query id: 019c97e3-0000-43d8-0000-b0b10001509a
2021-05-30 13:55:50.664565 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:55:50.664788 (Thread-2): finished collecting timing info
2021-05-30 13:55:50.665001 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 13:55:51.074359 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 13:55:51.517775 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-30 13:55:51.519347 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:55:51.519602 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 13:55:51.519718 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 13:55:51.679703 (Thread-2): Database Error in model customers (models/example/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/example/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/customers.sql
2021-05-30 13:55:51.682809 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f0ce520>]}
2021-05-30 13:55:51.683239 (Thread-2): 19:25:51 | 2 of 3 ERROR creating table model PUBLIC.customers................... [ERROR in 3.00s]
2021-05-30 13:55:51.683425 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 13:55:51.817615 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 13:55:51.834818 (Thread-1): finished collecting timing info
2021-05-30 13:55:51.835017 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 13:55:52.499639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f060fa0>]}
2021-05-30 13:55:52.500107 (Thread-1): 19:25:52 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.82s]
2021-05-30 13:55:52.500286 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 13:55:52.500887 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:52.501168 (Thread-4): 19:25:52 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 13:55:52.501515 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:52.501663 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:52.504100 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:55:52.504661 (Thread-4): finished collecting timing info
2021-05-30 13:55:52.506429 (Thread-4): Dropping relation "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" because it is of type view
2021-05-30 13:55:52.512910 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:52.513021 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" cascade
2021-05-30 13:55:52.513117 (Thread-4): Opening a new connection, currently in state init
2021-05-30 13:55:53.766915 (Thread-4): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-30 13:55:53.768691 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 13:55:53.769755 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:53.769885 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 13:55:54.076781 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 13:55:54.077024 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:54.077161 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
      );
2021-05-30 13:55:55.580789 (Thread-4): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 13:55:55.582153 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:55:55.582395 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 13:55:55.582534 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 13:55:55.989415 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 13:55:55.990476 (Thread-4): finished collecting timing info
2021-05-30 13:55:55.990670 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 13:55:56.607757 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03314b3f-b3da-4196-9095-87a4e7cc2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56f08c0d0>]}
2021-05-30 13:55:56.608244 (Thread-4): 19:25:56 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.11s]
2021-05-30 13:55:56.608426 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 13:55:56.610054 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 13:55:56.610305 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:56.610426 (MainThread): On master: BEGIN
2021-05-30 13:55:56.610538 (MainThread): Opening a new connection, currently in state closed
2021-05-30 13:55:58.344847 (MainThread): SQL status: SUCCESS 1 in 1.73 seconds
2021-05-30 13:55:58.345118 (MainThread): On master: COMMIT
2021-05-30 13:55:58.345357 (MainThread): Using snowflake connection "master".
2021-05-30 13:55:58.345493 (MainThread): On master: COMMIT
2021-05-30 13:55:58.959368 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 13:55:58.959646 (MainThread): On master: Close
2021-05-30 13:55:59.575643 (MainThread): 19:25:59 | 
2021-05-30 13:55:59.575869 (MainThread): 19:25:59 | Finished running 3 table models in 17.41s.
2021-05-30 13:55:59.576011 (MainThread): Connection 'master' was properly closed.
2021-05-30 13:55:59.576115 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 13:55:59.576207 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 13:55:59.576297 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 13:55:59.580874 (MainThread): 
2021-05-30 13:55:59.581021 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 13:55:59.581158 (MainThread): 
2021-05-30 13:55:59.581274 (MainThread): Database Error in model customers (models/example/customers.sql)
2021-05-30 13:55:59.581375 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 13:55:59.581468 (MainThread):   Object 'ORDERS' does not exist or not authorized.
2021-05-30 13:55:59.581556 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/customers.sql
2021-05-30 13:55:59.581658 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 13:55:59.581825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed1ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed84bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56ed843a0>]}
2021-05-30 13:55:59.582026 (MainThread): Flushing usage events
2021-05-30 14:03:24.627513 (MainThread): Running with dbt=0.19.1
2021-05-30 14:03:25.411119 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:03:25.412664 (MainThread): Tracking: tracking
2021-05-30 14:03:25.413091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e48cfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e754e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e754e700>]}
2021-05-30 14:03:25.422854 (MainThread): Partial parsing not enabled
2021-05-30 14:03:25.423804 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:03:25.425885 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:03:25.452043 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:03:25.453711 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:03:25.454921 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:03:25.458607 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:03:25.467353 (MainThread): Parsing macros/core.sql
2021-05-30 14:03:25.470700 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:03:25.478252 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:03:25.479774 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:03:25.495149 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:03:25.525514 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:03:25.543944 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:03:25.545521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:03:25.550942 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:03:25.563340 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:03:25.569246 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:03:25.574640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:03:25.578793 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:03:25.579595 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:03:25.580476 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:03:25.581846 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:03:25.589651 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:03:25.591295 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:03:25.592704 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:03:25.630329 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:03:25.631974 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:03:25.633257 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:03:25.634697 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:03:25.640884 (MainThread): Partial parsing not enabled
2021-05-30 14:03:25.659062 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:25.666194 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:25.668941 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:25.781404 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e430d7f0>]}
2021-05-30 14:03:25.786694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e430df40>]}
2021-05-30 14:03:25.786979 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:03:25.787924 (MainThread): 
2021-05-30 14:03:25.788274 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:03:25.789266 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:03:25.803683 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:03:25.803826 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:03:25.803926 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:03:27.776137 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.97 seconds
2021-05-30 14:03:27.780453 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:03:28.597646 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:03:28.605744 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:03:28.605880 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:03:28.605989 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:03:29.922998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.32 seconds
2021-05-30 14:03:29.924128 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:03:31.155818 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:31.156007 (MainThread): On master: BEGIN
2021-05-30 14:03:31.156106 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:03:32.843108 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-30 14:03:32.843388 (MainThread): On master: COMMIT
2021-05-30 14:03:32.843625 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:32.843764 (MainThread): On master: COMMIT
2021-05-30 14:03:33.410421 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-05-30 14:03:33.410694 (MainThread): On master: Close
2021-05-30 14:03:34.434376 (MainThread): 19:33:34 | Concurrency: 10 threads (target='dev')
2021-05-30 14:03:34.434616 (MainThread): 19:33:34 | 
2021-05-30 14:03:34.436959 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:34.437188 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 14:03:34.437478 (Thread-1): 19:33:34 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:03:34.437771 (Thread-2): 19:33:34 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 14:03:34.438151 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:34.438851 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:34.438973 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:34.439108 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 14:03:34.441844 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:03:34.443809 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 14:03:34.444321 (Thread-1): finished collecting timing info
2021-05-30 14:03:34.444482 (Thread-2): finished collecting timing info
2021-05-30 14:03:34.490994 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:03:34.492194 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 14:03:34.493171 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:34.493274 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:03:34.493366 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:03:34.495506 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:34.495613 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 14:03:34.495699 (Thread-2): Opening a new connection, currently in state init
2021-05-30 14:03:36.172265 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:03:36.172535 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:36.172993 (Thread-2): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:03:36.173104 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:03:36.173243 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:03:36.174417 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    with customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders

from customers

left join customer_orders using (customer_id)
  );
2021-05-30 14:03:36.683578 (Thread-2): Snowflake query id: 019c97eb-0000-43d8-0000-b0b1000150ae
2021-05-30 14:03:36.683818 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 14:03:36.684180 (Thread-2): finished collecting timing info
2021-05-30 14:03:36.684419 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 14:03:37.195765 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 14:03:37.420053 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-05-30 14:03:37.421536 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:03:37.421743 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:03:37.421860 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:03:38.219362 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-05-30 14:03:38.231089 (Thread-1): finished collecting timing info
2021-05-30 14:03:38.231249 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:03:38.633101 (Thread-2): Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:03:38.639520 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7809700>]}
2021-05-30 14:03:38.640045 (Thread-2): 19:33:38 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 4.20s]
2021-05-30 14:03:38.640267 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 14:03:39.348570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e78023a0>]}
2021-05-30 14:03:39.349031 (Thread-1): 19:33:39 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.91s]
2021-05-30 14:03:39.349204 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:03:39.349861 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:39.350255 (Thread-4): 19:33:39 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:03:39.350623 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:39.350771 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:39.353300 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:03:39.353823 (Thread-4): finished collecting timing info
2021-05-30 14:03:39.356099 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:03:39.356968 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:39.357088 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:03:39.357194 (Thread-4): Opening a new connection, currently in state init
2021-05-30 14:03:40.984266 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-05-30 14:03:40.984521 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:40.984659 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:03:42.520011 (Thread-4): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-30 14:03:42.521305 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:03:42.521502 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:03:42.521617 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:03:42.930085 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:03:42.931179 (Thread-4): finished collecting timing info
2021-05-30 14:03:42.931405 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:03:44.058493 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8181cd0-7954-4082-946a-b8a8a5b60600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7740220>]}
2021-05-30 14:03:44.058961 (Thread-4): 19:33:44 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.71s]
2021-05-30 14:03:44.059140 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:03:44.060824 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:03:44.061067 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:44.061185 (MainThread): On master: BEGIN
2021-05-30 14:03:44.061295 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:03:45.797147 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:03:45.797429 (MainThread): On master: COMMIT
2021-05-30 14:03:45.797666 (MainThread): Using snowflake connection "master".
2021-05-30 14:03:45.797816 (MainThread): On master: COMMIT
2021-05-30 14:03:46.206840 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:03:46.207118 (MainThread): On master: Close
2021-05-30 14:03:47.335615 (MainThread): 19:33:47 | 
2021-05-30 14:03:47.335860 (MainThread): 19:33:47 | Finished running 1 view model, 2 table models in 21.55s.
2021-05-30 14:03:47.336019 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:03:47.336129 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:03:47.336225 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 14:03:47.336317 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:03:47.342634 (MainThread): 
2021-05-30 14:03:47.342833 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:03:47.342975 (MainThread): 
2021-05-30 14:03:47.343107 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 14:03:47.343229 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-30 14:03:47.343344 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-30 14:03:47.343453 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:03:47.343575 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 14:03:47.343764 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e7782670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e76d66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e77bd850>]}
2021-05-30 14:03:47.343999 (MainThread): Flushing usage events
2021-05-30 14:10:40.638349 (MainThread): Running with dbt=0.19.1
2021-05-30 14:10:41.891434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:10:41.893120 (MainThread): Tracking: tracking
2021-05-30 14:10:41.893616 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a530fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a824d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a824d760>]}
2021-05-30 14:10:41.904587 (MainThread): Partial parsing not enabled
2021-05-30 14:10:41.905822 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:10:41.908583 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:10:41.936022 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:10:41.937782 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:10:41.938995 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:10:41.942485 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:10:41.951691 (MainThread): Parsing macros/core.sql
2021-05-30 14:10:41.955658 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:10:41.964929 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:10:41.966592 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:10:41.982074 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:10:42.012966 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:10:42.032160 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:10:42.033773 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:10:42.039011 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:10:42.051070 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:10:42.057061 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:10:42.062706 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:10:42.066890 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:10:42.067705 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:10:42.068607 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:10:42.069988 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:10:42.077639 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:10:42.079310 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:10:42.080778 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:10:42.118676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:10:42.120265 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:10:42.121557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:10:42.122996 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:10:42.129516 (MainThread): Partial parsing not enabled
2021-05-30 14:10:42.147650 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:42.154659 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:42.157662 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:42.281253 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a444f460>]}
2021-05-30 14:10:42.287560 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a44518b0>]}
2021-05-30 14:10:42.287935 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:10:42.289004 (MainThread): 
2021-05-30 14:10:42.289399 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:10:42.290519 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:10:42.305382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:10:42.305523 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:10:42.305624 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:10:43.915371 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.61 seconds
2021-05-30 14:10:43.918568 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:10:44.532187 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:10:44.539560 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:10:44.539691 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:10:44.539787 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:10:45.831176 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.29 seconds
2021-05-30 14:10:45.832360 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:10:46.401897 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:46.402085 (MainThread): On master: BEGIN
2021-05-30 14:10:46.402204 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:10:47.620912 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-30 14:10:47.621169 (MainThread): On master: COMMIT
2021-05-30 14:10:47.621415 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:47.621552 (MainThread): On master: COMMIT
2021-05-30 14:10:47.974504 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-30 14:10:47.974783 (MainThread): On master: Close
2021-05-30 14:10:48.578972 (MainThread): 19:40:48 | Concurrency: 10 threads (target='dev')
2021-05-30 14:10:48.579208 (MainThread): 19:40:48 | 
2021-05-30 14:10:48.581522 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:48.581706 (Thread-2): Began running node model.demo_dbt.customers
2021-05-30 14:10:48.582031 (Thread-1): 19:40:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:10:48.582270 (Thread-2): 19:40:48 | 2 of 3 START view model PUBLIC.customers............................. [RUN]
2021-05-30 14:10:48.582609 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:48.583119 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:48.583421 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:48.585909 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:10:48.586058 (Thread-2): Compiling model.demo_dbt.customers
2021-05-30 14:10:48.587983 (Thread-2): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-30 14:10:48.588377 (Thread-1): finished collecting timing info
2021-05-30 14:10:48.594241 (Thread-2): finished collecting timing info
2021-05-30 14:10:48.633130 (Thread-2): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-30 14:10:48.637761 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:10:48.638751 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:48.638852 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:10:48.638938 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:10:48.639893 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:48.639999 (Thread-2): On model.demo_dbt.customers: BEGIN
2021-05-30 14:10:48.640087 (Thread-2): Opening a new connection, currently in state init
2021-05-30 14:10:49.797698 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-05-30 14:10:49.797945 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:49.798079 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:10:49.966954 (Thread-2): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-30 14:10:49.967180 (Thread-2): Using snowflake connection "model.demo_dbt.customers".
2021-05-30 14:10:49.967315 (Thread-2): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */

  create or replace  view DEMO_DB.PUBLIC.customers  as (
    -- with customer_orders as (
--     select
--         customer_id,
--         min(order_date) as first_order_date,
--         max(order_date) as most_recent_order_date,
--         count(order_id) as number_of_orders

--     from orders

--     group by 1
-- )

-- select
--     customers.customer_id,
--     customers.first_name,
--     customers.last_name,
--     customer_orders.first_order_date,
--     customer_orders.most_recent_order_date,
--     coalesce(customer_orders.number_of_orders, 0) as number_of_orders

-- from customers

-- left join customer_orders using (customer_id)
  );
2021-05-30 14:10:50.299067 (Thread-2): Snowflake query id: 019c97f2-0000-43d8-0000-b0b1000150fe
2021-05-30 14:10:50.299290 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 2 unexpected ')'.
2021-05-30 14:10:50.299525 (Thread-2): finished collecting timing info
2021-05-30 14:10:50.299739 (Thread-2): On model.demo_dbt.customers: ROLLBACK
2021-05-30 14:10:50.677019 (Thread-2): On model.demo_dbt.customers: Close
2021-05-30 14:10:50.757503 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-05-30 14:10:50.759176 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:10:50.759392 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:10:50.759511 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:10:51.057222 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 14:10:51.069308 (Thread-1): finished collecting timing info
2021-05-30 14:10:51.069483 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:10:51.269037 (Thread-2): Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 25 at position 2 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:10:51.273480 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a82a0b80>]}
2021-05-30 14:10:51.273919 (Thread-2): 19:40:51 | 2 of 3 ERROR creating view model PUBLIC.customers.................... [ERROR in 2.69s]
2021-05-30 14:10:51.274092 (Thread-2): Finished running node model.demo_dbt.customers
2021-05-30 14:10:51.628454 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a82a0b80>]}
2021-05-30 14:10:51.628902 (Thread-1): 19:40:51 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.05s]
2021-05-30 14:10:51.629064 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:10:51.629657 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:51.629937 (Thread-4): 19:40:51 | 3 of 3 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:10:51.630276 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:51.630421 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:51.632541 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:10:51.633022 (Thread-4): finished collecting timing info
2021-05-30 14:10:51.635013 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:10:51.636398 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:51.636553 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:10:51.636652 (Thread-4): Opening a new connection, currently in state init
2021-05-30 14:10:53.006481 (Thread-4): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:10:53.006721 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:53.006853 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:10:54.053330 (Thread-4): SQL status: SUCCESS 1 in 1.05 seconds
2021-05-30 14:10:54.054754 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:10:54.054991 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:10:54.055140 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:10:54.365097 (Thread-4): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:10:54.365830 (Thread-4): finished collecting timing info
2021-05-30 14:10:54.365980 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:10:54.947875 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab4a6cc-6053-4316-870c-dabe5d4dd8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a8474ee0>]}
2021-05-30 14:10:54.948347 (Thread-4): 19:40:54 | 3 of 3 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 3.32s]
2021-05-30 14:10:54.948515 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:10:54.950126 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:10:54.950367 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:54.950480 (MainThread): On master: BEGIN
2021-05-30 14:10:54.950583 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:10:56.225786 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2021-05-30 14:10:56.226039 (MainThread): On master: COMMIT
2021-05-30 14:10:56.226264 (MainThread): Using snowflake connection "master".
2021-05-30 14:10:56.226389 (MainThread): On master: COMMIT
2021-05-30 14:10:56.585415 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 14:10:56.585618 (MainThread): On master: Close
2021-05-30 14:10:57.229142 (MainThread): 19:40:57 | 
2021-05-30 14:10:57.229367 (MainThread): 19:40:57 | Finished running 1 view model, 2 table models in 14.94s.
2021-05-30 14:10:57.229507 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:10:57.229605 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:10:57.229693 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-30 14:10:57.229775 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:10:57.234849 (MainThread): 
2021-05-30 14:10:57.235003 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:10:57.235134 (MainThread): 
2021-05-30 14:10:57.235257 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-30 14:10:57.235366 (MainThread):   001003 (42000): SQL compilation error:
2021-05-30 14:10:57.235463 (MainThread):   syntax error line 25 at position 2 unexpected ')'.
2021-05-30 14:10:57.235563 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-30 14:10:57.235674 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-30 14:10:57.235860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a8280490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a829f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8aa10ea00>]}
2021-05-30 14:10:57.236085 (MainThread): Flushing usage events
2021-05-30 14:11:12.664734 (MainThread): Running with dbt=0.19.1
2021-05-30 14:11:13.431416 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:11:13.432752 (MainThread): Tracking: tracking
2021-05-30 14:11:13.433327 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec2c6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee5525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee552640>]}
2021-05-30 14:11:13.443187 (MainThread): Partial parsing not enabled
2021-05-30 14:11:13.444232 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:11:13.446468 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:11:13.472704 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:11:13.474687 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:11:13.475949 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:11:13.479428 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:11:13.487993 (MainThread): Parsing macros/core.sql
2021-05-30 14:11:13.491280 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:11:13.498842 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:11:13.500360 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:11:13.516161 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:11:13.547248 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:11:13.565504 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:11:13.567069 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:11:13.572254 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:11:13.585083 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:11:13.591104 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:11:13.596563 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:11:13.600767 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:11:13.601576 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:11:13.602485 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:11:13.603877 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:11:13.611895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:11:13.613588 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:11:13.615025 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:11:13.653206 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:11:13.654789 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:11:13.656080 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:11:13.657523 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:11:13.663815 (MainThread): Partial parsing not enabled
2021-05-30 14:11:13.682114 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:13.690021 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:13.797651 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee51efd0>]}
2021-05-30 14:11:13.802944 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee51ef40>]}
2021-05-30 14:11:13.803237 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:11:13.804186 (MainThread): 
2021-05-30 14:11:13.804538 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:11:13.805454 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:11:13.820184 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:11:13.820338 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:11:13.820442 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:11:15.557995 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.74 seconds
2021-05-30 14:11:15.562610 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:11:16.277825 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:11:16.285696 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:11:16.285829 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:11:16.285932 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:11:17.912079 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 14:11:17.913199 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:11:18.489727 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:18.489920 (MainThread): On master: BEGIN
2021-05-30 14:11:18.490036 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:11:19.857978 (MainThread): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:11:19.858247 (MainThread): On master: COMMIT
2021-05-30 14:11:19.858482 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:19.858618 (MainThread): On master: COMMIT
2021-05-30 14:11:20.370805 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:11:20.371086 (MainThread): On master: Close
2021-05-30 14:11:20.986068 (MainThread): 19:41:20 | Concurrency: 10 threads (target='dev')
2021-05-30 14:11:20.986306 (MainThread): 19:41:20 | 
2021-05-30 14:11:20.988596 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:20.988944 (Thread-1): 19:41:20 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:11:20.989285 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:20.989440 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:20.992364 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:11:20.992874 (Thread-1): finished collecting timing info
2021-05-30 14:11:21.022829 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:11:21.023835 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:21.023939 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:11:21.024032 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:11:22.418727 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-30 14:11:22.418979 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:22.419121 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:11:23.646688 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:11:23.648292 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:11:23.648499 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:11:23.648619 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:11:23.953945 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:11:23.965346 (Thread-1): finished collecting timing info
2021-05-30 14:11:23.965509 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:11:24.571049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9a4be0>]}
2021-05-30 14:11:24.571521 (Thread-1): 19:41:24 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:11:24.571706 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:11:24.572383 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:24.572669 (Thread-3): 19:41:24 | 2 of 2 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:11:24.573069 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:24.573270 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:24.576270 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:11:24.576745 (Thread-3): finished collecting timing info
2021-05-30 14:11:24.578813 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:11:24.579666 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:24.579784 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:11:24.579895 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:11:25.954546 (Thread-3): SQL status: SUCCESS 1 in 1.37 seconds
2021-05-30 14:11:25.954803 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:25.954948 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:11:27.128122 (Thread-3): SQL status: SUCCESS 1 in 1.17 seconds
2021-05-30 14:11:27.129542 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:11:27.129783 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:11:27.129922 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:11:27.537864 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:11:27.538966 (Thread-3): finished collecting timing info
2021-05-30 14:11:27.539191 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:11:28.461449 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80bacb4-bdbd-4b57-bee9-5268f0d6632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9e8a60>]}
2021-05-30 14:11:28.461925 (Thread-3): 19:41:28 | 2 of 2 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 3.89s]
2021-05-30 14:11:28.462106 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:11:28.463706 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:11:28.463956 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:28.464075 (MainThread): On master: BEGIN
2021-05-30 14:11:28.464186 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:11:30.302434 (MainThread): SQL status: SUCCESS 1 in 1.84 seconds
2021-05-30 14:11:30.302709 (MainThread): On master: COMMIT
2021-05-30 14:11:30.302940 (MainThread): Using snowflake connection "master".
2021-05-30 14:11:30.303089 (MainThread): On master: COMMIT
2021-05-30 14:11:30.713168 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:11:30.713445 (MainThread): On master: Close
2021-05-30 14:11:31.430948 (MainThread): 19:41:31 | 
2021-05-30 14:11:31.431185 (MainThread): 19:41:31 | Finished running 2 table models in 17.63s.
2021-05-30 14:11:31.431332 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:11:31.431437 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:11:31.431534 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:11:31.436374 (MainThread): 
2021-05-30 14:11:31.436545 (MainThread): Completed successfully
2021-05-30 14:11:31.436696 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:11:31.436899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee6d75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec2d1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee9a7130>]}
2021-05-30 14:11:31.437150 (MainThread): Flushing usage events
2021-05-30 14:14:37.885461 (MainThread): Running with dbt=0.19.1
2021-05-30 14:14:38.895945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:14:38.897373 (MainThread): Tracking: tracking
2021-05-30 14:14:38.897892 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6e07d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8b90580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8b90610>]}
2021-05-30 14:14:38.908643 (MainThread): Partial parsing not enabled
2021-05-30 14:14:38.910031 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:14:38.913030 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:14:38.943502 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:14:38.945321 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:14:38.946612 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:14:38.950796 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:14:38.960350 (MainThread): Parsing macros/core.sql
2021-05-30 14:14:38.963785 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:14:38.972272 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:14:38.974970 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:14:38.993668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:14:39.032860 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:14:39.057437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:14:39.078214 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:14:39.085454 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:14:39.101905 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:14:39.109847 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:14:39.116851 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:14:39.122445 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:14:39.123544 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:14:39.124684 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:14:39.126702 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:14:39.136455 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:14:39.138708 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:14:39.140553 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:14:39.182245 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:14:39.183997 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:14:39.185368 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:14:39.186893 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:14:39.193701 (MainThread): Partial parsing not enabled
2021-05-30 14:14:39.213477 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:39.221612 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:39.330507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6763700>]}
2021-05-30 14:14:39.335985 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c6761eb0>]}
2021-05-30 14:14:39.336305 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:14:39.337297 (MainThread): 
2021-05-30 14:14:39.337709 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:14:39.338751 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:14:39.354381 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:14:39.354548 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:14:39.354655 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:14:40.969925 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-30 14:14:40.973709 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:14:41.791459 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:14:41.798630 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:14:41.798761 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:14:41.798860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:14:43.325992 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.53 seconds
2021-05-30 14:14:43.326945 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:14:43.940561 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:43.940738 (MainThread): On master: BEGIN
2021-05-30 14:14:43.940849 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:14:45.680445 (MainThread): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:14:45.680715 (MainThread): On master: COMMIT
2021-05-30 14:14:45.680948 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:45.681084 (MainThread): On master: COMMIT
2021-05-30 14:14:46.293884 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:14:46.294097 (MainThread): On master: Close
2021-05-30 14:14:46.910028 (MainThread): 19:44:46 | Concurrency: 10 threads (target='dev')
2021-05-30 14:14:46.910262 (MainThread): 19:44:46 | 
2021-05-30 14:14:46.912441 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:46.912737 (Thread-1): 19:44:46 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:14:46.913032 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:46.913158 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:46.915591 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:14:46.916044 (Thread-1): finished collecting timing info
2021-05-30 14:14:46.945164 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:14:46.946168 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:46.946276 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:14:46.946363 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:14:48.342208 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-05-30 14:14:48.342471 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:48.342675 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:14:49.571426 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:14:49.573000 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:14:49.573245 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:14:49.573392 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:14:50.083413 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:14:50.094979 (Thread-1): finished collecting timing info
2021-05-30 14:14:50.095143 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:14:50.699722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8ff0880>]}
2021-05-30 14:14:50.700218 (Thread-1): 19:44:50 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-05-30 14:14:50.700407 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:14:50.701007 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:50.701304 (Thread-3): 19:44:50 | 2 of 2 START table model PUBLIC.my_second_dbt_model.................. [RUN]
2021-05-30 14:14:50.701661 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:50.701805 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:50.704773 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:14:50.705398 (Thread-3): finished collecting timing info
2021-05-30 14:14:50.707497 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:14:50.708374 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:50.708491 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:14:50.708606 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:14:52.235231 (Thread-3): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 14:14:52.235485 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:52.235626 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
      );
2021-05-30 14:14:53.360494 (Thread-3): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-30 14:14:53.361916 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:14:53.362156 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:14:53.362322 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:14:53.668300 (Thread-3): SQL status: SUCCESS 1 in 0.31 seconds
2021-05-30 14:14:53.669372 (Thread-3): finished collecting timing info
2021-05-30 14:14:53.669592 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:14:54.797099 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4079b7bd-1e20-413e-bc48-3098a7c030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fc85b0>]}
2021-05-30 14:14:54.797559 (Thread-3): 19:44:54 | 2 of 2 OK created table model PUBLIC.my_second_dbt_model............. [SUCCESS 1 in 4.10s]
2021-05-30 14:14:54.797733 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:14:54.799165 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:14:54.799405 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:54.799522 (MainThread): On master: BEGIN
2021-05-30 14:14:54.799629 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:14:56.030344 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:14:56.030639 (MainThread): On master: COMMIT
2021-05-30 14:14:56.030943 (MainThread): Using snowflake connection "master".
2021-05-30 14:14:56.031090 (MainThread): On master: COMMIT
2021-05-30 14:14:56.389170 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-05-30 14:14:56.389453 (MainThread): On master: Close
2021-05-30 14:14:57.048740 (MainThread): 19:44:57 | 
2021-05-30 14:14:57.048965 (MainThread): 19:44:57 | Finished running 2 table models in 17.71s.
2021-05-30 14:14:57.049104 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:14:57.049202 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:14:57.049292 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:14:57.053832 (MainThread): 
2021-05-30 14:14:57.053992 (MainThread): Completed successfully
2021-05-30 14:14:57.054127 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:14:57.054309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8d17580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fa4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c8fa4af0>]}
2021-05-30 14:14:57.054532 (MainThread): Flushing usage events
2021-05-30 14:24:34.329356 (MainThread): Running with dbt=0.19.1
2021-05-30 14:24:35.552757 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:24:35.554545 (MainThread): Tracking: tracking
2021-05-30 14:24:35.555337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18dd10bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19004d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19004d760>]}
2021-05-30 14:24:35.566823 (MainThread): Partial parsing not enabled
2021-05-30 14:24:35.568071 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:24:35.570808 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:24:35.598781 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:24:35.600491 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:24:35.601736 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:24:35.605487 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:24:35.614611 (MainThread): Parsing macros/core.sql
2021-05-30 14:24:35.618244 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:24:35.626498 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:24:35.627994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:24:35.643218 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:24:35.673659 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:24:35.692803 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:24:35.694427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:24:35.699601 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:24:35.711782 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:24:35.717643 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:24:35.723296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:24:35.727415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:24:35.728203 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:24:35.729080 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:24:35.730424 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:24:35.737895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:24:35.739539 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:24:35.740952 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:24:35.778909 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:24:35.780485 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:24:35.781766 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:24:35.783205 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:24:35.789496 (MainThread): Partial parsing not enabled
2021-05-30 14:24:35.807254 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:35.814761 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:35.917347 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18d461040>]}
2021-05-30 14:24:35.922526 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18d46a8b0>]}
2021-05-30 14:24:35.922817 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:24:35.923702 (MainThread): 
2021-05-30 14:24:35.924073 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:24:35.925063 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:24:35.940658 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:24:35.940806 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:24:35.940909 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:24:37.750577 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.81 seconds
2021-05-30 14:24:37.755049 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:24:38.456684 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:24:38.464550 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:24:38.464690 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:24:38.464788 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:24:40.103907 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.64 seconds
2021-05-30 14:24:40.105032 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:24:41.334598 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:41.334780 (MainThread): On master: BEGIN
2021-05-30 14:24:41.334893 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:24:42.971092 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:24:42.971356 (MainThread): On master: COMMIT
2021-05-30 14:24:42.971592 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:42.971726 (MainThread): On master: COMMIT
2021-05-30 14:24:43.380493 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:43.380768 (MainThread): On master: Close
2021-05-30 14:24:44.304955 (MainThread): 19:54:44 | Concurrency: 10 threads (target='dev')
2021-05-30 14:24:44.305190 (MainThread): 19:54:44 | 
2021-05-30 14:24:44.307556 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:44.307891 (Thread-1): 19:54:44 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:24:44.308237 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:44.308383 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:44.311156 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:24:44.311618 (Thread-1): finished collecting timing info
2021-05-30 14:24:44.340704 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:24:44.341690 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:44.341798 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:24:44.341889 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:24:45.837837 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:24:45.838082 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:45.838224 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:24:46.964360 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-05-30 14:24:46.965918 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:24:46.966161 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:24:46.966305 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:24:47.270234 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-05-30 14:24:47.281929 (Thread-1): finished collecting timing info
2021-05-30 14:24:47.282090 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:24:47.887872 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1904d8970>]}
2021-05-30 14:24:47.888357 (Thread-1): 19:54:47 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:24:47.888573 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:24:47.889148 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:47.889445 (Thread-3): 19:54:47 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:24:47.889813 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:47.889959 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:47.893090 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:24:47.894376 (Thread-3): finished collecting timing info
2021-05-30 14:24:47.917291 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:47.917449 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop table if exists "DEMO_DB"."PUBLIC"."MY_SECOND_DBT_MODEL" cascade
2021-05-30 14:24:47.917550 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:24:49.217072 (Thread-3): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-30 14:24:49.224868 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:24:49.225821 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:49.225942 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:24:49.626252 (Thread-3): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-30 14:24:49.626496 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:49.626635 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:24:50.446646 (Thread-3): SQL status: SUCCESS 1 in 0.82 seconds
2021-05-30 14:24:50.448049 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:24:50.448297 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:24:50.448447 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:24:50.855345 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:50.856463 (Thread-3): finished collecting timing info
2021-05-30 14:24:50.856691 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:24:51.472788 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d96290-5bad-4920-961c-66a85901c277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19054aa00>]}
2021-05-30 14:24:51.473236 (Thread-3): 19:54:51 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-05-30 14:24:51.473412 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:24:51.474844 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:24:51.475083 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:51.475196 (MainThread): On master: BEGIN
2021-05-30 14:24:51.475301 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:24:52.903111 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 14:24:52.903379 (MainThread): On master: COMMIT
2021-05-30 14:24:52.903640 (MainThread): Using snowflake connection "master".
2021-05-30 14:24:52.903778 (MainThread): On master: COMMIT
2021-05-30 14:24:53.312747 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:24:53.313016 (MainThread): On master: Close
2021-05-30 14:24:53.928691 (MainThread): 19:54:53 | 
2021-05-30 14:24:53.928926 (MainThread): 19:54:53 | Finished running 1 table model, 1 view model in 18.00s.
2021-05-30 14:24:53.929075 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:24:53.929183 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:24:53.929291 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:24:53.933852 (MainThread): 
2021-05-30 14:24:53.934009 (MainThread): Completed successfully
2021-05-30 14:24:53.934148 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:24:53.934332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19001efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1901d76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19052c040>]}
2021-05-30 14:24:53.934564 (MainThread): Flushing usage events
2021-05-30 14:30:26.716549 (MainThread): Running with dbt=0.19.1
2021-05-30 14:30:27.559020 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:30:27.560345 (MainThread): Tracking: tracking
2021-05-30 14:30:27.560871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92a1c7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e210580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e210610>]}
2021-05-30 14:30:27.570740 (MainThread): Partial parsing not enabled
2021-05-30 14:30:27.571704 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:30:27.573897 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:30:27.600416 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:30:27.602764 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:30:27.604130 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:30:27.607765 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:30:27.617257 (MainThread): Parsing macros/core.sql
2021-05-30 14:30:27.621222 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:30:27.629534 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:30:27.631065 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:30:27.649100 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:30:27.684441 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:30:27.704475 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:30:27.706426 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:30:27.711891 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:30:27.725058 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:30:27.731334 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:30:27.737163 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:30:27.741589 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:30:27.742435 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:30:27.743374 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:30:27.744828 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:30:27.753498 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:30:27.755303 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:30:27.756828 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:30:27.796947 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:30:27.798776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:30:27.800277 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:30:27.801899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:30:27.808495 (MainThread): Partial parsing not enabled
2021-05-30 14:30:27.827842 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:27.836733 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:27.950415 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff929b1a700>]}
2021-05-30 14:30:27.956578 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff929b0feb0>]}
2021-05-30 14:30:27.956907 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:30:27.957778 (MainThread): 
2021-05-30 14:30:27.958157 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:30:27.959113 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:30:27.974831 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:30:27.974992 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:30:27.975094 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:30:31.120909 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.15 seconds
2021-05-30 14:30:31.125304 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:30:31.910441 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:30:31.919331 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:30:31.919525 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:30:31.919650 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:30:34.226034 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.31 seconds
2021-05-30 14:30:34.227001 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:30:35.830620 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:35.830801 (MainThread): On master: BEGIN
2021-05-30 14:30:35.830905 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:30:38.696580 (MainThread): SQL status: SUCCESS 1 in 2.87 seconds
2021-05-30 14:30:38.696744 (MainThread): On master: COMMIT
2021-05-30 14:30:38.696875 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:38.696941 (MainThread): On master: COMMIT
2021-05-30 14:30:40.745587 (MainThread): SQL status: SUCCESS 1 in 2.05 seconds
2021-05-30 14:30:40.745861 (MainThread): On master: Close
2021-05-30 14:30:41.872861 (MainThread): 20:00:41 | Concurrency: 10 threads (target='dev')
2021-05-30 14:30:41.873100 (MainThread): 20:00:41 | 
2021-05-30 14:30:41.875349 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:41.875688 (Thread-1): 20:00:41 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:30:41.876042 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:41.876197 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:41.879070 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:30:41.880391 (Thread-1): finished collecting timing info
2021-05-30 14:30:41.910092 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:30:41.911149 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:41.911256 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:30:41.911347 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:30:43.553093 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:30:43.553346 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:43.553487 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:30:45.127615 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 14:30:45.129180 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:30:45.129419 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:30:45.129533 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:30:45.662326 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-05-30 14:30:45.673586 (Thread-1): finished collecting timing info
2021-05-30 14:30:45.673781 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:30:47.095252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e7853a0>]}
2021-05-30 14:30:47.095732 (Thread-1): 20:00:47 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 5.22s]
2021-05-30 14:30:47.095921 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:30:47.096531 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:47.096811 (Thread-3): 20:00:47 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:30:47.097279 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:47.097434 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:47.100260 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:30:47.100788 (Thread-3): finished collecting timing info
2021-05-30 14:30:47.119777 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:30:47.121494 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:47.121603 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:30:47.121697 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:30:48.691185 (Thread-3): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-30 14:30:48.691439 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:48.691578 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-05-30 14:30:49.346673 (Thread-3): SQL status: SUCCESS 1 in 0.65 seconds
2021-05-30 14:30:49.348092 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:30:49.348364 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:30:49.348484 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:30:50.267317 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2021-05-30 14:30:50.268382 (Thread-3): finished collecting timing info
2021-05-30 14:30:50.268604 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:30:51.700162 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdda02c6-ed80-4b6d-bbec-7efd389a98e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e5e57f0>]}
2021-05-30 14:30:51.700615 (Thread-3): 20:00:51 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 4.60s]
2021-05-30 14:30:51.700785 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:30:51.702367 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:30:51.702610 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:51.702723 (MainThread): On master: BEGIN
2021-05-30 14:30:51.702828 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:30:53.646505 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-30 14:30:53.646761 (MainThread): On master: COMMIT
2021-05-30 14:30:53.646982 (MainThread): Using snowflake connection "master".
2021-05-30 14:30:53.647107 (MainThread): On master: COMMIT
2021-05-30 14:30:54.458983 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-05-30 14:30:54.459243 (MainThread): On master: Close
2021-05-30 14:30:55.184327 (MainThread): 20:00:55 | 
2021-05-30 14:30:55.184547 (MainThread): 20:00:55 | Finished running 1 table model, 1 view model in 27.23s.
2021-05-30 14:30:55.184690 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:30:55.184791 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:30:55.184882 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:30:55.189492 (MainThread): 
2021-05-30 14:30:55.189658 (MainThread): Completed successfully
2021-05-30 14:30:55.189805 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:30:55.190005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e497580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e438640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff926676550>]}
2021-05-30 14:30:55.190251 (MainThread): Flushing usage events
2021-05-30 14:35:01.209528 (MainThread): Running with dbt=0.19.1
2021-05-30 14:35:01.953991 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:35:01.955624 (MainThread): Tracking: tracking
2021-05-30 14:35:01.956076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bea05d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c4e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c4e6d0>]}
2021-05-30 14:35:01.967083 (MainThread): Partial parsing not enabled
2021-05-30 14:35:01.968083 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:35:01.970314 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:35:01.996414 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:35:01.998198 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:35:01.999456 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:35:02.002887 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:35:02.011390 (MainThread): Parsing macros/core.sql
2021-05-30 14:35:02.014661 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:35:02.022190 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:35:02.023938 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:35:02.039645 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:35:02.070173 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:35:02.089384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:35:02.091297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:35:02.096820 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:35:02.109214 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:35:02.115166 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:35:02.120640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:35:02.125174 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:35:02.125988 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:35:02.126887 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:35:02.128286 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:35:02.135947 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:35:02.137629 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:35:02.139112 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:35:02.183826 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:35:02.185515 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:35:02.186849 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:35:02.188337 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:35:02.194926 (MainThread): Partial parsing not enabled
2021-05-30 14:35:02.213341 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:02.221215 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:02.329832 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c1ef70>]}
2021-05-30 14:35:02.334997 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c1eeb0>]}
2021-05-30 14:35:02.335272 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:35:02.336171 (MainThread): 
2021-05-30 14:35:02.336521 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:35:02.337458 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:35:02.352268 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:35:02.352404 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:35:02.352504 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:35:04.637112 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.28 seconds
2021-05-30 14:35:04.641461 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:35:05.354034 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:35:05.361973 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:35:05.362108 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:35:05.362215 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:35:06.994918 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.63 seconds
2021-05-30 14:35:06.995993 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:35:07.713410 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:07.713597 (MainThread): On master: BEGIN
2021-05-30 14:35:07.713719 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:35:09.351185 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2021-05-30 14:35:09.351456 (MainThread): On master: COMMIT
2021-05-30 14:35:09.351699 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:09.351836 (MainThread): On master: COMMIT
2021-05-30 14:35:09.861374 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:35:09.861656 (MainThread): On master: Close
2021-05-30 14:35:10.478516 (MainThread): 20:05:10 | Concurrency: 10 threads (target='dev')
2021-05-30 14:35:10.478749 (MainThread): 20:05:10 | 
2021-05-30 14:35:10.481024 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:10.481340 (Thread-1): 20:05:10 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:35:10.481686 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:10.481838 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:10.484542 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:35:10.485043 (Thread-1): finished collecting timing info
2021-05-30 14:35:10.514365 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:35:10.515391 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:10.515497 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:35:10.515587 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:35:12.012538 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:35:12.012793 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:12.012932 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:35:12.998785 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-05-30 14:35:13.000357 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:35:13.000603 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:35:13.000750 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:35:13.343678 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-30 14:35:13.354896 (Thread-1): finished collecting timing info
2021-05-30 14:35:13.355059 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:35:13.930347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c35cf0d0>]}
2021-05-30 14:35:13.930810 (Thread-1): 20:05:13 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.45s]
2021-05-30 14:35:13.930987 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:35:13.931562 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:13.931827 (Thread-3): 20:05:13 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:35:13.932164 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:13.932309 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:13.935065 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:35:13.935524 (Thread-3): finished collecting timing info
2021-05-30 14:35:13.953622 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:35:13.954414 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:13.954522 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:35:13.954617 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:35:15.289253 (Thread-3): SQL status: SUCCESS 1 in 1.33 seconds
2021-05-30 14:35:15.289504 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:15.289646 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:35:15.903835 (Thread-3): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:35:15.905237 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:35:15.905503 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:35:15.905644 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:35:16.313926 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:35:16.315015 (Thread-3): finished collecting timing info
2021-05-30 14:35:16.315243 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:35:16.929287 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5860a62b-dfb1-4186-a14d-1c24fcced070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c3524820>]}
2021-05-30 14:35:16.929760 (Thread-3): 20:05:16 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.00s]
2021-05-30 14:35:16.929943 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:35:16.931588 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:35:16.931833 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:16.931951 (MainThread): On master: BEGIN
2021-05-30 14:35:16.932059 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:35:18.156949 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-30 14:35:18.157217 (MainThread): On master: COMMIT
2021-05-30 14:35:18.157448 (MainThread): Using snowflake connection "master".
2021-05-30 14:35:18.157584 (MainThread): On master: COMMIT
2021-05-30 14:35:18.566351 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:35:18.566629 (MainThread): On master: Close
2021-05-30 14:35:19.286253 (MainThread): 20:05:19 | 
2021-05-30 14:35:19.286479 (MainThread): 20:05:19 | Finished running 1 table model, 1 view model in 16.95s.
2021-05-30 14:35:19.286632 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:35:19.286739 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:35:19.286837 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:35:19.291622 (MainThread): 
2021-05-30 14:35:19.291790 (MainThread): Completed successfully
2021-05-30 14:35:19.291939 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:35:19.292228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c33d7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c9c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7c0c9c8b0>]}
2021-05-30 14:35:19.292485 (MainThread): Flushing usage events
2021-05-30 14:37:14.677648 (MainThread): Running with dbt=0.19.1
2021-05-30 14:37:15.426801 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:37:15.428201 (MainThread): Tracking: tracking
2021-05-30 14:37:15.428727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba0206d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d4f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d4f670>]}
2021-05-30 14:37:15.438051 (MainThread): Partial parsing not enabled
2021-05-30 14:37:15.438990 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:37:15.441173 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:37:15.467298 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:37:15.469049 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:37:15.470277 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:37:15.473654 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:37:15.482034 (MainThread): Parsing macros/core.sql
2021-05-30 14:37:15.485592 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:37:15.492981 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:37:15.494461 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:37:15.509698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:37:15.540998 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:37:15.559775 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:37:15.561358 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:37:15.566641 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:37:15.578707 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:37:15.585027 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:37:15.590491 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:37:15.594684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:37:15.595491 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:37:15.596383 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:37:15.597775 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:37:15.605524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:37:15.607190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:37:15.608617 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:37:15.646563 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:37:15.648153 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:37:15.649636 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:37:15.651112 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:37:15.657479 (MainThread): Partial parsing not enabled
2021-05-30 14:37:15.675701 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:15.683587 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:15.789629 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1efa0>]}
2021-05-30 14:37:15.794772 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1ee80>]}
2021-05-30 14:37:15.795051 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:37:15.795958 (MainThread): 
2021-05-30 14:37:15.796304 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:37:15.797227 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:37:15.811609 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:37:15.811748 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:37:15.811844 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:37:17.374698 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-30 14:37:17.379052 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:37:18.068548 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:37:18.076575 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:37:18.076702 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:37:18.076804 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:37:19.805966 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.73 seconds
2021-05-30 14:37:19.807106 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:37:20.523700 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:20.523889 (MainThread): On master: BEGIN
2021-05-30 14:37:20.524007 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:37:21.955407 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-30 14:37:21.955674 (MainThread): On master: COMMIT
2021-05-30 14:37:21.955915 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:21.956051 (MainThread): On master: COMMIT
2021-05-30 14:37:22.364971 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:22.365245 (MainThread): On master: Close
2021-05-30 14:37:23.147772 (MainThread): 20:07:23 | Concurrency: 10 threads (target='dev')
2021-05-30 14:37:23.148010 (MainThread): 20:07:23 | 
2021-05-30 14:37:23.150347 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:23.150679 (Thread-1): 20:07:23 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:37:23.151037 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:23.151191 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:23.153998 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:37:23.154472 (Thread-1): finished collecting timing info
2021-05-30 14:37:23.184059 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:37:23.185193 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:23.185329 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:37:23.185454 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:37:24.924831 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-05-30 14:37:24.925080 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:24.925219 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:37:26.153748 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-30 14:37:26.155176 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:37:26.155375 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:37:26.155492 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:37:26.563295 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:26.574097 (Thread-1): finished collecting timing info
2021-05-30 14:37:26.574252 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:37:27.384375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba23b1760>]}
2021-05-30 14:37:27.384860 (Thread-1): 20:07:27 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.23s]
2021-05-30 14:37:27.385048 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:37:27.385655 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:27.385937 (Thread-3): 20:07:27 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:37:27.386398 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:27.386556 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:27.389353 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:37:27.389832 (Thread-3): finished collecting timing info
2021-05-30 14:37:27.408191 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:37:27.408971 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:27.409078 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:37:27.409172 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:37:29.021422 (Thread-3): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-30 14:37:29.021668 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:29.021807 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:37:29.635092 (Thread-3): SQL status: SUCCESS 1 in 0.61 seconds
2021-05-30 14:37:29.636493 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:37:29.636748 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:37:29.636893 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:37:30.044731 (Thread-3): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:37:30.045816 (Thread-3): finished collecting timing info
2021-05-30 14:37:30.046037 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:37:30.866028 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb2dbcd8-a854-4949-a49b-057afd6b4edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d38940>]}
2021-05-30 14:37:30.866502 (Thread-3): 20:07:30 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-05-30 14:37:30.866680 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:37:30.868305 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:37:30.868546 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:30.868663 (MainThread): On master: BEGIN
2021-05-30 14:37:30.868772 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:37:32.626699 (MainThread): SQL status: SUCCESS 1 in 1.76 seconds
2021-05-30 14:37:32.626960 (MainThread): On master: COMMIT
2021-05-30 14:37:32.627189 (MainThread): Using snowflake connection "master".
2021-05-30 14:37:32.627323 (MainThread): On master: COMMIT
2021-05-30 14:37:33.116603 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-05-30 14:37:33.116895 (MainThread): On master: Close
2021-05-30 14:37:33.835361 (MainThread): 20:07:33 | 
2021-05-30 14:37:33.835582 (MainThread): 20:07:33 | Finished running 1 table model, 1 view model in 18.04s.
2021-05-30 14:37:33.835721 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:37:33.835834 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:37:33.835927 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:37:33.840399 (MainThread): 
2021-05-30 14:37:33.840540 (MainThread): Completed successfully
2021-05-30 14:37:33.840663 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:37:33.840827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba23a09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba1d1e9d0>]}
2021-05-30 14:37:33.841022 (MainThread): Flushing usage events
2021-05-30 14:41:30.416422 (MainThread): Running with dbt=0.19.1
2021-05-30 14:41:31.650252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:41:31.651857 (MainThread): Tracking: tracking
2021-05-30 14:41:31.652383 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeba07c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed551520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed5515b0>]}
2021-05-30 14:41:31.663874 (MainThread): Partial parsing not enabled
2021-05-30 14:41:31.665126 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:41:31.667921 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:41:31.695978 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:41:31.697702 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:41:31.698953 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:41:31.702550 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:41:31.712846 (MainThread): Parsing macros/core.sql
2021-05-30 14:41:31.718437 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:41:31.728281 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:41:31.730146 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:41:31.747319 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:41:31.778206 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:41:31.796823 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:41:31.798422 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:41:31.803626 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:41:31.815818 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:41:31.822010 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:41:31.827391 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:41:31.831561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:41:31.832355 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:41:31.833238 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:41:31.834609 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:41:31.842179 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:41:31.843827 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:41:31.845249 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:41:31.883116 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:41:31.884667 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:41:31.886101 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:41:31.887906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:41:31.894220 (MainThread): Partial parsing not enabled
2021-05-30 14:41:31.912527 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:31.920835 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:41:32.027749 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed51ffa0>]}
2021-05-30 14:41:32.032891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed51fee0>]}
2021-05-30 14:41:32.033179 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:41:32.034127 (MainThread): 
2021-05-30 14:41:32.034493 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:41:32.035446 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:41:32.050509 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:41:32.050648 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:41:32.050747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:41:33.904800 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.85 seconds
2021-05-30 14:41:33.909096 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:41:34.775785 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:41:34.783814 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:41:34.783948 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:41:34.784051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:41:36.206211 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.42 seconds
2021-05-30 14:41:36.207363 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:41:37.334679 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:37.334863 (MainThread): On master: BEGIN
2021-05-30 14:41:37.334981 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:41:38.868283 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2021-05-30 14:41:38.868576 (MainThread): On master: COMMIT
2021-05-30 14:41:38.868825 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:38.868964 (MainThread): On master: COMMIT
2021-05-30 14:41:39.278032 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:41:39.278301 (MainThread): On master: Close
2021-05-30 14:41:40.098994 (MainThread): 20:11:40 | Concurrency: 10 threads (target='dev')
2021-05-30 14:41:40.099226 (MainThread): 20:11:40 | 
2021-05-30 14:41:40.101491 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:40.101829 (Thread-1): 20:11:40 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:41:40.102180 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:40.102335 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:40.105243 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:41:40.105721 (Thread-1): finished collecting timing info
2021-05-30 14:41:40.134929 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:41:40.136730 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:40.136840 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:41:40.136932 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:41:41.530641 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-05-30 14:41:41.530889 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:41:41.531031 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1
)

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers
)


select *
from source_data
union
select * 
from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:41:42.042342 (Thread-1): Snowflake query id: 019c9811-0000-43cc-0000-b0b1000161de
2021-05-30 14:41:42.042557 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.
2021-05-30 14:41:42.042786 (Thread-1): finished collecting timing info
2021-05-30 14:41:42.042997 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:41:42.520381 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:41:43.171189 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:41:43.176690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6a8246-681f-4bee-bd49-37069ecc2499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee1d2100>]}
2021-05-30 14:41:43.177132 (Thread-1): 20:11:43 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.07s]
2021-05-30 14:41:43.177309 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:41:43.177987 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:41:43.178184 (Thread-3): 20:11:43 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:41:43.178452 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:41:43.179834 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:41:43.180063 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:43.180169 (MainThread): On master: BEGIN
2021-05-30 14:41:43.180266 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:41:44.704845 (MainThread): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-30 14:41:44.705106 (MainThread): On master: COMMIT
2021-05-30 14:41:44.705337 (MainThread): Using snowflake connection "master".
2021-05-30 14:41:44.705473 (MainThread): On master: COMMIT
2021-05-30 14:41:45.114587 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:41:45.114855 (MainThread): On master: Close
2021-05-30 14:41:45.935805 (MainThread): 20:11:45 | 
2021-05-30 14:41:45.936021 (MainThread): 20:11:45 | Finished running 1 table model, 1 view model in 13.90s.
2021-05-30 14:41:45.936160 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:41:45.936261 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:41:45.940880 (MainThread): 
2021-05-30 14:41:45.941036 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:41:45.941171 (MainThread): 
2021-05-30 14:41:45.941304 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:41:45.941434 (MainThread):   001003 (42000): SQL compilation error:
2021-05-30 14:41:45.941535 (MainThread):   syntax error line 20 at position 0 unexpected 'customer_orders'.
2021-05-30 14:41:45.941633 (MainThread):   syntax error line 23 at position 24 unexpected 'as'.
2021-05-30 14:41:45.941727 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:41:45.941831 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:41:45.941995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeb35c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefed58c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee1e3340>]}
2021-05-30 14:41:45.942213 (MainThread): Flushing usage events
2021-05-30 14:45:25.372419 (MainThread): Running with dbt=0.19.1
2021-05-30 14:45:26.207106 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:45:26.208287 (MainThread): Tracking: tracking
2021-05-30 14:45:26.208834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b82c05d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f4f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f4f6a0>]}
2021-05-30 14:45:26.220472 (MainThread): Partial parsing not enabled
2021-05-30 14:45:26.221610 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:45:26.224471 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:45:26.254085 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:45:26.256417 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:45:26.258012 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:45:26.261692 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:45:26.270503 (MainThread): Parsing macros/core.sql
2021-05-30 14:45:26.273898 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:45:26.281635 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:45:26.283179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:45:26.299377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:45:26.331658 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:45:26.350622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:45:26.352276 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:45:26.357774 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:45:26.370610 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:45:26.377447 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:45:26.383050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:45:26.387360 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:45:26.388194 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:45:26.389117 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:45:26.390690 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:45:26.398691 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:45:26.400418 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:45:26.401887 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:45:26.442040 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:45:26.443864 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:45:26.445193 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:45:26.446672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:45:26.452997 (MainThread): Partial parsing not enabled
2021-05-30 14:45:26.471867 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:26.479961 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:45:26.590845 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f1efa0>]}
2021-05-30 14:45:26.596304 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f1efd0>]}
2021-05-30 14:45:26.596612 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:45:26.597545 (MainThread): 
2021-05-30 14:45:26.597906 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:45:26.598866 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:45:26.613547 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:45:26.613703 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:45:26.613806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:45:30.388015 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.77 seconds
2021-05-30 14:45:30.392640 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:45:31.105513 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:45:31.112988 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:45:31.113155 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:45:31.113259 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:45:32.541146 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.43 seconds
2021-05-30 14:45:32.542172 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:45:33.256195 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:33.256376 (MainThread): On master: BEGIN
2021-05-30 14:45:33.256490 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:45:35.310661 (MainThread): SQL status: SUCCESS 1 in 2.05 seconds
2021-05-30 14:45:35.310891 (MainThread): On master: COMMIT
2021-05-30 14:45:35.311085 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:35.311195 (MainThread): On master: COMMIT
2021-05-30 14:45:35.810071 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-05-30 14:45:35.810303 (MainThread): On master: Close
2021-05-30 14:45:36.737293 (MainThread): 20:15:36 | Concurrency: 10 threads (target='dev')
2021-05-30 14:45:36.737519 (MainThread): 20:15:36 | 
2021-05-30 14:45:36.739863 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:36.740221 (Thread-1): 20:15:36 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:45:36.740571 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:36.740725 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:36.743395 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:45:36.743860 (Thread-1): finished collecting timing info
2021-05-30 14:45:36.773057 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:45:36.775128 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:36.775235 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:45:36.775327 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:45:38.680491 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2021-05-30 14:45:38.680697 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:45:38.680810 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:45:39.089660 (Thread-1): Snowflake query id: 019c9815-0000-43d8-0000-b0b1000151f2
2021-05-30 14:45:39.089891 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-30 14:45:39.090133 (Thread-1): finished collecting timing info
2021-05-30 14:45:39.090355 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:45:39.806686 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:45:40.570779 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:45:40.573794 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2cdfb4-aa8c-48b1-b4d6-866fb9e3a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8537ef70>]}
2021-05-30 14:45:40.574224 (Thread-1): 20:15:40 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.83s]
2021-05-30 14:45:40.574420 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:45:40.575027 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:45:40.575318 (Thread-3): 20:15:40 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:45:40.575472 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:45:40.576654 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:45:40.576855 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:40.576948 (MainThread): On master: BEGIN
2021-05-30 14:45:40.577035 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:45:42.264296 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2021-05-30 14:45:42.264513 (MainThread): On master: COMMIT
2021-05-30 14:45:42.264694 (MainThread): Using snowflake connection "master".
2021-05-30 14:45:42.264799 (MainThread): On master: COMMIT
2021-05-30 14:45:42.673982 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:45:42.674261 (MainThread): On master: Close
2021-05-30 14:45:43.495500 (MainThread): 20:15:43 | 
2021-05-30 14:45:43.495716 (MainThread): 20:15:43 | Finished running 1 table model, 1 view model in 16.90s.
2021-05-30 14:45:43.495853 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:45:43.495949 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:45:43.500660 (MainThread): 
2021-05-30 14:45:43.500810 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:45:43.500936 (MainThread): 
2021-05-30 14:45:43.501054 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:45:43.501160 (MainThread):   002003 (02000): SQL compilation error:
2021-05-30 14:45:43.501256 (MainThread):   Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-30 14:45:43.501349 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:45:43.501449 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:45:43.501612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f9b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b850d7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84f37040>]}
2021-05-30 14:45:43.501833 (MainThread): Flushing usage events
2021-05-30 14:46:13.126493 (MainThread): Running with dbt=0.19.1
2021-05-30 14:46:13.963793 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:46:13.965678 (MainThread): Tracking: tracking
2021-05-30 14:46:13.966282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4bcc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d912580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d912610>]}
2021-05-30 14:46:13.978032 (MainThread): Partial parsing not enabled
2021-05-30 14:46:13.979406 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:46:13.982218 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:46:14.012291 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:46:14.014166 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:46:14.015535 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:46:14.019108 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:46:14.027989 (MainThread): Parsing macros/core.sql
2021-05-30 14:46:14.031864 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:46:14.039645 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:46:14.041195 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:46:14.057580 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:46:14.089370 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:46:14.110838 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:46:14.112882 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:46:14.119478 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:46:14.132609 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:46:14.138641 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:46:14.144288 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:46:14.148838 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:46:14.149709 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:46:14.150621 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:46:14.152046 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:46:14.159945 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:46:14.161847 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:46:14.163323 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:46:14.203152 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:46:14.204838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:46:14.206163 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:46:14.207651 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:46:14.214594 (MainThread): Partial parsing not enabled
2021-05-30 14:46:14.233840 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:14.242032 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:46:14.355917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d8defd0>]}
2021-05-30 14:46:14.361300 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4d8dee80>]}
2021-05-30 14:46:14.361602 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:46:14.362557 (MainThread): 
2021-05-30 14:46:14.362933 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:46:14.363933 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:46:14.379519 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:46:14.379694 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:46:14.379799 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:46:16.261620 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.88 seconds
2021-05-30 14:46:16.266193 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:46:17.267079 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:46:17.274443 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:46:17.274572 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:46:17.274669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:46:18.923563 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.65 seconds
2021-05-30 14:46:18.924700 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:46:19.641702 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:19.641883 (MainThread): On master: BEGIN
2021-05-30 14:46:19.641997 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:46:22.342037 (MainThread): SQL status: SUCCESS 1 in 2.70 seconds
2021-05-30 14:46:22.342260 (MainThread): On master: COMMIT
2021-05-30 14:46:22.342450 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:22.342557 (MainThread): On master: COMMIT
2021-05-30 14:46:23.081979 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2021-05-30 14:46:23.082280 (MainThread): On master: Close
2021-05-30 14:46:23.941291 (MainThread): 20:16:23 | Concurrency: 10 threads (target='dev')
2021-05-30 14:46:23.941518 (MainThread): 20:16:23 | 
2021-05-30 14:46:23.943501 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:23.943807 (Thread-1): 20:16:23 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:46:23.944124 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:23.944249 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:23.946852 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:46:23.947299 (Thread-1): finished collecting timing info
2021-05-30 14:46:23.977083 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:46:23.979081 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:23.979190 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:46:23.979277 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:46:25.578431 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-05-30 14:46:25.578683 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:46:25.578825 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:46:26.110721 (Thread-1): Snowflake query id: 019c9816-0000-43d8-0000-b0b1000151fe
2021-05-30 14:46:26.110940 (Thread-1): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-30 14:46:26.111158 (Thread-1): finished collecting timing info
2021-05-30 14:46:26.111372 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-05-30 14:46:26.511533 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:46:27.423665 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:46:27.426503 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f941899d-1b28-4915-8e2a-24e7d8c298ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4dcab2b0>]}
2021-05-30 14:46:27.426901 (Thread-1): 20:16:27 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 3.48s]
2021-05-30 14:46:27.427068 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:46:27.427605 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:46:27.427873 (Thread-3): 20:16:27 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2021-05-30 14:46:27.428039 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:46:27.429286 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:46:27.429491 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:27.429589 (MainThread): On master: BEGIN
2021-05-30 14:46:27.429679 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:46:29.709623 (MainThread): SQL status: SUCCESS 1 in 2.28 seconds
2021-05-30 14:46:29.709894 (MainThread): On master: COMMIT
2021-05-30 14:46:29.710125 (MainThread): Using snowflake connection "master".
2021-05-30 14:46:29.710261 (MainThread): On master: COMMIT
2021-05-30 14:46:30.187809 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-05-30 14:46:30.188089 (MainThread): On master: Close
2021-05-30 14:46:31.108952 (MainThread): 20:16:31 | 
2021-05-30 14:46:31.109173 (MainThread): 20:16:31 | Finished running 1 table model, 1 view model in 16.75s.
2021-05-30 14:46:31.109313 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:46:31.109412 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:46:31.113610 (MainThread): 
2021-05-30 14:46:31.113754 (MainThread): Completed with 1 error and 0 warnings:
2021-05-30 14:46:31.113875 (MainThread): 
2021-05-30 14:46:31.113989 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-05-30 14:46:31.114093 (MainThread):   001100 (42601): SQL compilation error:
2021-05-30 14:46:31.114182 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-30 14:46:31.114268 (MainThread):   compiled SQL at target/run/demo_dbt/models/example/my_first_dbt_model.sql
2021-05-30 14:46:31.114366 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-30 14:46:31.114526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb480e6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4da97580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4dc1f7c0>]}
2021-05-30 14:46:31.114724 (MainThread): Flushing usage events
2021-05-30 14:47:45.521323 (MainThread): Running with dbt=0.19.1
2021-05-30 14:47:46.362116 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 14:47:46.363379 (MainThread): Tracking: tracking
2021-05-30 14:47:46.363986 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9388d10af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a84e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a84e700>]}
2021-05-30 14:47:46.375571 (MainThread): Partial parsing not enabled
2021-05-30 14:47:46.376831 (MainThread): Parsing macros/catalog.sql
2021-05-30 14:47:46.379597 (MainThread): Parsing macros/adapters.sql
2021-05-30 14:47:46.411673 (MainThread): Parsing macros/materializations/merge.sql
2021-05-30 14:47:46.413674 (MainThread): Parsing macros/materializations/view.sql
2021-05-30 14:47:46.415099 (MainThread): Parsing macros/materializations/table.sql
2021-05-30 14:47:46.419174 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-30 14:47:46.428529 (MainThread): Parsing macros/core.sql
2021-05-30 14:47:46.431879 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-30 14:47:46.439777 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-30 14:47:46.441317 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-30 14:47:46.457827 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-30 14:47:46.491931 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-30 14:47:46.511939 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-30 14:47:46.513595 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-30 14:47:46.519194 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-30 14:47:46.531916 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-30 14:47:46.538388 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-30 14:47:46.544056 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-30 14:47:46.548540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-30 14:47:46.549502 (MainThread): Parsing macros/etc/query.sql
2021-05-30 14:47:46.550441 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-30 14:47:46.551842 (MainThread): Parsing macros/etc/datetime.sql
2021-05-30 14:47:46.559661 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-30 14:47:46.561357 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-30 14:47:46.562826 (MainThread): Parsing macros/adapters/common.sql
2021-05-30 14:47:46.602623 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-30 14:47:46.604353 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-30 14:47:46.605681 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-30 14:47:46.607283 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-30 14:47:46.613820 (MainThread): Partial parsing not enabled
2021-05-30 14:47:46.632712 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:46.640813 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:47:46.754425 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a81efa0>]}
2021-05-30 14:47:46.759680 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a81ef40>]}
2021-05-30 14:47:46.759960 (MainThread): Found 2 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-30 14:47:46.760874 (MainThread): 
2021-05-30 14:47:46.761235 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:47:46.762152 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-30 14:47:46.776833 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-30 14:47:46.776989 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-30 14:47:46.777089 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 14:47:48.622964 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.85 seconds
2021-05-30 14:47:48.627232 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-30 14:47:49.444064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:47:49.451631 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-30 14:47:49.451802 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-30 14:47:49.451904 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-30 14:47:52.202280 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.75 seconds
2021-05-30 14:47:52.203427 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-30 14:47:53.027479 (MainThread): Using snowflake connection "master".
2021-05-30 14:47:53.027667 (MainThread): On master: BEGIN
2021-05-30 14:47:53.027785 (MainThread): Opening a new connection, currently in state init
2021-05-30 14:47:54.970633 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2021-05-30 14:47:54.970902 (MainThread): On master: COMMIT
2021-05-30 14:47:54.971143 (MainThread): Using snowflake connection "master".
2021-05-30 14:47:54.971292 (MainThread): On master: COMMIT
2021-05-30 14:47:55.482502 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-30 14:47:55.482778 (MainThread): On master: Close
2021-05-30 14:47:56.814945 (MainThread): 20:17:56 | Concurrency: 10 threads (target='dev')
2021-05-30 14:47:56.815169 (MainThread): 20:17:56 | 
2021-05-30 14:47:56.816971 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:47:56.817286 (Thread-1): 20:17:56 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-05-30 14:47:56.817599 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:56.817726 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-05-30 14:47:56.820194 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:47:56.820643 (Thread-1): finished collecting timing info
2021-05-30 14:47:56.850435 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-05-30 14:47:56.851555 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:56.851669 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-05-30 14:47:56.851764 (Thread-1): Opening a new connection, currently in state closed
2021-05-30 14:47:58.349583 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-05-30 14:47:58.349832 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:58.349971 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (


    select 1 as id, 'google.com' as url
    union all
    select null as id, 'abc.com' as url

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-05-30 14:47:59.885670 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-05-30 14:47:59.887226 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:47:59.887472 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-05-30 14:47:59.887586 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-05-30 14:48:00.296678 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-30 14:48:00.307814 (Thread-1): finished collecting timing info
2021-05-30 14:48:00.308019 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-05-30 14:48:00.959994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938adc2130>]}
2021-05-30 14:48:00.960446 (Thread-1): 20:18:00 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.14s]
2021-05-30 14:48:00.960624 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-05-30 14:48:00.961165 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:00.961448 (Thread-3): 20:18:00 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-05-30 14:48:00.962037 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:00.962351 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:00.965025 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:48:00.965513 (Thread-3): finished collecting timing info
2021-05-30 14:48:00.982195 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-05-30 14:48:00.982941 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:00.983042 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-05-30 14:48:00.983127 (Thread-3): Opening a new connection, currently in state init
2021-05-30 14:48:02.333429 (Thread-3): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-30 14:48:02.333684 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:02.333797 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id > 0
  );
2021-05-30 14:48:02.882843 (Thread-3): SQL status: SUCCESS 1 in 0.55 seconds
2021-05-30 14:48:02.896300 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:48:02.896604 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-05-30 14:48:02.896752 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-05-30 14:48:03.313396 (Thread-3): SQL status: SUCCESS 1 in 0.42 seconds
2021-05-30 14:48:03.314481 (Thread-3): finished collecting timing info
2021-05-30 14:48:03.314710 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-05-30 14:48:03.934859 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c08ce83e-4c08-4614-8c94-a96b068614ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938adc24c0>]}
2021-05-30 14:48:03.935338 (Thread-3): 20:18:03 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.97s]
2021-05-30 14:48:03.935524 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-05-30 14:48:03.937058 (MainThread): Acquiring new snowflake connection "master".
2021-05-30 14:48:03.937307 (MainThread): Using snowflake connection "master".
2021-05-30 14:48:03.937425 (MainThread): On master: BEGIN
2021-05-30 14:48:03.937535 (MainThread): Opening a new connection, currently in state closed
2021-05-30 14:48:05.619823 (MainThread): SQL status: SUCCESS 1 in 1.68 seconds
2021-05-30 14:48:05.620094 (MainThread): On master: COMMIT
2021-05-30 14:48:05.620334 (MainThread): Using snowflake connection "master".
2021-05-30 14:48:05.620476 (MainThread): On master: COMMIT
2021-05-30 14:48:06.317315 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2021-05-30 14:48:06.317585 (MainThread): On master: Close
2021-05-30 14:48:06.952343 (MainThread): 20:18:06 | 
2021-05-30 14:48:06.952566 (MainThread): 20:18:06 | Finished running 1 table model, 1 view model in 20.19s.
2021-05-30 14:48:06.952711 (MainThread): Connection 'master' was properly closed.
2021-05-30 14:48:06.952815 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-05-30 14:48:06.952908 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-05-30 14:48:06.957216 (MainThread): 
2021-05-30 14:48:06.957364 (MainThread): Completed successfully
2021-05-30 14:48:06.957488 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-30 14:48:06.957659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938a9d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938ad85610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938ad850a0>]}
2021-05-30 14:48:06.957865 (MainThread): Flushing usage events
2021-05-31 04:47:53.732091 (MainThread): Running with dbt=0.19.1
2021-05-31 04:47:55.143142 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:47:55.145248 (MainThread): Tracking: tracking
2021-05-31 04:47:55.145913 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba4407d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7750550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba77505e0>]}
2021-05-31 04:47:55.158914 (MainThread): Partial parsing not enabled
2021-05-31 04:47:55.160339 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:47:55.163522 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:47:55.197851 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:47:55.200232 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:47:55.201897 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:47:55.205779 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:47:55.215787 (MainThread): Parsing macros/core.sql
2021-05-31 04:47:55.219733 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:47:55.228075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:47:55.229888 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:47:55.247746 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:47:55.280359 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:47:55.300487 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:47:55.302312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:47:55.307896 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:47:55.321695 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:47:55.332367 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:47:55.339879 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:47:55.345618 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:47:55.346926 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:47:55.348241 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:47:55.350174 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:47:55.359312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:47:55.361274 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:47:55.362923 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:47:55.402601 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:47:55.405033 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:47:55.407000 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:47:55.408982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:47:55.417011 (MainThread): Partial parsing not enabled
2021-05-31 04:47:55.436537 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:47:55.478329 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79b3d60>]}
2021-05-31 04:47:55.482464 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7a570d0>]}
2021-05-31 04:47:55.482697 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:47:55.483373 (MainThread): 
2021-05-31 04:47:55.483665 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:47:55.484420 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:47:55.497457 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:47:55.497566 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:47:55.497650 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:47:58.109929 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.61 seconds
2021-05-31 04:47:58.114123 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:47:58.868682 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:47:58.876369 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:47:58.876511 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:47:58.876614 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:48:00.436898 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.56 seconds
2021-05-31 04:48:00.438071 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:48:01.089556 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:01.089721 (MainThread): On master: BEGIN
2021-05-31 04:48:01.089817 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:48:02.444688 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-05-31 04:48:02.444909 (MainThread): On master: COMMIT
2021-05-31 04:48:02.445082 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:02.445175 (MainThread): On master: COMMIT
2021-05-31 04:48:03.065780 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-05-31 04:48:03.066005 (MainThread): On master: Close
2021-05-31 04:48:03.763734 (MainThread): 10:18:03 | Concurrency: 10 threads (target='dev')
2021-05-31 04:48:03.763969 (MainThread): 10:18:03 | 
2021-05-31 04:48:03.766167 (Thread-1): Began running node model.demo_dbt.customers
2021-05-31 04:48:03.766501 (Thread-1): 10:18:03 | 1 of 1 START table model PUBLIC.customers............................ [RUN]
2021-05-31 04:48:03.766848 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:03.766998 (Thread-1): Compiling model.demo_dbt.customers
2021-05-31 04:48:03.768563 (Thread-1): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:03.770705 (Thread-1): finished collecting timing info
2021-05-31 04:48:03.801642 (Thread-1): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:03.803955 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:03.804175 (Thread-1): On model.demo_dbt.customers: BEGIN
2021-05-31 04:48:03.804281 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:48:05.317450 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-05-31 04:48:05.317704 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:05.317842 (Thread-1): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 04:48:05.726493 (Thread-1): Snowflake query id: 019c9b60-0000-43db-0000-b0b10001b00e
2021-05-31 04:48:05.726722 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-31 04:48:05.726952 (Thread-1): finished collecting timing info
2021-05-31 04:48:05.727168 (Thread-1): On model.demo_dbt.customers: ROLLBACK
2021-05-31 04:48:06.137633 (Thread-1): On model.demo_dbt.customers: Close
2021-05-31 04:48:06.753033 (Thread-1): Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database '"`DBT-TUTORIAL`"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  002003 (02000): SQL compilation error:
  Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:06.763535 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94edbba-c5cd-4778-aa1f-08cdd00de2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7b67cd0>]}
2021-05-31 04:48:06.763981 (Thread-1): 10:18:06 | 1 of 1 ERROR creating table model PUBLIC.customers................... [ERROR in 3.00s]
2021-05-31 04:48:06.764157 (Thread-1): Finished running node model.demo_dbt.customers
2021-05-31 04:48:06.765690 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:06.765952 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:06.766052 (MainThread): On master: BEGIN
2021-05-31 04:48:06.766144 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:48:08.182233 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2021-05-31 04:48:08.182464 (MainThread): On master: COMMIT
2021-05-31 04:48:08.182645 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:08.182750 (MainThread): On master: COMMIT
2021-05-31 04:48:08.594207 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:48:08.594502 (MainThread): On master: Close
2021-05-31 04:48:09.135220 (MainThread): 10:18:09 | 
2021-05-31 04:48:09.135455 (MainThread): 10:18:09 | Finished running 1 table model in 13.65s.
2021-05-31 04:48:09.135597 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:48:09.135698 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 04:48:09.140298 (MainThread): 
2021-05-31 04:48:09.140486 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:48:09.140704 (MainThread): 
2021-05-31 04:48:09.140946 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 04:48:09.141100 (MainThread):   002003 (02000): SQL compilation error:
2021-05-31 04:48:09.141199 (MainThread):   Database '"`DBT-TUTORIAL`"' does not exist or not authorized.
2021-05-31 04:48:09.141289 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:09.141385 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-31 04:48:09.141558 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79e24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba771fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba79a9700>]}
2021-05-31 04:48:09.141775 (MainThread): Flushing usage events
2021-05-31 04:48:32.819535 (MainThread): Running with dbt=0.19.1
2021-05-31 04:48:33.734323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:48:33.735716 (MainThread): Tracking: tracking
2021-05-31 04:48:33.736279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05ec0fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff060f8d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff060f8d760>]}
2021-05-31 04:48:33.748190 (MainThread): Partial parsing not enabled
2021-05-31 04:48:33.749363 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:48:33.752187 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:48:33.783391 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:48:33.785197 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:48:33.786824 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:48:33.790651 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:48:33.801933 (MainThread): Parsing macros/core.sql
2021-05-31 04:48:33.807604 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:48:33.817198 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:48:33.819103 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:48:33.837127 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:48:33.869638 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:48:33.889194 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:48:33.891125 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:48:33.896593 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:48:33.909746 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:48:33.915818 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:48:33.922154 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:48:33.926540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:48:33.927363 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:48:33.928261 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:48:33.929668 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:48:33.937438 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:48:33.939134 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:48:33.940594 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:48:33.980711 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:48:33.982407 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:48:33.983733 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:48:33.985220 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:48:33.992300 (MainThread): Partial parsing not enabled
2021-05-31 04:48:34.010911 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:34.051540 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611e61f0>]}
2021-05-31 04:48:34.055103 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611bd400>]}
2021-05-31 04:48:34.055340 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:48:34.055992 (MainThread): 
2021-05-31 04:48:34.056253 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:34.057191 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:48:34.070115 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:48:34.070262 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:48:34.070353 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:48:35.729454 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.66 seconds
2021-05-31 04:48:35.733756 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:48:36.457069 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:48:36.464862 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:48:36.464993 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:48:36.465095 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:48:37.991378 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.53 seconds
2021-05-31 04:48:37.992575 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:48:38.532418 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:38.532606 (MainThread): On master: BEGIN
2021-05-31 04:48:38.532720 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:48:39.733977 (MainThread): SQL status: SUCCESS 1 in 1.20 seconds
2021-05-31 04:48:39.734268 (MainThread): On master: COMMIT
2021-05-31 04:48:39.734511 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:39.734661 (MainThread): On master: COMMIT
2021-05-31 04:48:40.087973 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:48:40.088250 (MainThread): On master: Close
2021-05-31 04:48:40.658332 (MainThread): 10:18:40 | Concurrency: 10 threads (target='dev')
2021-05-31 04:48:40.658567 (MainThread): 10:18:40 | 
2021-05-31 04:48:40.661033 (Thread-1): Began running node model.demo_dbt.customers
2021-05-31 04:48:40.661463 (Thread-1): 10:18:40 | 1 of 1 START table model PUBLIC.customers............................ [RUN]
2021-05-31 04:48:40.661902 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:40.662045 (Thread-1): Compiling model.demo_dbt.customers
2021-05-31 04:48:40.663700 (Thread-1): Writing injected SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:40.664207 (Thread-1): finished collecting timing info
2021-05-31 04:48:40.694370 (Thread-1): Writing runtime SQL for node "model.demo_dbt.customers"
2021-05-31 04:48:40.696675 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:40.696912 (Thread-1): On model.demo_dbt.customers: BEGIN
2021-05-31 04:48:40.697030 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:48:41.925016 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 04:48:41.925268 (Thread-1): Using snowflake connection "model.demo_dbt.customers".
2021-05-31 04:48:41.925405 (Thread-1): On model.demo_dbt.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.customers"} */


      create or replace transient table DEMO_DB.PUBLIC.customers  as
      (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-05-31 04:48:42.259585 (Thread-1): Snowflake query id: 019c9b60-0000-43cf-0000-b0b10001c01a
2021-05-31 04:48:42.259808 (Thread-1): Snowflake error: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE
2021-05-31 04:48:42.260029 (Thread-1): finished collecting timing info
2021-05-31 04:48:42.260243 (Thread-1): On model.demo_dbt.customers: ROLLBACK
2021-05-31 04:48:42.637628 (Thread-1): On model.demo_dbt.customers: Close
2021-05-31 04:48:43.527902 (Thread-1): Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001100 (42601): SQL compilation error:
'CUSTOMERS' is an invalid Recursive CTE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  001100 (42601): SQL compilation error:
  'CUSTOMERS' is an invalid Recursive CTE
  compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:43.531192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41a2b26-134f-4809-b00d-375c01ac8f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0613a88b0>]}
2021-05-31 04:48:43.531626 (Thread-1): 10:18:43 | 1 of 1 ERROR creating table model PUBLIC.customers................... [ERROR in 2.87s]
2021-05-31 04:48:43.531794 (Thread-1): Finished running node model.demo_dbt.customers
2021-05-31 04:48:43.533354 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:48:43.533597 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:43.533704 (MainThread): On master: BEGIN
2021-05-31 04:48:43.533799 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:48:44.858047 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 04:48:44.858311 (MainThread): On master: COMMIT
2021-05-31 04:48:44.858538 (MainThread): Using snowflake connection "master".
2021-05-31 04:48:44.858681 (MainThread): On master: COMMIT
2021-05-31 04:48:45.205245 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:48:45.205513 (MainThread): On master: Close
2021-05-31 04:48:45.778280 (MainThread): 10:18:45 | 
2021-05-31 04:48:45.778498 (MainThread): 10:18:45 | Finished running 1 table model in 11.72s.
2021-05-31 04:48:45.778633 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:48:45.778727 (MainThread): Connection 'model.demo_dbt.customers' was properly closed.
2021-05-31 04:48:45.783032 (MainThread): 
2021-05-31 04:48:45.783233 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:48:45.783371 (MainThread): 
2021-05-31 04:48:45.783496 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-31 04:48:45.783606 (MainThread):   001100 (42601): SQL compilation error:
2021-05-31 04:48:45.783704 (MainThread):   'CUSTOMERS' is an invalid Recursive CTE
2021-05-31 04:48:45.783798 (MainThread):   compiled SQL at target/run/demo_dbt/models/customers.sql
2021-05-31 04:48:45.783900 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-31 04:48:45.784083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff06128dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff061256820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0611077c0>]}
2021-05-31 04:48:45.784332 (MainThread): Flushing usage events
2021-05-31 04:48:51.774532 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-31 04:48:51.774780 (MainThread): Error sending message, disabling tracking
2021-05-31 04:53:26.307970 (MainThread): Running with dbt=0.19.1
2021-05-31 04:53:27.220163 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:53:27.221616 (MainThread): Tracking: tracking
2021-05-31 04:53:27.222177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271f0faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27434c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27434c760>]}
2021-05-31 04:53:27.233263 (MainThread): Partial parsing not enabled
2021-05-31 04:53:27.234485 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:53:27.237101 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:53:27.265759 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:53:27.267610 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:53:27.269097 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:53:27.272688 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:53:27.281828 (MainThread): Parsing macros/core.sql
2021-05-31 04:53:27.285247 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:53:27.293531 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:53:27.295126 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:53:27.311579 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:53:27.343451 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:53:27.362437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:53:27.364105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:53:27.369456 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:53:27.382396 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:53:27.388630 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:53:27.394249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:53:27.398561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:53:27.399419 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:53:27.400330 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:53:27.401760 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:53:27.409819 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:53:27.411548 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:53:27.413014 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:53:27.452762 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:53:27.454448 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:53:27.455780 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:53:27.457306 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:53:27.463770 (MainThread): Partial parsing not enabled
2021-05-31 04:53:27.482343 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:27.489725 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:53:27.525534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2745a26a0>]}
2021-05-31 04:53:27.529025 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274681fd0>]}
2021-05-31 04:53:27.529209 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:53:27.529797 (MainThread): 
2021-05-31 04:53:27.530036 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:53:27.530702 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:53:27.603189 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:53:27.603373 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:53:27.603482 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:53:29.427119 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.82 seconds
2021-05-31 04:53:29.431470 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:53:30.043486 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:53:30.051321 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:53:30.051450 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:53:30.051551 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:53:31.158972 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.11 seconds
2021-05-31 04:53:31.160158 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:53:31.784814 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:31.785004 (MainThread): On master: BEGIN
2021-05-31 04:53:31.785118 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:53:33.214598 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:53:33.214883 (MainThread): On master: COMMIT
2021-05-31 04:53:33.215119 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:33.215227 (MainThread): On master: COMMIT
2021-05-31 04:53:33.726761 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-05-31 04:53:33.727038 (MainThread): On master: Close
2021-05-31 04:53:34.547412 (MainThread): 10:23:34 | Concurrency: 10 threads (target='dev')
2021-05-31 04:53:34.547646 (MainThread): 10:23:34 | 
2021-05-31 04:53:34.549887 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:53:34.550229 (Thread-1): 10:23:34 | 1 of 2 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 04:53:34.550557 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:34.550704 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:53:34.552247 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:53:34.552716 (Thread-1): finished collecting timing info
2021-05-31 04:53:34.582342 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:53:34.583199 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:34.583305 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:53:34.583397 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:53:35.774667 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:53:35.774926 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:53:35.775064 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 04:53:36.183878 (Thread-1): Snowflake query id: 019c9b65-0000-43dd-0000-b0b10001a03a
2021-05-31 04:53:36.184106 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:53:36.184334 (Thread-1): finished collecting timing info
2021-05-31 04:53:36.184548 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:53:36.594043 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:53:37.209631 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:53:37.212589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e838fed3-8b02-4510-b5a2-fffef7822c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274893c40>]}
2021-05-31 04:53:37.212967 (Thread-1): 10:23:37 | 1 of 2 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.66s]
2021-05-31 04:53:37.213135 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:53:37.213741 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:53:37.213922 (Thread-3): 10:23:37 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:53:37.214181 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:53:37.215472 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:53:37.215694 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:37.215803 (MainThread): On master: BEGIN
2021-05-31 04:53:37.215903 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:53:38.334608 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-05-31 04:53:38.334881 (MainThread): On master: COMMIT
2021-05-31 04:53:38.335114 (MainThread): Using snowflake connection "master".
2021-05-31 04:53:38.335252 (MainThread): On master: COMMIT
2021-05-31 04:53:38.747554 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:53:38.747840 (MainThread): On master: Close
2021-05-31 04:53:39.565357 (MainThread): 10:23:39 | 
2021-05-31 04:53:39.565600 (MainThread): 10:23:39 | Finished running 2 table models in 12.04s.
2021-05-31 04:53:39.565752 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:53:39.565864 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:53:39.570320 (MainThread): 
2021-05-31 04:53:39.570491 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:53:39.570630 (MainThread): 
2021-05-31 04:53:39.570760 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:53:39.570874 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:53:39.570979 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:53:39.571084 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:53:39.571198 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:53:39.571380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27467e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2748b0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2748b0e80>]}
2021-05-31 04:53:39.571601 (MainThread): Flushing usage events
2021-05-31 04:54:17.634997 (MainThread): Running with dbt=0.19.1
2021-05-31 04:54:18.516096 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:54:18.517517 (MainThread): Tracking: tracking
2021-05-31 04:54:18.518052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83252cbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329a4f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329a4f730>]}
2021-05-31 04:54:18.529642 (MainThread): Partial parsing not enabled
2021-05-31 04:54:18.530857 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:54:18.533536 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:54:18.562961 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:54:18.564746 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:54:18.566045 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:54:18.569786 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:54:18.578778 (MainThread): Parsing macros/core.sql
2021-05-31 04:54:18.582163 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:54:18.589968 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:54:18.591509 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:54:18.608069 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:54:18.640092 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:54:18.659480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:54:18.661146 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:54:18.666529 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:54:18.679364 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:54:18.685476 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:54:18.691148 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:54:18.695498 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:54:18.696329 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:54:18.697242 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:54:18.698665 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:54:18.706590 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:54:18.708405 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:54:18.709924 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:54:18.749189 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:54:18.750889 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:54:18.752245 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:54:18.753746 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:54:18.760368 (MainThread): Partial parsing not enabled
2021-05-31 04:54:18.779406 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:18.786873 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:54:18.822400 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329b98880>]}
2021-05-31 04:54:18.825871 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329c82f40>]}
2021-05-31 04:54:18.826051 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:54:18.826635 (MainThread): 
2021-05-31 04:54:18.826861 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:54:18.827520 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:54:18.899210 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:54:18.899393 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:54:18.899503 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:54:20.401531 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.50 seconds
2021-05-31 04:54:20.405572 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:54:20.957454 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:54:20.965339 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:54:20.965470 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:54:20.965572 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:54:22.262154 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.30 seconds
2021-05-31 04:54:22.263315 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:54:22.815827 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:22.816013 (MainThread): On master: BEGIN
2021-05-31 04:54:22.816127 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:54:24.003414 (MainThread): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:54:24.003707 (MainThread): On master: COMMIT
2021-05-31 04:54:24.003911 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:24.004023 (MainThread): On master: COMMIT
2021-05-31 04:54:24.343067 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 04:54:24.343348 (MainThread): On master: Close
2021-05-31 04:54:24.923606 (MainThread): 10:24:24 | Concurrency: 10 threads (target='dev')
2021-05-31 04:54:24.923837 (MainThread): 10:24:24 | 
2021-05-31 04:54:24.926028 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:54:24.926358 (Thread-1): 10:24:24 | 1 of 2 START table model PUBLIC.stg_customers........................ [RUN]
2021-05-31 04:54:24.926688 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:24.926852 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:54:24.928393 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:54:24.928894 (Thread-1): finished collecting timing info
2021-05-31 04:54:24.959254 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:54:24.960105 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:24.960216 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:54:24.960306 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:54:26.149618 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:54:26.149869 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:54:26.150005 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */


      create or replace transient table DEMO_DB.PUBLIC.stg_customers  as
      (select 
    id as customer_id,
    first_name,
    last_name

from customers
      );
2021-05-31 04:54:26.559299 (Thread-1): Snowflake query id: 019c9b66-0000-43dd-0000-b0b10001a04e
2021-05-31 04:54:26.559520 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:54:26.559741 (Thread-1): finished collecting timing info
2021-05-31 04:54:26.559945 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:54:26.989540 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:54:27.563629 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:54:27.566704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87cac03-e0d0-43a4-bac6-0ed2d22f973f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f832a101b50>]}
2021-05-31 04:54:27.567122 (Thread-1): 10:24:27 | 1 of 2 ERROR creating table model PUBLIC.stg_customers............... [ERROR in 2.64s]
2021-05-31 04:54:27.567304 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:54:27.567971 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:54:27.568166 (Thread-3): 10:24:27 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:54:27.568332 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:54:27.569806 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:54:27.570051 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:27.570167 (MainThread): On master: BEGIN
2021-05-31 04:54:27.570274 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:54:29.155676 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2021-05-31 04:54:29.155949 (MainThread): On master: COMMIT
2021-05-31 04:54:29.156180 (MainThread): Using snowflake connection "master".
2021-05-31 04:54:29.156314 (MainThread): On master: COMMIT
2021-05-31 04:54:29.532393 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 04:54:29.532669 (MainThread): On master: Close
2021-05-31 04:54:30.149631 (MainThread): 10:24:30 | 
2021-05-31 04:54:30.149862 (MainThread): 10:24:30 | Finished running 2 table models in 11.32s.
2021-05-31 04:54:30.150004 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:54:30.150106 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:54:30.154518 (MainThread): 
2021-05-31 04:54:30.154682 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:54:30.154817 (MainThread): 
2021-05-31 04:54:30.154944 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:54:30.155058 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:54:30.155163 (MainThread):   Object 'CUSTOMERS' does not exist or not authorized.
2021-05-31 04:54:30.155264 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:54:30.155375 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:54:30.155555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329be2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329cf6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8329cf6160>]}
2021-05-31 04:54:30.155784 (MainThread): Flushing usage events
2021-05-31 04:55:25.242777 (MainThread): Running with dbt=0.19.1
2021-05-31 04:55:26.013528 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:55:26.015005 (MainThread): Tracking: tracking
2021-05-31 04:55:26.015528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc007fc8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d94e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d94e700>]}
2021-05-31 04:55:26.024913 (MainThread): Partial parsing not enabled
2021-05-31 04:55:26.025883 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:55:26.028131 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:55:26.054156 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:55:26.055915 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:55:26.057157 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:55:26.060623 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:55:26.069254 (MainThread): Parsing macros/core.sql
2021-05-31 04:55:26.072469 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:55:26.079931 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:55:26.081420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:55:26.096785 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:55:26.126863 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:55:26.145879 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:55:26.147463 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:55:26.152635 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:55:26.165149 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:55:26.171305 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:55:26.176736 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:55:26.180872 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:55:26.181671 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:55:26.182552 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:55:26.183918 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:55:26.191412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:55:26.193054 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:55:26.194466 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:55:26.232513 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:55:26.234090 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:55:26.235367 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:55:26.236796 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:55:26.243044 (MainThread): Partial parsing not enabled
2021-05-31 04:55:26.261053 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:26.268230 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:55:26.305723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00da96c40>]}
2021-05-31 04:55:26.309129 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00db84490>]}
2021-05-31 04:55:26.309301 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:55:26.309862 (MainThread): 
2021-05-31 04:55:26.310086 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:55:26.310840 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:55:26.382653 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:55:26.382840 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:55:26.382940 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:55:27.899266 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.52 seconds
2021-05-31 04:55:27.903765 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:55:28.514262 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:55:28.520994 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:55:28.521124 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:55:28.521221 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:55:29.743601 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.22 seconds
2021-05-31 04:55:29.744767 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:55:30.563629 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:30.563822 (MainThread): On master: BEGIN
2021-05-31 04:55:30.563940 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:55:31.824902 (MainThread): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-31 04:55:31.825203 (MainThread): On master: COMMIT
2021-05-31 04:55:31.825451 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:31.825593 (MainThread): On master: COMMIT
2021-05-31 04:55:32.180289 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-05-31 04:55:32.180569 (MainThread): On master: Close
2021-05-31 04:55:32.814838 (MainThread): 10:25:32 | Concurrency: 10 threads (target='dev')
2021-05-31 04:55:32.815081 (MainThread): 10:25:32 | 
2021-05-31 04:55:32.817358 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:55:32.817700 (Thread-1): 10:25:32 | 1 of 2 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 04:55:32.818058 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:32.818215 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:55:32.819850 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:55:32.820355 (Thread-1): finished collecting timing info
2021-05-31 04:55:32.847657 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:55:32.848489 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:32.848599 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:55:32.848691 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:55:34.041463 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-05-31 04:55:34.041720 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:55:34.041860 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 04:55:34.450583 (Thread-1): Snowflake query id: 019c9b67-0000-43cf-0000-b0b10001c05a
2021-05-31 04:55:34.450814 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:55:34.451055 (Thread-1): finished collecting timing info
2021-05-31 04:55:34.451272 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:55:35.064804 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:55:35.682719 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:55:35.685835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '559acf7a-8955-4e03-834b-e2e137671575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00df0a730>]}
2021-05-31 04:55:35.686239 (Thread-1): 10:25:35 | 1 of 2 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.87s]
2021-05-31 04:55:35.686411 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:55:35.687121 (Thread-3): Began running node model.demo_dbt.customers
2021-05-31 04:55:35.687321 (Thread-3): 10:25:35 | 2 of 2 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:55:35.687491 (Thread-3): Finished running node model.demo_dbt.customers
2021-05-31 04:55:35.688912 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:55:35.689138 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:35.689247 (MainThread): On master: BEGIN
2021-05-31 04:55:35.689347 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:55:37.011298 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-05-31 04:55:37.011571 (MainThread): On master: COMMIT
2021-05-31 04:55:37.011801 (MainThread): Using snowflake connection "master".
2021-05-31 04:55:37.011936 (MainThread): On master: COMMIT
2021-05-31 04:55:37.420568 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:55:37.420851 (MainThread): On master: Close
2021-05-31 04:55:38.139379 (MainThread): 10:25:38 | 
2021-05-31 04:55:38.139620 (MainThread): 10:25:38 | Finished running 2 view models in 11.83s.
2021-05-31 04:55:38.139766 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:55:38.139870 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:55:38.144330 (MainThread): 
2021-05-31 04:55:38.144518 (MainThread): Completed with 1 error and 0 warnings:
2021-05-31 04:55:38.144658 (MainThread): 
2021-05-31 04:55:38.144792 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:55:38.144931 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:55:38.145043 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:55:38.145157 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:55:38.145281 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-05-31 04:55:38.145467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dae2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dfdea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00dfded60>]}
2021-05-31 04:55:38.145709 (MainThread): Flushing usage events
2021-05-31 04:58:07.901623 (MainThread): Running with dbt=0.19.1
2021-05-31 04:58:08.711184 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 04:58:08.712655 (MainThread): Tracking: tracking
2021-05-31 04:58:08.713145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb0edbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb3152550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb31525e0>]}
2021-05-31 04:58:08.724341 (MainThread): Partial parsing not enabled
2021-05-31 04:58:08.725640 (MainThread): Parsing macros/catalog.sql
2021-05-31 04:58:08.728453 (MainThread): Parsing macros/adapters.sql
2021-05-31 04:58:08.757603 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 04:58:08.759388 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 04:58:08.760680 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 04:58:08.764166 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 04:58:08.773171 (MainThread): Parsing macros/core.sql
2021-05-31 04:58:08.776542 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 04:58:08.784462 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 04:58:08.786041 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 04:58:08.802292 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 04:58:08.833429 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 04:58:08.852604 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 04:58:08.854255 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 04:58:08.859620 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 04:58:08.872796 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 04:58:08.878923 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 04:58:08.884497 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 04:58:08.888807 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 04:58:08.889659 (MainThread): Parsing macros/etc/query.sql
2021-05-31 04:58:08.890579 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 04:58:08.892010 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 04:58:08.900646 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 04:58:08.902432 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 04:58:08.904000 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 04:58:08.943550 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 04:58:08.945256 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 04:58:08.946603 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 04:58:08.948110 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 04:58:08.954555 (MainThread): Partial parsing not enabled
2021-05-31 04:58:08.973035 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:08.980176 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 04:58:08.983216 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:09.022090 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33951f0>]}
2021-05-31 04:58:09.083862 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb311fbe0>]}
2021-05-31 04:58:09.084226 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 04:58:09.085074 (MainThread): 
2021-05-31 04:58:09.085470 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:58:09.086584 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 04:58:09.101873 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 04:58:09.102041 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 04:58:09.102145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 04:58:10.980060 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.88 seconds
2021-05-31 04:58:10.984366 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 04:58:12.083869 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:58:12.091518 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 04:58:12.091643 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 04:58:12.091743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 04:58:13.676088 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.58 seconds
2021-05-31 04:58:13.677267 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 04:58:14.701673 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:14.701860 (MainThread): On master: BEGIN
2021-05-31 04:58:14.701976 (MainThread): Opening a new connection, currently in state init
2021-05-31 04:58:16.133034 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:58:16.133280 (MainThread): On master: COMMIT
2021-05-31 04:58:16.133494 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:16.133610 (MainThread): On master: COMMIT
2021-05-31 04:58:16.543251 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-05-31 04:58:16.543534 (MainThread): On master: Close
2021-05-31 04:58:17.262131 (MainThread): 10:28:17 | Concurrency: 10 threads (target='dev')
2021-05-31 04:58:17.262367 (MainThread): 10:28:17 | 
2021-05-31 04:58:17.264704 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 04:58:17.264949 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 04:58:17.265351 (Thread-1): 10:28:17 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 04:58:17.265697 (Thread-2): 10:28:17 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 04:58:17.266452 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:17.266755 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:17.266921 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 04:58:17.267085 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 04:58:17.268451 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:58:17.269745 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 04:58:17.270269 (Thread-1): finished collecting timing info
2021-05-31 04:58:17.281019 (Thread-2): finished collecting timing info
2021-05-31 04:58:17.315499 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 04:58:17.317713 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 04:58:17.318554 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:17.318655 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 04:58:17.318745 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 04:58:17.320291 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:17.320397 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 04:58:17.320507 (Thread-2): Opening a new connection, currently in state init
2021-05-31 04:58:18.563542 (Thread-2): SQL status: SUCCESS 1 in 1.24 seconds
2021-05-31 04:58:18.563748 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 04:58:18.563856 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 04:58:18.835951 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 04:58:18.836167 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 04:58:18.836273 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 04:58:18.874856 (Thread-2): Snowflake query id: 019c9b6a-0000-43cf-0000-b0b10001c072
2021-05-31 04:58:18.875072 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 04:58:18.875299 (Thread-2): finished collecting timing info
2021-05-31 04:58:18.875504 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 04:58:19.219015 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 04:58:19.473225 (Thread-1): Snowflake query id: 019c9b6a-0000-43db-0000-b0b10001b072
2021-05-31 04:58:19.473441 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:58:19.473647 (Thread-1): finished collecting timing info
2021-05-31 04:58:19.473843 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 04:58:19.781715 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 04:58:19.784700 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb35d7610>]}
2021-05-31 04:58:19.785105 (Thread-2): 10:28:19 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 2.52s]
2021-05-31 04:58:19.785263 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 04:58:19.819358 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 04:58:20.435398 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:58:20.436209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93cbc1a-07ab-45b9-918a-99eb86ab4ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb35d7610>]}
2021-05-31 04:58:20.436586 (Thread-1): 10:28:20 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 3.17s]
2021-05-31 04:58:20.436742 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 04:58:20.437352 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 04:58:20.437537 (Thread-4): 10:28:20 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 04:58:20.437691 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 04:58:20.439063 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 04:58:20.439256 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:20.439346 (MainThread): On master: BEGIN
2021-05-31 04:58:20.439428 (MainThread): Opening a new connection, currently in state closed
2021-05-31 04:58:21.870347 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 04:58:21.870618 (MainThread): On master: COMMIT
2021-05-31 04:58:21.870855 (MainThread): Using snowflake connection "master".
2021-05-31 04:58:21.870986 (MainThread): On master: COMMIT
2021-05-31 04:58:22.332896 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-05-31 04:58:22.333175 (MainThread): On master: Close
2021-05-31 04:58:22.996092 (MainThread): 10:28:22 | 
2021-05-31 04:58:22.996317 (MainThread): 10:28:22 | Finished running 3 view models in 13.91s.
2021-05-31 04:58:22.996458 (MainThread): Connection 'master' was properly closed.
2021-05-31 04:58:22.996557 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 04:58:22.996646 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 04:58:23.001124 (MainThread): 
2021-05-31 04:58:23.001295 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 04:58:23.001424 (MainThread): 
2021-05-31 04:58:23.001546 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 04:58:23.001652 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:58:23.001747 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 04:58:23.001840 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 04:58:23.001938 (MainThread): 
2021-05-31 04:58:23.002046 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 04:58:23.002202 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 04:58:23.002355 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 04:58:23.002468 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 04:58:23.002583 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 04:58:23.002766 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb490ccd0>]}
2021-05-31 04:58:23.002988 (MainThread): Flushing usage events
2021-05-31 05:26:49.551231 (MainThread): Running with dbt=0.19.1
2021-05-31 05:26:50.592902 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 05:26:50.594319 (MainThread): Tracking: tracking
2021-05-31 05:26:50.594768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27f6c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282a0e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282a0e7c0>]}
2021-05-31 05:26:50.604487 (MainThread): Partial parsing not enabled
2021-05-31 05:26:50.605470 (MainThread): Parsing macros/catalog.sql
2021-05-31 05:26:50.607731 (MainThread): Parsing macros/adapters.sql
2021-05-31 05:26:50.633742 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 05:26:50.635480 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 05:26:50.636773 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 05:26:50.640194 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 05:26:50.649058 (MainThread): Parsing macros/core.sql
2021-05-31 05:26:50.652473 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 05:26:50.660041 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 05:26:50.661553 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 05:26:50.677320 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 05:26:50.707490 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 05:26:50.726504 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 05:26:50.728123 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 05:26:50.733407 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 05:26:50.746175 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 05:26:50.752161 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 05:26:50.757623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 05:26:50.761789 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 05:26:50.762607 (MainThread): Parsing macros/etc/query.sql
2021-05-31 05:26:50.763491 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 05:26:50.764864 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 05:26:50.772466 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 05:26:50.774133 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 05:26:50.775819 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 05:26:50.813989 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 05:26:50.815592 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 05:26:50.816896 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 05:26:50.818357 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 05:26:50.824647 (MainThread): Partial parsing not enabled
2021-05-31 05:26:50.843127 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:50.850395 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 05:26:50.853325 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:50.886586 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282c541f0>]}
2021-05-31 05:26:50.945442 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2828dedf0>]}
2021-05-31 05:26:50.945772 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 05:26:50.946567 (MainThread): 
2021-05-31 05:26:50.946940 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:26:50.948013 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 05:26:50.966473 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 05:26:50.966636 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 05:26:50.966741 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 05:26:52.796660 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.83 seconds
2021-05-31 05:26:52.801118 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 05:26:53.595326 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:26:53.603368 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:26:53.603499 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 05:26:53.603604 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 05:26:54.843349 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.24 seconds
2021-05-31 05:26:54.844511 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 05:26:55.460563 (MainThread): Using snowflake connection "master".
2021-05-31 05:26:55.460757 (MainThread): On master: BEGIN
2021-05-31 05:26:55.460877 (MainThread): Opening a new connection, currently in state init
2021-05-31 05:26:56.683724 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-05-31 05:26:56.684004 (MainThread): On master: COMMIT
2021-05-31 05:26:56.684242 (MainThread): Using snowflake connection "master".
2021-05-31 05:26:56.684376 (MainThread): On master: COMMIT
2021-05-31 05:26:57.028399 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-05-31 05:26:57.028675 (MainThread): On master: Close
2021-05-31 05:26:57.627612 (MainThread): 10:56:57 | Concurrency: 10 threads (target='dev')
2021-05-31 05:26:57.627841 (MainThread): 10:56:57 | 
2021-05-31 05:26:57.630082 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 05:26:57.630408 (Thread-1): 10:56:57 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 05:26:57.630615 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 05:26:57.631298 (Thread-2): 10:56:57 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 05:26:57.631509 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:57.631797 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:57.631938 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 05:26:57.632050 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 05:26:57.633248 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:26:57.634383 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:26:57.634906 (Thread-1): finished collecting timing info
2021-05-31 05:26:57.635045 (Thread-2): finished collecting timing info
2021-05-31 05:26:57.669264 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:26:57.671554 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:26:57.672434 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:57.672537 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 05:26:57.672628 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 05:26:57.674246 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:57.674425 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 05:26:57.674536 (Thread-2): Opening a new connection, currently in state init
2021-05-31 05:26:58.898653 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-05-31 05:26:58.898904 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:26:58.899040 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 05:26:59.193116 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-05-31 05:26:59.193361 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:26:59.193495 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 05:26:59.209843 (Thread-1): Snowflake query id: 019c9b86-0000-43cf-0000-b0b10001c082
2021-05-31 05:26:59.210061 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:26:59.210291 (Thread-1): finished collecting timing info
2021-05-31 05:26:59.210506 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 05:26:59.502262 (Thread-2): Snowflake query id: 019c9b86-0000-43dc-0000-b0b10001d01a
2021-05-31 05:26:59.502480 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:26:59.502690 (Thread-2): finished collecting timing info
2021-05-31 05:26:59.502890 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 05:26:59.612001 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 05:26:59.967761 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 05:27:00.288084 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:27:00.291348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282edc1f0>]}
2021-05-31 05:27:00.291737 (Thread-1): 10:57:00 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.66s]
2021-05-31 05:27:00.291910 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 05:27:00.746330 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:27:00.747054 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc9b51b1-9668-4ed2-b66b-d0629aad8ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282edc5b0>]}
2021-05-31 05:27:00.747377 (Thread-2): 10:57:00 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 3.12s]
2021-05-31 05:27:00.747518 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 05:27:00.748065 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 05:27:00.748232 (Thread-4): 10:57:00 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 05:27:00.748458 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 05:27:00.749622 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:27:00.749824 (MainThread): Using snowflake connection "master".
2021-05-31 05:27:00.749920 (MainThread): On master: BEGIN
2021-05-31 05:27:00.750008 (MainThread): Opening a new connection, currently in state closed
2021-05-31 05:27:02.320039 (MainThread): SQL status: SUCCESS 1 in 1.57 seconds
2021-05-31 05:27:02.320307 (MainThread): On master: COMMIT
2021-05-31 05:27:02.320535 (MainThread): Using snowflake connection "master".
2021-05-31 05:27:02.320669 (MainThread): On master: COMMIT
2021-05-31 05:27:02.725569 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-05-31 05:27:02.725843 (MainThread): On master: Close
2021-05-31 05:27:03.426424 (MainThread): 10:57:03 | 
2021-05-31 05:27:03.426657 (MainThread): 10:57:03 | Finished running 3 view models in 12.48s.
2021-05-31 05:27:03.426799 (MainThread): Connection 'master' was properly closed.
2021-05-31 05:27:03.426901 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 05:27:03.426995 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 05:27:03.431531 (MainThread): 
2021-05-31 05:27:03.431698 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 05:27:03.431840 (MainThread): 
2021-05-31 05:27:03.431974 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 05:27:03.432094 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:27:03.432205 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:27:03.432313 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:27:03.432427 (MainThread): 
2021-05-31 05:27:03.432551 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 05:27:03.432668 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:27:03.432773 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:27:03.432876 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:27:03.432990 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 05:27:03.433180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282e01b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282ba2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd282e39c70>]}
2021-05-31 05:27:03.433439 (MainThread): Flushing usage events
2021-05-31 05:44:52.967276 (MainThread): Running with dbt=0.19.1
2021-05-31 05:44:54.525245 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dhirajpatra/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-31 05:44:54.527603 (MainThread): Tracking: tracking
2021-05-31 05:44:54.528506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ea805f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec34e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec34e6d0>]}
2021-05-31 05:44:54.542723 (MainThread): Partial parsing not enabled
2021-05-31 05:44:54.544824 (MainThread): Parsing macros/catalog.sql
2021-05-31 05:44:54.548433 (MainThread): Parsing macros/adapters.sql
2021-05-31 05:44:54.586073 (MainThread): Parsing macros/materializations/merge.sql
2021-05-31 05:44:54.588871 (MainThread): Parsing macros/materializations/view.sql
2021-05-31 05:44:54.591017 (MainThread): Parsing macros/materializations/table.sql
2021-05-31 05:44:54.596272 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-31 05:44:54.609217 (MainThread): Parsing macros/core.sql
2021-05-31 05:44:54.614249 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-31 05:44:54.625752 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-31 05:44:54.628403 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-31 05:44:54.651474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-31 05:44:54.697193 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-31 05:44:54.724894 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-31 05:44:54.727679 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-31 05:44:54.735516 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-31 05:44:54.756082 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-31 05:44:54.765588 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-31 05:44:54.773629 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-31 05:44:54.779956 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-31 05:44:54.781624 (MainThread): Parsing macros/etc/query.sql
2021-05-31 05:44:54.783339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-31 05:44:54.785559 (MainThread): Parsing macros/etc/datetime.sql
2021-05-31 05:44:54.797261 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-31 05:44:54.800442 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-31 05:44:54.802755 (MainThread): Parsing macros/adapters/common.sql
2021-05-31 05:44:54.857919 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-31 05:44:54.860792 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-31 05:44:54.863208 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-31 05:44:54.865437 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-31 05:44:54.873943 (MainThread): Partial parsing not enabled
2021-05-31 05:44:54.900251 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:44:54.911551 (MainThread): Acquiring new snowflake connection "model.demo_dbt.customers".
2021-05-31 05:44:54.916616 (MainThread): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:44:54.967159 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec594130>]}
2021-05-31 05:44:55.046006 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec31ecd0>]}
2021-05-31 05:44:55.046390 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-31 05:44:55.047288 (MainThread): 
2021-05-31 05:44:55.047821 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:44:55.049011 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-05-31 05:44:55.068212 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-05-31 05:44:55.068378 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-05-31 05:44:55.068486 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-31 05:44:56.689432 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-05-31 05:44:56.693229 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-05-31 05:44:57.269774 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:44:57.277807 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-05-31 05:44:57.278031 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-05-31 05:44:57.278157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-31 05:44:58.566817 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.29 seconds
2021-05-31 05:44:58.567713 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-05-31 05:44:59.147938 (MainThread): Using snowflake connection "master".
2021-05-31 05:44:59.148109 (MainThread): On master: BEGIN
2021-05-31 05:44:59.148215 (MainThread): Opening a new connection, currently in state init
2021-05-31 05:45:00.445703 (MainThread): SQL status: SUCCESS 1 in 1.30 seconds
2021-05-31 05:45:00.445948 (MainThread): On master: COMMIT
2021-05-31 05:45:00.446146 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:00.446251 (MainThread): On master: COMMIT
2021-05-31 05:45:00.825221 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 05:45:00.825470 (MainThread): On master: Close
2021-05-31 05:45:01.476743 (MainThread): 11:15:01 | Concurrency: 10 threads (target='dev')
2021-05-31 05:45:01.476971 (MainThread): 11:15:01 | 
2021-05-31 05:45:01.478692 (Thread-1): Began running node model.demo_dbt.stg_customers
2021-05-31 05:45:01.478919 (Thread-2): Began running node model.demo_dbt.stg_orders
2021-05-31 05:45:01.479235 (Thread-1): 11:15:01 | 1 of 3 START view model PUBLIC.stg_customers......................... [RUN]
2021-05-31 05:45:01.479490 (Thread-2): 11:15:01 | 2 of 3 START view model PUBLIC.stg_orders............................ [RUN]
2021-05-31 05:45:01.480256 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:01.480515 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:01.480677 (Thread-2): Compiling model.demo_dbt.stg_orders
2021-05-31 05:45:01.480820 (Thread-1): Compiling model.demo_dbt.stg_customers
2021-05-31 05:45:01.482024 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:45:01.483194 (Thread-1): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:45:01.483777 (Thread-2): finished collecting timing info
2021-05-31 05:45:01.512171 (Thread-1): finished collecting timing info
2021-05-31 05:45:01.512035 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-05-31 05:45:01.514593 (Thread-1): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-05-31 05:45:01.515701 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:01.516212 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:01.516300 (Thread-2): On model.demo_dbt.stg_orders: BEGIN
2021-05-31 05:45:01.516418 (Thread-1): On model.demo_dbt.stg_customers: BEGIN
2021-05-31 05:45:01.516564 (Thread-2): Opening a new connection, currently in state init
2021-05-31 05:45:01.516701 (Thread-1): Opening a new connection, currently in state closed
2021-05-31 05:45:02.774069 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-05-31 05:45:02.774265 (Thread-1): Using snowflake connection "model.demo_dbt.stg_customers".
2021-05-31 05:45:02.774369 (Thread-1): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create or replace  view DEMO_DB.PUBLIC.stg_customers  as (
    select 
    id as customer_id,
    first_name,
    last_name

from customers
  );
2021-05-31 05:45:03.111532 (Thread-1): Snowflake query id: 019c9b99-0000-43cf-0000-b0b10001c0ca
2021-05-31 05:45:03.111709 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:45:03.111881 (Thread-1): finished collecting timing info
2021-05-31 05:45:03.112033 (Thread-1): On model.demo_dbt.stg_customers: ROLLBACK
2021-05-31 05:45:03.123854 (Thread-2): SQL status: SUCCESS 1 in 1.61 seconds
2021-05-31 05:45:03.124046 (Thread-2): Using snowflake connection "model.demo_dbt.stg_orders".
2021-05-31 05:45:03.124145 (Thread-2): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create or replace  view DEMO_DB.PUBLIC.stg_orders  as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

from orders
  );
2021-05-31 05:45:03.455647 (Thread-1): On model.demo_dbt.stg_customers: Close
2021-05-31 05:45:03.633336 (Thread-2): Snowflake query id: 019c9b99-0000-43dd-0000-b0b10001a10a
2021-05-31 05:45:03.633499 (Thread-2): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:45:03.633648 (Thread-2): finished collecting timing info
2021-05-31 05:45:03.633787 (Thread-2): On model.demo_dbt.stg_orders: ROLLBACK
2021-05-31 05:45:04.114481 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:45:04.125084 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec6abd60>]}
2021-05-31 05:45:04.125484 (Thread-1): 11:15:04 | 1 of 3 ERROR creating view model PUBLIC.stg_customers................ [ERROR in 2.65s]
2021-05-31 05:45:04.125644 (Thread-1): Finished running node model.demo_dbt.stg_customers
2021-05-31 05:45:04.143216 (Thread-2): On model.demo_dbt.stg_orders: Close
2021-05-31 05:45:04.755251 (Thread-2): Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dhirajpatra/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:45:04.756162 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e30375dc-2b4f-4d9f-939a-4ca3f7cd2541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec6ab730>]}
2021-05-31 05:45:04.756566 (Thread-2): 11:15:04 | 2 of 3 ERROR creating view model PUBLIC.stg_orders................... [ERROR in 3.28s]
2021-05-31 05:45:04.757285 (Thread-2): Finished running node model.demo_dbt.stg_orders
2021-05-31 05:45:04.757994 (Thread-4): Began running node model.demo_dbt.customers
2021-05-31 05:45:04.758290 (Thread-4): 11:15:04 | 3 of 3 SKIP relation PUBLIC.customers................................ [SKIP]
2021-05-31 05:45:04.758471 (Thread-4): Finished running node model.demo_dbt.customers
2021-05-31 05:45:04.760120 (MainThread): Acquiring new snowflake connection "master".
2021-05-31 05:45:04.760375 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:04.760478 (MainThread): On master: BEGIN
2021-05-31 05:45:04.760570 (MainThread): Opening a new connection, currently in state closed
2021-05-31 05:45:06.192396 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-05-31 05:45:06.192595 (MainThread): On master: COMMIT
2021-05-31 05:45:06.192761 (MainThread): Using snowflake connection "master".
2021-05-31 05:45:06.192851 (MainThread): On master: COMMIT
2021-05-31 05:45:06.572303 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-05-31 05:45:06.572575 (MainThread): On master: Close
2021-05-31 05:45:07.323672 (MainThread): 11:15:07 | 
2021-05-31 05:45:07.323884 (MainThread): 11:15:07 | Finished running 3 view models in 12.28s.
2021-05-31 05:45:07.324008 (MainThread): Connection 'master' was properly closed.
2021-05-31 05:45:07.324091 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-05-31 05:45:07.324166 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-05-31 05:45:07.328310 (MainThread): 
2021-05-31 05:45:07.328495 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-31 05:45:07.328618 (MainThread): 
2021-05-31 05:45:07.328728 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-05-31 05:45:07.328836 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:45:07.329021 (MainThread):   Object 'DEMO_DB.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-05-31 05:45:07.329144 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_customers.sql
2021-05-31 05:45:07.329253 (MainThread): 
2021-05-31 05:45:07.329365 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-05-31 05:45:07.329464 (MainThread):   002003 (42S02): SQL compilation error:
2021-05-31 05:45:07.329550 (MainThread):   Object 'DEMO_DB.PUBLIC.ORDERS' does not exist or not authorized.
2021-05-31 05:45:07.329633 (MainThread):   compiled SQL at target/run/demo_dbt/models/stg_orders.sql
2021-05-31 05:45:07.329726 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-05-31 05:45:07.329893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec4e26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec674a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec674af0>]}
2021-05-31 05:45:07.330119 (MainThread): Flushing usage events
